{"version":3,"sources":["component/highlight/index.js","component/utility/Export.js","data/utilities/checkModifierKeyActivated.js","component/EventsTrackers/BrushTracker.js","component/EventsTrackers/MouseTracker.js","component/context/ChartContext.jsx","component/context/DispatchContext.jsx","component/context/PreferencesContext.jsx","component/context/ScaleContext.jsx","component/elements/popup/options.js","component/elements/popup/Modal/Context.js","component/elements/popup/Modal/Modal.jsx","component/elements/popup/Transition.js","component/elements/popup/Wrapper.js","component/elements/popup/Modal/ConfirmDialog.jsx","component/elements/popup/Modal/Provider.js","component/context/LoaderContext.tsx","component/loader/NoData.jsx","component/loader/DefaultSpinnerComponent.tsx","component/loader/SpinnerContext.tsx","component/loader/Spinner.jsx","component/context/GlobalContext.jsx","component/elements/ToolTip/ToolTip.jsx","component/elements/CloseButton.jsx","component/modal/MultipletAnalysisModal.jsx","component/constants/InitSetting.js","component/utility/LocalStorage.js","component/reducer/helper/Spectrum1DZoomHelper.js","component/reducer/actions/Zoom.js","component/1d/utilities/scale.js","component/reducer/scaleReducer.js","component/reducer/types/Types.js","data/data1d/filter1d/absolute.js","data/data1d/filter1d/autoPhaseCorrection.js","data/data1d/filter1d/baselineCorrection.js","data/data1d/filter1d/centerMean.js","data/data1d/filter1d/digitalFilter.js","data/data1d/filter1d/equallySpaced.js","data/data1d/filter1d/fft.js","data/data1d/filter1d/fromTo.js","data/data1d/filter1d/lineBroadening.js","data/data1d/filter1d/pareto.js","data/data1d/filter1d/phaseCorrection.js","data/data1d/filter1d/shiftX.js","data/data1d/filter1d/standardDeviation.js","data/data1d/filter1d/zeroFilling.js","data/data2d/filter2d/shiftX.js","data/data2d/filter2d/shiftY.js","data/Filters.js","component/toolbar/ToolTypes.js","component/tool/BrushXY.jsx","component/tool/CrossLinePointer.jsx","component/utility/Events.js","component/elements/DeleteButton.jsx","component/1d/BaseLineZones.jsx","component/hoc/ExclusionZonesWrapper.js","component/1d/ExclusionZones.jsx","component/panels/extra/preferences/defaultValues.js","component/1d/Resizable.jsx","component/1d/IntegralResizable.jsx","component/1d/Integral.jsx","component/1d/IntegralsSeries.jsx","component/1d/Line.jsx","component/1d/LinesSeries.jsx","component/utility/FormatNumber.js","component/1d/PeakNotation.jsx","component/1d/PeaksNotations.jsx","component/1d/XAxis.jsx","component/hoc/MultiAnalysisWrapper.js","component/1d/multiAnalysis/AnalysisRange.jsx","component/1d/multiAnalysis/MultiAnalysisRanges.jsx","component/hoc/RangesWrapper.js","data/constants/SignalsKinds.js","data/utilities/RangeUtilities.js","component/assignment/index.js","data/constants/Multiplets.js","component/panels/extra/utilities/MultiplicityUtilities.js","component/1d/multiplicityTree/TreeColors.js","component/1d/multiplicityTree/LevelNode.jsx","component/1d/multiplicityTree/StringNode.jsx","component/1d/multiplicityTree/TreeNodes.jsx","component/1d/multiplicityTree/buildTreeNode.js","component/1d/multiplicityTree/MultiplicityTree.jsx","component/1d/ranges/Range.jsx","component/1d/ranges/Ranges.jsx","component/1d/Chart1D.jsx","component/elements/popup/Help/Context.js","component/elements/popup/helpers.js","component/elements/popup/Help/Reducer.js","component/elements/popup/Help/Provider.js","component/hoc/FooterWarpper.js","component/1d/FooterBanner.jsx","component/1d/SpectraTracker.jsx","component/1d/tool/PeakPointer.jsx","component/1d/tool/VerticalIndicator.jsx","component/1d/tool/XLabelPointer.jsx","component/1d/Viewer1D.jsx","component/hoc/ContoursWrapper.js","component/2d/utilities/DimensionLayout.js","component/2d/utilities/scale.js","component/2d/Contours.jsx","component/reducer/core/Constants.js","component/2d/IndicationLines.jsx","component/2d/Left1DChart.jsx","component/2d/Top1DChart.jsx","component/2d/XAxis.jsx","component/2d/YAxis.jsx","component/hoc/ZonesWrapper.js","data/utilities/ZoneUtilities.js","data/utilities/Concatenation.js","component/2d/SignalDeltaLine.jsx","component/2d/zones/SignalCrosshair.jsx","component/2d/zones/Signal.jsx","component/2d/zones/Zone.jsx","component/2d/zones/Zones.jsx","component/2d/Chart2D.jsx","component/2d/FooterBanner.jsx","component/2d/tools/XYLabelPointer.jsx","data/utilities/generateID.js","data/FiltersManager.ts","data/utilities/getColor.js","data/data1d/autoRangesDetection.js","data/data1d/detectSignal.js","data/data1d/Datum1D.ts","data/data2d/Processing2D.js","data/data2d/Datum2D.ts","data/data2d/autoZonesDetection.js","component/2d/tools/slicing/SliceScale.js","component/2d/tools/slicing/HorizontalSliceChart.jsx","component/2d/tools/slicing/VerticalSliceChart.jsx","component/2d/tools/slicing/SlicingView.jsx","component/2d/Viewer2D.jsx","component/ErrorBoundary.tsx","component/elements/popup/Alert/Context.js","component/elements/popup/Alert/ProgressIndicator.js","component/elements/popup/Alert/Provider.js","data/data1d/Data1DManager.js","data/data2d/Data2DManager.js","data/SpectraManager.js","component/elements/CheckBox.jsx","component/elements/formik/FormikCheckBox.jsx","component/elements/formik/FormikForm.jsx","component/elements/Input.jsx","component/elements/formik/FormikInput.jsx","component/modal/ModalStyle.js","component/modal/SaveAsModal.jsx","component/utility/util/getToFix.js","component/utility/util/get1DSignals.js","component/utility/util/getCouplingObserved.js","component/utility/util/get2DSignals.js","component/utility/util/flat2DSignals.js","component/utility/util/getLabels.js","component/utility/toNmredata.js","component/hooks/useExport.js","component/hooks/useToolsFunctions.js","component/EventsTrackers/KeysListenerTracker.js","component/constants/help.js","component/elements/ButtonToolTip.jsx","component/elements/Logo.jsx","component/modal/AboutUsModal.jsx","component/modal/UserManualModal.jsx","component/elements/Tab/DeleteButton.jsx","component/elements/Tab/Tab.jsx","component/elements/Tab/options.js","component/elements/Tab/Tabs.jsx","component/reducer/preferencesReducer.js","component/modal/setting/ControllersTabContent.jsx","component/modal/setting/DisplayTabContent.jsx","component/modal/setting/FormattingTabContent.jsx","component/modal/setting/GeneralSettings.jsx","component/elements/NumberInput.jsx","component/header/AutoPeakPickingOptionPanel.jsx","component/elements/Select.jsx","component/header/BaseLineCorrectionPanel.jsx","component/elements/InputRange.jsx","component/header/ManualPhaseCorrectionPanel.jsx","component/header/RangesPickingOptionPanel.jsx","component/header/ZeroFillingOptionsPanel.jsx","component/header/Zones2DOptionPanel.jsx","component/header/Header.jsx","component/utility/FileUtility.js","component/loader/DropZone.jsx","component/elements/accordion/AccordionItem.jsx","component/elements/accordion/Accordion.jsx","component/elements/ReactTable/Style.js","component/elements/ReactTable/ReactTableFlexLayout.jsx","component/hoc/InfoWrapper.js","component/panels/InformationPanel.jsx","component/hoc/IntegralsWrapper.js","component/modal/changeSum/NumberInput.jsx","component/elements/NextPrev.jsx","component/elements/MoleculeSelection.jsx","component/modal/changeSum/SelectMolecule.jsx","component/modal/changeSum/ChangeSumModal.jsx","component/elements/ToggleButton.jsx","component/panels/header/DefaultPanelHeader.jsx","component/elements/SaveButton.jsx","component/panels/header/PreferencesHeader.jsx","component/elements/EditableColumn.jsx","component/elements/ContextMenu.jsx","component/elements/ReactTable/Elements/ReactTableHeader.js","component/elements/ReactTable/Elements/ReactTableRow.js","component/elements/ReactTable/ReactTable.jsx","component/panels/extra/placeholder/NoTableData.jsx","component/panels/IntegralsPanel/IntegralTable.jsx","component/elements/ColorInput.jsx","component/panels/extra/preferences/ColumnFormatField.jsx","component/panels/IntegralsPanel/IntegralsPreferences.jsx","component/panels/IntegralsPanel/IntegralPanel.jsx","component/elements/MenuButton.jsx","component/hoc/MoleculeWrapper.js","component/modal/MoleculeStructureEditorModal.jsx","component/elements/IsotopesViewer.jsx","component/elements/formik/FormikSelect.jsx","component/modal/PredictSpectraModal.jsx","component/panels/MoleculesPanel/Utilities.js","component/panels/MoleculesPanel/MoleculePanel.jsx","data/data1d/MulitpleAnalysis.js","data/utilities/generateChar.js","data/constants/References.js","component/modal/AlignSpectraModal.jsx","component/modal/ExportAsMatrixModal.jsx","component/modal/MultipleSpectraFiltersModal/EquallySpacedFilter.jsx","component/modal/MultipleSpectraFiltersModal/FromToFilter.jsx","component/modal/MultipleSpectraFiltersModal/index.jsx","component/elements/styles/prism.js","component/utility/Evaluate.js","component/panels/MultipleSpectraAnalysisPanel/MulipleAnalysisCodeEditor.jsx","component/panels/MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisPreferences.jsx","component/elements/dropDownButton/DropDownList.jsx","component/elements/dropDownButton/DropDownButton.jsx","component/panels/MultipleSpectraAnalysisPanel/ColumnHeader.jsx","component/panels/MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisTable.jsx","component/panels/MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisPanel.jsx","component/hoc/PeaksWrapper.js","component/panels/PeaksPanel/PeaksPreferences.jsx","component/panels/PeaksPanel/PeaksTable.jsx","component/panels/PeaksPanel/PeaksPanel.jsx","component/modal/CopyClipboardModal.jsx","component/panels/RangesPanel/RangesHeader.jsx","component/panels/RangesPanel/RangesPreferences.jsx","component/panels/extra/utilities/UseToggleStatus.js","component/panels/extra/preferences/ColumnsHelper.js","component/panels/RangesPanel/TableColumns/AbsoluteColumn.jsx","component/elements/Button.jsx","component/elements/formik/ErrorMessage.jsx","component/elements/formik/Input.jsx","component/modal/editRange/forms/components/AddSignalFormTab.jsx","component/elements/formik/SelectBox.jsx","component/modal/editRange/forms/components/CouplingsTable.jsx","component/modal/editRange/forms/components/SignalFormTab.jsx","component/modal/editRange/forms/components/SignalsForm.jsx","component/modal/editRange/forms/validation/EditRangeValidation.js","component/modal/editRange/EditRangeModal.jsx","component/panels/RangesPanel/TableColumns/ActionsColumn.jsx","component/panels/RangesPanel/TableColumns/CouplingColumn.jsx","component/panels/RangesPanel/TableColumns/RangeAssignmentsColumn.jsx","component/panels/RangesPanel/TableColumns/RangeColumn.jsx","component/panels/RangesPanel/TableColumns/RelativeColumn.jsx","component/panels/RangesPanel/TableColumns/SignalAssignmentsColumn.jsx","component/panels/RangesPanel/TableColumns/format.js","component/panels/RangesPanel/TableColumns/SignalDeltaColumn.jsx","component/panels/RangesPanel/RangesTableRow.jsx","component/panels/RangesPanel/useMapRanges.js","component/panels/RangesPanel/RangesTable.jsx","component/panels/RangesPanel/RangesPanel.jsx","component/hoc/SpectraWraper.js","component/panels/SpectrumsPanel/SpectraPanelHeader.jsx","component/utility/GroupByInfoKey.js","component/panels/SpectrumsPanel/base/ColorIndicator.jsx","component/panels/SpectrumsPanel/base/ShowHideMarkersButton.jsx","component/panels/SpectrumsPanel/base/ShowHideSpectrumButton.jsx","component/panels/SpectrumsPanel/SpectrumListItem.jsx","component/elements/formik/FormikColorPicker.jsx","component/panels/SpectrumsPanel/base/setting/Spectrum1DHistogram.jsx","component/panels/SpectrumsPanel/base/setting/Spectrum1DSetting.jsx","component/elements/formik/FormikSlider.jsx","component/panels/SpectrumsPanel/base/setting/Spectrum2DHistogram.jsx","component/panels/SpectrumsPanel/base/setting/Spectrum2DSetting.jsx","component/panels/SpectrumsPanel/base/setting/SpectrumSetting.jsx","component/panels/SpectrumsPanel/SpectrumsTabs.jsx","component/panels/SpectrumsPanel/SpectrumListPanel.jsx","component/elements/SelectUncontrolled.jsx","component/panels/SummaryPanel/CorrelationTable/Constants.js","component/panels/SummaryPanel/Utilities.js","component/panels/SummaryPanel/CorrelationTable/AdditionalColumnHeader.jsx","component/panels/SummaryPanel/CorrelationTable/AdditionalColumnField.jsx","component/panels/SummaryPanel/CorrelationTable/CorrelationTableRow.jsx","component/panels/SummaryPanel/CorrelationTable/CorrelationTable.jsx","component/panels/SummaryPanel/Overview.jsx","component/elements/MolecularFormulaInput.jsx","component/panels/SummaryPanel/SetMolecularFormulaModal.jsx","component/panels/SummaryPanel/SetShiftTolerancesModal.jsx","component/panels/SummaryPanel/SummaryPanel.jsx","component/panels/ZonesPanel/ZonesPreferences.jsx","component/panels/ZonesPanel/TableColumns/ActionsColumn.jsx","component/panels/ZonesPanel/TableColumns/SignalAssignmentsColumn.jsx","component/panels/ZonesPanel/TableColumns/SignalAssignmentsColumns.jsx","component/panels/ZonesPanel/TableColumns/SignalDeltaColumn.jsx","component/panels/ZonesPanel/TableColumns/ZoneAssignmentsColumn.jsx","component/panels/ZonesPanel/TableColumns/ZoneAssignmentsColumns.jsx","component/panels/ZonesPanel/ZonesTableRow.jsx","component/panels/ZonesPanel/ZonesTable.jsx","component/panels/ZonesPanel/ZonesPanel.jsx","component/elements/Table/Table.jsx","component/elements/Table/TableBody.jsx","component/elements/Table/TableCell.jsx","component/elements/Table/TableHead.jsx","component/elements/Table/TableRow.jsx","component/hoc/FiltersWrapper.js","component/panels/filtersPanel/FiltersTableRow.jsx","component/panels/filtersPanel/FilterPanel.jsx","component/panels/Panels.jsx","component/reducer/IgnoreActions.ts","component/utility/nmredataToNmrium.js","component/reducer/actions/CorrelationsActions.ts","component/reducer/actions/DomainActions.ts","component/utility/nucluesToString.js","component/reducer/helper/GetClosestNumber.js","component/reducer/helper/ZoomHistory.js","component/reducer/actions/PreferencesActions.ts","component/reducer/actions/ToolsActions.ts","component/reducer/actions/FiltersActions.ts","component/reducer/helper/getRange.ts","component/reducer/actions/IntegralsActions.ts","data/molecules/Molecule.js","data/molecules/MoleculeManager.js","component/reducer/actions/LoadActions.ts","component/reducer/actions/RangesActions.ts","component/reducer/actions/ZonesActions.ts","component/reducer/helper/get2DRange.ts","component/reducer/actions/MoleculeActions.ts","component/reducer/actions/PeaksActions.ts","data/data1d/autoPeakPicking.js","component/reducer/actions/SpectraAanalysisAction.ts","data/data1d/getReferenceShift.js","component/reducer/actions/SpectrumsActions.ts","component/reducer/types/HistoryTypes.js","component/reducer/Reducer.ts","component/reducer/actions/DimensionsActions.ts","component/reducer/actions/HistoryActions.js","component/reducer/actions/GlobalActions.ts","component/hoc/ToolBarWrapper.js","component/modal/LoadJCAMPModal.jsx","component/toolbar/BasicToolBar.jsx","component/elements/toggle/ToggleButton.jsx","component/elements/toggle/ToggleButtonGroup.jsx","component/toolbar/FunctionToolBar.jsx","component/toolbar/ToolBar.jsx","component/NMRium.tsx"],"names":["TYPES","PEAK","INTEGRAL","RANGE","ZONE","EXCLUSION_ZONE","highlightContext","createContext","highlightReducer","state","action","type","payload","convertedHighlights","newState","highlights","value","highlighted","Object","keys","highlightedPermanently","Error","emptyState","HighlightProvider","props","useReducer","highlight","dispatch","contextValue","useMemo","Provider","children","useHighlightData","useContext","useHighlight","Array","isArray","context","newHighlights","push","String","useEffect","isActive","some","key","includes","isActivePermanently","show","useCallback","hide","add","id","remove","click","e","preventDefault","stopPropagation","onHover","onMouseEnter","onMouseLeave","onClick","copyFormattedHtml","html","container","document","createElement","innerHTML","style","position","pointerEvents","opacity","activeSheets","prototype","slice","call","styleSheets","filter","sheet","disabled","body","appendChild","window","getSelection","removeAllRanges","range","createRange","selectNode","addRange","execCommand","i","length","removeChild","copyHTMLToClipboard","data","a","copyTextToClipboard","navigator","clipboard","writeText","exportAsJSON","fileName","spaceIndent","isCompressed","fileData","JSON","stringify","ArrayBuffer","isView","from","blob","Blob","saveAs","zip","JSZip","file","generateAsync","compression","compressionOptions","level","console","log","exportAsMatrix","options","exportData","to","nbPoints","exportAsNMRE","then","content","exportAsSVG","elementID","getBlob","exportAsPng","width","height","canvas","getContext","fillStyle","fillRect","img","Image","url","URL","createObjectURL","onload","drawImage","png","toDataURL","revokeObjectURL","src","copyDataURLCliboard","image","copyBlobToCliboard","toBlob","b","clip","ClipboardItem","write","err","copyPNGToClipboard","ReferenceError","alert","_svg","getElementById","cloneNode","getAttribute","replace","querySelectorAll","forEach","element","head","svg","checkModifierKeyActivated","event","getModifierState","BrushContext","initialState","step","brush","start","end","debounceClickEvents","BrushTracker","className","onBrush","onZoom","onDoubleClick","noPropagation","reducer","useState","mouseDownTime","setMouseDownTime","mouseDownHandler","button","shiftKey","altKey","screenX","screenY","clientX","clientY","boundingRect","currentTarget","getBoundingClientRect","timeStamp","clickHandler","persist","x","y","callback","lodashDebounce","lodashMap","debounce","cancel","handleMouseWheel","deltaY","deltaX","deltaMode","startX","endX","Math","abs","moveCallback","upCallback","onMouseDown","onMouseUp","onMouseMove","onWheel","endY","startY","startScreenX","startScreenY","startClientX","startClientY","defaultProps","MouseContext","MouseaProvider","MouseTracker","mouseTrackerState","setMouseTrackerState","mouseMoveHandler","mouseLeaveHandler","ChartContext","ChartDataProvider","useChartData","dispatchContext","DispatchProvider","useDispatch","PreferencesConext","PreferencesProvider","usePreferences","scaleContext","ScaleProvider","useScale","positions","TOP_LEFT","TOP_CENTER","TOP_RIGHT","MIDDLE_LEFT","MIDDLE","MIDDLE_RIGHT","BOTTOM_LEFT","BOTTOM_CENTER","BOTTOM_RIGHT","types","transitions","ModalContext","ModalProvider","useModal","styles","outerContainer","top","right","bottom","left","backgroundColor","display","justifyContent","alignItems","zIndex","innerContainer","boxSizing","boxShadow","flexDirection","minWidth","minHeight","borderRadius","Modal","open","onClose","handleClose","defaultStyle","transition","transform","defaultTransitionStyles","entering","entered","exiting","exited","Transtion","transitionStyles","ref","useRef","nodeRef","timeout","default","Wrapper","getStyles","initialStyles","overflow","containerStyle","css","ConfirmationDialog","buttons","message","optionsHandler","handler","map","option","text","offset","wrapperRef","root","modal","setModal","current","parentStyle","innerWidth","innerHeight","closeHandler","component","_modal","isBackgroundBlur","enableResizing","onOpen","showConfirmDialog","dialogOptions","ConfirmDialog","keyHandler","addEventListener","removeEventListener","outerStyle","close","createPortal","TransitionGroup","appear","margin","userSelect","dragHandleClassName","enableUserSelectHack","cloneElement","cursor","CENTER","LoaderContext","LoaderProvider","useLoader","NoData","isEmpty","emptyText","loader","openFileDialogHadnler","DefaultSpinnerComponent","xmlns","viewBox","fill","d","defaultGetSpinner","spinnerContext","SpinnerProvider","Spinner","isLoading","undefined","checkEmpty","startCheckEmpty","timeour","setTimeout","clearTimeout","getSpinner","GlobalConetxt","GlobalProvider","useGlobal","padding","color","whiteSpace","fontSize","fontFamily","textShadow","ToolTip","popupPlacement","title","refChild","refContent","placement","setPlacement","showToolTip","elementsWraperRef","useLayoutEffect","pl","getPopupPlacement","childBounding","contentBounding","mouseOverHandler","mainContainer","onMouseOver","onMouseOut","popup","memo","CloseButton","popupTitle","loaderStyles","MultipletAnalysisModal","activeSpectrum","scaleX","analysisData","setAnalysisData","calcStart","setCalcStartStatus","isCalcFinished","setCalcFinished","index","info","invert","xGetFromToIndex","fromIndex","toIndex","analysesProps","result","analyseMultiplet","frequency","originFrequency","takeBestPartMultiplet","symmetrizeEachStep","debug","steps","chart","series","multiplet","j","multiplicity","coupling","toFixed","errorFunction","initSetting","controllers","mws","low","high","formatting","nucleus","name","useStateWithLocalStorage","localStorageKey","localStorage","getItem","setValue","setItem","setData","castData","parse","lodashSet","lodashGet","getLocalStorage","isJson","settings","getValue","object","keyPath","defaultValue","zoomDefaultValues","lowStep","highStep","speedThreshold","Spectrum1DZoomHelper","scale","this","slowZoomStep","fastZoomStep","wheel","deltaYValue","toString","_slowZoomStep","_fastZoomStep","LOW_STEP","FAST_STEP","ZOOM_STEP","_scale","sign","getScale","setScale","spectraZoomHanlders","integralZoomHanlder","ZoomType","initZoom1DHandler","datum","dimension","activeTab","getScaleByID","reduce","acc","setZoom","draft","defaultScale","spectrumID","zoomFactor","yDomains","scaleLinear","originDomain","min","max","scalePoint","yDomain","zoomIdentity","translate","rescaleY","domain","spectrumId","t","setZoom1D","tabActiveSpectrum","split","setIntegralZoom","originIntegralYDomain","scaleValue","newYDomain","integralZoomFactor","integralsYDomains","getXScale","xDomains","xDomain","mode","getYScale","verticalAlign","_height","flag","stacked","domainY","SET_SCALE","scaleInitialState","scaleY","scaleReducer","produce","INITIATE","LOAD_JSON_FILE","LOAD_JCAMP_FILE","LOAD_NMREDATA_FILE","LOAD_MOL_FILE","LOAD_ZIP_FILE","LOAD_JDF_FILE","ADD_PEAK","ADD_PEAKS","DELETE_PEAK_NOTATION","SHIFT_SPECTRUM","SET_X_DOMAIN","SET_Y_DOMAIN","SET_ORIGINAL_DOMAIN","SET_WIDTH","SET_DIMENSIONS","SET_SELECTED_TOOL","SET_SELECTED_FILTER","CHANGE_SPECTRUM_SETTING","FULL_ZOOM_OUT","CHANGE_VISIBILITY","CHANGE_PEAKS_MARKERS_VISIBILITY","CHANGE_ACTIVE_SPECTRUM","CHANGE_SPECTRUM_COLOR","ADD_INTEGRAL","DELETE_INTEGRAL","TOGGLE_REAL_IMAGINARY_VISIBILITY","SET_ZOOM_FACTOR","ADD_MOLECULE","SET_MOLECULE","DELETE_MOLECULE","SET_CORRELATION","SET_CORRELATIONS","SET_CORRELATIONS_MF","SET_CORRELATIONS_TOLERANCE","DELETE_SPECTRA","CHANGE_SPECTRUM_DISPLAY_VIEW_MODE","RESIZE_INTEGRAL","BRUSH_END","RESET_DOMAIN","CHANGE_INTEGRAL_ZOOM","ENABLE_FILTER","DELETE_FILTER","DELETE_SPECTRA_FILTER","APPLY_ZERO_FILLING_FILTER","APPLY_FFT_FILTER","CALCULATE_MANUAL_PHASE_CORRECTION_FILTER","APPLY_MANUAL_PHASE_CORRECTION_FILTER","APPLY_AUTO_PHASE_CORRECTION_FILTER","APPLY_ABSOLUTE_FILTER","SET_VERTICAL_INDICATOR_X_POSITION","AUTO_PEAK_PICKING","AUTO_RANGES_DETECTION","AUTO_ZONES_DETECTION","DELETE_RANGE","SET_SELECTED_OPTIONS_PANEL","SET_LOADING_FLAG","RESET_SELECTED_TOOL","SET_SPECTRUMS_VERTICAL_ALIGN","CHANGE_INTEGRAL_DATA","SET_ACTIVE_TAB","CHANGE_INTEGRAL_SUM","ADD_BASE_LINE_ZONE","DELETE_BASE_LINE_ZONE","APPLY_BASE_LINE_CORRECTION_FILTER","SET_KEY_PREFERENCES","APPLY_KEY_PREFERENCES","RESIZE_RANGE","CHANGE_RANGE_SUM","ADD_RANGE","SET_2D_LEVEL","ADD_2D_ZONE","DELETE_2D_ZONE","ADD_MISSING_PROJECTION","SET_FILTER_SNAPSHOT","CHANGE_RANGE_RELATIVE","CHANGE_RANGE_SIGNAL_VALUE","CHANGE_RANGE_SIGNAL_KIND","SAVE_EDITED_RANGE","UNLINK_RANGE","SET_DIAID_RANGE","CHANGE_INTEGRAL_RELATIVE","ANALYZE_SPECTRA","DELETE_ANALYZE_SPECTRA_RANGE","RESIZE_ANALYZE_SPECTRA_RANGE","SET_ANALYZE_SPECTRA_COLUMNS","FILTER_SPECTRA_COLUMN","ALIGN_SPECTRA","CHANGE_ZONE_SIGNAL_VALUE","CHANGE_ZONE_SIGNAL_KIND","UNLINK_ZONE","SET_DIAID_ZONE","PREDICT_SPECTRA","SET_SPECTRA_SAME_TOP","RESET_SPECTRA_SCALE","SET_MOUSE_OVER_DISPLAYER","APPLY_MULTIPLE_SPECTRA_FILTER","ADD_EXCLUSION_ZONE","DELETE_EXCLUSION_ZONE","apply","datum1D","isApplicable","re","reimAbsolute","im","Float64Array","isComplex","isFid","once","defaultOptions","magnitudeMode","minRegSize","maxDistanceToJoin","assign","reimAutoPhaseCorrection","previousValue","newValue","reduced","k","baselineAlgorithms","airpls","polynomial","corrected","algorithm","zones","airPLS","equallySpaced","numberOfPoints","baselineRegression","regression","predict","polynomialRegression","PolynomialRegression","degree","reMean","mean","imMean","digitalFilterValue","pointsToShift","floor","skip","newRe","newIm","set","exclusions","XREdata","XIMdata","digitalFilterApplied","filters","reimFFT","applyZeroShift","digitalFilter","ph1","PI","reimPhaseCorrection","generateXAxis","baseFrequency","parseFloat","frequencyOffset","spectralWidth","spectralHalfWidth","firstPoint","dx","xAxis","grpdly","newRE","newIM","dw","em","exp","coefExp","curFactor","xParetoNormalization","ph0","shiftValue","val","reStd","standardDeviation","imStd","size","newX","diff","currentX","_previousValue","datum2D","minX","maxX","minY","maxY","Filters","absolute","baselineCorrection","lineBroadening","fft","phaseCorrection","autoPhaseCorrection","shiftX","zeroFilling","fromTo","centerMean","pareto","shift2DX","shift2DY","zoom","label","hasOptionPanel","isFilter","peakPicking","integral","zone2D","slicingTool","HMove","equalizerTool","rangesPicking","baseLineCorrection","generalSelector","editRange","multipleSpectraAnalysis","exclusionZones","transformOrigin","allowTools","BRUSH_TYPE","BrushXY","brushType","dimensionBorder","widthProps","heightProps","selectedTool","willChange","line","stroke","strokeOpacity","shapeRendering","strokeWidth","CrossLinePointer","brushState","x1","y1","x2","y2","eventEmitter","EventEmitter","Emitter","on","fn","off","emit","freeze","DeleteButton","onDelete","data-no-export","rx","BaseLineZones","baseLineZones","deleteRangeHandler","zone","ExclusionZonesWrapper","WrappedComponent","ExclusionZone","ExclusionZones","integralDefaultValues","showAbsolute","absoluteFormat","showRelative","relativeFormat","rangeDefaultValues","showFrom","fromFormat","showTo","toFormat","peaksDefaultValues","showPeakNumber","peakNumberFormat","showPeakIndex","peakIndexFormat","showDeltaPPM","deltaPPMFormat","showDeltaHz","deltaHzFormat","showPeakWidth","peakWidthFormat","showIntensity","intensityFormat","Resizable","onDrag","onDrop","rightDragVisibility","setRightDragVisibility","leftDragVisibility","setLeftDragVisibility","enable","setEnable","draggableRightRef","draggableLeftRef","handleRightStart","handleRightDrag","layerX","handleRightStop","_range","handleLeftStart","handleLeftDrag","handleLeftStop","mouseDownCaptureHandler","mouseUpCaptureHandler","target","axis","defaultPosition","handle","onStart","onStop","fillOpacity","onMouseDownCapture","onMouseUpCapture","stylesOnHover","stylesHighlighted","IntegralResizable","integralData","setIntgral","handleOnStopResizing","resized","handleOnEnterNotation","handleOnMouseLeaveNotation","dragHandler","boundary","x0","fontWeight","Integral","preferences","integralSettings","xyIntegral","reverse","makePath","pathPoints","xyReduce","optimize","path","accumulator","point","IntegralsSeries","displayerKey","getIntegralYScale","Integrals","IsActive","isVisible","isVisibleInDomain","spectrum","integrals","values","clipPath","Line","vAlign","paths","_scaleX","_scaleY","get","LinesSeries","tempData","_data","useFormatNumberByNucleus","nucleusByKey","ppm","hz","formatFun","n","formatKey","prefix","suffix","Numeral","Number","format","toLowerCase","getNumberOfDecimals","lastIndex","trim","lastIndexOf","substr","FormatNumber","PeakNotation","refText","isSelected","setIsSelected","_value","containerSize","setContainerSize","handleOnPeakChange","textBox","getBBox","handleKeyDown","oldValue","blur","keyCode","handleChange","handleSelectPeakNotation","outline","dy","paddingRight","border","onKeyDown","onChange","PeaksNotations","Peaks","getVerticalAlign","findIndex","reSortData","sort","peaks","isPeaksMarkersVisible","delta","intensity","axisStyles","gridStyles","XAxis","showGrid","refAxis","refGrid","d3","ticks","tickFormat","grid","tickSize","Axis","textAnchor","Grid","propTypes","PropTypes","bool","string","MultiAnalysisWrapper","spectraAnalysis","forwardedRef","rest","forwardRef","AnalysisRange","rangeData","columnKey","deleteHandler","colKey","MultiAnalysisRanges","columns","ranges","RangesWrapper","molecules","find","SignalKinds","SignalKindsToInclude","DatumKind","getPubIntegral","getDiaIDs","concat","diaID","signal","_signal","flat","setPubIntegral","pubIntegral","resetDiaIDs","unlink","unlinkType","signalIndex","checkRangeKind","kind","unlinkInAssignmentData","assignmentData","ids","assignmentContext","assignmentReducer","assignment","_id","activeID","activeAxis","isOnHover","onHoverID","onHoverAxis","AssignmentProvider","spectraData","initAssignmentDataRanges","_contextValue","_diaID","initAssignmentDataZones","useAssignmentData","useAssignment","assigned","removeAll","toggle","deleteRecord","setIsOnHover","Multiplets","checkMultiplet","rejected","_multiplet","m","checkMultiplicity","translateMultiplet","hasCouplingConstant","TREE_LEVEL_COLORS","LevelNode","levelHeight","StringNode","showLabels","lengthAdjust","visibility","TreeNodes","nodesData","signalID","labelOptions","buildTreeNodeAndEdge","_startX","ratio","multiplicityIndex","edgeLevel","_startYEdge","_startYNode","distance","node","createTreeNodes","spectrumData","buildTreeNodesData","jIndices","treeNodesData","jIndex","_jIndex","pascal","getPascal","spin","mult","previousLine","_line","getMultiplicityNumber","charAt","MultiplicityTree","rangeFrom","rangeTo","xRange","setXRange","treeProps","setTreeProps","drawInFullRange","setDrawInFullRange","setShowLabels","_drawInFullRange","_treeWidth","_treeHeight","_treeLevelHeight","yMax","_x","_mult","_i","_xRange","_treeNodeData","multiplicityTree","firstLevelStartY","_startY","secondLevelStartY","_rangeFrom","_rangeTo","pathData","Range","showMultiplicityTrees","assignmentRange","highlightRange","rangeBoundary","setRangeBoundary","reduceOpacity","setReduceOpacity","isBlockedByEditing","setIsBlockedByEditing","mouseEnterHandler","assignHandler","Ranges","isMultiplicityTreesVisibile","Events","Chart1D","HelpContext","HelpProvider","useHelp","delay","ctrlKey","clear","groupBy","array","item","initState","helpText","helpObject","helpReducer","closeButton","dealyTimeOut","multiple","preventAutoHelp","timersId","modals","setModals","timersIdRef","currentModals","lengthBeforeRemove","filteredModals","helpid","random","modalOptions","startModal","timerId","splice","indexOf","helpState","modalsByPosition","_position","filePath","frameBorder","scrolling","FooterWarpper","helpStyles","FooterBanner","useHelptData","getYValue","xPosition","xIndex","xFindClosestIndex","toPrecision","MIN_VALUE","colorIndicator","borderBottom","marginBottom","YTracker","SpectraTracker","ToggleVisiblility","trackers","borderColor","PeakPointer","closePeakPosition","setPosition","candidatePeakPosition","getClosePeak","xShift","mouseCoordinates","maxIndex","number","minIndex","yDataRange","yValue","xValue","cx","cy","r","VerticalIndicator","pivot","XLabelPointer","activeSpectrumData","getXValue","xVal","xInvert","Viewer1D","general","widthProp","heightProp","scaleState","dispatchScale","handelBrushEnd","brushData","disableMultipletAnalysis","propagateEvent","startXPPM","endXPPM","handelOnDoubleClick","zoomType","handleZoom","mouseClick","xPPM","useSize","sizedNMRChart","finalSize","setFinalSize","useDebounce","isFinite","ContoursWrapper","LAYOUT","TOP_1D","LEFT_1D","CENTER_2D","getLayoutID","get2DXScale","get2DYScale","get1DYScale","ContoursPaths","contours","buildContourPath","lines","Contours","isPositiveVisible","positiveColor","isNegativeVisible","negativeColor","DISPLAYER_MODE","DM_1D","DM_2D","MARGIN","lineStyle","IndicationLines","displayerMode","deltas1D","setDeltas1D","deltas","_datum","experiment","_kind","indicationLines","_delta","Left1DChart","marignValue","originHeight","lastXIndex","lastYIndex","reduceRight","mainHeight","Top1DChart","marginProps","originMargin","shape","isRequired","YAxis","ZonesWrapper","isOnZoneLevel","buildID","SignalDeltaLine","SignalCrosshair","highlightIDsX","highlightIDsY","highlightX","highlightY","Signal","buildIDs","highlightData","isHighlighted","setIsHighlighted","_highlighted","signals","peak","Zone","zoneData","assignmentZone","highlightZone","checkZoneKind","Zones","setVisibility","prevVisiblity","Chart2D","onDimensionChange","propsTypes","PropsTypes","func","layout","data1D","trackID","nucleuses","formatX","formatY","getRealYValue","cordinate","getLabel","label2d","labelld","mf","getZValue","z","xStep","yStep","yIndex","getDeltaX","getRation","textAlign","XYLabelPointer","generateID","applyFilter","isReduced","filterOption","previousFilter","lookupForFilter","reduceResult","replaceFilter","addFilter","hasOwnProperty","isDeleteAllow","isLastFilter","reapplyFilters","f","filterName","_filters","enableFilter","checked","originalData","originalInfo","filterIndex","error","deleteFilter","isSnapshot","filterID","COLORS","color2D","cosy","roesy","noesy","tocsy","hsqc","hmbc","percentToHex","p","percent","hexValue","round","padStart","adjustAlpha","factor","getColor","isRandom","usedColors","resetColors","c","lum","hex","toUpperCase","rgb","parseInt","defaultPeakPickingOptions","minMaxRatio","realTopDetection","maxCriteria","smoothY","nH","compile","frequencyCluster","clean","keepPeaks","sgOptions","windowSize","detectSignal","join","chemShift","usedColors1D","initiateDatum1D","source","jcampURL","binary","extension","get1dColor","isRealSpectrumVisible","meta","sum","FiltersManager","preprocessing","FiltersTypes","toJSON","forceIncludeData","lookupPeak","dataRange","updateIntegralIntegrals","updateRelatives","countingCondition","storageKey","currentSum","previous","updateIntegralRanges","checkSignalKinds","kinds","mapRanges","getShiftX","newRange","xyIntegration","originDelta","originFrom","originTo","detectRanges","impurities","solvent","autoRangesDetection","noiseLevel","xAbsoluteMedian","windowFromIndex","windowToIndex","peakPickingOptions","rangesOptions","xyAutoRangesPicking","updateXShift","updatePeaksXShift","updateRangesXShift","s","updateIntegralXShift","defaultContourOptions","positive","contourLevels","numberOfLayers","negative","Processing2D","minMax","defaultLevel","currentLevelPositive","currentLevelNegative","xs","getRange","ys","conrec","Conrec","swapAxes","median","noise","getLevel","levelPositive","levelNegative","setLevel","setOptions","positiveBoundary","negativeBoundary","shiftWheel","drawContours","zoomPositive","zoomNegative","numberOfPositiveLayer","numberOfNegativeLayer","getContours","nbLevels","zoomLevel","maxZ","minZ","pow","drawContour","contourDrawer","levels","factors","lastFactor","usedColors2D","initiateDatum2D","jcamp","original","get2DColor","colors","contourOptions","processingController","getShift","shift","yShift","updateShift","updateZonesShift","getMissingProjection","projection","zoneToX","getDetectionZones","dataMatrix","selectedZone","getSubMatrix","fromX","toX","fromY","toY","xIndexFrom","yIndexFrom","xIndexTo","yIndexTo","MIN_SAFE_INTEGER","MAX_SAFE_INTEGER","nbXPoints","row","Float32Array","rowValue","autoZonesDetection","thresholdFactor","maxPercentCutOff","enhanceSymmetry","convolutionByFFT","isHomoNuclear","xyzAutoPeaksPicking","observeFrequencies","detectZones","xError","yError","formattedZones","newXRange","newYRange","shiftY","extent","HorizontalSliceChart","VerticalSliceChart","SlicingView","spectra","useMouseTracker","chart2d","scale2dX","scale2dY","getSlice","infoX","dataX","infoY","dataY","horizontal","vertical","Viewer2D","DIMENSION","get2DDimensionLayout","wheelData","header","ErrorBoundary","errorInfo","setState","componentStack","Component","AlertContext","AlertProvider","useAlert","ProgressIndicator","alertContext","alerts","setAlerts","currentAlerts","filteredAlerts","alertOptions","success","showLoading","Promise","resolve","alertsByPosition","fromBruker","dependentVariables","getData","components","fromCSD","dimensions","quantityName","count","incr","increment","magnitude","origin","originOffset","coordinatesOffset","buffer","addJcampFromURL","fetch","response","arrayBuffer","addJcamp","entries","fromJCAMP","noContour","xy","keepRecordsRegExp","profiling","entry","addJcampSS","fromParsedJcamp","parsedJcamp","Data1DManager","Data2DManager","addData","Datum1D","Datum2D","addJDF","jdf","converted","fromJEOL","description","metadata","acquisitionMode","acquisitionTime","spectralWidthClipped","application","isFt","fromJSON","promises","all","addBruker","noContours","correlations","multipleAnalysis","ob","CheckBox","checkProps","setCheck","handleCheck","defaultChecked","FormikCheckBox","resProps","useFormikContext","setFieldValue","changeHandler","htmlFor","FormikForm","initialValues","onSubmit","validationSchema","innerRef","lineHeight","Input","checkValue","enableAutoSelect","prop","setVal","select","formatValue","onChangeHandler","check","test","preventPropagate","input","onKeyPress","FormikInput","errors","touched","isInvalid","ModalStyles","INITIAL_VALUE","compressed","pretty","includeData","SaveAsModal","onSave","refForm","handleSave","submitForm","submitHandler","getToFix","nucleusArray","toFix","chooseDecimal","get1DSignals","labels","nmrRecord","str","nbOneD","counter","subfix","signalLabel","arr","separator","byDiaID","jCoupling","jCouple","putIntegral","nbAtoms","folder","getCouplingObserved","get2DSignals","nucleusRecorded","nbTwoD","pulseSequence","couplingObserved","xLabel","getAssignment","yLabel","flat2DSignals","flattedSignal","getLabels","groupedDiaIDs","molecule","connections","getShortestPaths","toLabel","maxLength","byAssignNumber","roiKey","flatSignals","rois","roi","diaIDs","groupedOclID","dia","oclID","atom","atoms","atomLabel","createLabel","pLabel","hLabel","getAtomLabel","tags","temperature","toNmredata","filename","sdfResult","jszip","OCLMolecule","fromMolfile","molfile","addImplicitHydrogens","getGroupedDiastereotopicAtomIDs","groupedOptions","toMolfile","putTag","formatAssignments","l","tag","useExport","saveToClipboardHandler","hideLoading","saveAsJSONHandler","exportedData","saveAsNMREHandler","saveAsSVGHandler","saveAsPNGHandler","saveHandler","saveAsHandler","useToolsFunctions","isRealSpectrumShown","setIsRealSpectrumShown","debounceClickEventsRef","clicks","handleChangeOption","handleFullZoomOut","changeDisplayViewModeHandler","changeSpectrumViewHandler","alignSpectrumsVerticallyHandler","KeysListenerTracker","keysPreferences","overDisplayer","allow1DTool","allow2DTool","integralID","activeKey","keysPreferencesListenerHandler","num","toolsListenerHandler","metaKey","toolID","handleOnKeyDown","localName","code","baseURL","getHelpList","zoomIn","integralPicking","fullScreen","loadSpectrum","ButtonToolTip","Logo","fillRule","points","json","AboutUsModal","setInfo","href","rel","UserManualModal","getHelpData","Tab","tabid","tablabel","canDelete","tabstyles","topStyles","leftStyles","Tabs","defaultTabID","setActiveTab","onClickTabHandler","tab","tabs","Children","child","candelete","deleteFlag","tabsContent","INIT_PREFERENCES","SET_PREFERENCES","SET_PANELS_PREFERENCES","preferencesInitialState","basePreferences","hideSetSumFromMolecule","panels","hideSpectraPanel","hideInformationPanel","hidePeaksPanel","hideIntegralsPanel","hideRangesPanel","hideStructuresPanel","hideFiltersPanel","hideZonesPanel","hideSummaryPanel","hideMultipleSpectraAnalysisPanel","toolBarButtons","hideZoomTool","hideZoomOutTool","hideImport","hideExportAs","hideSpectraStackAlignments","hideSpectraCenterAlignments","hideRealImaginary","hidePeakTool","hideIntegralTool","hideAutoRangesTool","hideZeroFillingTool","hidePhaseCorrectionTool","hideBaseLineCorrectionTool","hideFFTTool","hideMultipleSpectraAnalysisTool","help","dimmedSpectraTransparency","mapNucleus","preferencesReducer","nmrLocalStorageVersion","removeData","removeItem","storeData","localData","resPreferences","v","lodashMerge","ControllersTabContent","marginTop","LIST","DisplayTabContent","FormattingTabContent","nucleusesObject","addNewNucleusFormatHandler","newFormat","newNucleuses","GeneralSettings","setSettingsData","resValues","tabChangeHandler","flex","NumberInput","onInput","pattern","localRef","changeHander","checkValidity","inputContainer","actionButton","AutoPeakPickingOptionPanel","minMaxRatioRef","maxNumberOfPeaksRef","noiseFactor","lookNegativeRef","handleApplyFilter","maxNumberOfPeaks","lookNegative","handleCancelFilter","justifyItems","marginRight","Select","handleOnChanged","isNaN","BaseLineCorrectionPanel","algorithmRef","maxIterationsRef","toleranceRef","degreeRef","setAlgorithm","maxIterations","tolerance","getAlgorithmsList","changeAlgorithmHandler","marginLeft","textOverflow","maxWidth","stateValues","speedX","oldX","firstCalc","calcSpeed","setToZero","InputRange","minValue","maxValue","valueProps","mouseMoveCallback","valueRange","positionDiff","mouseUpCallback","phaseCorrectionTypes","algorithms","ManualPhaseCorrectionPanel","pivotIndex","phaseCorrectionType","setPhaseCorrectionType","handleInput","fieldName","inputValue","prevValue","handleRangeChange","hint","RangesPickingOptionPanel","formatNumber","Sizes","generateSizes","ZeroFillingOptionsPanel","sizeTextInputRef","lineBroadeningValue","setLineBroadeningValue","zeroFillingSize","getDefaultValue","log2","validity","valid","Zones2DOptionPanel","headerStyle","Header","isFullscreen","onMaximize","selectedOptionPanel","selectedPanel","openGeneralSettingsHandler","openUserManual","openAboutUs","data-helpid","FILES_TYPES","MOL","NMRIUM","DX","JDX","JDF","ZIP","SDF","FILES_SIGNATURES","asBuffer","checkStatus","ok","status","statusText","getFileExtension","getFileName","loadFiles","acceptedFiles","reject","reader","FileReader","onabort","onerror","readAsArrayBuffer","readAsBinaryString","loadFilesFromZip","files","async","DropZone","loadsubFilesfromZip","extractedfiles","uniqueFileExtensions","selectedFilesByExtensions","decoder","TextDecoder","decode","loadFilesHandler","Set","fileArrayBuffer","Uint8Array","byte","Zip","loadAsync","unzipResult","zipFile","ex","droppedFiles","useDropzone","noClick","getRootProps","getInputProps","isDragActive","openImportDialog","timer","prevent","background","textDecoration","borderTop","buttonTitle","maxHeight","triggerSource","AccordionItem","isOpen","active","setActiveState","refContainer","toggleAccordion","dbClickHandler","forcedOpenedElements","alwaysOpen","Accordion","defaultOpenIndex","elements","setElements","handleOpen","trigger","el","mappedChildren","prevState","HighlightedRowStyle","ConstantlyHighlightedRowStyle","ReactTableStyle","ReactTableFlexLayout","useTable","useSortBy","useFlexLayout","getTableProps","getTableBodyProps","headerGroups","rows","prepareRow","headerGroup","getHeaderGroupProps","headers","column","getHeaderProps","getSortByToggleProps","render","isSorted","isSortedDesc","overflowY","getRowProps","cells","cell","getCellProps","InfoWrapper","tableContainer","searchInput","InformationPanel","information","setInformation","matches","setMatchesData","searchRef","handleSearch","sortType","Cell","resizable","placeholder","IntegralsWrapper","valueReft","Arrow","direction","NextPrev","loop","defaultIndex","useMeasure","activeIndex","setActiveIndex","Sliders","nextHandler","preActiveIndex","nextIndex","prevHandler","prevIndex","toolbarStyle","moleculeContainerStyle","MoleculeSelection","currentIndex","setCurrentIndex","slideIndex","mol","mw","selectMoleculeContainerStyle","optionalTextStyle","SelectMolecule","newSum","saveSelectMoleculeHandler","onChangeMoleculeSelectionHandler","modalContainer","ChangeSumModal","saveInputValueHandler","ToggleButton","Toggle","toggleHandler","DefaultPanelHeader","deleteToolTip","onFilter","filterToolTip","filterIsActive","counterFiltered","onSettingClick","showSettingButton","SaveButton","PreferencesHeader","EditableColumn","onEditStart","editStatus","enabled","enableEdit","refInput","useImperativeHandle","startEdit","closeEdit","editModeHandler","ContextMenu","lef","rootRef","sourceElement","setSourceElement","handleContextMenu","contextMenuHandler","parentElement","clickX","clickY","_handleGlobalClick","isSameNode","ReactTableHeader","ReactTableRow","onContextMenu","isConstantlyHighlighted","ReactTable","contextRef","NoTableData","selectStyle","IntegralTable","relativeRefs","deleteIntegralHandler","params","changeIntegralDataHandler","defaultColumns","orderIndex","accessor","saveRealtiveHandler","editStartHander","tableColumns","setCustomColumn","columnLabel","cellHandler","integralsPreferences","cols","formattedNumber","object1","object2","tableData","isInRange","ColorInput","onColorChange","displayColorPicker","showColorPicker","setColor","handleClick","handleOnColorChanged","colorEvent","onChangeComplete","inputLabel","ColumnFormatField","checkControllerName","formatControllerName","inputChangeHandler","groupID","Boolean","_checked","setChecked","groupContainer","paddingBottom","formatFields","checkController","formatController","defaultFormat","IntegralsPreferences","setSetting","formRef","getValueByKeyPath","saveToLocalStorgate","showMessage","saveSetting","requestSubmit","dispatchEvent","Event","cancelable","handleSubmit","form","formData","FormData","field","keyIndex","nucleusLabel","IntegralPanel","setFilterIsActive","integralsCounter","setIntegralsCounter","isFlipped","setFlipStatus","settingRef","yesHandler","handleDeleteAll","changeIntegralSumHandler","showChangeIntegralSumModal","settingsPanelHandler","saveSettingHandler","handleOnFilter","changedHandler","infinite","menuStyles","MenuItem","icon","MenuList","items","boxBounding","MenuButton","toolTip","menuButtonRef","isShown","showMenu","closeMenuButton","MoleculeWrapper","modalButtonStyle","MoleculeStructureEditorModal","selectedMolecule","setMolfile","cb","newMolfile","initialMolfile","svgMenu","fragment","IsotopesViewer","othersProps","dangerouslySetInnerHTML","__html","FormikSelect","FREQUENCIES","PredictSpectraModal","extractFromAtom","dim","oclIDs","hydrogenOCLIDs","nbHydrogens","findDatumAndSignalIndex","panelContainerStyle","MOL_EXPORT_MENU","MoleculePanel","setOpen","currentMolfile","setCurrentMolfile","onAtomHoverHighlights","setOnAtomHoverHighlights","onAtomHoverAction","setOnAtomHoverAction","activeAssignment","assignedDiaIDs","assignedDiaID","assignedDiaIDsMerged","toggleAssignment","atomInformation","_oclID","toggleDiaIDs","handleOnClickAtom","currentDiaIDsToHighlight","getCurrentDiaIDsToHighlight","assignmentOnHover","axisOnHover","handleOnAtomHover","getHighlightsOnHover","stop","_assigned","handlePaste","readText","handleDelete","saveAsMolHandler","handleReplaceMolecule","openPredicSpectraModal","exportHandler","OCLnmr","OCL","setSelectedAtom","atomHighlightColor","atomHighlightOpacity","setHoverAtom","COLUMNS_TYPES","reservedColumnsNames","addColumnKey","columnProps","getChar","aPotions","charCodeAt","len","chartResult","fromCharCode","generateChar","getSpectraAnalysis","detectRange","xyMinYPoint","xyMaxYPoint","SID","init","refreshCalculation","refreshByRow","calculate","formula","analyzeSpectra","valueKey","spectraSum","prevNucleusData","relative","variables","Function","REFERENCES","tms","nbPeaks","tsp","glucose","baseList","AlignSpectraModal","List","list","setValues","optionChangeHandler","targetX","ExportAsMatrixModal","EquallySpacedFilter","FromToFilter","MultipleSpectraFiltersModal","setFilter","filterChangeHandler","filterOptions","args","MulipleAnalysisCodeEditor","setCode","setResult","evalResult","Eval","valueChangeHandler","highlightHandler","languages","js","prismStyles","onValueChange","MultipleSpectraAnalysisPreferences","onAfterSave","setColumns","tempKey","columnsKeys","preferncesSchema","Yup","columnSchema","required","colmnName","addNewColumn","prevData","DropDownList","onSelect","DropDownButton","selectedKey","formatSelectedValue","drop","closest","selectHandler","columnsFilters","ColumnHeader","charLabel","rangeLabel","onColumnFilter","MultipleSpectraAnalysisTable","codeEvaluation","columnFilterHandler","initColumns","columnIndex","columnData","MultipleSpectraAnalysisPanel","afterSaveHandler","showTrackerHandler","openAlignSpectra","openFiltersModal","copyToClipboardHandler","getDataAsString","letter","openExportAsMatrixModal","PeaksWrapper","PeaksPreferences","peaksPreferences","PeaksTable","deltaPPMRefs","deletePeakHandler","initialColumns","saveDeltaPPMRefsHandler","extraParams","valueHz","peakWidth","PeaksPanel","peaksCounter","setPeaksCounter","CopyClipboardModal","onCopyClick","toolbar","center","removeAssignmentsButton","RangesHeader","onUnlink","onFilterActivated","isFilterActive","filterCounter","isMultiplicityTreesVisible","changeRangesSumHandler","showChangeRangesSumModal","removeAssignments","handleOnRemoveAssignments","handleSetShowMultiplicityTrees","saveAsHTMLHandler","observedFrequency","nbDecimalDelta","nbDecimalJ","rangesToACS","RangesPreferences","oldId","useToggleStatus","setStatus","statusflags","newStatus","isColumnVisible","lodash","AbsoluteColumn","rowSpanTags","onHoverRange","Button","ErrorMessage","useField","onFocus","onBlur","enableErrorMessage","AddSignalFormTabStyle","AddSignalFormTab","disableAddButton","setDisableAddButton","onAddSignal","newSignal","newSignalDelta","_signals","SelectBox","as","protoTypes","valuePath","instanceOf","valueSelectionTemplate","CouplingsTableStyle","errorStyle","CouplingsTable","_coupling","hasMissingCouplingValue","_error","colSpan","SignalFormTabStyle","SignalFormTab","textStyles","tabStylesAddition","SignalsForm","activeField","setActiveField","setFrequency","handleOnFocus","tapClickHandler","handleDeleteSignal","tabContainsErrors","signalFormTabs","signalTabs","addSignalTab","editSignalInfoText","addSignalInfoText","noSignals","noCouplings","EditRangeValidation","createSignalsError","missingCouplings","EditRangeModal","onSaveEditRangeModal","onCloseEditRangeModal","onZoomEditRangeModal","handleOnZoom","handleOnClose","getCouplings","couplings","getSignals","handleOnSave","formValues","initialStateSignals","counterJ","_multiplicity","isSaveButtonDisabled","errorKeys","validate","setSubmitting","selectBoxStyle","ActionsColumn","rowData","onHoverSignal","zoomRangeHandler","changeRangeSignalKindHandler","saveEditRangeHandler","editedRowData","closeEditRangeHandler","openEditRangeHandler","CENTER_RIGHT","tableMetaInfo","CouplingColumn","spanStyle","RangeAssignmentsColumn","onUnlinkVisibilityChange","unlinkVisibility","onLink","visibilityChangeHandler","spanCss","RangeColumn","RelativeColumn","integralVal","formattedValue","SignalAssignmentsColumn","tdCss","useFormat","keysPath","SignalDeltaColumn","rangeID","editStartHandler","RangesTableRow","onColumnEditStart","editFlags","relativeFlags","signalFlags","assignmentSignal","highlightSignal","unlinkRangeButtonVisibility","showUnlinkRangeButton","unlinkSignalButtonVisibility","showUnlinkSignalButton","getFormat","rowSpan","unlinkHandler","isOnRangeLevel","linkHandler","trCss","rowIndex","signalId","useMapRanges","_rangesData","tableStyle","RangesTable","onChangeKind","onEdit","toggleRelativeColumn","toggleSignalColumn","columnEditStartHandler","handleEditStart","sumButton","setShowMultiplicityTreesButton","RangesTablePanel","rangesData","isInView","getFilteredRanges","unlinkRangeHandler","saveJSONToClipboardHandler","dataToClipboard","rangesPreferences","contextMenu","filterHandler","SpectraWraper","SpectraPanelHeader","spectrums","showAllSpectrumsHandler","spectrumsPerTab","hideAllSpectrumsHandler","addMissingProjectionHandler","missingNucleus","SpectrumsData","setSameTopHandler","resetScaleHandler","getNucleusSum","additions","GroupByInfoKey","orderByNucleus","unorderedGroup","objectsByKeyValue","obj","ColorIndicator1D","activated","ColorIndicator2D","ColorIndicator","ShowHideMarkersButton","onChangeMarkersVisibility","markersVisible","isMarkerVisible","ShowHideSpectrumButton","onChangeVisibility","alignContent","SpectrumListItem","onChangeActiveSpectrum","onOpenSettingModal","formatValueAsHTML","borderLeft","pulse","FormikColorPicker","colorchangeHandler","presetColors","Spectrum2DHistogram","histogramData","prepareData","xAbsolute","xMinMaxValues","xHistogram","logBaseX","logBaseY","nbSlots","paddingTop","yAxis","markerStyle","displayGridLines","tickStyle","hidden","Spectrum1DSetting","SpectrumData","triggerSubmitHandler","Spectrum1DHistogram","FormikSlider","onAfterChange","ReactSlider","thumbClassName","trackClassName","renderThumb","valueNow","pearling","minDistance","matrix","existingMatrix","matrixMinMaxZ","matrixHistogram","Spectrum2DSetting","SpectrumSetting","arePropsEqual","SpectrumsTabs","onTabChange","setMarkersVisible","selectedSpectrumData","setSelectedSpectrum","settingModalPosition","setSettingModalPosition","isSettingModalDisplayed","setIsSettingModalDisplayed","visibleMarkers","spectrumsGroupByNucleus","groupByNucleus","handleChangeMarkersVisibility","newChecked","onTabChangeHandler","openSettingHandler","selectedSpectrum","nativeEvent","handleChangeVisibility","handleChangeActiveSpectrum","group","SpectrumListPanel","activeTabState","setSpectrums","SelectUncontrolled","ErrorColors","Errors","errorColor","Hybridizations","DefaultTolerance","C","H","N","F","Si","P","getLabelColor","correlationData","correlation","atomType","errorIndex","findSpectrum","_spectrum","experimentID","findSignal","findRangeOrZoneID","findRange","findZone","findSignalMatch2D","xDomain0","xDomain1","yDomain0","yDomain1","AdditionalColumnHeader","correlationsData","highlightIDsAdditionalColumn","pseudo","link","highlightAdditionalColumn","focus","tableHeaderProps","experimentType","equivalenceTextStyle","edited","equivalence","isInteger","AdditionalColumnField","rowCorrelation","columnCorrelation","commonLinks","isEdited","setIsEdited","highlightIDsCommonLinks","highlightCommonLinks","commonLink","onEditHandler","_rowCorrelation","lodashCloneDeep","_columnCorrelation","pseudoLinkCountHSQC","pseudoLinkID","pseudoExperimentID","pseudoCommonLink","LinkUtilities","buildLink","CorrelationUtilities","addLink","match","GeneralUtilities","getCorrelationIndex","protonsCount","removeLink","commonLinkHSQC","linkSet","CorrelationTableRow","additionalColumnData","styleRow","styleLabel","onSaveEditEquivalences","onChangeHybridization","onSaveEditProtonsCount","onEditAdditionalColumnField","highlightIDsRow","highlightRow","onSaveEquivalencesHandler","onSaveProtonsCountHandler","additionalColumnFields","_correlation","_link","experimentLabel","onChangeHybridizationHandler","equivalenceCellStyle","tableDataProps","borderRight","hybridization","CorrelationTable","filteredCorrelationsData","editEquivalencesSaveHandler","changeHybridizationSaveHandler","editProtonsCountSaveHandler","editAdditionalColumnFieldSaveHandler","showProtonsAsRows","additionalColumnHeader","Overview","getAtomCounts","stateAtomType","errorColorIndex","complete","fontStyle","inputStyle","MolecularFormulaInput","previousMF","setMF","isValidMF","setIsValidMF","hasChanged","setHasChanged","checkMF","MF","onSaveHandler","SetMolecularFormulaModal","onSaveHandlerMolecularFormulaInput","onSaveHandlerMoleculeSelection","onChangeHandlerMoleculeSelection","SetShiftToleranceModal","previousTolerance","setTolerance","inputFields","panelStyle","SummaryPanel","setAdditionalColumnData","selectedAdditionalColumnsAtomType","setSelectedAdditionalColumnsAtomType","setShowProtonsAsRows","atomTypesInView","getAtomType","findSignalMatch1D","otherAxis","_values","handleOnSetMolecularFormula","handleOnSetShiftTolerance","showSetMolecularFormulaModal","showSetShiftToleranceModal","additionalColumnTypes","columnTypes","columnType","_selectedAdditionalColumnsAtomType","valuesString","char","additionalColumnField","selection","ZonesPreferences","zonesPreferences","changeSignalKindHandler","deleteZoneHandler","zoomZoneHandler","xMargin","yMargin","showUnlinkButton","setShowUnlinkButton","SignalAssignmentsColumns","onHoverSignalX","onHoverSignalY","showUnlinkButtonSignalX","showUnlinkButtonSignalY","setShowUnlinkButtonSignalX","setShowUnlinkButtonSignalY","highlightSignalX","highlightSignalY","signalDeltaX","signalDeltaY","saveXHandler","zoneID","saveYHandler","ZoneAssignmentColumn","ZoneAssignmentsColumns","onHoverZoneX","onHoverZoneY","showUnlinkButtonZoneX","showUnlinkButtonZoneY","setShowUnlinkButtonZoneX","setShowUnlinkButtonZoneY","highlightZoneX","highlightZoneY","ZonesTableRow","ZonesTable","nuclei","ZonesPanel","xFrom","xTo","yFrom","yTo","getFilteredZones","unlinkZoneHandler","visibilityHandler","Table","TableBody","getVAlign","align","TableHeader","TableHead","FiltersWrapper","FiltersTableRow","selectedFilterID","setSelectedFilter","handelFilterCheck","handelDeleteFilter","filterType","filterSnapShotHandler","newID","prevId","TableRow","TableCell","FilterPanel","accordionItems","openWhen","hidePreferenceKey","RangesPanel","Panels","panelIndex","setSelectedPanelIndex","getDefaultIndex","ignoreActions","checkActionType","computeDistance","s1","s2","dist","zipFilesValues","getSDF","sdfFiles","NmrRecord","sdf","zipFiles","jsonData","nmrium","assignZones","assignRanges","pathFile","parserResult","parseSDF","mixedEOL","eSignals","signalsInside","isInside","deltaIn","closeSignalIndex","currentDistance","handleUpdateCorrelations","Build","build","getActiveData","activeSpectrumIndex","activeData","getDomain","xArray","yArray","integralYDomain","_extent","integralResult","get2DDomain","spectrumsIDs","filteredData","setDomain","isYDomainChanged","originYDomains","setMode","nucluesToString","nuclues","getClosestNumber","goal","prev","curr","ZoomHistory","stack","pop","getLast","ZoomHistoryInstances","changeSpectrumVerticalAlignment","checkData","YAxisShift","setFilterChanges","selectedFilter","activeSpectrumId","getStrongestPeak","strongestPeakValue","spectrumIndex","resetTool","setDefaultTool","resetSelectedTool","filterOnly","getSpectrumID","hasAcceptedSpectrum","setMargin","Processing2DData","setDisplayerMode","setTabActiveSpectrum","dataGroupByTab","tabs2D","tabkeys","tabKey","nucleusLength","tabSpectra","tabSpectraLength","FTSpectrums","setTab","refresh","groupByTab","refreshTabActiveSpectrums","dataGroupByNucleus","currentTab","zoomHistory","getInstance","zoomValue","setDataBy1DFilter","changeIntegral","orignalDatum","integralIndex","handleChangeIntegralsRaltiveValue","changeIntegralsRealtive","newIntegralValue","initMolecule","mfInfo","getMolecularFormula","absoluteWeight","relativeWeight","toSVG","getInfo","addMolfile","fragments","Molecule","getFragments","toMolfileV3","mols","MoleculeManager","loadJDFFile","addJDFs","loadJcampFile","addJcamps","getRangeIndex","drfat","handleUnlinkRange","rangeIndex","cloneDeep","handleResizeRange","changeRange","handleAddRange","handleOnChangeRangesData","handleChangeRangeRaltiveValue","changeRangesRealtive","newRealtiveValue","add2dZoneHandler","drawnZone","get2DRange","detectZonesManual","handleOnChangeZonesData","getZoneIndex","handleUnlinkZone","_zoneData","zoneIndex","setMoleculeHandler","_mol","molIndex","handleAutoPeakPicking","autOptions","autoPeakPicking","xyAutoPeaksPicking","newPeak","handleDeleteSpectraRanges","deleteSpectraAnalysis","MulitpleAnalysis","handleSetcolumns","setColumn","inputColumns","newColumns","outerAcc","spectraKey","newKey","isFormula","handleFiltercolumn","changeColumnValueKey","getReferenceShift","reference","xyCalibrate","checkIsVisible2D","setVisible","history","past","present","future","hasUndo","hasRedo","dispatchMiddleware","res","SpectraManager","nmredataToNmrium","predictionProton","spectrumReducer","innerSpectrumReducer","actionType","initiate","LoadActions","setIsLoading","handleLoadJsonFile","actions","handleLoadMOLFile","handleLoadZIPFile","handleLoadNmredata","addPeak","candidatePeak","PeaksActions","addPeaks","datumOriginal","deletePeak","peakData","peakIndex","addIntegral","IntegralsActions","deleteIntegral","handleChangeIntegralZoom","handleChangeIntegralSum","setOriginalDomain","DomainActions","setXDomain","setYDomain","setWidth","handleSetDimensions","setSelectedTool","ToolsActions","setSelectedOptionPanel","zoomOut","shiftSpectrumAlongXAxis","FiltersActions","applyZeroFillingFilter","applyFFTFilter","applyManualPhaseCorrectionFilter","applyAutoPhaseCorrectionFilter","applyAbsoluteFilter","calculateManualPhaseCorrection","update2dShift","deleteSpectraFilter","filterSnapshotHandler","handleMultipleSpectraFilter","handleSpectrumVisibility","IDs","SpectrumsActions","handleChangePeaksMarkersVisibility","refreshDomain","newIndex","oldIndex","newActiveSpectrum","handleChangeSpectrumColor","changeSpectrumSetting","alignSpectraHandler","handleToggleRealImaginaryVisibility","setSpectraSameTopHandler","resetSpectraScale","handleChangeSpectrumDisplayMode","addMoleculeHandler","MoleculeActions","deleteMoleculeHandler","moleculeIndex","predictSpectraFromMolculeHandler","signalsToXY","handleSetMF","CorrelationsActions","handleSetTolerance","handleSetCorrelation","setCorrelation","handleSetCorrelations","handleDeleteSpectra","handleChangeIntegralYDomain","handleBrushEnd","is2D","xScale","yScale","domainX","brushHistory","setVerticalIndicatorXPosition","setSpectrumsVerticalAlign","handleAutoZonesDetection","detectionOptions","ZonesActions","handleAutoRangesDetection","RangesActions","handleDeleteRange","handleChangeRangeSum","handleChangeRangeSignalValue","changeRangeSignal","newSignalValue","handleChangeRangeSignalKind","handleSaveEditedRange","_editedRowData","handleSetDiaIDRange","handelSetPreferences","panelsPreferences","handelSetActiveTab","handleAddBaseLineZone","handleDeleteBaseLineZone","handleAddExclusionZone","newExclusionZone","handleDeleteExclusionZone","handleBaseLineCorrectionFilter","xDomainSnapshot","setKeyPreferencesHandler","spectrumsGroupsList","applyKeyPreferencesHandler","datumID","processController","levelChangeHandler","handleDeleteZone","addMissingProjectionHander","handelResetDomain","changeZoneSignalDelta","changeZoneSignal","originalSignal","handleChangeZoneSignalKind","_zone","handleSetDiaIDZone","SpectraAanalysisActions","handleResizeSpectraRange","handleHistoryUndo","newPast","newfuture","handleHistoryRedo","newPresent","handleHistoryReset","setIsOverDisplayer","GlobalActions","ToolBarWrapper","spectrumsCount","allowedExtensions","LoadJCAMPModal","onLoadClick","startLoading","pathReft","loadJCAMPHandler","extractFileMetaFromPath","loadFile","onLoadButtonClick","IMPORT_MENU","EXPORT_MENU","BasicToolBar","selectedSpectrumInfo","LoadJacmpHandler","startLoadingHandler","importJCAMPFile","isButtonVisible","importFromFileSystemHandler","ImportHandler","activeStyles","helpID","setActive","toggleButton","_isActive","displayName","onValueReady","ToggleButtonGroup","toggleButtons","setToggleButtons","handleOnChange","toggles","_child","FunctionToolBar","setOption","selectedOption","handleOnFFTFilter","ToolBar","splitPaneStyles","resizer","pane","containerStyles","NMRium","dataProp","onDataChange","docsBaseUrl","useToggle","useFullscreen","isRightPanelHide","hideRightPanel","isResizeEventStart","setResizeEventStart","helpList","helpData","setHelpData","preferencesState","dispatchPreferences","dispatchMiddleWare","setBaseUrl","newBaseUrl","handleSplitPanelDragFinished","rightPanelHandler","prevFlag","preventContextMenuHandler","resizerStyle","paneStyle","pane1Style","defaultSize","minSize","onDragFinished","onResizerDoubleClick","onDragStarted","hideExclusionZonesTool"],"mappings":"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","file":"static/js/1.5b276310.chunk.js","sourcesContent":["import {\n  createContext,\n  useReducer,\n  useMemo,\n  useContext,\n  useCallback,\n  useEffect,\n} from 'react';\n\nexport const TYPES = {\n  PEAK: 'PEAK',\n  INTEGRAL: 'INTEGRAL',\n  RANGE: 'RANGE',\n  ZONE: 'ZONE',\n  EXCLUSION_ZONE: 'EXCLUSION_ZONE',\n};\n\nconst highlightContext = createContext();\n\nfunction highlightReducer(state, action) {\n  switch (action.type) {\n    case 'SHOW': {\n      const { convertedHighlights, type } = action.payload;\n      const newState = {\n        ...state,\n        highlights: { ...state.highlights },\n        type,\n      };\n      for (const value of convertedHighlights) {\n        if (!(value in newState.highlights)) {\n          newState.highlights[value] = 1;\n        }\n      }\n      newState.highlighted = Object.keys(newState.highlights);\n\n      return newState;\n    }\n    case 'HIDE': {\n      const { convertedHighlights } = action.payload;\n\n      const newState = {\n        ...state,\n        highlights: { ...state.highlights },\n        type: null,\n      };\n      for (const value of convertedHighlights) {\n        if (value in newState.highlights) {\n          delete newState.highlights[value];\n        }\n      }\n      newState.highlighted = Object.keys(newState.highlights);\n      return newState;\n    }\n    case 'SET_PERMANENT': {\n      const newState = {\n        ...state,\n        // allow just one permanent highlights group at same time\n        highlightedPermanently: action.payload,\n      };\n\n      return newState;\n    }\n    case 'UNSET_PERMANENT': {\n      const newState = {\n        ...state,\n        highlightedPermanently: [],\n      };\n\n      return newState;\n    }\n    default: {\n      throw new Error(`unknown action type: ${action.type}`);\n    }\n  }\n}\n\nconst emptyState = {\n  highlights: {},\n  highlighted: [],\n  highlightedPermanently: [],\n  type: null,\n};\n\nexport function HighlightProvider(props) {\n  const [highlight, dispatch] = useReducer(highlightReducer, emptyState);\n  const contextValue = useMemo(() => ({ highlight, dispatch }), [highlight]);\n  return (\n    <highlightContext.Provider value={contextValue}>\n      {props.children}\n    </highlightContext.Provider>\n  );\n}\n\nexport function useHighlightData() {\n  return useContext(highlightContext);\n}\n\nexport function useHighlight(highlights, type = null) {\n  if (!Array.isArray(highlights)) {\n    throw new Error('highlights must be an array');\n  }\n\n  const context = useHighlightData();\n\n  const convertedHighlights = useMemo(() => {\n    const newHighlights = [];\n    for (const highlight of highlights) {\n      if (typeof highlight !== 'string' && typeof highlight !== 'number') {\n        throw new Error(`highlight key must be a string or number`);\n      }\n      if (highlight !== '') {\n        newHighlights.push(String(highlight));\n      }\n    }\n    return newHighlights;\n  }, [highlights]);\n\n  useEffect(() => {\n    // if deletion of component then also delete its highlight information -> componentWillUnmount\n    return () => {\n      context.dispatch({\n        type: 'HIDE',\n        payload: { convertedHighlights },\n      });\n      context.dispatch({\n        type: 'UNSET_PERMANENT',\n      });\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const isActive = useMemo(() => {\n    return context.highlight.highlighted.some((key) =>\n      convertedHighlights.includes(key),\n    );\n  }, [context.highlight.highlighted, convertedHighlights]);\n\n  const isActivePermanently = useMemo(() => {\n    return context.highlight.highlightedPermanently.some((key) =>\n      convertedHighlights.includes(key),\n    );\n  }, [context.highlight.highlightedPermanently, convertedHighlights]);\n\n  const show = useCallback(() => {\n    context.dispatch({\n      type: 'SHOW',\n      payload: {\n        convertedHighlights,\n        type,\n      },\n    });\n  }, [context, convertedHighlights, type]);\n\n  const hide = useCallback(() => {\n    context.dispatch({\n      type: 'HIDE',\n      payload: {\n        convertedHighlights,\n      },\n    });\n  }, [context, convertedHighlights]);\n\n  const add = useCallback(\n    (id) => {\n      context.dispatch({\n        type: 'SHOW',\n        payload: { convertedHighlights: [], id },\n      });\n    },\n    [context],\n  );\n\n  const remove = useCallback(\n    (id) => {\n      context.dispatch({\n        type: 'HIDE',\n        payload: { convertedHighlights: [], id },\n      });\n    },\n    [context],\n  );\n\n  const click = useCallback(\n    (e) => {\n      if (e) {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n\n      if (!isActivePermanently) {\n        context.dispatch({\n          type: 'SET_PERMANENT',\n          payload: convertedHighlights,\n        });\n      } else {\n        context.dispatch({\n          type: 'UNSET_PERMANENT',\n        });\n      }\n    },\n    [context, convertedHighlights, isActivePermanently],\n  );\n\n  const onHover = {\n    onMouseEnter: show,\n    onMouseLeave: hide,\n  };\n\n  const onClick = {\n    onClick: click,\n  };\n\n  return {\n    isActive,\n    show,\n    hide,\n    onHover,\n    onClick,\n    isActivePermanently,\n    click,\n    add,\n    remove,\n  };\n}\n","/* eslint-disable default-param-last */\nimport { saveAs } from 'file-saver';\nimport JSZip from 'jszip';\n\nfunction copyFormattedHtml(html) {\n  // Create an iframe (isolated container) for the HTML\n  let container = document.createElement('div');\n  container.innerHTML = html;\n\n  // Hide element\n  container.style.position = 'fixed';\n  container.style.pointerEvents = 'none';\n  container.style.opacity = 0;\n\n  // Detect all style sheets of the page\n  let activeSheets = Array.prototype.slice\n    .call(document.styleSheets)\n    .filter(function (sheet) {\n      return !sheet.disabled;\n    });\n\n  // Mount the iframe to the DOM to make `contentWindow` available\n  document.body.appendChild(container);\n\n  // Copy to clipboard\n  window.getSelection().removeAllRanges();\n\n  let range = document.createRange();\n  range.selectNode(container);\n  window.getSelection().addRange(range);\n\n  document.execCommand('copy');\n  for (let i = 0; i < activeSheets.length; i++) {\n    activeSheets[i].disabled = true;\n  }\n  document.execCommand('copy');\n  for (let i = 0; i < activeSheets.length; i++) {\n    activeSheets[i].disabled = false;\n  }\n\n  // Remove the iframe\n  document.body.removeChild(container);\n}\n\nasync function copyHTMLToClipboard(data) {\n  try {\n    copyFormattedHtml(data);\n    return true;\n  } catch (err) {\n    return false;\n  }\n}\nasync function copyTextToClipboard(data) {\n  try {\n    await navigator.clipboard.writeText(data);\n    return true;\n  } catch (err) {\n    return false;\n  }\n}\n/**\n * export the experiments result in JSON format\n * @param {*} data\n */\nasync function exportAsJSON(\n  data,\n  fileName = 'experiment',\n  spaceIndent = 0,\n  isCompressed = false,\n) {\n  const fileData = JSON.stringify(\n    data,\n    (key, value) => (ArrayBuffer.isView(value) ? Array.from(value) : value),\n    spaceIndent,\n  );\n  if (!isCompressed) {\n    const blob = new Blob([fileData], { type: 'text/plain' });\n    saveAs(blob, `${fileName}.nmrium`);\n  } else {\n    try {\n      const zip = new JSZip();\n      zip.file(`${fileName}.nmrium`, fileData);\n      const blob = await zip.generateAsync({\n        type: 'blob',\n        compression: 'DEFLATE',\n        compressionOptions: {\n          level: 9,\n        },\n      });\n      saveAs(blob, `${fileName}.nmrium`);\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.log(e);\n    }\n  }\n}\n\nfunction exportAsMatrix(data, options, fileName = 'experiment') {\n  // eslint-disable-next-line no-unused-vars\n  const { from, to, nbPoints } = options;\n\n  // your code\n\n  const exportData = JSON.stringify(\n    data,\n    (key, value) => (ArrayBuffer.isView(value) ? Array.from(value) : value),\n    2,\n  );\n\n  const blob = new Blob([exportData], { type: 'text/plain' });\n  saveAs(blob, `${fileName}.tsv`);\n}\n\nfunction exportAsNMRE(data, fileName = 'experiment') {\n  data.generateAsync({ type: 'blob' }).then((content) => {\n    saveAs(content, `${fileName}.zip`);\n  });\n}\n\nfunction exportAsMol(data, fileName = 'mol') {\n  const blob = new Blob([data], { type: 'text/plain' });\n  saveAs(blob, `${fileName}.mol`);\n}\n/**\n * export the vitalization result as SVG, if you need to remove some content during exportation process enclose the the content with <!-- export-remove --> ${content} <!-- export-remove -->\n */\nfunction exportAsSVG(fileName = 'experiment', elementID) {\n  const { blob } = getBlob(elementID);\n  saveAs(blob, `${fileName}.svg`);\n}\n\nfunction exportAsPng(fileName = 'experiment', elementID) {\n  const { blob, width, height } = getBlob(elementID);\n  try {\n    let canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    let context = canvas.getContext('2d');\n    context.fillStyle = 'white';\n    context.fillRect(0, 0, canvas.width, canvas.height);\n    let img = new Image();\n    let url = URL.createObjectURL(blob);\n    img.onload = async function () {\n      context.drawImage(img, 0, 0);\n      let png = canvas.toDataURL('image/png', 1);\n      saveAs(png, `${fileName}.png`);\n      URL.revokeObjectURL(png);\n    };\n    img.src = url;\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n}\n\nfunction copyDataURLCliboard(image) {\n  const img = document.createElement('img');\n  img.src = image;\n\n  img.style.position = 'fixed';\n  img.style.pointerEvents = 'none';\n  img.style.opacity = 0;\n\n  document.body.appendChild(img);\n  const range = document.createRange();\n  range.selectNode(img);\n  window.getSelection().addRange(range);\n  document.execCommand('Copy');\n  document.body.removeChild(img);\n}\n\nfunction copyBlobToCliboard(canvas) {\n  canvas.toBlob((b) => {\n    //eslint-disable-next-line no-undef\n    const clip = new ClipboardItem({\n      [b.type]: b,\n    });\n    navigator.clipboard.write([clip]).then(\n      () => {\n        // eslint-disable-next-line no-console\n        console.log('experiment copied.');\n      },\n      (err) => {\n        // eslint-disable-next-line no-console\n        console.log(err);\n      },\n    );\n  });\n}\n\nfunction copyPNGToClipboard(elementID) {\n  const { blob, width, height } = getBlob(elementID);\n  try {\n    let canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    let context = canvas.getContext('2d');\n    context.fillStyle = 'white';\n    context.fillRect(0, 0, canvas.width, canvas.height);\n    let img = new Image();\n    const url = URL.createObjectURL(blob);\n    img.onload = async function () {\n      context.drawImage(img, 0, 0);\n      const png = canvas.toDataURL('image/png', 1);\n      if (navigator.clipboard.write) {\n        copyBlobToCliboard(canvas);\n      } else {\n        copyDataURLCliboard(png);\n      }\n\n      URL.revokeObjectURL(png);\n    };\n    img.src = url;\n  } catch (e) {\n    if (e instanceof ReferenceError) {\n      // eslint-disable-next-line no-alert\n      alert(\n        'Your browser does not support this feature, please use Google Chrome',\n      );\n    }\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n}\n\nfunction getBlob(elementID) {\n  // nmrSVG\n  let _svg = document.getElementById(elementID).cloneNode(true);\n  const width = _svg.getAttribute('width').replace('px', '');\n  const height = _svg.getAttribute('height').replace('px', '');\n  _svg\n    .querySelectorAll('[data-no-export=\"true\"]')\n    .forEach((element) => element.remove());\n  const head = `<svg class=\"nmr-svg\"  viewBox='0 0 ${width} ${height}' width=\"${width}\"  height=\"${height}\"  version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">`;\n  const style = `<style>.grid line,.grid path{stroke:none;} .peaks-text{fill:#730000} .x path{stroke-width:1px} .x text{\n    font-size: 12px;\n    font-weight: bold;\n  } \n \n  .nmr-svg,.contours{\n    background-color:white;\n    fill:white;\n  }\n  \n\n  \n  </style>`;\n  const svg = `${head + style + _svg.innerHTML}</svg>`;\n  const blob = new Blob([svg], { type: 'image/svg+xml' });\n  return { blob, width, height };\n}\n\nexport {\n  exportAsSVG,\n  exportAsJSON,\n  exportAsNMRE,\n  exportAsPng,\n  copyPNGToClipboard,\n  copyTextToClipboard,\n  copyHTMLToClipboard,\n  exportAsMol,\n  exportAsMatrix,\n};\n","export default function checkModifierKeyActivated(event) {\n  const modifiersKeys = [\n    'Alt',\n    'AltGraph',\n    'CapsLock',\n    'Control',\n    'Meta',\n    'NumLocK',\n    'ScrollLock',\n    'Shift',\n    'OS',\n  ];\n  for (const key of modifiersKeys) {\n    if (event.getModifierState(key)) {\n      return true;\n    }\n  }\n  return false;\n}\n","import lodashDebounce from 'lodash/debounce';\nimport lodashMap from 'lodash/map';\nimport {\n  createContext,\n  useCallback,\n  useEffect,\n  useReducer,\n  useState,\n} from 'react';\n\nexport const BrushContext = createContext();\n\nconst initialState = {\n  step: 'initial',\n  brush: {\n    start: null,\n    end: null,\n  },\n};\n\nlet debounceClickEvents = [];\n\nexport function BrushTracker({\n  children,\n  className,\n  style,\n  onBrush,\n  onZoom,\n  onDoubleClick,\n  onClick,\n  noPropagation,\n}) {\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const [mouseDownTime, setMouseDownTime] = useState();\n\n  const mouseDownHandler = useCallback(\n    (event) => {\n      if (event.button === 0) {\n        if (noPropagation) {\n          event.stopPropagation();\n        }\n        dispatch({\n          type: 'DOWN',\n          shiftKey: event.shiftKey,\n          altKey: event.altKey,\n          screenX: event.screenX,\n          screenY: event.screenY,\n          clientX: event.clientX,\n          clientY: event.clientY,\n          boundingRect: event.currentTarget.getBoundingClientRect(),\n        });\n\n        setMouseDownTime(event.timeStamp);\n      }\n      return false;\n    },\n    [noPropagation],\n  );\n\n  const clickHandler = useCallback(\n    (e) => {\n      e.persist();\n      const timeStamp = e.timeStamp;\n      const boundingRect = e.currentTarget.getBoundingClientRect();\n      const x = e.clientX - boundingRect.x;\n      const y = e.clientY - boundingRect.y;\n\n      const callback = lodashDebounce(() => {\n        if (\n          timeStamp - mouseDownTime <= 150 &&\n          debounceClickEvents.length === 1\n        ) {\n          onClick({ ...e, x, y });\n        }\n        debounceClickEvents = [];\n      }, 200);\n      debounceClickEvents.push(callback);\n\n      callback();\n\n      if (debounceClickEvents.length > 1) {\n        lodashMap(debounceClickEvents, (debounce) => debounce.cancel());\n        debounceClickEvents = [];\n        onDoubleClick({ ...e, x, y });\n      }\n    },\n    [mouseDownTime, onClick, onDoubleClick],\n  );\n\n  const handleMouseWheel = useCallback(\n    (event) => {\n      const boundingRect = event.currentTarget.getBoundingClientRect();\n      const x = event.clientX - boundingRect.x;\n      const y = event.clientY - boundingRect.y;\n\n      const { deltaY, deltaX, shiftKey, deltaMode } = event;\n      onZoom({ deltaY: deltaY || deltaX, shiftKey, deltaMode, x, y });\n    },\n    [onZoom],\n  );\n\n  useEffect(() => {\n    const { step, startX, endX } = state;\n    if (step === 'end' && Math.abs(startX - endX) > 5) {\n      onBrush(state);\n      dispatch({\n        type: 'DONE',\n      });\n    }\n  }, [onBrush, state]);\n\n  const moveCallback = useCallback((event) => {\n    dispatch({\n      type: 'MOVE',\n      screenX: event.screenX,\n      screenY: event.screenY,\n      clientX: event.clientX,\n      clientY: event.clientY,\n    });\n  }, []);\n\n  const upCallback = useCallback((event) => {\n    dispatch({\n      type: 'UP',\n      clientX: event.clientX,\n      clientY: event.clientY,\n    });\n    return false;\n  }, []);\n\n  return (\n    <BrushContext.Provider value={state}>\n      <div\n        className={className}\n        style={style}\n        onMouseDown={mouseDownHandler}\n        onMouseUp={upCallback}\n        onMouseMove={moveCallback}\n        onClick={clickHandler}\n        onWheel={handleMouseWheel}\n      >\n        {children}\n      </div>\n    </BrushContext.Provider>\n  );\n}\n\nBrushTracker.defaultProps = {\n  onBrush: () => null,\n  onZoom: () => null,\n  onDoubleClick: () => null,\n  onClick: () => null,\n};\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'UP':\n      if (state.step === 'brushing' || state.step === 'start') {\n        const { clientX, clientY } = action;\n\n        return {\n          ...state,\n          endX: clientX - state.boundingRect.x,\n          endY: clientY - state.boundingRect.y,\n\n          step: state.step === 'start' ? 'initial' : 'end',\n        };\n      }\n      return state;\n    case 'DOWN':\n      if (state.step === 'initial' || state.step === 'end') {\n        const {\n          screenX,\n          screenY,\n          clientX,\n          clientY,\n          boundingRect,\n          shiftKey,\n          altKey,\n        } = action;\n        const x = clientX - boundingRect.x;\n        const y = clientY - boundingRect.y;\n\n        return {\n          ...state,\n          shiftKey,\n          altKey,\n          startX: x,\n          startY: y,\n          startScreenX: screenX,\n          startScreenY: screenY,\n          startClientX: clientX,\n          startClientY: clientY,\n          boundingRect,\n          step: 'start',\n        };\n      }\n      return state;\n    case 'MOVE':\n      if (state.step === 'start' || state.step === 'brushing') {\n        const { clientX, clientY } = action;\n\n        return {\n          ...state,\n          step: 'brushing',\n          endX: clientX - state.boundingRect.x,\n          endY: clientY - state.boundingRect.y,\n        };\n      }\n      return state;\n    case 'DONE':\n      if (state.step === 'end') {\n        return {\n          ...state,\n          step: 'initial',\n        };\n      }\n      break;\n    default:\n      return state;\n  }\n}\n","import { createContext, useCallback, useState, useContext } from 'react';\n\nexport const MouseContext = createContext();\nconst MouseaProvider = MouseContext.Provider;\n\nexport function useMouseTracker() {\n  return useContext(MouseContext);\n}\n\nexport function MouseTracker({ children, className, style, noPropagation }) {\n  const [mouseTrackerState, setMouseTrackerState] = useState(null);\n  const mouseMoveHandler = useCallback(\n    (e) => {\n      const boundingRect = e.currentTarget.getBoundingClientRect();\n      const x = e.clientX - boundingRect.x;\n      const y = e.clientY - boundingRect.y;\n      setMouseTrackerState({ x, y });\n      if (noPropagation) {\n        e.stopPropagation();\n      }\n    },\n    [noPropagation],\n  );\n\n  const mouseLeaveHandler = useCallback(\n    (e) => {\n      setMouseTrackerState(null);\n      if (noPropagation) {\n        e.stopPropagation();\n      }\n    },\n    [noPropagation],\n  );\n\n  return (\n    <MouseaProvider value={mouseTrackerState}>\n      <div\n        className={className}\n        style={style}\n        onMouseMove={mouseMoveHandler}\n        onMouseLeave={mouseLeaveHandler}\n      >\n        {children}\n      </div>\n    </MouseaProvider>\n  );\n}\n","import { createContext, useContext } from 'react';\n\nexport const ChartContext = createContext();\n\nexport const ChartDataProvider = ChartContext.Provider;\n\nexport function useChartData() {\n  return useContext(ChartContext);\n}\n","import { createContext, useContext } from 'react';\n\nexport const dispatchContext = createContext();\n\nexport const DispatchProvider = dispatchContext.Provider;\n\nexport function useDispatch() {\n  return useContext(dispatchContext);\n}\n","import { createContext, useContext } from 'react';\n\nexport const PreferencesConext = createContext();\n\nexport const PreferencesProvider = PreferencesConext.Provider;\n\nexport function usePreferences() {\n  return useContext(PreferencesConext);\n}\n","import { createContext, useContext } from 'react';\n\nexport const scaleContext = createContext();\n\nexport const ScaleProvider = scaleContext.Provider;\n\nexport function useScale() {\n  return useContext(scaleContext);\n}\n","export const positions = {\n  TOP_LEFT: 'top left',\n  TOP_CENTER: 'top center',\n  TOP_RIGHT: 'top right',\n  MIDDLE_LEFT: 'middle left',\n  MIDDLE: 'middle',\n  MIDDLE_RIGHT: 'middle right',\n  BOTTOM_LEFT: 'bottom left',\n  BOTTOM_CENTER: 'bottom center',\n  BOTTOM_RIGHT: 'bottom right',\n};\n\nexport const types = {\n  INFO: 'info',\n  SUCCESS: 'success',\n  ERROR: 'error',\n  PROGRESS_INDICATOR: 'progress_indicator',\n};\n\nexport const transitions = {\n  FADE: 'fade',\n  SCALE: 'scale',\n  SLIDE_RIGHT: 'slide_right',\n  SLIDE_LEFT: 'slide_left',\n  SLIDE_TOP: 'slide_top',\n  SLIDE_BOTTOM: 'slide_bottom',\n};\n","import { createContext, useContext } from 'react';\n\nconst ModalContext = createContext();\nexport const ModalProvider = ModalContext.Provider;\n\nexport const useModal = () => {\n  return useContext(ModalContext);\n};\n","import { useEffect, useCallback } from 'react';\n\nconst styles = {\n  outerContainer: {\n    position: 'fixed',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    backgroundColor: 'rgba(255,255,255,0.8)',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    zIndex: 1,\n  },\n  innerContainer: {\n    boxSizing: 'initial',\n    backgroundColor: '#fff',\n    boxShadow: '0 0 0 0, 0 8px 16px rgba(0,0,0,.30)',\n    display: 'flex',\n    flexDirection: 'column',\n    minWidth: '300px',\n    minHeight: '140px',\n    justifyContent: 'space-between',\n    borderRadius: '5px',\n  },\n};\n\nconst Modal = ({ children, open, onClose, style }) => {\n  const handleClose = useCallback(\n    (e) => {\n      onClose(e);\n    },\n    [onClose],\n  );\n\n  useEffect(() => {\n    if (open === false) {\n      handleClose();\n    }\n  }, [handleClose, open]);\n\n  return (\n    open && (\n      <div style={styles.outerContainer} onClick={handleClose}>\n        <div\n          style={{ ...styles.innerContainer, ...style }}\n          onClick={(e) => {\n            e.preventDefault();\n            e.stopPropagation();\n          }}\n        >\n          {children}\n        </div>\n      </div>\n    )\n  );\n};\n\nModal.defaultProps = {\n  onClose: function () {\n    return null;\n  },\n  open: false,\n};\n\nexport default Modal;\n","import { useRef } from 'react';\nimport { Transition as ContainerTransition } from 'react-transition-group';\n\nimport { transitions } from './options';\n\nconst duration = 250;\n\nconst defaultStyle = {\n  [transitions.FADE]: {\n    transition: `opacity ${duration}ms ease`,\n    opacity: 0,\n  },\n  [transitions.SCALE]: {\n    transform: 'scale(1)',\n    transition: `all ${duration}ms ease-in-out`,\n  },\n};\n\nconst defaultTransitionStyles = {\n  [transitions.FADE]: {\n    entering: { opacity: 0 },\n    entered: { opacity: 1 },\n  },\n  [transitions.SCALE]: {\n    entering: { transform: 'scale(0)' },\n    entered: { transform: 'scale(1)' },\n    exiting: { transform: 'scale(0)' },\n    exited: { transform: 'scale(1)' },\n  },\n};\n\nconst Transtion = ({ children, type, transitionStyles, ...props }) => {\n  const ref = useRef(null);\n  return (\n    <ContainerTransition nodeRef={ref} {...props} timeout={duration}>\n      {(state) => (\n        <div\n          ref={ref}\n          style={{\n            ...defaultStyle[type],\n            ...transitionStyles[type][state],\n            ...transitionStyles.default,\n          }}\n        >\n          {children}\n        </div>\n      )}\n    </ContainerTransition>\n  );\n};\n\nTranstion.defaultProps = {\n  transitionStyles: defaultTransitionStyles,\n};\n\nexport default Transtion;\n","import { useMemo } from 'react';\n\nimport { positions } from './options';\n\nexport const getStyles = (position, props) => {\n  const initialStyles = {\n    // left: 0,\n    position: 'fixed',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    flexDirection: 'column',\n    // width: '100%',\n    pointerEvents: 'none',\n    overflow: 'visible',\n    ...(props.containerStyle\n      ? {\n          top: `${props.containerStyle.top}px`,\n          left: `${props.containerStyle.left}px`,\n          height: `${props.containerStyle.height}px`,\n          width: `${props.containerStyle.width}px`,\n        }\n      : { width: '100%', height: '100%' }),\n  };\n\n  switch (position) {\n    case positions.TOP_LEFT:\n      return {\n        ...initialStyles,\n        // top: 0,\n        justifyContent: 'flex-start',\n        alignItems: 'flex-start',\n      };\n    case positions.TOP_CENTER:\n      return {\n        ...initialStyles,\n        justifyContent: 'flex-start',\n\n        // top: 0,\n      };\n    case positions.TOP_RIGHT:\n      return {\n        ...initialStyles,\n        // top: 0,\n        justifyContent: 'flex-start',\n        alignItems: 'flex-end',\n      };\n    case positions.MIDDLE_LEFT:\n      return {\n        ...initialStyles,\n        // top: '50%',\n        justifyContent: 'center',\n        alignItems: 'flex-start',\n      };\n    case positions.MIDDLE: {\n      return {\n        ...initialStyles,\n        // top: '50%',\n        justifyContent: 'center',\n      };\n    }\n    case positions.MIDDLE_RIGHT:\n      return {\n        ...initialStyles,\n        // top: '50%',\n        justifyContent: 'center',\n\n        alignItems: 'flex-end',\n      };\n\n    case positions.BOTTOM_LEFT:\n      return {\n        ...initialStyles,\n        // bottom: 0,\n        justifyContent: 'flex-end',\n\n        alignItems: 'flex-start',\n      };\n    case positions.BOTTOM_CENTER:\n      return {\n        ...initialStyles,\n        // bottom: 0,\n        justifyContent: 'flex-end',\n      };\n    case positions.BOTTOM_RIGHT:\n      return {\n        ...initialStyles,\n        // bottom: 0,\n        justifyContent: 'flex-end',\n\n        alignItems: 'flex-end',\n      };\n\n    default: {\n      return initialStyles;\n    }\n  }\n};\n\nfunction Wrapper({ children, options: { position }, ...props }) {\n  const styles = useMemo(() => getStyles(position, props), [position, props]);\n\n  return (\n    children.length > 0 && (\n      <div style={styles} {...props}>\n        {children}\n      </div>\n    )\n  );\n}\n\nexport default Wrapper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport { useCallback } from 'react';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  border-top: 10px solid #ed0000;\n  flex: 1;\n  border-radius: 5px;\n\n  .message {\n    font-weight: bold;\n    font-size: 14px;\n    text-align: center;\n    color: #af0000;\n    text-align: center;\n    padding: 35px;\n    flex: 1;\n  }\n  .buttons-container {\n    display: flex;\n    align-items: flex-end;\n    justify-content: flex-end;\n    padding: 5px;\n    border-top: 1px solid #efefef;\n\n    button:first-of-type {\n      border-radius: 5px 0 0 5px;\n      border-weight: 0 1px 0 0;\n    }\n    button:last-child {\n      border-radius: 0px 5px 5px 0px;\n      border-weight: 0 0 0 1px;\n    }\n    button {\n      border: 1px solid #dcdcdc;\n      background-color: white;\n      display: inline-block;\n      cursor: pointer;\n      color: #363636;\n      font-weight: bold;\n      padding: 6px 24px;\n      text-decoration: none;\n    }\n    button:hover {\n      background: -webkit-gradient(\n        linear,\n        left top,\n        left bottom,\n        color-stop(0.05, #f6f6f6),\n        color-stop(1, #ffffff)\n      );\n      background: -moz-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n      background: -webkit-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n      background: -o-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n      background: -ms-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n      background: linear-gradient(to bottom, #f6f6f6 5%, #ffffff 100%);\n      filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#f6f6f6', endColorstr='#ffffff',GradientType=0);\n      background-color: #f6f6f6;\n    }\n  }\n`;\n\nconst ConfirmationDialog = ({ style, buttons, onClose, message }) => {\n  const optionsHandler = useCallback(\n    (e, { handler = () => null }) => {\n      handler(e);\n      onClose();\n    },\n    [onClose],\n  );\n\n  return (\n    <div style={style} css={styles}>\n      <p className=\"message\">{message}</p>\n      <div className=\"buttons-container\">\n        {buttons.map((option) => (\n          <button\n            key={option.text}\n            type=\"button\"\n            onClick={(e) => optionsHandler(e, option)}\n            style={option.style && option.style}\n          >\n            {option.text}\n          </button>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nConfirmationDialog.defaultProps = {\n  buttons: [],\n  style: {},\n};\n\nConfirmationDialog.propTypes = {\n  style: PropTypes.object,\n  buttons: PropTypes.arrayOf(\n    PropTypes.shape({\n      handler: PropTypes.func,\n      text: PropTypes.string,\n      style: PropTypes.object,\n    }),\n  ),\n};\n\nexport default ConfirmationDialog;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  useRef,\n  useState,\n  useEffect,\n  useCallback,\n  Fragment,\n  cloneElement,\n  useMemo,\n} from 'react';\nimport { createPortal } from 'react-dom';\nimport { Rnd } from 'react-rnd';\nimport { TransitionGroup } from 'react-transition-group';\n\nimport Transition from '../Transition';\nimport Wrapper from '../Wrapper';\nimport { positions, transitions } from '../options';\n\nimport ConfirmDialog from './ConfirmDialog';\nimport { ModalProvider } from './Context';\n\nconst transitionStyles = {\n  [transitions.FADE]: {\n    entering: { opacity: 0 },\n    entered: { opacity: 1 },\n  },\n  [transitions.SCALE]: {\n    entering: { transform: 'scale(0)' },\n    entered: { transform: 'scale(1)' },\n    exiting: { transform: 'scale(0)' },\n    exited: { transform: 'scale(0)' },\n  },\n};\n\nfunction Provider({\n  children,\n  style,\n  offset,\n  position,\n  transition,\n  wrapperRef,\n}) {\n  const root = useRef();\n  const [modal, setModal] = useState();\n\n  useEffect(() => {\n    root.current = document.createElement('div');\n    const ref = root.current;\n    if (wrapperRef) {\n      wrapperRef.appendChild(ref);\n    }\n    return () => {\n      if (ref) {\n        if (wrapperRef) {\n          wrapperRef.removeChild(ref);\n        }\n      }\n    };\n  }, [wrapperRef]);\n\n  const remove = () => {\n    setModal(null);\n  };\n\n  const parentStyle = useMemo(() => {\n    return wrapperRef\n      ? wrapperRef.getBoundingClientRect()\n      : {\n          top: 0,\n          left: 0,\n          width: window.innerWidth,\n          height: window.innerHeight,\n        };\n  }, [wrapperRef]);\n\n  const closeHandler = useCallback(() => {\n    remove();\n  }, []);\n  /**\n   *\n   * @param {*} component  <component />\n   * @param {object} options    {onYest:()=>{}, prop1, .... etc}\n   * @param {transitions} options.transition\n   * @param {positions} options.position\n   * @param {boolean} options.isBackgroundBlur\n   * @param {boolean} options.enableResizing\n   */\n  const show = useCallback((component, options = {}) => {\n    const _modal = {\n      component,\n      options: { isBackgroundBlur: true, enableResizing: false, ...options },\n    };\n\n    _modal.close = () => remove();\n\n    setModal(_modal);\n    if (_modal.options.onOpen) _modal.options.onOpen();\n    return _modal;\n  }, []);\n\n  /**\n   * @param {object} dialogOptions\n   * @param {object} dialogOptions.message\n   * @param {Array<{ handler: Function,text: string,style: object}>} dialogOptions.buttons\n   * @param {object} dialogOptions.tyle\n   */\n  const showConfirmDialog = useCallback(\n    (dialogOptions, options = { enableResizing: false }) => {\n      const _modal = {\n        component: <ConfirmDialog {...dialogOptions} />,\n        options: { isBackgroundBlur: true, ...options },\n      };\n\n      _modal.close = () => remove();\n\n      setModal(_modal);\n      if (_modal.options.onOpen) _modal.options.onOpen();\n\n      return _modal;\n    },\n    [],\n  );\n\n  const close = () => {\n    closeHandler();\n  };\n\n  useEffect(() => {\n    const keyHandler = (e) => {\n      if (['Escape', 'Esc'].includes(e.key)) {\n        closeHandler();\n      }\n    };\n    document.addEventListener('keydown', keyHandler, false);\n    return () => document.removeEventListener('keydown', keyHandler, false);\n  }, [closeHandler]);\n\n  const styles = css`\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    z-index: 0;\n\n    .handle {\n      cursor: move;\n    }\n\n    .rnd-container {\n      box-sizing: initial;\n      background-color: #fff;\n      box-shadow: 0 0 0 0, 0 8px 16px rgba(0, 0, 0, 0.3);\n      borderradius: 5px;\n    }\n  `;\n\n  const outerStyle =\n    modal && modal.options.isBackgroundBlur\n      ? { backgroundColor: 'rgba(255,255,255,0.8)' }\n      : { pointerEvents: 'none' };\n\n  return (\n    <ModalProvider value={{ show, close, modal, showConfirmDialog }}>\n      {children}\n      {root.current &&\n        createPortal(\n          <Fragment>\n            {modal ? (\n              <div\n                css={styles}\n                style={{\n                  ...outerStyle,\n                }}\n              >\n                <TransitionGroup\n                  appear\n                  key={\n                    positions[\n                      modal.options.transition\n                        ? modal.options.transition\n                        : transition\n                    ]\n                  }\n                  options={{\n                    position: modal.options.position\n                      ? modal.options.position\n                      : position,\n                  }}\n                  containerStyle={parentStyle}\n                  component={Wrapper}\n                >\n                  <Transition\n                    type={\n                      modal.options.transition\n                        ? modal.options.transition\n                        : transition\n                    }\n                    transitionStyles={{\n                      ...transitionStyles,\n                      default: {\n                        width: modal.options.width\n                          ? `${modal.options.width}px`\n                          : 'auto',\n                      },\n                      height: modal.options.height\n                        ? `${modal.options.height}px`\n                        : 'auto',\n                    }}\n                    key={modal.id}\n                  >\n                    <Rnd\n                      default={{\n                        width: modal.options.width\n                          ? modal.options.width\n                          : 'auto',\n                        height: modal.options.height\n                          ? modal.options.height\n                          : 'auto',\n                        x: 0,\n                        y: 0,\n                      }}\n                      className=\"rnd-container\"\n                      style={{\n                        ...style,\n                        margin: offset,\n                        pointerEvents: 'all',\n                        position: 'none',\n                        userSelect: 'none',\n                      }}\n                      enableResizing={modal.options.enableResizing}\n                      dragHandleClassName=\"handle\"\n                      enableUserSelectHack={false}\n                    >\n                      {modal.options &&\n                        cloneElement(modal.component, {\n                          ...modal.options,\n                          onClose: closeHandler,\n                          style: { cursor: 'default' },\n                        })}\n                    </Rnd>\n                  </Transition>\n                </TransitionGroup>\n              </div>\n            ) : null}\n          </Fragment>,\n          root.current,\n        )}\n    </ModalProvider>\n  );\n}\n\nProvider.defaultProps = {\n  offset: '10px',\n  position: positions.CENTER,\n  transition: transitions.SCALE,\n  wrapperRef: null,\n  style: {},\n};\n\nexport default Provider;\n","import { createContext, useContext } from 'react';\n\ninterface Loader {\n  open: () => void;\n}\n\nconst LoaderContext = createContext<Loader>({ open: () => null });\n\nexport const LoaderProvider = LoaderContext.Provider;\n\nexport function useLoader() {\n  return useContext(LoaderContext);\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport { useLoader } from '../context/LoaderContext';\n\nconst styles = css`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: rgba(255, 255, 255, 0.25);\n  height: 100%;\n  flex-direction: column;\n  user-select: none;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  outline: 10px dashed rgba(0, 0, 0, 0.3);\n  outline-offset: -10px;\n  padding-left: 20px;\n  padding-right: 20px;\n\n  p {\n    padding: 15px 30px;\n    background-color:rgba(0, 0, 0, 0.5);\n    border-radius: 39px;\n    color: white;\n    font-size: x-large;\n    font-weight: bold;\n\n  }\n}\n`;\n\nfunction NoData({\n  isEmpty = true,\n  emptyText = 'Drag and drop here a JCAMP-DX, zipped Bruker folder, Jeol jdf or NMRium file',\n}) {\n  const loader = useLoader();\n\n  const openFileDialogHadnler = useCallback(() => {\n    loader.open();\n  }, [loader]);\n\n  if (!isEmpty) {\n    return null;\n  }\n\n  return (\n    <div css={styles} onClick={openFileDialogHadnler}>\n      <p>{emptyText}</p>\n    </div>\n  );\n}\n\nexport default NoData;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\n\nconst styles = css`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: rgba(255, 255, 255, 0.25);\n  height: 100%;\n  flex-direction: column;\n  user-select: none;\n  position: absolute;\n  width: 100%;\n\n  svg {\n    animation-duration: 0.5s;\n    animation-name: spinAnimation;\n    animation-iteration-count: infinite;\n    animation-fill-mode: forwards;\n    animation-direction: inherit;\n    animation-timing-function: linear;\n    animation-duration: 1s;\n    width: 100px;\n    height: 100px;\n  }\n\n  @keyframes spinAnimation {\n    from {\n      transform: rotate(0deg);\n    }\n\n    to {\n      transform: rotate(360deg);\n    }\n  }\n`;\n\nexport default function DefaultSpinnerComponent() {\n  return (\n    <div css={styles}>\n      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 841.9 595.3\">\n        <g fill=\"#61DAFB\">\n          <path d=\"M666.3 296.5c0-32.5-40.7-63.3-103.1-82.4 14.4-63.6 8-114.2-20.2-130.4-6.5-3.8-14.1-5.6-22.4-5.6v22.3c4.6 0 8.3.9 11.4 2.6 13.6 7.8 19.5 37.5 14.9 75.7-1.1 9.4-2.9 19.3-5.1 29.4-19.6-4.8-41-8.5-63.5-10.9-13.5-18.5-27.5-35.3-41.6-50 32.6-30.3 63.2-46.9 84-46.9V78c-27.5 0-63.5 19.6-99.9 53.6-36.4-33.8-72.4-53.2-99.9-53.2v22.3c20.7 0 51.4 16.5 84 46.6-14 14.7-28 31.4-41.3 49.9-22.6 2.4-44 6.1-63.6 11-2.3-10-4-19.7-5.2-29-4.7-38.2 1.1-67.9 14.6-75.8 3-1.8 6.9-2.6 11.5-2.6V78.5c-8.4 0-16 1.8-22.6 5.6-28.1 16.2-34.4 66.7-19.9 130.1-62.2 19.2-102.7 49.9-102.7 82.3 0 32.5 40.7 63.3 103.1 82.4-14.4 63.6-8 114.2 20.2 130.4 6.5 3.8 14.1 5.6 22.5 5.6 27.5 0 63.5-19.6 99.9-53.6 36.4 33.8 72.4 53.2 99.9 53.2 8.4 0 16-1.8 22.6-5.6 28.1-16.2 34.4-66.7 19.9-130.1 62-19.1 102.5-49.9 102.5-82.3zm-130.2-66.7c-3.7 12.9-8.3 26.2-13.5 39.5-4.1-8-8.4-16-13.1-24-4.6-8-9.5-15.8-14.4-23.4 14.2 2.1 27.9 4.7 41 7.9zm-45.8 106.5c-7.8 13.5-15.8 26.3-24.1 38.2-14.9 1.3-30 2-45.2 2-15.1 0-30.2-.7-45-1.9-8.3-11.9-16.4-24.6-24.2-38-7.6-13.1-14.5-26.4-20.8-39.8 6.2-13.4 13.2-26.8 20.7-39.9 7.8-13.5 15.8-26.3 24.1-38.2 14.9-1.3 30-2 45.2-2 15.1 0 30.2.7 45 1.9 8.3 11.9 16.4 24.6 24.2 38 7.6 13.1 14.5 26.4 20.8 39.8-6.3 13.4-13.2 26.8-20.7 39.9zm32.3-13c5.4 13.4 10 26.8 13.8 39.8-13.1 3.2-26.9 5.9-41.2 8 4.9-7.7 9.8-15.6 14.4-23.7 4.6-8 8.9-16.1 13-24.1zM421.2 430c-9.3-9.6-18.6-20.3-27.8-32 9 .4 18.2.7 27.5.7 9.4 0 18.7-.2 27.8-.7-9 11.7-18.3 22.4-27.5 32zm-74.4-58.9c-14.2-2.1-27.9-4.7-41-7.9 3.7-12.9 8.3-26.2 13.5-39.5 4.1 8 8.4 16 13.1 24 4.7 8 9.5 15.8 14.4 23.4zM420.7 163c9.3 9.6 18.6 20.3 27.8 32-9-.4-18.2-.7-27.5-.7-9.4 0-18.7.2-27.8.7 9-11.7 18.3-22.4 27.5-32zm-74 58.9c-4.9 7.7-9.8 15.6-14.4 23.7-4.6 8-8.9 16-13 24-5.4-13.4-10-26.8-13.8-39.8 13.1-3.1 26.9-5.8 41.2-7.9zm-90.5 125.2c-35.4-15.1-58.3-34.9-58.3-50.6 0-15.7 22.9-35.6 58.3-50.6 8.6-3.7 18-7 27.7-10.1 5.7 19.6 13.2 40 22.5 60.9-9.2 20.8-16.6 41.1-22.2 60.6-9.9-3.1-19.3-6.5-28-10.2zM310 490c-13.6-7.8-19.5-37.5-14.9-75.7 1.1-9.4 2.9-19.3 5.1-29.4 19.6 4.8 41 8.5 63.5 10.9 13.5 18.5 27.5 35.3 41.6 50-32.6 30.3-63.2 46.9-84 46.9-4.5-.1-8.3-1-11.3-2.7zm237.2-76.2c4.7 38.2-1.1 67.9-14.6 75.8-3 1.8-6.9 2.6-11.5 2.6-20.7 0-51.4-16.5-84-46.6 14-14.7 28-31.4 41.3-49.9 22.6-2.4 44-6.1 63.6-11 2.3 10.1 4.1 19.8 5.2 29.1zm38.5-66.7c-8.6 3.7-18 7-27.7 10.1-5.7-19.6-13.2-40-22.5-60.9 9.2-20.8 16.6-41.1 22.2-60.6 9.9 3.1 19.3 6.5 28.1 10.2 35.4 15.1 58.3 34.9 58.3 50.6-.1 15.7-23 35.6-58.4 50.6zM320.8 78.4z\" />\n          <path d=\"M520.5 78.1z\" />\n        </g>\n      </svg>\n      <p>Loading ...</p>\n    </div>\n  );\n}\n","import { createContext, ReactElement } from 'react';\n\nimport DefaultSpinnerComponent from './DefaultSpinnerComponent';\n\nexport function defaultGetSpinner() {\n  return <DefaultSpinnerComponent />;\n}\n\nexport const spinnerContext = createContext<() => ReactElement>(\n  defaultGetSpinner,\n);\n\nexport const SpinnerProvider = spinnerContext.Provider;\n","import { useState, Fragment, useEffect, useContext } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport NoData from './NoData';\nimport { spinnerContext } from './SpinnerContext';\n\nfunction Spinner({ isLoading = true, emptyText = undefined }) {\n  const { data } = useChartData();\n  const [checkEmpty, startCheckEmpty] = useState(false);\n\n  useEffect(() => {\n    let timeour = null;\n    if (!isLoading) {\n      timeour = setTimeout(() => {\n        startCheckEmpty(true);\n      }, 500);\n    }\n    return () => {\n      clearTimeout(timeour);\n    };\n  }, [isLoading]);\n\n  const getSpinner = useContext(spinnerContext);\n\n  return (\n    <Fragment>\n      {isLoading && getSpinner()}\n      {checkEmpty && !isLoading && (\n        <NoData isEmpty={data && data.length === 0} emptyText={emptyText} />\n      )}\n    </Fragment>\n  );\n}\n\nexport default Spinner;\n","import { createContext, useContext } from 'react';\n\nexport const GlobalConetxt = createContext();\n\nexport const GlobalProvider = GlobalConetxt.Provider;\n\nexport function useGlobal() {\n  return useContext(GlobalConetxt);\n}\n","import {\n  useRef,\n  useLayoutEffect,\n  useCallback,\n  useState,\n  memo,\n  Fragment,\n} from 'react';\nimport { createPortal } from 'react-dom';\n\nimport { useGlobal } from '../../context/GlobalContext';\n\nconst styles = {\n  popup: {\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    pointerEvents: 'none',\n    backgroundColor: 'gray',\n    padding: '3px',\n    borderRadius: '2px',\n    color: 'white',\n    whiteSpace: 'nowrap',\n    fontSize: '10px',\n    fontFamily: 'tahoma',\n    textShadow: 'none',\n  },\n};\n\nfunction ToolTip({\n  style,\n  className,\n  popupPlacement = 'right',\n  children,\n  title,\n  offset = { x: 0, y: 0 },\n}) {\n  const refChild = useRef();\n  const refContent = useRef();\n  const [placement, setPlacement] = useState({ x: 0, y: 0 });\n  const [show, showToolTip] = useState(false);\n  const { elementsWraperRef } = useGlobal();\n\n  useLayoutEffect(() => {\n    const getPopupPlacement = () => {\n      let x;\n      let y;\n      const childBounding = refChild.current.getBoundingClientRect();\n      const contentBounding = refContent.current.getBoundingClientRect();\n      switch (popupPlacement) {\n        case 'left':\n          x = -contentBounding.width;\n          y =\n            childBounding.height / 2 -\n            ((childBounding.height / 2) * contentBounding.height) /\n              childBounding.height;\n          break;\n        case 'right':\n          x = childBounding.width;\n          y =\n            childBounding.height / 2 -\n            ((childBounding.height / 2) * contentBounding.height) /\n              childBounding.height;\n          break;\n        case 'top':\n          x =\n            childBounding.width / 2 -\n            ((childBounding.width / 2) * contentBounding.width) /\n              childBounding.width;\n          y = -childBounding.height;\n          break;\n        case 'bottom':\n          x =\n            childBounding.width / 2 -\n            ((childBounding.width / 2) * contentBounding.width) /\n              childBounding.width;\n          y = childBounding.height;\n          break;\n        default:\n          x = 0;\n          y = 0;\n          break;\n      }\n      return { x: x + childBounding.x, y: y + childBounding.y };\n    };\n    if (show) {\n      const pl = getPopupPlacement();\n      setPlacement(pl);\n    }\n  }, [popupPlacement, show]);\n\n  const mouseOverHandler = useCallback(() => {\n    showToolTip(true);\n  }, []);\n\n  const mouseLeaveHandler = useCallback(() => {\n    showToolTip(false);\n  }, []);\n\n  return (\n    <Fragment>\n      <div\n        style={{\n          position: 'relative',\n          height: '100%',\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          ...style.mainContainer,\n        }}\n        ref={refChild}\n        onMouseOver={mouseOverHandler}\n        onMouseOut={mouseLeaveHandler}\n      >\n        {children}\n      </div>\n      {show &&\n        createPortal(\n          <div\n            ref={refContent}\n            style={{\n              ...styles.popup,\n              transform: `translate(${placement.x + offset.x}px,${\n                placement.y + offset.y\n              }px)`,\n              zIndex: 999999999,\n              ...style.popup,\n            }}\n            className={className}\n          >\n            <span style={{ pointerEvents: 'none' }}>{title}</span>\n          </div>,\n          elementsWraperRef,\n        )}\n    </Fragment>\n  );\n}\n\nToolTip.defaultProps = {\n  style: {\n    popup: {},\n    mainContainer: {},\n  },\n};\n\nexport default memo(ToolTip);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport { memo } from 'react';\nimport { FaTimes } from 'react-icons/fa';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst styles = css`\n  background-color: transparent;\n  border: none;\n  height: 100%;\n  display:flex,\n  justify-content:center;\n  align-items:center;\n\n  svg {\n    fill: #ca0000;\n    font-size: 16px;\n  }\n`;\nfunction CloseButton({ onClick, popupTitle, popupPlacement, className }) {\n  return (\n    <div className={className}>\n      <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n        <button css={styles} type=\"button\" onClick={onClick}>\n          <FaTimes />\n        </button>\n      </ToolTip>\n    </div>\n  );\n}\n\nCloseButton.defaultProps = {\n  onClick: () => null,\n  popupTitle: 'Close',\n  popupPlacement: 'left',\n  className: '',\n};\nCloseButton.propTypes = {\n  onClick: PropTypes.func,\n  popupTitle: PropTypes.string,\n  popupPlacement: PropTypes.string,\n  className: PropTypes.string,\n};\n\nexport default memo(CloseButton);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { xGetFromToIndex } from 'ml-spectra-processing';\nimport { analyseMultiplet } from 'multiplet-analysis';\nimport { useState, useEffect } from 'react';\nimport { Chart } from 'react-jsgraph';\n\nimport CloseButton from '../elements/CloseButton';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  width: 900px;\n  height: 400px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    overflow-y: auto;\n    background-color: white;\n    padding-top: 10px;\n\n    .row {\n      outline: none;\n      display: flex !important;\n      flex-direction: row;\n      margin: 0;\n      div {\n        flex: 4;\n      }\n      .multiplicity {\n        flex: 2;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n    }\n\n    .row:nth-child(odd) {\n      background: #fafafa;\n    }\n  }\n`;\n\nconst loaderStyles = css`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n  user-select: none;\n  width: 900px;\n  height: 400px;\n\n  svg {\n    animation-duration: 0.5s;\n    animation-name: spinAnimation;\n    animation-iteration-count: infinite;\n    animation-fill-mode: forwards;\n    animation-direction: inherit;\n    animation-timing-function: linear;\n    animation-duration: 1s;\n    width: 100px;\n    height: 100px;\n  }\n\n  @keyframes spinAnimation {\n    from {\n      transform: rotate(0deg);\n    }\n\n    to {\n      transform: rotate(360deg);\n    }\n  }\n`;\n\nfunction MultipletAnalysisModal({\n  data,\n  activeSpectrum,\n  scaleX,\n  startX,\n  endX,\n  onClose,\n}) {\n  const [analysisData, setAnalysisData] = useState();\n  const [calcStart, setCalcStartStatus] = useState(false);\n  const [isCalcFinished, setCalcFinished] = useState(false);\n\n  useEffect(() => {\n    setTimeout(() => {\n      setCalcStartStatus(true);\n    }, 400);\n  }, []);\n\n  useEffect(() => {\n    if (activeSpectrum && startX && endX && calcStart) {\n      const {\n        data: { x, y },\n        info,\n      } = data[activeSpectrum.index];\n\n      const from = scaleX().invert(startX);\n      const to = scaleX().invert(endX);\n\n      const { fromIndex, toIndex } = xGetFromToIndex(x, {\n        from,\n        to,\n      });\n      const analysesProps = {\n        x: x.slice(fromIndex, toIndex),\n        y: y.slice(fromIndex, toIndex),\n      };\n      try {\n        const result = analyseMultiplet(analysesProps, {\n          frequency: info.originFrequency,\n          takeBestPartMultiplet: true,\n          symmetrizeEachStep: true,\n          debug: true,\n        });\n        setCalcFinished(true);\n        setAnalysisData(result);\n      } catch (err) {\n        // eslint-disable-next-line no-console\n        console.log(err);\n      }\n    }\n  }, [startX, endX, data, scaleX, activeSpectrum, calcStart]);\n\n  if (!isCalcFinished) {\n    return (\n      <div css={loaderStyles}>\n        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 841.9 595.3\">\n          <g fill=\"#61DAFB\">\n            <path d=\"M666.3 296.5c0-32.5-40.7-63.3-103.1-82.4 14.4-63.6 8-114.2-20.2-130.4-6.5-3.8-14.1-5.6-22.4-5.6v22.3c4.6 0 8.3.9 11.4 2.6 13.6 7.8 19.5 37.5 14.9 75.7-1.1 9.4-2.9 19.3-5.1 29.4-19.6-4.8-41-8.5-63.5-10.9-13.5-18.5-27.5-35.3-41.6-50 32.6-30.3 63.2-46.9 84-46.9V78c-27.5 0-63.5 19.6-99.9 53.6-36.4-33.8-72.4-53.2-99.9-53.2v22.3c20.7 0 51.4 16.5 84 46.6-14 14.7-28 31.4-41.3 49.9-22.6 2.4-44 6.1-63.6 11-2.3-10-4-19.7-5.2-29-4.7-38.2 1.1-67.9 14.6-75.8 3-1.8 6.9-2.6 11.5-2.6V78.5c-8.4 0-16 1.8-22.6 5.6-28.1 16.2-34.4 66.7-19.9 130.1-62.2 19.2-102.7 49.9-102.7 82.3 0 32.5 40.7 63.3 103.1 82.4-14.4 63.6-8 114.2 20.2 130.4 6.5 3.8 14.1 5.6 22.5 5.6 27.5 0 63.5-19.6 99.9-53.6 36.4 33.8 72.4 53.2 99.9 53.2 8.4 0 16-1.8 22.6-5.6 28.1-16.2 34.4-66.7 19.9-130.1 62-19.1 102.5-49.9 102.5-82.3zm-130.2-66.7c-3.7 12.9-8.3 26.2-13.5 39.5-4.1-8-8.4-16-13.1-24-4.6-8-9.5-15.8-14.4-23.4 14.2 2.1 27.9 4.7 41 7.9zm-45.8 106.5c-7.8 13.5-15.8 26.3-24.1 38.2-14.9 1.3-30 2-45.2 2-15.1 0-30.2-.7-45-1.9-8.3-11.9-16.4-24.6-24.2-38-7.6-13.1-14.5-26.4-20.8-39.8 6.2-13.4 13.2-26.8 20.7-39.9 7.8-13.5 15.8-26.3 24.1-38.2 14.9-1.3 30-2 45.2-2 15.1 0 30.2.7 45 1.9 8.3 11.9 16.4 24.6 24.2 38 7.6 13.1 14.5 26.4 20.8 39.8-6.3 13.4-13.2 26.8-20.7 39.9zm32.3-13c5.4 13.4 10 26.8 13.8 39.8-13.1 3.2-26.9 5.9-41.2 8 4.9-7.7 9.8-15.6 14.4-23.7 4.6-8 8.9-16.1 13-24.1zM421.2 430c-9.3-9.6-18.6-20.3-27.8-32 9 .4 18.2.7 27.5.7 9.4 0 18.7-.2 27.8-.7-9 11.7-18.3 22.4-27.5 32zm-74.4-58.9c-14.2-2.1-27.9-4.7-41-7.9 3.7-12.9 8.3-26.2 13.5-39.5 4.1 8 8.4 16 13.1 24 4.7 8 9.5 15.8 14.4 23.4zM420.7 163c9.3 9.6 18.6 20.3 27.8 32-9-.4-18.2-.7-27.5-.7-9.4 0-18.7.2-27.8.7 9-11.7 18.3-22.4 27.5-32zm-74 58.9c-4.9 7.7-9.8 15.6-14.4 23.7-4.6 8-8.9 16-13 24-5.4-13.4-10-26.8-13.8-39.8 13.1-3.1 26.9-5.8 41.2-7.9zm-90.5 125.2c-35.4-15.1-58.3-34.9-58.3-50.6 0-15.7 22.9-35.6 58.3-50.6 8.6-3.7 18-7 27.7-10.1 5.7 19.6 13.2 40 22.5 60.9-9.2 20.8-16.6 41.1-22.2 60.6-9.9-3.1-19.3-6.5-28-10.2zM310 490c-13.6-7.8-19.5-37.5-14.9-75.7 1.1-9.4 2.9-19.3 5.1-29.4 19.6 4.8 41 8.5 63.5 10.9 13.5 18.5 27.5 35.3 41.6 50-32.6 30.3-63.2 46.9-84 46.9-4.5-.1-8.3-1-11.3-2.7zm237.2-76.2c4.7 38.2-1.1 67.9-14.6 75.8-3 1.8-6.9 2.6-11.5 2.6-20.7 0-51.4-16.5-84-46.6 14-14.7 28-31.4 41.3-49.9 22.6-2.4 44-6.1 63.6-11 2.3 10.1 4.1 19.8 5.2 29.1zm38.5-66.7c-8.6 3.7-18 7-27.7 10.1-5.7-19.6-13.2-40-22.5-60.9 9.2-20.8 16.6-41.1 22.2-60.6 9.9 3.1 19.3 6.5 28.1 10.2 35.4 15.1 58.3 34.9 58.3 50.6-.1 15.7-23 35.6-58.4 50.6zM320.8 78.4z\" />\n            <path d=\"M520.5 78.1z\" />\n          </g>\n        </svg>\n        <p>Analyse Multiplet in progress. Please wait ...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>Analyse Multiplet</span>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div className=\"container\">\n        {analysisData &&\n          analysisData.debug &&\n          analysisData.debug.steps.map((d, index) => (\n            // eslint-disable-next-line react/no-array-index-key\n            <div key={index} className=\"row\">\n              <Chart\n                chart={{\n                  series: {\n                    type: 'line',\n                    data: d.multiplet,\n                  },\n                }}\n                style={{ height: 200, width: 400, overflow: 'auto' }}\n              />\n              <div className=\"multiplicity\">\n                <p>\n                  {analysisData.j[index]\n                    ? `${analysisData.j[index]?.multiplicity}: ${analysisData.j[\n                        index\n                      ]?.coupling.toFixed(3)} Hz`\n                    : ''}\n                </p>\n              </div>\n              <Chart\n                chart={{\n                  series: {\n                    type: 'line',\n                    data: d.errorFunction,\n                  },\n                }}\n                style={{ height: 200, width: 400, overflow: 'auto' }}\n              />\n            </div>\n          ))}\n      </div>\n    </div>\n  );\n}\n\nMultipletAnalysisModal.defaultProps = {\n  onClose: () => {\n    return null;\n  },\n};\nexport default MultipletAnalysisModal;\n","const initSetting = {\n  controllers: {\n    mws: { low: 2, high: 20 },\n  },\n  formatting: {\n    nucleus: [\n      { key: '1H', name: '1H', value: '0.00' },\n      { key: '13C', name: '13C', value: '0.00' },\n      { key: '15N', name: '15N', value: '0.00' },\n      { key: '19F', name: '19F', value: '0.00' },\n      { key: '29Si', name: '29Si', value: '0.00' },\n      { key: '31P', name: '31P', value: '0.00' },\n    ],\n  },\n};\n\nexport default initSetting;\n","import lodashGet from 'lodash/get';\nimport lodashSet from 'lodash/set';\nimport { useCallback, useEffect, useState } from 'react';\n\nfunction useStateWithLocalStorage(localStorageKey, key = null) {\n  const [value, setValue] = useState(\n    localStorage.getItem(localStorageKey) || '{}',\n  );\n  useEffect(() => {\n    localStorage.setItem(localStorageKey, value);\n  }, [localStorageKey, value]);\n\n  const setData = useCallback(\n    (data, key = null) => {\n      let castData = JSON.parse(value);\n      if (key) {\n        lodashSet(castData, key, data);\n      } else {\n        castData = { ...castData, ...data };\n      }\n      setValue(JSON.stringify(castData));\n    },\n    [value],\n  );\n  return [\n    key ? lodashGet(JSON.parse(value), key, {}) : JSON.parse(value),\n    setData,\n  ];\n}\n\nconst getLocalStorage = (localStorageKey, isJson = true) => {\n  const settings = localStorage.getItem(localStorageKey);\n  return settings && isJson ? JSON.parse(settings) : settings;\n};\n\nconst storeData = (localStorageKey, value) => {\n  localStorage.setItem(localStorageKey, value);\n};\nconst removeData = (localStorageKey) => {\n  localStorage.removeItem(localStorageKey);\n};\n\nconst getValue = (object, keyPath, defaultValue = null) => {\n  return lodashGet(object, keyPath, defaultValue);\n};\n\nexport {\n  useStateWithLocalStorage,\n  getLocalStorage,\n  getValue,\n  storeData,\n  removeData,\n};\n","import initSetting from '../../constants/InitSetting';\nimport { getLocalStorage, getValue } from '../../utility/LocalStorage';\n\nexport const zoomDefaultValues = {\n  lowStep: initSetting.controllers.mws.low,\n  highStep: initSetting.controllers.mws.high,\n  speedThreshold: 3,\n};\n\nexport default class Spectrum1DZoomHelper {\n  constructor(scale = 1, options = {}) {\n    this.scale = scale;\n    this.speedThreshold =\n      options.speedThreshold || zoomDefaultValues.speedThreshold;\n    this.slowZoomStep = options.slowZoomStep || zoomDefaultValues.lowStep;\n    this.fastZoomStep = options.fastZoomStep || zoomDefaultValues.highStep;\n  }\n\n  // eslint-disable-next-line no-unused-vars\n  wheel(deltaY, deltaMode) {\n    const deltaYValue =\n      Math.abs(deltaY).toString().length === 1\n        ? Math.abs(deltaY)\n        : Math.abs(deltaY) / 100;\n    const settings = getLocalStorage('nmr-general-settings');\n\n    const _slowZoomStep = getValue(settings, 'general.controllers.mws.low');\n    const _fastZoomStep = getValue(settings, 'general.controllers.mws.high');\n\n    const LOW_STEP = _slowZoomStep\n      ? 0.01 * _slowZoomStep\n      : 0.01 * this.slowZoomStep;\n    const FAST_STEP = _fastZoomStep\n      ? 0.05 * _fastZoomStep\n      : 0.05 * this.fastZoomStep;\n\n    let ZOOM_STEP = deltaYValue <= this.speedThreshold ? LOW_STEP : FAST_STEP;\n\n    const direction = Math.sign(deltaY);\n    const _scale =\n      direction === -1 ? this.scale + ZOOM_STEP : this.scale - ZOOM_STEP;\n    if (_scale >= 0 || _scale === 0) {\n      this.scale = _scale;\n    } else {\n      this.scale = 0;\n    }\n  }\n\n  getScale() {\n    return this.scale;\n  }\n\n  setScale(scale) {\n    this.scale = scale;\n  }\n}\n","import { zoomIdentity, scaleLinear } from 'd3';\n\nimport Spectrum1DZoomHelper from '../helper/Spectrum1DZoomHelper';\n\nexport const spectraZoomHanlders = {};\nexport const integralZoomHanlder = new Spectrum1DZoomHelper(0.5);\n\nexport const ZoomType = {\n  HORIZONTAL: 'HORIZONTAL',\n  VERTICAL: 'VERTICAL',\n  STEP_HROZENTAL: 'STEP_HROZENTAL',\n  FULL: 'FULL',\n};\n\nexport function initZoom1DHandler(data) {\n  data.forEach((datum) => {\n    if (!spectraZoomHanlders[datum.id] && datum.info.dimension === 1) {\n      spectraZoomHanlders[datum.id] = new Spectrum1DZoomHelper();\n    }\n  });\n}\n\nexport function wheel(\n  deltaY,\n  deltaMode,\n  { data, activeSpectrum, activeTab },\n  id = null,\n) {\n  if (activeSpectrum || id) {\n    spectraZoomHanlders[id ? id : activeSpectrum.id].wheel(deltaY, deltaMode);\n  } else {\n    data.forEach((datum) => {\n      if (datum.info.dimension === 1 && activeTab === datum.info.nucleus) {\n        spectraZoomHanlders[datum.id].wheel(deltaY, deltaMode);\n      }\n    });\n  }\n}\nexport function getScaleByID(id) {\n  return { [id]: spectraZoomHanlders[id].getScale(id) };\n}\n\nexport function getScale({ data, activeTab }) {\n  return data.reduce((acc, datum) => {\n    if (datum.info.dimension === 1 && activeTab === datum.info.nucleus) {\n      acc[datum.id] = spectraZoomHanlders[datum.id].getScale();\n    }\n    return acc;\n  }, {});\n}\n\nexport function setScale(scale) {\n  if (typeof scale === 'number') {\n    Object.keys(spectraZoomHanlders).forEach((id) => {\n      spectraZoomHanlders[id].setScale(scale);\n    });\n  } else if (typeof scale === 'object') {\n    Object.keys(scale).forEach((id) => {\n      spectraZoomHanlders[id].setScale(scale[id]);\n    });\n  } else {\n    throw Error('scale must be number or Object');\n  }\n}\n/**\n *\n * @param {Draft} draft\n * @param {number} defaultScale\n * @param {string | null } [spectrumID = null]\n * @param {boolean} [useOrigin = false]\n */\nfunction setZoom(draft, defaultScale = null, spectrumID = null) {\n  const { height, margin, activeSpectrum } = draft;\n  if (defaultScale) {\n    setScale(defaultScale);\n  }\n  const scale = getScale(draft);\n  draft.zoomFactor = { scale };\n\n  if (activeSpectrum === null && spectrumID === null) {\n    draft.yDomains = Object.keys(draft.yDomains).reduce((acc, id) => {\n      const _scale = scaleLinear(draft.originDomain.yDomains[id], [\n        height - margin.bottom,\n        margin.top,\n      ]);\n      const [min, max] = draft.originDomain.yDomains[id];\n      const maxPoint = Math.max(Math.abs(max), Math.abs(min));\n      const scalePoint = maxPoint === max ? 0 : min;\n      const t = zoomIdentity\n        .translate(\n          0,\n          Math.sign(scalePoint) >= 0 ? _scale(scalePoint) : _scale(scalePoint),\n        )\n        .scale(scale[id])\n        .translate(0, -_scale(0));\n      const yDomain = t.rescaleY(_scale).domain();\n      acc[id] = yDomain;\n      return acc;\n    }, {});\n  } else {\n    const spectrumId = spectrumID ? spectrumID : activeSpectrum.id;\n    const _scale = scaleLinear(draft.originDomain.yDomains[spectrumId], [\n      height - margin.bottom,\n      margin.top,\n    ]);\n\n    const t = zoomIdentity\n      .translate(0, _scale(0))\n      .scale(scale[spectrumId])\n      .translate(0, -_scale(0));\n\n    const yDomain = t.rescaleY(_scale).domain();\n    draft.yDomains = {\n      ...draft.yDomains,\n      [spectrumId]: yDomain,\n    };\n  }\n}\n\nfunction setZoom1D(draft, height, margin, index, defaultScale = null) {\n  const { originDomain, tabActiveSpectrum, activeTab } = draft;\n\n  const { id } = tabActiveSpectrum[activeTab.split(',')[index]];\n  if (defaultScale) {\n    setScale(defaultScale);\n  }\n  const scale = getScaleByID(id);\n  draft.zoomFactor = { scale };\n\n  const _scale = scaleLinear(originDomain.yDomains[id], [\n    height - margin,\n    margin,\n  ]);\n  const t = zoomIdentity\n    .translate(0, _scale(0))\n    .scale(scale[id])\n    .translate(0, -_scale(0));\n  let yDomain = t.rescaleY(_scale).domain();\n  draft.yDomains[id] = yDomain;\n}\n\nfunction setIntegralZoom(scale, draft) {\n  if (draft.activeSpectrum) {\n    const { height, margin } = draft;\n    if (draft.originIntegralYDomain[draft.activeSpectrum.id]) {\n      const _scale = scaleLinear(\n        draft.originIntegralYDomain[draft.activeSpectrum.id],\n        [height - margin.bottom, margin.top],\n      );\n\n      const scaleValue = scale < 0.1 ? 0.05 : scale;\n\n      const t = zoomIdentity\n        .translate(0, _scale(0))\n        .scale(scaleValue)\n        .translate(0, -_scale(0));\n\n      const newYDomain = t.rescaleY(_scale).domain();\n\n      draft.integralZoomFactor = { scale };\n      const activeSpectrum = draft.activeSpectrum;\n      draft.integralsYDomains[activeSpectrum.id] = newYDomain;\n    }\n  }\n}\n\nexport { setZoom, setZoom1D, setIntegralZoom };\n","import { scaleLinear } from 'd3';\n\nfunction getXScale(state, spectrumId = null) {\n  const { width, margin, xDomains, xDomain, mode } = state;\n  const range =\n    mode === 'RTL'\n      ? [width - margin.right, margin.left]\n      : [margin.left, width - margin.right];\n  return scaleLinear(spectrumId ? xDomains[spectrumId] : xDomain, range);\n}\n\nfunction getYScale(state, spectrumId = null) {\n  const { height, margin, verticalAlign, yDomain, yDomains } = state;\n  const _height =\n    verticalAlign.flag && !verticalAlign.stacked\n      ? (height - 30) / 2\n      : height - margin.bottom - 30;\n\n  let domainY = [];\n  if (spectrumId === null || yDomains[spectrumId] === undefined) {\n    domainY = [0, yDomain[1]];\n  } else {\n    domainY = [0, yDomains[spectrumId][1]];\n  }\n  return scaleLinear(domainY, [_height, margin.top]);\n}\n\nfunction getIntegralYScale(state, spectrumId) {\n  const { height, margin, verticalAlign, integralsYDomains } = state;\n  const _height =\n    verticalAlign.flag && !verticalAlign.stacked ? height / 2 : height;\n\n  return scaleLinear(integralsYDomains[spectrumId], [\n    _height - (margin.bottom + _height * 0.3),\n    margin.top,\n  ]);\n}\n\nexport { getXScale, getYScale, getIntegralYScale };\n","import { produce } from 'immer';\n\nimport { getXScale, getYScale } from '../1d/utilities/scale';\n\nexport const SET_X_SCALE = 'SET_X_SCALE';\nexport const SET_Y_SCALE = 'SET_Y_SCALE';\nexport const SET_SCALE = 'SET_SCALE';\n\nexport const scaleInitialState = {\n  scaleX: null,\n  scaleY: null,\n};\n\nexport function scaleReducer(state, action) {\n  switch (action.type) {\n    case SET_X_SCALE:\n      return produce(state, (draft) => {\n        draft.scaleX = (spectrumId = null) => getXScale(action, spectrumId);\n      });\n    case SET_Y_SCALE:\n      return produce(state, (draft) => {\n        draft.scaleY = (spectrumId = null) => getYScale(action, spectrumId);\n      });\n    case SET_SCALE:\n      return produce(state, (draft) => {\n        draft.scaleX = (spectrumId = null) =>\n          getXScale(action.payload, spectrumId);\n        draft.scaleY = (spectrumId = null) =>\n          getYScale(action.payload, spectrumId);\n      });\n\n    default:\n      return state;\n  }\n}\n","export const INITIATE = 'INITIATE';\nexport const SAVE_DATA_AS_JSON = 'SAVE_DATA_AS_JSON';\nexport const LOAD_JSON_FILE = 'LOAD_JSON_FILE';\nexport const LOAD_JCAMP_FILE = 'LOAD_JCAMP_FILE';\nexport const LOAD_NMREDATA_FILE = 'LOAD_NMREDATA_FILE';\nexport const LOAD_MOL_FILE = 'LOAD_MOL_FILE';\nexport const LOAD_ZIP_FILE = 'LOAD_ZIP_FILE';\nexport const LOAD_JDF_FILE = 'LOAD_JDF_FILE';\nexport const ADD_PEAK = 'ADD_PEAK';\nexport const ADD_PEAKS = 'ADD_PEAKS';\nexport const DELETE_PEAK_NOTATION = 'DELETE_PEAK_NOTATION';\nexport const SHIFT_SPECTRUM = 'SHIFT_SPECTRUM';\nexport const SET_X_DOMAIN = 'SET_X_DOMAIN';\nexport const SET_Y_DOMAIN = 'SET_Y_DOMAIN';\nexport const SET_ORIGINAL_DOMAIN = 'SET_ORIGINAL_DOMAIN';\nexport const SET_WIDTH = 'SET_WIDTH';\nexport const SET_DIMENSIONS = 'SET_DIMENSIONS';\nexport const SET_SELECTED_TOOL = 'SET_SELECTED_TOOL';\nexport const SET_SELECTED_FILTER = 'SET_SELECTED_FILTER';\nexport const CHANGE_SPECTRUM_SETTING = 'CHANGE_SPECTRUM_SETTING';\nexport const CHANGE_SPECTRUM_TYPE = 'CHANGE_SPECTRUM_TYPE';\nexport const FULL_ZOOM_OUT = 'FULL_ZOOM_OUT';\nexport const CHANGE_VISIBILITY = 'CHANGE_VISIBILITY';\nexport const CHANGE_PEAKS_MARKERS_VISIBILITY =\n  'CHANGE_PEAKS_MARKERS_VISIBILITY';\nexport const CHANGE_ACTIVE_SPECTRUM = 'CHANGE_ACTIVE_SPECTRUM';\nexport const CHANGE_SPECTRUM_COLOR = 'CHANGE_SPECTRUM_COLOR';\nexport const ADD_INTEGRAL = 'ADD_INTEGRAL';\nexport const DELETE_INTEGRAL = 'DELETE_INTEGRAL';\nexport const TOGGLE_REAL_IMAGINARY_VISIBILITY =\n  'TOGGLE_REAL_IMAGINARY_VISIBILITY';\nexport const SET_ZOOM_FACTOR = 'SET_ZOOM_FACTOR';\nexport const ADD_MOLECULE = 'ADD_MOLECULE';\nexport const SET_MOLECULE = 'SET_MOLECULE';\nexport const DELETE_MOLECULE = 'DELETE_MOLECULE';\nexport const SET_CORRELATION = 'SET_CORRELATION';\nexport const SET_CORRELATIONS = 'SET_CORRELATIONS';\nexport const SET_CORRELATIONS_MF = 'SET_CORRELATIONS_MF';\nexport const SET_CORRELATIONS_TOLERANCE = 'SET_CORRELATIONS_TOLERANCE';\nexport const DELETE_SPECTRA = 'DELETE_SPECTRA';\nexport const CHANGE_SPECTRUM_DISPLAY_VIEW_MODE =\n  'CHANGE_SPECTRUM_DISPLAY_VIEW_MODE';\nexport const SET_INTEGRAL_Y_DOMAIN = 'SET_INTEGRAL_Y_DOMAIN';\nexport const RESIZE_INTEGRAL = 'RESIZE_INTEGRAL';\nexport const BRUSH_END = 'BRUSH_END';\nexport const RESET_DOMAIN = 'RESET_X_DOMAIN';\nexport const CHANGE_INTEGRAL_ZOOM = 'CHANGE_INTEGRAL_ZOOM';\nexport const ENABLE_FILTER = 'ENABLE_FILTER';\nexport const DELETE_FILTER = 'DELETE_FILTER';\nexport const DELETE_SPECTRA_FILTER = 'DELETE_SPECTRA_FILTER';\nexport const APPLY_ZERO_FILLING_FILTER = 'APPLY_ZERO_FILLING_FILTER';\nexport const APPLY_FFT_FILTER = 'APPLY_FFT_FILTER';\nexport const CALCULATE_MANUAL_PHASE_CORRECTION_FILTER =\n  'CALCULATE_MANUAL_PHASE_CORRECTION_FILTER';\nexport const APPLY_MANUAL_PHASE_CORRECTION_FILTER =\n  'APPLY_MANUAL_PHASE_CORRECTION_FILTER';\nexport const APPLY_AUTO_PHASE_CORRECTION_FILTER =\n  'APPLY_AUTO_PHASE_CORRECTION_FILTER';\nexport const APPLY_ABSOLUTE_FILTER = 'APPLY_ABSOLUTE_FILTER';\nexport const SET_VERTICAL_INDICATOR_X_POSITION =\n  'SET_VERTICAL_INDICATOR_X_POSITION';\nexport const AUTO_PEAK_PICKING = 'AUTO_PEAK_PICKING';\nexport const AUTO_RANGES_DETECTION = 'AUTO_RANGES_DETECTION';\nexport const AUTO_ZONES_DETECTION = 'AUTO_ZONES_DETECTION';\nexport const DELETE_RANGE = 'DELETE_RANGE';\nexport const SET_SELECTED_OPTIONS_PANEL = 'SET_SELECTED_OPTIONS_PANEL';\nexport const SET_LOADING_FLAG = 'SET_LOADING_FLAG';\nexport const RESET_SELECTED_TOOL = 'RESET_SELECTED_TOOL';\nexport const SET_SPECTRUMS_VERTICAL_ALIGN = 'SET_SPECTRUMS_VERTICAL_AlIGN';\nexport const SAVE_AS_SVG = 'SAVE_AS_SVG';\nexport const CHANGE_INTEGRAL_DATA = 'CHANGE_INTEGRAL_DATA';\nexport const SET_PREFERENCES = 'SET_PREFERENCES';\nexport const SET_ACTIVE_TAB = 'SET_ACTIVE_TAB';\nexport const CHANGE_INTEGRAL_SUM = 'CHANGE_INTEGRAL_SUM';\nexport const ADD_BASE_LINE_ZONE = 'ADD_BASE_LINE_ZONE';\nexport const DELETE_BASE_LINE_ZONE = 'DELETE_BASE_LINE_ZONE';\nexport const APPLY_BASE_LINE_CORRECTION_FILTER =\n  'APPLY_BASE_LINE_CORRECTION_FILTER';\nexport const SET_KEY_PREFERENCES = 'SET_KEY_PREFERENCES';\nexport const APPLY_KEY_PREFERENCES = 'APPLY_KEY_PREFERENCES';\nexport const RESIZE_RANGE = 'RESIZE_RANGE';\nexport const CHANGE_RANGE_SUM = 'CHANGE_RANGE_SUM';\nexport const ADD_RANGE = 'ADD_RANGE';\nexport const SET_2D_LEVEL = 'SET_2D_LEVEL';\nexport const ADD_2D_ZONE = 'ADD_2D_ZONE';\nexport const DELETE_2D_ZONE = 'DELETE_2D_ZONE';\nexport const ADD_MISSING_PROJECTION = 'ADD_MISSING_PROJECTION';\nexport const SET_FILTER_SNAPSHOT = 'SET_FILTER_SNAPSHOT';\nexport const CHANGE_RANGE_RELATIVE = 'CHANGE_RANGE_RELATIVE';\nexport const CHANGE_RANGE_SIGNAL_VALUE = 'CHANGE_RANGE_SIGNAL_VALUE';\nexport const CHANGE_RANGE_SIGNAL_KIND = 'CHANGE_RANGE_SIGNAL_KIND';\nexport const SAVE_EDITED_RANGE = 'SAVE_EDITED_RANGE';\nexport const UNLINK_RANGE = 'UNLINK_RANGE';\nexport const SET_DIAID_RANGE = 'SET_DIAID_RANGE';\nexport const CHANGE_INTEGRAL_RELATIVE = 'CHANGE_INTEGRAL_RELATIVE';\nexport const ANALYZE_SPECTRA = 'ANALYZE_SPECTRA';\nexport const DELETE_ANALYZE_SPECTRA_RANGE = 'DELETE_ANALYZE_SPECTRA_RANGE';\nexport const RESIZE_ANALYZE_SPECTRA_RANGE = 'RESIZE_ANALYZE_SPECTRA_RANGE';\nexport const SET_ANALYZE_SPECTRA_COLUMNS = 'SET_ANALYZE_SPECTRA_COLUMNS';\nexport const FILTER_SPECTRA_COLUMN = 'FILTER_SPECTRA_COLUMN';\nexport const ALIGN_SPECTRA = 'ALIGN_SPECTRA';\nexport const CHANGE_ZONE_SIGNAL_VALUE = 'CHANGE_ZONE_SIGNAL_VALUE';\nexport const CHANGE_ZONE_SIGNAL_KIND = 'CHANGE_ZONE_SIGNAL_KIND';\nexport const UNLINK_ZONE = 'UNLINK_ZONE';\nexport const SET_DIAID_ZONE = 'SET_DIAID_ZONE';\nexport const PREDICT_SPECTRA = 'PREDICT_SPECTRA';\nexport const SET_SPECTRA_SAME_TOP = 'SET_SPECTRA_SAME_TOP';\nexport const RESET_SPECTRA_SCALE = 'RESET_SPECTRA_SCALE';\nexport const SET_MOUSE_OVER_DISPLAYER = 'SET_MOUSE_OVER_DISPLAYER';\nexport const APPLY_MULTIPLE_SPECTRA_FILTER = 'APPLY_MULTIPLE_SPECTRA_FILTER';\nexport const ADD_EXCLUSION_ZONE = 'ADD_EXCLUSION_ZONE';\nexport const DELETE_EXCLUSION_ZONE = 'DELETE_EXCLUSION_ZONE';\n","import { reimAbsolute } from 'ml-spectra-processing';\n\nexport const id = 'absolute';\nexport const name = 'Absolute';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('absolute not applicable on this data');\n  }\n\n  datum1D.data.re = reimAbsolute(datum1D.data);\n  datum1D.data.im = new Float64Array(0);\n  datum1D.info = { ...datum1D.info, isComplex: false };\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","import { reimAutoPhaseCorrection } from 'ml-spectra-processing';\n\nexport const id = 'autoPhaseCorrection';\nexport const name = 'Automatic phase correction';\n\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [options={}]\n * @param {number} [options.ph0=0]\n * @param {number} [options.ph1=0]\n */\n\nconst defaultOptions = {\n  magnitudeMode: false,\n  minRegSize: 30,\n  maxDistanceToJoin: 256,\n};\n\nexport function apply(datum1D, options = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('phaseCorrection not applicable on this data');\n  }\n  options = Object.assign({}, defaultOptions, options);\n\n  return reimAutoPhaseCorrection(datum1D.data, options);\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  let reduced = Object.assign({}, previousValue);\n  for (const k in reduced) {\n    reduced[k] += newValue[k];\n  }\n  return {\n    once: true,\n    reduce: reduced,\n  };\n}\n","import airPLS from 'ml-airpls';\nimport equallySpaced from 'ml-array-xy-equally-spaced';\nimport baselineRegression from 'ml-baseline-correction-regression';\nimport PolynomialRegression from 'ml-regression-polynomial';\n\nexport const id = 'baselineCorrection';\nexport const name = 'Baseline correction';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport const baselineAlgorithms = {\n  airpls: 'airPLS',\n  polynomial: 'Polynomial',\n};\n\nexport function apply(datum1D, options = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('baselineCorrection not applicable on this data');\n  }\n  const { algorithm, zones } = options;\n  let { x, re } = datum1D.data;\n\n  let corrected;\n  switch (algorithm) {\n    case 'airpls':\n      corrected = airPLS(x, re, options).corrected;\n      break;\n    case 'polynomial':\n      {\n        let reduced = equallySpaced(\n          { x, y: re },\n          { numberOfPoints: 4096, zones },\n        );\n        if (zones.length === 0) {\n          let { regression } = baselineRegression(\n            reduced.x,\n            reduced.y,\n            options,\n          );\n          corrected = new Float64Array(x.length);\n          for (let i = 0; i < re.length; i++) {\n            corrected[i] = re[i] - regression.predict(x[i]);\n          }\n        } else {\n          let polynomialRegression = new PolynomialRegression(\n            x,\n            re,\n            options.degree,\n          );\n          corrected = new Float64Array(x.length);\n          for (let i = 0; i < re.length; i++) {\n            corrected[i] = re[i] - polynomialRegression.predict(x[i]);\n          }\n        }\n      }\n\n      break;\n    default:\n      throw new Error(`baselineCorrection: algorithm unknown: ${algorithm}`);\n  }\n\n  Object.assign(datum1D.data, { re: corrected });\n}\n\nexport function isApplicable(datum1D) {\n  if (!datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n\n/**\n * Will extract x/y points based on zones\n * @param {*} x\n * @param {*} re\n * @param {*} zones\n */\n// eslint-disable-next-line no-unused-vars,no-empty-function\nfunction getZones(x, re, zones = []) {}\n","import { mean } from 'ml-stat/array';\n\nexport const id = 'centerMean';\nexport const name = 'Center Mean';\n\n/**\n * Computes the arithmetic mean of the given values\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Center Mean is not applicable on this data');\n  }\n\n  const re = datum1D.data.re.slice(0);\n  const im = datum1D.data.im?.slice(0);\n\n  const reMean = mean(re);\n  const imMean = mean(im || []);\n\n  for (let i = 0; i < re.length; i++) {\n    re[i] -= reMean;\n    if (im) {\n      im[i] -= imMean;\n    }\n  }\n\n  datum1D.data.re = re;\n\n  if (im) {\n    datum1D.data.im = im;\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","export const id = 'digitalFilter';\nexport const name = 'Digital Filter';\n\n/**\n * Move points from the beginning to the end of FID and performs a first order phase correction\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D, options = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Digital Filter is not applicable on this data');\n  }\n\n  let { digitalFilterValue = 0 } = options;\n  let re = new Float64Array(datum1D.data.re);\n  let im = new Float64Array(datum1D.data.im);\n\n  let pointsToShift = Math.floor(digitalFilterValue);\n\n  const skip = 0;\n  pointsToShift += 0;\n\n  const newRe = new Float64Array(re.length);\n  const newIm = new Float64Array(im.length);\n  newRe.set(re.slice(pointsToShift));\n  newRe.set(re.slice(skip, pointsToShift), re.length - pointsToShift);\n  newIm.set(im.slice(pointsToShift));\n  newIm.set(im.slice(skip, pointsToShift), im.length - pointsToShift);\n\n  datum1D.data.re = newRe;\n  datum1D.data.im = newIm;\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: true,\n    reduce: undefined,\n  };\n}\n","import equallySpaced from 'ml-array-xy-equally-spaced';\n\nexport const id = 'equallySpaced';\nexport const name = 'Equally Spaced';\n\n/**\n * Equally Spaced\n * **\n * Function that returns a Number array of equally spaced numberOfPoints\n * containing a representation of intensities of the spectra arguments x\n * and y.\n *\n * The options parameter contains an object in the following form:\n * from: starting point\n * to: last point\n * numberOfPoints: number of points between from and to\n * variant: \"slot\" or \"smooth\" - smooth is the default option\n *\n * The slot variant consist that each point in the new array is calculated\n * averaging the existing points between the slot that belongs to the current\n * value. The smooth variant is the same but takes the integral of the range\n * of the slot and divide by the step size between two points in the new array.\n *\n * @param {Datum1d} datum1d\n * @param {Object} options.from\n * @param {number} options.to\n * @param {number} options.numberOfPoints\n * @param {Array<{from:number;to:number}>} options.exclusions\n */\n\nexport function apply(datum1D, options = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Equally Spaced is not applicable on this data');\n  }\n  const { from, to, numberOfPoints, exclusions } = options;\n  const { x, re, im } = datum1D.data;\n  const XREdata = equallySpaced(\n    { x, y: re },\n    { from, to, numberOfPoints, exclusions },\n  );\n\n  datum1D.data.x = XREdata.x;\n  datum1D.data.re = XREdata.y;\n  if (im) {\n    const XIMdata = equallySpaced(\n      { x, y: re },\n      { from, to, numberOfPoints, exclusions },\n    );\n    datum1D.data.im = XIMdata.y;\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","import { reimFFT, reimPhaseCorrection } from 'ml-spectra-processing';\n\nexport const id = 'fft';\nexport const name = 'FFT';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('fft not applicable on this data');\n  }\n\n  let digitalFilterApplied = datum1D.filters.some(\n    (e) => e.name === 'digitalFilter' && e.flag,\n  );\n\n  Object.assign(datum1D.data, reimFFT(datum1D.data, { applyZeroShift: true }));\n\n  if (digitalFilterApplied) {\n    let { digitalFilter } = datum1D.info;\n    let ph1 = (digitalFilter - Math.floor(digitalFilter)) * Math.PI * 2;\n    Object.assign(datum1D.data, reimPhaseCorrection(datum1D.data, 0, ph1));\n  }\n\n  datum1D.data.x = generateXAxis(datum1D);\n  datum1D.info = { ...datum1D.info, isFid: false };\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: true,\n    reduce: undefined,\n  };\n}\n\nfunction generateXAxis(datum1D) {\n  const info = datum1D.info;\n  const baseFrequency = parseFloat(info.baseFrequency);\n  const frequencyOffset = parseFloat(info.frequencyOffset);\n  const spectralWidth = parseFloat(info.spectralWidth);\n  const offset = frequencyOffset / baseFrequency;\n  let spectralHalfWidth = 0.5 * spectralWidth;\n  let nbPoints = datum1D.data.x.length;\n  let firstPoint = offset - spectralHalfWidth;\n  let dx = spectralWidth / (nbPoints - 1);\n  const xAxis = new Array(nbPoints);\n  for (let i = 0; i < nbPoints; i++) {\n    xAxis[i] = firstPoint;\n    firstPoint += dx;\n  }\n  return xAxis;\n}\n","import { xGetFromToIndex } from 'ml-spectra-processing';\n\nexport const id = 'fromTo';\nexport const name = 'From/To';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D, options = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('From/To filter not applicable on this data');\n  }\n  const { x, re, im } = datum1D.data;\n  const { from, to } = options;\n  const { fromIndex, toIndex } = xGetFromToIndex(x, { from, to });\n\n  datum1D.data.x = x.slice(fromIndex, toIndex);\n  datum1D.data.re = re.slice(fromIndex, toIndex);\n  if (im) {\n    datum1D.data.im = im.slice(fromIndex, toIndex);\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: newValue,\n  };\n}\n","export const id = 'lineBroadening';\nexport const name = 'Line broadening';\n\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [value]\n */\n\nexport function apply(datum1D, value) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('lineBroadening not applicable on this data');\n  }\n\n  let grpdly = datum1D.info.digitalFilter;\n  let pointsToShift;\n  if (grpdly > 0) {\n    pointsToShift = Math.floor(grpdly);\n  } else {\n    pointsToShift = 0;\n  }\n\n  const re = datum1D.data.re;\n  const im = datum1D.data.im;\n  const t = datum1D.data.x;\n\n  const length = re.length;\n\n  const newRE = new Float64Array(length); // I don't think we need a new array... here\n  const newIM = new Float64Array(length);\n  //if (value !== 0) {// is it OK to skip this line if \"value\" is zero?\n  //please check this test of zero is correct !== or != ...\n  const dw = (t[length - 1] - t[0]) / (length - 1); //REPLACE CONSTANT with calculated value... : for this we need AQ or DW to set it right...\n  // convert line broadening in Hz into exponential coefficient:\n  const em = -value * Math.exp(1);\n\n  const coefExp = Math.exp(em * dw);\n  let curFactor = Math.exp(em * t[0]); // in case does not start at zero\n  for (let i = 0; i < length - pointsToShift; i++) {\n    newRE[i] = re[i] * curFactor;\n    newIM[i] = im[i] * curFactor;\n    curFactor = curFactor * coefExp;\n  }\n  curFactor = Math.exp(em * t[0]);\n  for (let i = length; i > length - pointsToShift; i--) {\n    newRE[i] = re[i] * curFactor;\n    newIM[i] = im[i] * curFactor;\n    curFactor = curFactor * coefExp;\n  }\n  datum1D.data = { ...datum1D.data, ...{ re: newRE, im: newIM } };\n  //}\n}\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","import { xParetoNormalization } from 'ml-spectra-processing';\n\nexport const id = 'pareto';\nexport const name = 'Pareto';\n\n/**\n * Computes the arithmetic mean of the given values\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Pareto is not applicable on this data');\n  }\n\n  const re = datum1D.data.re.slice(0);\n  const im = datum1D.data.im?.slice(0);\n\n  datum1D.data.re = xParetoNormalization(re);\n  if (im) {\n    datum1D.data.im = xParetoNormalization(im);\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","import { reimPhaseCorrection } from 'ml-spectra-processing';\n\nexport const id = 'phaseCorrection';\nexport const name = 'Phase correction';\n\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [options={}]\n * @param {number} [options.ph0=0]\n * @param {number} [options.ph1=0]\n */\n\nexport function apply(datum1D, options = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('phaseCorrection not applicable on this data');\n  }\n  let { ph0, ph1 } = options;\n  ph0 *= Math.PI / 180.0;\n  ph1 *= Math.PI / 180.0;\n  Object.assign(datum1D.data, reimPhaseCorrection(datum1D.data, ph0, ph1));\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  let reduced = Object.assign({}, previousValue);\n  for (const k in reduced) {\n    reduced[k] += newValue[k];\n  }\n  return {\n    once: true,\n    reduce: reduced,\n  };\n}\n","/**\n *\n * @param {Object} datum1d\n * @param {number} [shiftValue=0]\n */\n\nexport const id = 'shiftX';\nexport const name = 'Shift X';\n\nexport function apply(datum1D, shiftValue = 0) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('shiftX not applicable on this data');\n  }\n\n  datum1D.data.x = datum1D.data.x.map((val) => val + shiftValue);\n}\n\nexport function isApplicable() {\n  return true;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","import { standardDeviation } from 'ml-stat/array';\n\nexport const id = 'standardDeviation';\nexport const name = 'Standard Deviation';\n\n/**\n * Computes the standard deviation of the given values\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Standard Deviation is not applicable on this data');\n  }\n\n  const re = datum1D.data.re.slice(0);\n  const im = datum1D.data.im?.slice(0);\n\n  const reStd = standardDeviation(re);\n  const imStd = standardDeviation(im || []);\n\n  for (let i = 0; i < re.length; i++) {\n    re[i] /= reStd;\n    if (im) {\n      im[i] /= imStd;\n    }\n  }\n\n  datum1D.data.re = re;\n\n  if (im) {\n    datum1D.data.im = im;\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","export const id = 'zeroFilling';\nexport const name = 'Zero Filling';\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [size]\n */\nexport function apply(datum1D, size) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('zeroFilling not applicable on this data');\n  }\n\n  let digitalFilterApplied = datum1D.filters.some(\n    (e) => e.name === 'digitalFilter' && e.flag,\n  );\n\n  let grpdly = datum1D.info.digitalFilter;\n  let pointsToShift;\n  if (grpdly > 0 && digitalFilterApplied) {\n    pointsToShift = Math.floor(grpdly);\n  } else {\n    pointsToShift = 0;\n  }\n\n  const { re, im, x } = datum1D.data;\n\n  let newRE = new Float64Array(size);\n  let newIM = new Float64Array(size);\n  let newX = new Float64Array(size);\n\n  const length = Math.min(size, re.length);\n\n  newRE.set(re.slice(0, length - pointsToShift));\n  newIM.set(im.slice(0, length - pointsToShift));\n  newX.set(x.slice(0, length - pointsToShift));\n\n  let diff = x[1] - x[0];\n  let currentX = x[length - pointsToShift - 1];\n  for (let i = length - pointsToShift; i < size; i++) {\n    currentX += diff;\n    newX[i] = currentX;\n  }\n\n  if (pointsToShift > 0 && pointsToShift < size) {\n    newRE.set(re.slice(re.length - pointsToShift), size - pointsToShift);\n    newIM.set(im.slice(re.length - pointsToShift), size - pointsToShift);\n  }\n\n  datum1D.data = { ...datum1D.data, ...{ re: newRE, im: newIM, x: newX } };\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(_previousValue, newValue) {\n  return {\n    once: true,\n    reduce: newValue,\n  };\n}\n","/**\n *\n * @param {Object} datum2d\n * @param {number} [shiftValue=0]\n */\n\nexport const id = 'shift2DX';\nexport const name = 'Shift 2D X';\n\nexport function apply(datum2D, shiftValue = 0) {\n  if (!isApplicable(datum2D)) {\n    throw new Error('shiftX not applicable on this data');\n  }\n  datum2D.data.minX += shiftValue;\n  datum2D.data.maxX += shiftValue;\n}\n\nexport function isApplicable() {\n  return true;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","/**\n *\n * @param {Object} datum2d\n * @param {number} [shiftValue=0]\n */\n\nexport const id = 'shift2DY';\nexport const name = 'Shift 2D Y';\n\nexport function apply(datum2D, shiftValue = 0) {\n  if (!isApplicable(datum2D)) {\n    throw new Error('shiftY not applicable on this data');\n  }\n  datum2D.data.minY += shiftValue;\n  datum2D.data.maxY += shiftValue;\n}\n\nexport function isApplicable() {\n  return true;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","import * as absolute from './data1d/filter1d/absolute';\nimport * as autoPhaseCorrection from './data1d/filter1d/autoPhaseCorrection';\nimport * as baselineCorrection from './data1d/filter1d/baselineCorrection';\nimport * as centerMean from './data1d/filter1d/centerMean';\nimport * as digitalFilter from './data1d/filter1d/digitalFilter';\nimport * as equallySpaced from './data1d/filter1d/equallySpaced';\nimport * as fft from './data1d/filter1d/fft';\nimport * as fromTo from './data1d/filter1d/fromTo';\nimport * as lineBroadening from './data1d/filter1d/lineBroadening';\nimport * as pareto from './data1d/filter1d/pareto';\nimport * as phaseCorrection from './data1d/filter1d/phaseCorrection';\nimport * as shiftX from './data1d/filter1d/shiftX';\nimport * as standardDeviation from './data1d/filter1d/standardDeviation';\nimport * as zeroFilling from './data1d/filter1d/zeroFilling';\nimport * as shift2DX from './data2d/filter2d/shiftX';\nimport * as shift2DY from './data2d/filter2d/shiftY';\n\nexport const Filters = {\n  absolute,\n  baselineCorrection,\n  lineBroadening,\n  fft,\n  phaseCorrection,\n  autoPhaseCorrection,\n  shiftX,\n  zeroFilling,\n  digitalFilter,\n  fromTo,\n  equallySpaced,\n  standardDeviation,\n  centerMean,\n  pareto,\n  shift2DX,\n  shift2DY,\n};\n","import { Filters } from '../../data/Filters';\n\nexport const options = {\n  zoom: {\n    id: 'zoom',\n    label: 'Zoom',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  peakPicking: {\n    id: 'peakPicking',\n    label: 'Peaks Picking',\n    hasOptionPanel: true,\n    isFilter: false,\n  },\n  integral: {\n    id: 'integral',\n    label: 'integral Tool',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  zone2D: {\n    id: 'zone2D',\n    label: 'Zone Tool',\n    hasOptionPanel: true,\n    isFilter: false,\n  },\n  slicingTool: {\n    id: 'slicingTool',\n    label: 'Slicing Tool',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  HMove: {\n    id: 'HMove',\n    label: 'Move spectrum horizontally',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  equalizerTool: {\n    id: 'equalizerTool',\n    label: 'Equalizer Tool',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  rangesPicking: {\n    id: 'rangesPicking',\n    label: 'Ranges Picking ( Press r )',\n    hasOptionPanel: true,\n    isFilter: false,\n  },\n  zeroFilling: {\n    id: Filters.zeroFilling.id,\n    label: Filters.zeroFilling.name,\n    hasOptionPanel: true,\n    isFilter: true,\n  },\n  phaseCorrection: {\n    id: Filters.phaseCorrection.id,\n    label: `${Filters.phaseCorrection.name} ( Press a )`,\n    hasOptionPanel: true,\n    isFilter: true,\n  },\n  baseLineCorrection: {\n    id: 'baseLineCorrection',\n    label: 'baseline correction ( Press b )',\n    hasOptionPanel: true,\n    isFilter: true,\n  },\n  generalSelector: {\n    id: 'generalSelector',\n    label: 'range general selecttor',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n\n  editRange: {\n    id: 'editRange',\n    label: 'edit range',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n\n  multipleSpectraAnalysis: {\n    id: 'multipleSpectraAnalysis',\n    label: 'Multiple Spectra Analysis',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  exclusionZones: {\n    id: 'exclusionZones',\n    label: 'Exclusion Zones',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n};\n","import { useContext } from 'react';\n\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { options } from '../toolbar/ToolTypes';\n\nconst styles = {\n  container: {\n    transformOrigin: 'top left',\n    position: 'absolute',\n    top: '0px',\n    left: '0px',\n    zoom: '100%',\n  },\n};\n\nconst allowTools = [\n  options.zoom.id,\n  options.zeroFilling.id,\n  options.peakPicking.id,\n  options.integral.id,\n  options.phaseCorrection.id,\n  options.baseLineCorrection.id,\n  options.rangesPicking.id,\n  options.zone2D.id,\n  options.slicingTool.id,\n  options.editRange.id,\n  options.multipleSpectraAnalysis.id,\n  options.exclusionZones.id,\n];\n\nexport const BRUSH_TYPE = {\n  X: 1,\n  Y: 2,\n  XY: 3,\n};\n\nfunction BrushXY({\n  brushType,\n  dimensionBorder,\n  width: widthProps,\n  height: heightProps,\n}) {\n  let { width, height, selectedTool } = useChartData();\n  let { startX, endX, startY, endY, step } = useContext(BrushContext);\n\n  if (\n    !allowTools.includes(selectedTool) ||\n    step !== 'brushing' ||\n    !dimensionBorder ||\n    (dimensionBorder.startX && startX < dimensionBorder.startX) ||\n    (dimensionBorder.startY && startY < dimensionBorder.startY) ||\n    ((dimensionBorder.endX && Math.sign(endX - startX) === 1\n      ? endX > dimensionBorder.endX\n      : endX < dimensionBorder.startX) &&\n      (dimensionBorder.endX && Math.sign(endY - startY) === 1\n        ? endY > dimensionBorder.endY\n        : endY < dimensionBorder.startY))\n  ) {\n    return null;\n  }\n\n  width = widthProps ? widthProps : width;\n\n  height = heightProps ? heightProps : height;\n\n  endX =\n    dimensionBorder.endX && endX > dimensionBorder.endX\n      ? dimensionBorder.endX\n      : dimensionBorder.startX && endX < dimensionBorder.startX\n      ? dimensionBorder.startX\n      : endX;\n  endY =\n    dimensionBorder.endY && endY > dimensionBorder.endY\n      ? dimensionBorder.endY\n      : dimensionBorder.startY && endY < dimensionBorder.startY\n      ? dimensionBorder.startY\n      : endY;\n\n  const scaleX =\n    brushType === BRUSH_TYPE.X || brushType === BRUSH_TYPE.XY\n      ? (endX - startX) / width\n      : 1;\n  startX =\n    brushType === BRUSH_TYPE.X || brushType === BRUSH_TYPE.XY ? startX : 0;\n\n  const scaleY =\n    brushType === BRUSH_TYPE.Y || brushType === BRUSH_TYPE.XY\n      ? (endY - startY) / height\n      : 1;\n  startY =\n    brushType === BRUSH_TYPE.Y || brushType === BRUSH_TYPE.XY ? startY : 0;\n  return (\n    <div\n      style={{\n        ...styles.container,\n        transform: `translate(${startX}px, ${startY}px) scale(${scaleX},${scaleY})`,\n        willChange: 'transform',\n      }}\n    >\n      <svg width={width} height={height}>\n        <rect\n          x=\"0\"\n          y=\"0\"\n          width={width}\n          height={height}\n          fill=\"gray\"\n          opacity=\"0.2\"\n        />\n      </svg>\n    </div>\n  );\n}\n\nBrushXY.defaultProps = {\n  brushType: BRUSH_TYPE.XY,\n  dimensionBorder: {\n    startX: 0,\n    startY: 0,\n  },\n  width: null,\n  height: null,\n};\n\nexport default BrushXY;\n","import { useContext } from 'react';\n\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { options } from '../toolbar/ToolTypes';\n\nconst styles = {\n  line: {\n    stroke: 'black',\n    strokeOpacity: '1',\n    shapeRendering: 'crispEdges',\n    strokeWidth: '1',\n    willChange: 'transform',\n  },\n};\n\nconst allowTools = [\n  options.zoom.id,\n  options.equalizerTool.id,\n  options.baseLineCorrection.id,\n  options.zone2D.id,\n  options.slicingTool.id,\n  options.integral.id,\n  options.rangesPicking.id,\n  options.editRange.id,\n  options.multipleSpectraAnalysis.id,\n  options.exclusionZones.id,\n];\n\nfunction CrossLinePointer() {\n  const { height, width, margin, selectedTool } = useChartData();\n  let position = useContext(MouseContext);\n  const brushState = useContext(BrushContext);\n\n  if (\n    !allowTools.includes(selectedTool) ||\n    brushState.step === 'brushing' ||\n    !position ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom ||\n    !width ||\n    !height\n  ) {\n    return null;\n  }\n  return (\n    <div\n      key=\"crossLine\"\n      style={{\n        willChange: 'transform',\n        cursor: 'crosshair',\n        transform: `translate(${-width + position.x}px, ${\n          -height + position.y\n        }px)`,\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        pointerEvents: 'none',\n        overflow: 'visible',\n        width: 2 * width,\n        height: 2 * height,\n      }}\n    >\n      <svg width={2 * width} height={2 * height}>\n        <line\n          style={styles.line}\n          x1={width}\n          y1=\"0\"\n          x2={width}\n          y2={height * 2}\n          key=\"vertical_line\"\n        />\n        <line\n          style={styles.line}\n          x1=\"0\"\n          y1={height}\n          x2={width * 2}\n          y2={height}\n          key=\"horizontal_line\"\n        />\n      </svg>\n    </div>\n  );\n}\n\nexport default CrossLinePointer;\n","import EventEmitter from 'eventemitter3';\n\nconst eventEmitter = new EventEmitter();\n\nconst Emitter = {\n  on: (event, fn) => eventEmitter.on(event, fn),\n  once: (event, fn) => eventEmitter.once(event, fn),\n  off: (event, fn) => eventEmitter.off(event, fn),\n  emit: (event, payload) => eventEmitter.emit(event, payload),\n};\n\nObject.freeze(Emitter);\n\nexport default Emitter;\n","function DeleteButton({ x, y, onDelete, fill }) {\n  return (\n    <svg\n      className=\"delete-button\"\n      x={x}\n      y={y}\n      onClick={onDelete}\n      data-no-export=\"true\"\n    >\n      <rect rx=\"5\" width=\"16\" height=\"16\" fill={fill} />\n      <line x1=\"5\" x2=\"10\" y1=\"8\" y2=\"8\" stroke=\"white\" strokeWidth=\"2\" />\n    </svg>\n  );\n}\n\nDeleteButton.defaultProps = {\n  onDelete: () => null,\n  fill: '#c81121',\n  x: 'initial',\n  y: 'initial',\n};\n\nexport default DeleteButton;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { useScale } from '../context/ScaleContext';\nimport DeleteButton from '../elements/DeleteButton';\nimport { DELETE_BASE_LINE_ZONE } from '../reducer/types/Types';\n\nconst styles = css`\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  .zone-area {\n    height: 100%;\n    fill: #b8b8b857;\n    cursor: pointer;\n  }\n  .delete-button {\n    display: none;\n    cursor: pointer;\n  }\n  :hover .delete-button {\n    display: block;\n  }\n`;\n\nfunction BaseLineZones() {\n  const { baseLineZones } = useChartData();\n\n  const { scaleX } = useScale();\n  const dispatch = useDispatch();\n\n  const deleteRangeHandler = useCallback(\n    (id) => {\n      dispatch({ type: DELETE_BASE_LINE_ZONE, id });\n    },\n    [dispatch],\n  );\n\n  return (\n    baseLineZones &&\n    Array.isArray(baseLineZones) &&\n    baseLineZones.length > 0 && (\n      <g>\n        {baseLineZones.map((zone) => (\n          <g\n            key={zone.id}\n            transform={`translate(${scaleX()(zone.to)},0)`}\n            css={styles}\n          >\n            <DeleteButton\n              x={-20}\n              y={10}\n              onDelete={() => deleteRangeHandler(zone.id)}\n            />\n            <rect\n              x=\"0\"\n              width={`${scaleX()(zone.from) - scaleX()(zone.to)}`}\n              className=\"zone-area\"\n            />\n          </g>\n        ))}\n      </g>\n    )\n  );\n}\n\nexport default BaseLineZones;\n","import { useChartData } from '../context/ChartContext';\n\nfunction ExclusionZonesWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const { exclusionZones, activeTab } = useChartData();\n\n    return (\n      <WrappedComponent\n        {...props}\n        exclusionZones={\n          exclusionZones[activeTab] ? exclusionZones[activeTab] : null\n        }\n      />\n    );\n  };\n\n  return (props) => {\n    return <Wrapper {...props} />;\n  };\n}\nexport default ExclusionZonesWrapper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\n\nimport { useScale } from '../context/ScaleContext';\nimport { TYPES, useHighlight } from '../highlight';\nimport ExclusionZonesWrapper from '../hoc/ExclusionZonesWrapper';\n\nconst styles = css`\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  .zone-area {\n    height: 100%;\n    fill: #dddddd;\n    cursor: pointer;\n  }\n  .zone-area.active {\n    fill: #ff6f0057;\n  }\n`;\n\nconst ExclusionZone = ({ zone }) => {\n  const { scaleX } = useScale();\n  const highlight = useHighlight([zone.id], TYPES.EXCLUSION_ZONE);\n  return (\n    <g\n      key={zone.id}\n      transform={`translate(${scaleX()(zone.to)},0)`}\n      css={styles}\n      {...highlight.onHover}\n    >\n      <rect\n        x=\"0\"\n        width={`${scaleX()(zone.from) - scaleX()(zone.to)}`}\n        className={`zone-area ${highlight.isActive && 'active'}`}\n      />\n    </g>\n  );\n};\n\nfunction ExclusionZones({ exclusionZones }) {\n  if (!exclusionZones) return null;\n\n  return (\n    <g className=\"exclusionZones\">\n      {exclusionZones.map((zone) => (\n        <ExclusionZone key={zone.id} zone={zone} />\n      ))}\n    </g>\n  );\n}\n\nexport default ExclusionZonesWrapper(ExclusionZones);\n","const integralDefaultValues = {\n  showAbsolute: false,\n  absoluteFormat: '0.00',\n  showRelative: true,\n  relativeFormat: '0.00',\n  color: '#000000',\n  strokeWidth: 1,\n};\n\nconst rangeDefaultValues = {\n  showFrom: false,\n  fromFormat: '0.00',\n  showTo: false,\n  toFormat: '0.00',\n  showAbsolute: false,\n  absoluteFormat: '0.00',\n  showRelative: true,\n  relativeFormat: '0.00',\n};\n\nconst peaksDefaultValues = {\n  showPeakNumber: true,\n  peakNumberFormat: '0',\n  showPeakIndex: false,\n  peakIndexFormat: '0.00',\n  showDeltaPPM: true,\n  deltaPPMFormat: '0.00',\n  showDeltaHz: false,\n  deltaHzFormat: '0.00',\n  showPeakWidth: false,\n  peakWidthFormat: '00.0000',\n  showIntensity: true,\n  intensityFormat: '0.00',\n};\n\nexport { peaksDefaultValues, integralDefaultValues, rangeDefaultValues };\n","/** @jsxImportSource @emotion/react */\nimport { Fragment, useCallback, useRef, useState } from 'react';\nimport Draggable from 'react-draggable';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useScale } from '../context/ScaleContext';\n\nfunction Resizable({ from, to, onDrag = () => null, onDrop }) {\n  const { height, margin, mode } = useChartData();\n  const [rightDragVisibility, setRightDragVisibility] = useState(false);\n  const [leftDragVisibility, setLeftDragVisibility] = useState(false);\n  const [enable, setEnable] = useState(true);\n  const draggableRightRef = useRef(null);\n  const draggableLeftRef = useRef(null);\n\n  const { scaleX } = useScale();\n\n  const handleRightStart = useCallback((e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setRightDragVisibility(true);\n  }, []);\n  const handleRightDrag = useCallback(\n    (e) => {\n      onDrag({ from: scaleX().invert(e.layerX) });\n    },\n    [onDrag, scaleX],\n  );\n  const handleRightStop = useCallback(\n    (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      setRightDragVisibility(false);\n\n      const _range =\n        mode === 'RTL'\n          ? [scaleX().invert(e.layerX), to]\n          : [to, scaleX().invert(e.layerX)];\n\n      let resized;\n      if (_range[1] > _range[0]) {\n        resized = {\n          from: _range[0],\n          to: _range[1],\n        };\n      } else {\n        resized = {\n          from,\n          to,\n        };\n      }\n\n      onDrop(resized);\n    },\n    [from, mode, onDrop, scaleX, to],\n  );\n\n  const handleLeftStart = useCallback((e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setLeftDragVisibility(true);\n  }, []);\n  const handleLeftDrag = useCallback(\n    (e) => {\n      onDrag({ to: scaleX().invert(e.layerX) });\n    },\n    [onDrag, scaleX],\n  );\n  const handleLeftStop = useCallback(\n    (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      setLeftDragVisibility(false);\n      const _range =\n        mode === 'RTL'\n          ? [from, scaleX().invert(e.layerX)]\n          : [scaleX().invert(e.layerX), from];\n\n      let resized;\n      if (_range[1] > _range[0]) {\n        resized = {\n          from: _range[0],\n          to: _range[1],\n        };\n      } else {\n        resized = {\n          from,\n          to,\n        };\n      }\n\n      onDrop(resized);\n    },\n    [from, mode, onDrop, scaleX, to],\n  );\n\n  const mouseDownCaptureHandler = useCallback(({ shiftKey }) => {\n    if (shiftKey) {\n      setEnable(false);\n    }\n  }, []);\n  const mouseUpCaptureHandler = useCallback(() => {\n    setEnable(true);\n  }, []);\n  const mouseOverHandler = useCallback(({ target, shiftKey }) => {\n    if (shiftKey) {\n      target.style.cursor = 'crosshair';\n    } else {\n      target.style.cursor = 'ew-resize';\n    }\n  }, []);\n\n  return (\n    <Fragment>\n      <Draggable\n        axis=\"x\"\n        defaultPosition={{\n          x: scaleX()(from),\n          y: 0,\n        }}\n        position={{\n          x: scaleX()(from),\n          y: 0,\n        }}\n        scale={1}\n        handle=\".handle\"\n        onStart={handleRightStart}\n        onDrag={handleRightDrag}\n        onStop={handleRightStop}\n        nodeRef={draggableRightRef}\n      >\n        <rect\n          ref={draggableRightRef}\n          className={enable ? 'handle' : ''}\n          width={rightDragVisibility ? 1 : 6}\n          fill=\"red\"\n          height={height + margin.top}\n          style={{ fillOpacity: rightDragVisibility ? 1 : 0 }}\n          onMouseDownCapture={mouseDownCaptureHandler}\n          onMouseUpCapture={mouseUpCaptureHandler}\n          onMouseEnter={mouseOverHandler}\n        />\n      </Draggable>\n\n      <Draggable\n        axis=\"x\"\n        defaultPosition={{\n          x: scaleX()(to),\n          y: 0,\n        }}\n        position={{\n          x: scaleX()(to),\n          y: 0,\n        }}\n        handle=\".handle\"\n        scale={1}\n        onStart={handleLeftStart}\n        onDrag={handleLeftDrag}\n        onStop={handleLeftStop}\n        nodeRef={draggableLeftRef}\n      >\n        <rect\n          ref={draggableLeftRef}\n          className={enable ? 'handle' : ''}\n          width={leftDragVisibility ? 1 : 6}\n          fill=\"red\"\n          height={height + margin.top}\n          style={{ fillOpacity: leftDragVisibility ? 1 : 0 }}\n          onMouseDownCapture={mouseDownCaptureHandler}\n          onMouseUpCapture={mouseUpCaptureHandler}\n          onMouseEnter={mouseOverHandler}\n        />\n      </Draggable>\n    </Fragment>\n  );\n}\n\nexport default Resizable;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, Fragment, useState } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { useScale } from '../context/ScaleContext';\nimport { TYPES, useHighlight } from '../highlight/index';\nimport { RESIZE_INTEGRAL } from '../reducer/types/Types';\n\nimport Resizable from './Resizable';\n\nconst stylesOnHover = css`\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  // // disabled because Resizable component appears now when hovering over it\n  // :hover .target {\n  //   visibility: visible !important;\n  //   cursor: pointer;\n  // }\n  .highlight {\n    fill: transparent;\n  }\n  .target {\n    visibility: hidden;\n  }\n`;\n\nconst stylesHighlighted = css`\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  fill: #ff6f0057;\n\n  .target {\n    visibility: visible;\n  }\n`;\n\nfunction IntegralResizable({ integralData }) {\n  const { height, margin } = useChartData();\n  const { scaleX } = useScale();\n\n  const [{ id, integral, from, to }, setIntgral] = useState(integralData);\n\n  const highlight = useHighlight([id], TYPES.INTEGRAL);\n\n  const dispatch = useDispatch();\n\n  const handleOnStopResizing = useCallback(\n    (resized) => {\n      dispatch({\n        type: RESIZE_INTEGRAL,\n        data: { ...integralData, ...resized },\n      });\n    },\n    [dispatch, integralData],\n  );\n\n  const handleOnEnterNotation = useCallback(() => {\n    highlight.show();\n  }, [highlight]);\n\n  const handleOnMouseLeaveNotation = useCallback(() => {\n    highlight.hide();\n  }, [highlight]);\n\n  const dragHandler = useCallback((boundary) => {\n    setIntgral((integral) => ({ ...integral, ...boundary }));\n  }, []);\n\n  const x0 = from ? scaleX()(from) : 0;\n  const x1 = to ? scaleX()(to) : 0;\n\n  return (\n    <Fragment>\n      <g\n        css={highlight.isActive ? stylesHighlighted : stylesOnHover}\n        onMouseEnter={handleOnEnterNotation}\n        onMouseLeave={handleOnMouseLeaveNotation}\n      >\n        <rect\n          data-no-export=\"true\"\n          x={`${x1}`}\n          y=\"0\"\n          width={`${x0 - x1}`}\n          height={height - margin.bottom}\n          className=\"highlight\"\n        />\n        {/* {highlight.isActive && ( */}\n        <text\n          x={x1}\n          y={height - margin.bottom + 30}\n          fill=\"black\"\n          style={{ fontSize: '12px', fontWeight: 'bold' }}\n        >\n          {integral !== undefined ? integral.toFixed(2) : ''}\n        </text>\n        {/* )} */}\n        <Resizable\n          from={integralData.from}\n          to={integralData.to}\n          onDrag={dragHandler}\n          onDrop={handleOnStopResizing}\n          data-no-export=\"true\"\n        />\n      </g>\n    </Fragment>\n  );\n}\n\nexport default IntegralResizable;\n","import { xyReduce, xyIntegral } from 'ml-spectra-processing';\nimport { useCallback, Fragment, useMemo } from 'react';\n\nimport { usePreferences } from '../context/PreferencesContext';\nimport { integralDefaultValues } from '../panels/extra/preferences/defaultValues';\nimport { getValue } from '../utility/LocalStorage';\n\nimport IntegralResizable from './IntegralResizable';\n\nfunction Integral({\n  integralData,\n  x,\n  y,\n  xDomain,\n  isActive,\n  spectrumID,\n  scaleY,\n  scaleX,\n}) {\n  const { from, to } = integralData;\n  // const { preferences } = useChartData();\n  const preferences = usePreferences();\n\n  const integralSettings = useMemo(() => {\n    let {\n      color = integralDefaultValues.color,\n      strokeWidth = integralDefaultValues.strokeWidth,\n    } = getValue(preferences, 'formatting.panels.integrals') || {};\n    return { color, strokeWidth };\n  }, [preferences]);\n\n  const integral = useMemo(() => {\n    return xyIntegral(\n      { x: x, y: y },\n      {\n        from: from,\n        to: to,\n        reverse: true,\n      },\n    );\n  }, [from, to, x, y]);\n\n  const makePath = useCallback(() => {\n    if (integral && scaleY) {\n      const pathPoints = xyReduce(integral, {\n        from: xDomain[0],\n        to: xDomain[1],\n        nbPoints: 200,\n        optimize: true,\n      });\n\n      let path = `M ${scaleX()(pathPoints.x[0])} ${scaleY(pathPoints.y[0])}`;\n      path += pathPoints.x.slice(1).reduce((accumulator, point, i) => {\n        accumulator += ` L ${scaleX()(point)} ${scaleY(pathPoints.y[i + 1])}`;\n        return accumulator;\n      }, '');\n\n      return path;\n    } else {\n      return '';\n    }\n  }, [integral, scaleX, scaleY, xDomain]);\n\n  return (\n    <Fragment>\n      <path\n        className=\"line\"\n        stroke={integralSettings.color}\n        strokeWidth={integralSettings.strokeWidth}\n        fill=\"none\"\n        style={{\n          transformOrigin: 'center top',\n          opacity: isActive ? 1 : 0.2,\n        }}\n        d={makePath()}\n        // vectorEffect=\"non-scaling-stroke\"\n      />\n\n      <IntegralResizable\n        spectrumID={spectrumID}\n        integralData={integralData}\n        scaleY={scaleY}\n      />\n    </Fragment>\n  );\n}\n\nexport default Integral;\n","import { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useScale } from '../context/ScaleContext';\n\nimport Integral from './Integral';\nimport { getIntegralYScale } from './utilities/scale';\n\nfunction IntegralsSeries() {\n  const {\n    xDomain,\n    activeSpectrum,\n    data,\n    height,\n    margin,\n    verticalAlign,\n    integralsYDomains,\n    displayerKey,\n  } = useChartData();\n  const { scaleX } = useScale();\n\n  const scaleY = useMemo(() => {\n    if (activeSpectrum && integralsYDomains[activeSpectrum.id]) {\n      return getIntegralYScale(\n        { height, margin, verticalAlign, integralsYDomains },\n        activeSpectrum.id,\n      );\n    } else {\n      return null;\n    }\n  }, [activeSpectrum, height, integralsYDomains, margin, verticalAlign]);\n\n  const Integrals = useMemo(() => {\n    const IsActive = (id) => {\n      return activeSpectrum === null\n        ? true\n        : id === activeSpectrum.id\n        ? true\n        : false;\n    };\n\n    return (\n      data &&\n      data[0] &&\n      data\n        .filter(\n          (d) =>\n            d.display.isVisible === true &&\n            d.display.isVisibleInDomain === true,\n        )\n        .map(\n          (spectrum) =>\n            spectrum.integrals &&\n            spectrum.integrals.values &&\n            spectrum.integrals.values.map((integral) => (\n              <Integral\n                key={integral.id}\n                spectrumID={spectrum.id}\n                integralData={integral}\n                x={spectrum.data.x}\n                y={spectrum.data.y}\n                isActive={IsActive(spectrum.id)}\n                xDomain={xDomain}\n                scaleY={scaleY}\n                scaleX={scaleX}\n              />\n            )),\n        )\n    );\n  }, [activeSpectrum, data, scaleX, scaleY, xDomain]);\n\n  return <g clipPath={`url(#${displayerKey}clip-chart-1d)`}>{Integrals}</g>;\n}\n\nexport default IntegralsSeries;\n","import get from 'lodash/get';\nimport { xyReduce } from 'ml-spectra-processing';\nimport { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport { useScale } from '../context/ScaleContext';\n\nfunction Line({ data, id, display, index }) {\n  const { xDomain, activeSpectrum, verticalAlign } = useChartData();\n  const preferences = usePreferences();\n  const { scaleX, scaleY } = useScale();\n\n  const isActive = useMemo(() => {\n    return activeSpectrum === null\n      ? true\n      : id === activeSpectrum.id\n      ? true\n      : false;\n  }, [activeSpectrum, id]);\n\n  const vAlign = useMemo(() => {\n    return verticalAlign.flag\n      ? verticalAlign.stacked\n        ? index * verticalAlign.value\n        : 0\n      : 0;\n  }, [index, verticalAlign.flag, verticalAlign.stacked, verticalAlign.value]);\n\n  const paths = useMemo(() => {\n    const _scaleX = scaleX();\n    const _scaleY = scaleY(id);\n    if (data?.x && data?.y && _scaleX(0)) {\n      const pathPoints = xyReduce(\n        { x: data.x, y: data.y },\n        {\n          from: xDomain[0],\n          to: xDomain[1],\n        },\n      );\n\n      let path = `M ${_scaleX(pathPoints.x[0])} ${_scaleY(pathPoints.y[0])} `;\n      path += pathPoints.x.slice(1).reduce((accumulator, point, i) => {\n        accumulator += ` L ${_scaleX(point)} ${_scaleY(pathPoints.y[i + 1])}`;\n        return accumulator;\n      }, '');\n      return path;\n    } else {\n      return '';\n    }\n  }, [id, scaleX, scaleY, data, xDomain]);\n\n  return (\n    <path\n      className=\"line\"\n      key={id}\n      stroke={display.color}\n      fill=\"none\"\n      style={{\n        opacity: isActive\n          ? 1\n          : get(preferences, 'controllers.dimmedSpectraTransparency', 0.1),\n      }}\n      d={paths}\n      transform={`translate(0,-${vAlign})`}\n    />\n  );\n}\n\nexport default Line;\n","import { useChartData } from '../context/ChartContext';\n\nimport Line from './Line';\n\nfunction LinesSeries() {\n  const { data, tempData, displayerKey } = useChartData();\n\n  const _data = tempData ? tempData : data;\n\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-1d)`}>\n      {_data &&\n        _data\n          .filter(\n            (d) =>\n              d.display.isVisible === true &&\n              d.display.isVisibleInDomain === true,\n          )\n          .map((d, i) => <Line key={d.id} {...d} index={i} />)}\n    </g>\n  );\n}\n\nexport default LinesSeries;\n","import lodashGet from 'lodash/get';\nimport Numeral from 'numeral';\n\nimport { usePreferences } from '../context/PreferencesContext';\n// let getNuclusFormat = memoize(getDefaultNuclusFormat);\n\nfunction FormatNumber(value, format, prefix = '', suffix = '') {\n  return prefix + Numeral(value).format(format) + suffix;\n}\n\n/**\n *\n * @param {string|Array} nucleus\n */\nexport function useFormatNumberByNucleus(nucleus) {\n  const preferences = usePreferences();\n  const nucleusByKey = lodashGet(preferences, `formatting.nucleusByKey`, {\n    ppm: '0.0',\n    hz: '0.0',\n  });\n\n  const formatFun = (n) => (\n    value,\n    formatKey = 'ppm',\n    prefix = '',\n    suffix = '',\n  ) => {\n    return (\n      prefix +\n      Numeral(Number(value)).format(\n        lodashGet(nucleusByKey, `${n.toLowerCase()}.${formatKey}`, '0.0'),\n      ) +\n      suffix\n    );\n  };\n\n  if (!nucleus) {\n    return;\n  }\n\n  if (typeof nucleus === 'string') {\n    return formatFun(nucleus);\n  } else if (Array.isArray(nucleus)) {\n    return nucleus.map((n) => formatFun(n));\n  } else {\n    throw Error('nuclus must be string or array of string');\n  }\n}\n\n/**\n * @param {number|string} value\n */\nexport function getNumberOfDecimals(value) {\n  value = String(value).trim();\n  const lastIndex = value.lastIndexOf('.');\n  return lastIndex > 0 ? value.substr(lastIndex).split('').length - 1 : 0;\n}\n\nexport default FormatNumber;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  useRef,\n  useState,\n  useCallback,\n  useLayoutEffect,\n  useEffect,\n  Fragment,\n  useMemo,\n} from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport { TYPES, useHighlight } from '../highlight';\nimport { SHIFT_SPECTRUM } from '../reducer/types/Types';\nimport { useFormatNumberByNucleus } from '../utility/FormatNumber';\n\nconst styles = css`\n  text,\n  input {\n    -webkit-user-select: none; /* Safari 3.1+ */\n    -moz-user-select: none; /* Firefox 2+ */\n    -ms-user-select: none; /* IE 10+ */\n    user-select: none; /* Standard syntax */\n  }\n\n  input[type='number']::-webkit-outer-spin-button,\n  input[type='number']::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n\n  input[type='number'] {\n    -moz-appearance: textfield;\n  }\n\n  .notification-input {\n    width: calc(100% - 10px) !important;\n    user-select: 'none';\n    -webkit-user-select: none; /* Chrome all / Safari all */\n    -moz-user-select: none; /* Firefox all */\n  }\n\n  .notification-input-normal {\n    opacity: 1;\n    left: 4px;\n    position: absolute;\n    font-size: 10px;\n    outline: none;\n    user-select: 'none';\n    -webkit-user-select: none; /* Chrome all / Safari all */\n    -moz-user-select: none; /* Firefox all */\n    background-color: transparent;\n  }\n\n  .notification-input-normal input:focus {\n    outline: none;\n    background-color: white;\n  }\n\n  .input-over {\n    background-color: white;\n    outline: none;\n  }\n\n  .notification-label {\n    display: none;\n  }\n\n  .notification-group-over {\n    z-index: 9999999999;\n  }\n\n  .notification-group {\n    z-index: 1;\n  }\n\n  .notifcate-selected {\n    opacity: 0;\n  }\n\n  input[type='number']::-webkit-inner-spin-button,\n  input[type='number']::-webkit-outer-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n`;\n\nfunction PeakNotation({\n  id,\n  x,\n  y,\n  sign, // 1 positive -1 negative\n  value,\n  color,\n  isActive,\n  nucleus,\n}) {\n  const refText = useRef();\n  const [isSelected, setIsSelected] = useState(false);\n  const [_value, setValue] = useState(value);\n  const [containerSize, setContainerSize] = useState({ width: 0, height: 0 });\n  const format = useFormatNumberByNucleus(nucleus);\n  const highlight = useHighlight([id], TYPES.PEAK);\n\n  const dispatch = useDispatch();\n\n  const handleOnPeakChange = useCallback(\n    (e) => dispatch({ type: SHIFT_SPECTRUM, shiftValue: e.shiftValue }),\n    [dispatch],\n  );\n\n  useLayoutEffect(() => {\n    const textBox = refText.current.getBBox();\n    setContainerSize({ width: textBox.width, height: textBox.height });\n  }, [isSelected]);\n\n  useEffect(() => {\n    setValue(value);\n  }, [value]);\n\n  const handleKeyDown = useCallback(\n    (event) => {\n      if (event.key === 'Enter') {\n        const newValue = parseFloat(event.target.value);\n        const oldValue = parseFloat(value);\n        const shiftValue = parseFloat(event.target.value) - parseFloat(value);\n\n        handleOnPeakChange({\n          id,\n          value: newValue,\n          oldValue: oldValue,\n          shiftValue: shiftValue,\n        });\n\n        event.target.blur();\n        setIsSelected(false);\n      } else if (event.keyCode === 27) {\n        setValue(value);\n        event.target.blur();\n        setIsSelected(false);\n      }\n    },\n    [value, handleOnPeakChange, id],\n  );\n\n  const handleChange = useCallback((event) => {\n    setValue(event.target.value);\n  }, []);\n\n  const handleSelectPeakNotation = useCallback((e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsSelected(true);\n    return false;\n  }, []);\n\n  const handleOnEnterNotation = useCallback(() => {\n    highlight.show();\n  }, [highlight]);\n\n  const handleOnMouseLeaveNotation = useCallback(() => {\n    highlight.hide();\n  }, [highlight]);\n\n  const newValue = useMemo(() => (isSelected ? value : format(value)), [\n    format,\n    isSelected,\n    value,\n  ]);\n  const oldValue = useMemo(() => (isSelected ? _value : format(_value)), [\n    _value,\n    format,\n    isSelected,\n  ]);\n\n  return (\n    <Fragment>\n      <g\n        css={styles}\n        id={id}\n        style={{ outline: 'none' }}\n        transform={`translate(${x}, ${y})`}\n        onMouseEnter={handleOnEnterNotation}\n        onMouseLeave={handleOnMouseLeaveNotation}\n        // onKeyDown={keyDownHandler}\n      >\n        <line\n          x1=\"0\"\n          x2=\"0\"\n          y1={sign === -1 ? 10 : 0}\n          y2={sign === -1 ? 28 : -18}\n          stroke={color}\n          strokeWidth={highlight.isActive ? '7px' : '1px'}\n        />\n        <text\n          ref={refText}\n          className=\"peaks-text\"\n          x=\"0\"\n          y={sign === -1 ? 28 : -12}\n          dy=\"0\"\n          dx=\"0.35em\"\n          fill=\"transparent\"\n          fontSize=\"10px\"\n          fontWeight=\"100\"\n          style={{\n            position: 'absolute',\n          }}\n        >\n          {newValue}\n        </text>\n        <foreignObject\n          x=\"0\"\n          y={sign === -1 ? 16 : -22}\n          dy=\"0.1em\"\n          dx=\"0.35em\"\n          width={containerSize.width + 20}\n          height=\"40px\"\n          data-no-export=\"true\"\n        >\n          <div\n            style={{\n              width: containerSize.width + 20,\n              height: '100%',\n              paddingRight: 5,\n            }}\n            xmlns=\"http://www.w3.org/1999/xhtml\"\n          >\n            <input\n              onClick={handleSelectPeakNotation}\n              className={\n                isSelected\n                  ? 'notification-input input-over'\n                  : 'notification-input-normal'\n              }\n              style={{\n                width: 'inherit',\n                border: isSelected ? `1px solid ${color}` : `0`,\n                opacity: isActive ? 1 : 0.2,\n                userSelect: 'none',\n                color: color,\n              }}\n              value={oldValue}\n              onKeyDown={handleKeyDown}\n              onChange={handleChange}\n              type=\"number\"\n              disabled={!isActive}\n            />\n          </div>\n        </foreignObject>\n      </g>\n    </Fragment>\n  );\n}\n\nexport default PeakNotation;\n","import { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useScale } from '../context/ScaleContext';\n\nimport PeakNotation from './PeakNotation';\n\nfunction PeaksNotations() {\n  const { data, activeSpectrum, verticalAlign, displayerKey } = useChartData();\n  const { scaleX, scaleY } = useScale();\n\n  const Peaks = useMemo(() => {\n    const getVerticalAlign = (id) => {\n      const i = data.findIndex((d) => d.id === id);\n      return verticalAlign.flag\n        ? verticalAlign.stacked\n          ? (i + 1) * verticalAlign.value\n          : 0\n        : 0;\n    };\n\n    const reSortData = () => {\n      const _data = [...data];\n      return activeSpectrum\n        ? _data.sort(function (x, y) {\n            return x.id === activeSpectrum.id\n              ? 1\n              : y.id === activeSpectrum.id\n              ? -1\n              : 0;\n          })\n        : _data;\n    };\n\n    return (\n      data &&\n      reSortData()\n        .filter(\n          (d) =>\n            d.display.isVisible === true &&\n            d.display.isVisibleInDomain === true,\n        )\n        .map((d) => {\n          return (\n            d.peaks &&\n            d.peaks.values &&\n            d.display.isPeaksMarkersVisible && (\n              <g\n                key={d.id}\n                transform={`translate(0,-${getVerticalAlign(d.id)})`}\n              >\n                {d.peaks.values.map(({ delta, intensity, id }) => (\n                  <PeakNotation\n                    key={id}\n                    x={scaleX()(delta)}\n                    y={scaleY(d.id)(intensity) - 5}\n                    sign={Math.sign(intensity)}\n                    id={id}\n                    spectrumID={d.id}\n                    value={delta}\n                    color=\"#730000\"\n                    nucleus={d.info.nucleus}\n                    isActive={\n                      activeSpectrum == null\n                        ? false\n                        : activeSpectrum.id === d.id\n                        ? true\n                        : false\n                    }\n                  />\n                ))}\n              </g>\n            )\n          );\n        })\n    );\n  }, [\n    data,\n    verticalAlign.flag,\n    verticalAlign.stacked,\n    verticalAlign.value,\n    activeSpectrum,\n    scaleX,\n    scaleY,\n  ]);\n\n  return (\n    <g className=\"peaks\" clipPath={`url(#${displayerKey}clip-chart-1d)`}>\n      {Peaks}\n    </g>\n  );\n}\n\nexport default PeaksNotations;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport * as d3 from 'd3';\nimport PropTypes from 'prop-types';\nimport { useEffect, useRef, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useScale } from '../context/ScaleContext';\n\nconst axisStyles = css`\n  user-select: none;\n\n  path,\n  line {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    shape-rendering: crispEdges;\n    user-select: none;\n  }\n`;\n\nconst gridStyles = css`\n  user-select: none;\n\n  line {\n    stroke: rgb(104, 104, 104);\n    stroke-opacity: 0.2;\n    shape-rendering: crispEdges;\n    stroke-dasharray: 3;\n    stroke-width: 1;\n    user-select: none;\n  }\n\n  path {\n    stroke-width: 0;\n  }\n`;\n\nfunction XAxis({ label, show, showGrid, mode }) {\n  const { xDomain, height, width, margin } = useChartData();\n  const { scaleX } = useScale();\n\n  const refAxis = useRef();\n  const refGrid = useRef();\n\n  label = label ? label : mode === 'RTL' ? 'δ [ppm]' : 'time [s]';\n\n  useEffect(() => {\n    const xAxis = d3.axisBottom().ticks(8).tickFormat(d3.format('0'));\n    const grid = d3\n      .axisBottom()\n      .ticks(50)\n      .tickSize(-(height - margin.top - margin.bottom))\n      .tickFormat('');\n    if (show && scaleX) {\n      d3.select(refAxis.current).call(xAxis.scale(scaleX().domain(xDomain)));\n      d3.select(refGrid.current).call(grid.scale(scaleX().domain(xDomain)));\n    }\n  }, [height, margin.bottom, margin.top, scaleX, show, xDomain]);\n\n  const Axis = useMemo(\n    () =>\n      show &&\n      show === true && (\n        <g\n          className=\"x\"\n          css={axisStyles}\n          transform={`translate(0,${height - margin.bottom})`}\n          ref={refAxis}\n        >\n          <text fill=\"#000\" x={width - 10} y=\"30\" dy=\"0.70em\" textAnchor=\"end\">\n            {label}\n          </text>\n        </g>\n      ),\n\n    [height, label, margin.bottom, show, width],\n  );\n\n  const Grid = useMemo(\n    () =>\n      showGrid &&\n      showGrid === true && (\n        <g\n          css={gridStyles}\n          className=\"grid\"\n          ref={refGrid}\n          transform={`translate(0,${height - margin.bottom})`}\n        />\n      ),\n\n    [showGrid, height, margin.bottom],\n  );\n  if (!width || !height || !scaleX) {\n    return null;\n  }\n\n  return (\n    <>\n      {Axis}\n      {Grid}\n    </>\n  );\n}\n\nXAxis.propTypes = {\n  showGrid: PropTypes.bool,\n  show: PropTypes.bool,\n  label: PropTypes.string,\n};\n\nXAxis.defaultProps = {\n  showGrid: false,\n  show: true,\n  label: '',\n};\n\nexport default XAxis;\n","import { forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction MultiAnalysisWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const { activeTab, spectraAnalysis, displayerKey } = useChartData();\n    const { forwardedRef, ...rest } = props;\n\n    return (\n      <WrappedComponent\n        {...rest}\n        activeTab={activeTab}\n        spectraAnalysis={spectraAnalysis}\n        displayerKey={displayerKey}\n        ref={forwardedRef}\n      />\n    );\n  };\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default MultiAnalysisWrapper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useScale } from '../../context/ScaleContext';\nimport DeleteButton from '../../elements/DeleteButton';\nimport { useHighlight } from '../../highlight';\nimport {\n  DELETE_ANALYZE_SPECTRA_RANGE,\n  RESIZE_ANALYZE_SPECTRA_RANGE,\n} from '../../reducer/types/Types';\nimport Resizable from '../Resizable';\n\nconst stylesOnHover = css`\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  .delete-button {\n    visibility: hidden;\n  }\n`;\n\nconst stylesHighlighted = css`\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  .range-area {\n    height: 100%;\n    fill: #ff6f0057;\n  }\n  .delete-button {\n    visibility: visible;\n    cursor: pointer;\n  }\n`;\n\nfunction AnalysisRange({ rangeData, columnKey }) {\n  const { from, to } = rangeData;\n  const highlight = useHighlight([columnKey]);\n  const { scaleX } = useScale();\n  const dispatch = useDispatch();\n\n  const deleteHandler = useCallback(() => {\n    dispatch({ type: DELETE_ANALYZE_SPECTRA_RANGE, colKey: columnKey });\n  }, [columnKey, dispatch]);\n\n  const handleOnStopResizing = useCallback(\n    (resized) => {\n      dispatch({\n        type: RESIZE_ANALYZE_SPECTRA_RANGE,\n        payload: { ...rangeData, ...resized, columnKey },\n      });\n    },\n    [columnKey, dispatch, rangeData],\n  );\n\n  return (\n    <g\n      {...highlight.onHover}\n      css={highlight.isActive ? stylesHighlighted : stylesOnHover}\n    >\n      <g transform={`translate(${scaleX()(to)},25)`}>\n        <rect\n          x=\"0\"\n          width={scaleX()(from) - scaleX()(to)}\n          height=\"6\"\n          className=\"range-area\"\n          fill=\"green\"\n        />\n        <text\n          textAnchor=\"middle\"\n          x={(scaleX()(from) - scaleX()(to)) / 2}\n          y=\"-5\"\n          fontSize=\"12\"\n          fill=\"red\"\n          fontWeight=\"bolder\"\n          fillOpacity={highlight.isActive ? 1 : 0.6}\n        >\n          {columnKey}\n        </text>\n      </g>\n      <Resizable\n        from={rangeData.from}\n        to={rangeData.to}\n        onDrop={handleOnStopResizing}\n      />\n      <DeleteButton x={scaleX()(to) - 20} y={10} onDelete={deleteHandler} />\n    </g>\n  );\n}\n\nexport default AnalysisRange;\n","import { memo, useMemo } from 'react';\n\nimport MultiAnalysisWrapper from '../../hoc/MultiAnalysisWrapper';\n\nimport AnalysisRange from './AnalysisRange';\n\nfunction MultiAnalysisRanges({ activeTab, spectraAnalysis, displayerKey }) {\n  const columns = useMemo(() => {\n    const {\n      options: { columns },\n    } = spectraAnalysis[activeTab] || {\n      options: { columns: {} },\n    };\n    return columns;\n  }, [activeTab, spectraAnalysis]);\n\n  const ranges = useMemo(() => {\n    return Object.keys(columns).map((key) => key, []);\n  }, [columns]);\n\n  if (!ranges || ranges.length === 0) {\n    return null;\n  }\n\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-1d)`}>\n      {ranges.map((columnKey) => (\n        <AnalysisRange\n          key={columnKey}\n          columnKey={columnKey}\n          rangeData={columns[columnKey]}\n        />\n      ))}\n    </g>\n  );\n}\n\nexport default MultiAnalysisWrapper(memo(MultiAnalysisRanges));\n","import { useMemo, memo, forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\n\nfunction RangesWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      data,\n      activeSpectrum,\n      xDomain,\n      activeTab,\n      molecules,\n      tabActiveSpectrum,\n      displayerKey,\n      selectedTool,\n    } = useChartData();\n    const preferences = usePreferences();\n\n    const { ranges = {}, x = [], y = [], info = {} } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const datum = data.find((datum) => datum.id === activeSpectrum.id) || {\n          ranges: {},\n          x: [],\n          y: [],\n          info: {},\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, data]);\n\n    const nucleus = useMemo(() => {\n      if (tabActiveSpectrum && Object.keys(tabActiveSpectrum).length > 0) {\n        return Object.keys(tabActiveSpectrum);\n      }\n      return null;\n    }, [tabActiveSpectrum]);\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        ranges={ranges}\n        x={x}\n        y={y}\n        info={info}\n        xDomain={xDomain}\n        preferences={preferences}\n        activeTab={activeTab}\n        molecules={molecules}\n        nucleus={nucleus}\n        displayerKey={displayerKey}\n        selectedTool={selectedTool}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return memo(\n    forwardRef((props, ref) => {\n      return <Wrapper {...props} forwardedRef={ref} />;\n    }),\n  );\n}\nexport default RangesWrapper;\n","const SignalKinds = [\n  {\n    key: 'signal',\n    label: 'Signal',\n    value: 'signal',\n  },\n  {\n    key: 'reference',\n    label: 'Reference',\n    value: 'reference',\n  },\n  {\n    key: 'solvent',\n    label: 'Solvent',\n    value: 'solvent',\n  },\n  {\n    key: 'impurity',\n    label: 'Impurity',\n    value: 'impurity',\n  },\n  {\n    key: 'standard',\n    label: 'Standard',\n    value: 'standard',\n  },\n  {\n    key: 'p1',\n    label: 'P1',\n    value: 'p1',\n  },\n  {\n    key: 'p2',\n    label: 'P2',\n    value: 'p2',\n  },\n  {\n    key: 'p3',\n    label: 'P3',\n    value: 'p3',\n  },\n];\n\nconst SignalKindsToInclude = ['signal'];\nconst DatumKind = { signal: 'signal', mixed: 'mixed' };\n\nexport { SignalKinds, SignalKindsToInclude, DatumKind };\n","import { DatumKind } from '../constants/SignalsKinds';\n\nconst getDiaIDs = (range) => {\n  return [].concat(\n    range.diaID || [],\n    range.signal\n      ? range.signal.map((_signal) => _signal.diaID || []).flat()\n      : [],\n  );\n};\n\nconst getPubIntegral = (range) => {\n  return getDiaIDs(range).length;\n};\n\nconst setPubIntegral = (range) => {\n  range.pubIntegral = getPubIntegral(range);\n  if (range.pubIntegral === 0) {\n    delete range.pubIntegral;\n  }\n};\n\nconst resetDiaIDs = (range) => {\n  delete range.diaID;\n  range.signal.forEach((_signal) => {\n    delete _signal.diaID;\n  });\n  delete range.pubIntegral;\n};\n/**\n *\n * @param {object} range\n * @param {String('both' | 'range' | 'signal')} unlinkType\n * @param {object} options\n * @param {number} [options.signalIndex]\n * @returns {object}\n */\nconst unlink = (range, unlinkType = 'both', options = {}) => {\n  switch (unlinkType) {\n    case 'both':\n      resetDiaIDs(range);\n\n      break;\n    case 'range':\n      delete range.diaID;\n\n      break;\n    case 'signal':\n      delete range.signal[options.signalIndex].diaID;\n\n      break;\n\n    default:\n      break;\n  }\n\n  setPubIntegral(range);\n\n  return range;\n};\n\nconst addDefaultSignal = (range) => {\n  range.signal.push({\n    multiplicity: 'm',\n    kind: 'signal',\n    delta: (range.to + range.from) / 2,\n  });\n};\n\nconst checkRangeKind = (range) => {\n  return range.kind === DatumKind.signal;\n};\n\nconst checkSignalKinds = (range, kinds) => {\n  return !range.signal.some(\n    (_signal) => _signal.kind === undefined || !kinds.includes(_signal.kind),\n  );\n};\n\nconst unlinkInAssignmentData = (assignmentData, ranges) => {\n  const ids = ranges.reduce((acc, range) => {\n    acc.push(range.id);\n    if (range.signal) {\n      acc = acc.concat(range.signal.map((signal) => signal.id, []));\n    }\n    return acc;\n  }, []);\n  assignmentData.dispatch({\n    type: 'REMOVE_ALL',\n    payload: { id: ids, axis: 'x' },\n  });\n};\n\nexport {\n  addDefaultSignal,\n  checkRangeKind,\n  checkSignalKinds,\n  getDiaIDs,\n  getPubIntegral,\n  resetDiaIDs,\n  unlink,\n  unlinkInAssignmentData,\n};\n","import {\n  createContext,\n  useReducer,\n  useMemo,\n  useContext,\n  useCallback,\n  useEffect,\n} from 'react';\n\nconst assignmentContext = createContext();\n\nfunction assignmentReducer(state, action) {\n  switch (action.type) {\n    case 'ADD': {\n      const newState = {\n        ...state,\n        assignment: { ...state.assignment },\n      };\n      if (newState.assignment[action.payload.id[0]] === undefined) {\n        newState.assignment[action.payload.id[0]] = {};\n      }\n      if (\n        newState.assignment[action.payload.id[0]][action.payload.axis] ===\n        undefined\n      ) {\n        newState.assignment[action.payload.id[0]][action.payload.axis] = [];\n      }\n      // avoid duplicates\n      if (\n        !newState.assignment[action.payload.id[0]][\n          action.payload.axis\n        ].includes(action.payload.id[1])\n      ) {\n        newState.assignment[action.payload.id[0]][action.payload.axis].push(\n          action.payload.id[1],\n        );\n      }\n\n      return newState;\n    }\n    case 'REMOVE': {\n      const newState = {\n        ...state,\n        assignment: { ...state.assignment },\n      };\n      if (\n        newState.assignment[action.payload.id[0]] !== undefined &&\n        newState.assignment[action.payload.id[0]][action.payload.axis] !==\n          undefined\n      ) {\n        newState.assignment[action.payload.id[0]][\n          action.payload.axis\n        ] = newState.assignment[action.payload.id[0]][\n          action.payload.axis\n        ].filter((_id) => _id !== action.payload.id[1]);\n\n        if (\n          newState.assignment[action.payload.id[0]][action.payload.axis]\n            .length === 0\n        ) {\n          delete newState.assignment[action.payload.id[0]][action.payload.axis];\n        }\n        if (\n          Object.keys(newState.assignment[action.payload.id[0]]).length === 0\n        ) {\n          delete newState.assignment[action.payload.id[0]];\n        }\n      }\n\n      return newState;\n    }\n    case 'REMOVE_ALL': {\n      const newState = {\n        ...state,\n        assignment: { ...state.assignment },\n      };\n      // takes an array now to delete multiple identifiers\n      action.payload.id.forEach((_id) => {\n        if (\n          newState.assignment[_id] !== undefined &&\n          newState.assignment[_id][action.payload.axis] !== undefined\n        ) {\n          delete newState.assignment[_id][action.payload.axis];\n          if (Object.keys(newState.assignment[_id]).length === 0) {\n            delete newState.assignment[_id];\n          }\n        }\n      });\n\n      return newState;\n    }\n    case 'SET_IS_ACTIVE': {\n      return {\n        ...state,\n        isActive:\n          action.payload.id !== undefined && action.payload.axis !== undefined,\n        activeID: action.payload.id,\n        activeAxis: action.payload.axis,\n      };\n    }\n    case 'SET_IS_ON_HOVER': {\n      return {\n        ...state,\n        isOnHover: action.payload.id !== undefined,\n        onHoverID: action.payload.id,\n        onHoverAxis: action.payload.axis,\n      };\n    }\n    case 'DELETE_RECORD': {\n      const newState = {\n        ...state,\n        assignment: { ...state.assignment },\n      };\n      delete newState.assignment[action.payload.id];\n\n      if (newState.isActive && newState.activeID === action.payload.id) {\n        newState.isActive = false;\n        newState.activeID = undefined;\n        newState.activeAxis = undefined;\n      }\n      if (newState.isOnHover && newState.onHoverID === action.payload.id) {\n        newState.isOnHover = false;\n        newState.onHoverID = undefined;\n        newState.onHoverAxis = undefined;\n      }\n\n      return newState;\n    }\n    default: {\n      throw new Error(`unknown action type: ${action.type}`);\n    }\n  }\n}\n\nconst emptyState = {\n  assignment: {},\n  isActive: false,\n  activeID: undefined,\n  activeAxis: undefined,\n  isOnHover: false,\n  onHoverID: undefined,\n  onHoverAxis: undefined,\n};\n\nexport function AssignmentProvider(props) {\n  const { spectraData } = props;\n  const [assignment, dispatch] = useReducer(assignmentReducer, emptyState);\n  const contextValue = useMemo(() => ({ assignment, dispatch }), [assignment]);\n\n  const initAssignmentDataRanges = (range, _contextValue) => {\n    _contextValue.dispatch({\n      type: 'DELETE_RECORD',\n      payload: { id: range.id },\n    });\n    (range.diaID || []).forEach((_diaID) =>\n      _contextValue.dispatch({\n        type: 'ADD',\n        payload: { id: [range.id, _diaID], axis: 'x' },\n      }),\n    );\n    range.signal.forEach((signal) =>\n      (signal.diaID || []).forEach((_diaID) =>\n        _contextValue.dispatch({\n          type: 'ADD',\n          payload: { id: [signal.id, _diaID], axis: 'x' },\n        }),\n      ),\n    );\n  };\n\n  const initAssignmentDataZones = (zone, _contextValue) => {\n    _contextValue.dispatch({\n      type: 'DELETE_RECORD',\n      payload: { id: zone.id },\n    });\n    (zone.y.diaID || []).forEach((_diaID) =>\n      _contextValue.dispatch({\n        type: 'ADD',\n        payload: { id: [zone.id, _diaID], axis: 'y' },\n      }),\n    );\n    (zone.x.diaID || []).forEach((_diaID) =>\n      _contextValue.dispatch({\n        type: 'ADD',\n        payload: { id: [zone.id, _diaID], axis: 'x' },\n      }),\n    );\n    zone.signal.forEach((signal) => {\n      (signal.x.diaID || []).forEach((_diaID) =>\n        _contextValue.dispatch({\n          type: 'ADD',\n          payload: { id: [signal.id, _diaID], axis: 'x' },\n        }),\n      );\n      (signal.y.diaID || []).forEach((_diaID) =>\n        _contextValue.dispatch({\n          type: 'ADD',\n          payload: { id: [signal.id, _diaID], axis: 'y' },\n        }),\n      );\n    });\n  };\n\n  useEffect(() => {\n    if (spectraData) {\n      spectraData.forEach((spectrum) => {\n        if (spectrum.info.dimension === 1) {\n          spectrum.ranges.values.forEach((range) =>\n            initAssignmentDataRanges(range, contextValue),\n          );\n        } else if (spectrum.info.dimension === 2) {\n          spectrum.zones.values.forEach((zone) =>\n            initAssignmentDataZones(zone, contextValue),\n          );\n        }\n      });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [spectraData]);\n\n  return (\n    <assignmentContext.Provider value={contextValue}>\n      {props.children}\n    </assignmentContext.Provider>\n  );\n}\n\nexport function useAssignmentData() {\n  return useContext(assignmentContext);\n}\n\nexport function useAssignment(key) {\n  const context = useAssignmentData();\n\n  if ((typeof key !== 'string' && typeof key !== 'number') || key === '') {\n    throw new Error(`assignment key must be a non-empty string or number`);\n  }\n  const id = String(key);\n\n  const isActive = useMemo(() => {\n    return context.assignment.isActive && context.assignment.activeID === id;\n  }, [context.assignment.activeID, context.assignment.isActive, id]);\n\n  const activeAxis = useMemo(() => {\n    return isActive ? context.assignment.activeAxis : undefined;\n  }, [context.assignment.activeAxis, isActive]);\n\n  const assigned = useMemo(() => {\n    return context.assignment.assignment[id]\n      ? context.assignment.assignment[id]\n      : [];\n  }, [context.assignment.assignment, id]);\n\n  const isOnHover = useMemo(() => {\n    return context.assignment.isOnHover && context.assignment.onHoverID === id;\n  }, [context.assignment.isOnHover, context.assignment.onHoverID, id]);\n\n  const onHoverAxis = useMemo(() => {\n    return isOnHover ? context.assignment.onHoverAxis : undefined;\n  }, [context.assignment.onHoverAxis, isOnHover]);\n\n  const add = useCallback(\n    (_id) => {\n      context.dispatch({\n        type: 'ADD',\n        payload: { id: [id, _id], axis: activeAxis },\n      });\n    },\n    [activeAxis, context, id],\n  );\n\n  const remove = useCallback(\n    (_id) => {\n      context.dispatch({\n        type: 'REMOVE',\n        payload: { id: [id, _id], axis: activeAxis },\n      });\n    },\n    [activeAxis, context, id],\n  );\n\n  const removeAll = useCallback(\n    (axis) => {\n      context.dispatch({\n        type: 'REMOVE_ALL',\n        payload: { id: [id], axis },\n      });\n    },\n    [context, id],\n  );\n\n  const toggle = useCallback(\n    (_id) => {\n      if (\n        assigned[activeAxis] === undefined ||\n        !assigned[activeAxis].includes(_id)\n      ) {\n        add(_id);\n      } else {\n        remove(_id);\n      }\n    },\n    [activeAxis, add, assigned, remove],\n  );\n\n  // totally deletion of a record from assignment storage\n  const deleteRecord = useCallback(() => {\n    context.dispatch({\n      type: 'DELETE_RECORD',\n      payload: { id },\n    });\n  }, [context, id]);\n\n  const onClick = useCallback(\n    (axis) => {\n      context.dispatch({\n        type: 'SET_IS_ACTIVE',\n        payload: {\n          id: !isActive ? id : undefined,\n          axis: !isActive && id !== undefined ? axis : undefined,\n        },\n      });\n    },\n    [context, id, isActive],\n  );\n\n  const setIsOnHover = useCallback(\n    (action, axis) => {\n      if (action === 'enter') {\n        context.dispatch({\n          type: 'SET_IS_ON_HOVER',\n          payload: {\n            id: id,\n            axis: id !== undefined ? axis : undefined,\n          },\n        });\n      } else if (action === 'leave') {\n        context.dispatch({\n          type: 'SET_IS_ON_HOVER',\n          payload: {},\n        });\n      }\n    },\n    [context, id],\n  );\n\n  const onMouseEnter = useCallback((axis) => setIsOnHover('enter', axis), [\n    setIsOnHover,\n  ]);\n\n  const onMouseLeave = useCallback((axis) => setIsOnHover('leave', axis), [\n    setIsOnHover,\n  ]);\n\n  return {\n    id,\n    isActive,\n    activeAxis,\n    assigned,\n    add,\n    remove,\n    removeAll,\n    toggle,\n    deleteRecord,\n    onClick,\n    isOnHover,\n    onHoverAxis,\n    onMouseEnter,\n    onMouseLeave,\n  };\n}\n","const Multiplets = [\n  { label: 'massive (m)', value: 'm', multiplicity: null },\n  { label: 'singlet (s)', value: 's', multiplicity: 1 },\n  { label: 'doublet (d)', value: 'd', multiplicity: 2 },\n  { label: 'triplet (t)', value: 't', multiplicity: 3 },\n  { label: 'quartet (q)', value: 'q', multiplicity: 4 },\n  { label: 'quintet (i)', value: 'i', multiplicity: 5 },\n  { label: 'sextet (x)', value: 'x', multiplicity: 6 },\n  { label: 'septet (p)', value: 'p', multiplicity: 7 },\n  { label: 'octet (o)', value: 'o', multiplicity: 8 },\n  { label: 'nonet (n)', value: 'n', multiplicity: 9 },\n];\n\nexport { Multiplets };\n","import { Multiplets } from '../../../../data/constants/Multiplets';\n\nfunction getMultiplicityNumber(string) {\n  const multiplet = Multiplets.find(\n    (_multiplet) => string === _multiplet.label || string === _multiplet.value,\n  );\n\n  return multiplet ? multiplet.multiplicity : null;\n}\n\nfunction checkMultiplet(multiplet, rejected = []) {\n  // options to determine whether a massive (m), for example, should be considered as rejected multiplet\n  if (multiplet === undefined || multiplet.length === 0) {\n    return false;\n  }\n  const _multiplet = Multiplets.find(\n    (m) => m.value === multiplet || m.label === multiplet,\n  );\n  return (\n    _multiplet &&\n    !rejected.includes(_multiplet.value) &&\n    !rejected.includes(_multiplet.label)\n  );\n}\n\nfunction checkMultiplicity(multiplicity, rejected = []) {\n  // options to determine whether a massive (m), for example, should be considered as rejected multiplicity\n  if (multiplicity === undefined || multiplicity.length === 0) {\n    return false;\n  }\n  return !multiplicity\n    .split('')\n    .find((_multiplet) => !checkMultiplet(_multiplet, rejected));\n}\n\nfunction translateMultiplet(multiplet) {\n  return multiplet.length === 1\n    ? Multiplets.find((_multiplet) => _multiplet.value === multiplet).label\n    : Multiplets.find((_multiplet) => _multiplet.label === multiplet).value;\n}\n\nfunction hasCouplingConstant(multiplet) {\n  if (multiplet.length > 1) {\n    multiplet = translateMultiplet(multiplet);\n  }\n  // with the pre-set rejected ones, we check the given multiplicity for the need of having a coupling constant (massive and singlet do not)\n  return checkMultiplicity(multiplet, ['m', 's']);\n}\n\nfunction getPascal(n, spin) {\n  if (n === undefined || n === 0 || spin === undefined) return [1];\n  let mult = 2 * spin + 1;\n  let previousLine = [];\n  for (let j = 0; j < mult - 1; j++) previousLine.push(1);\n  // complete with \"1 1\" or \"1 1 1\" for spin 1/2 and 1 respectively\n  for (let i = 0; i < n - 1; i++) {\n    // copy the line\n    let _line = previousLine.slice();\n    for (let j = 1; j < mult; j++) {\n      for (let k = 0; k < previousLine.length - 1; k++) {\n        _line[k + j] += previousLine[k];\n      } // add the previous line\n      _line.push(1); // complete the line\n    }\n    previousLine = _line.slice();\n  }\n  return previousLine;\n}\n\nexport {\n  checkMultiplet,\n  checkMultiplicity,\n  getMultiplicityNumber,\n  getPascal,\n  hasCouplingConstant,\n  translateMultiplet,\n};\n","export const TREE_LEVEL_COLORS = ['red', 'green', 'blue', 'magenta'];\n","import { useScale } from '../../context/ScaleContext';\n\nimport { TREE_LEVEL_COLORS } from './TreeColors';\n\nfunction LevelNode({ signal, startY, levelHeight }) {\n  const { scaleX } = useScale();\n  return (\n    <line\n      key={`startLevelNode_${signal.id}`}\n      x1={scaleX()(signal.delta)}\n      y1={startY}\n      x2={scaleX()(signal.delta)}\n      y2={startY + levelHeight}\n      stroke={TREE_LEVEL_COLORS[0]}\n    />\n  );\n}\n\nexport default LevelNode;\n","import { useScale } from '../../context/ScaleContext';\n\nfunction StringNode({ signal, startY, levelHeight, fontSize, showLabels }) {\n  const { scaleX } = useScale();\n  return (\n    <text\n      key={`multiplicityString_${signal.id}`}\n      textAnchor=\"middle\"\n      x={scaleX()(signal.delta)}\n      y={startY + levelHeight / 2}\n      fontSize={fontSize}\n      lengthAdjust=\"spacing\"\n      fill=\"black\"\n      visibility={showLabels ? 'visible' : 'hidden'}\n    >\n      {signal.multiplicity}\n    </text>\n  );\n}\n\nexport default StringNode;\n","import { useCallback } from 'react';\n\nimport { useScale } from '../../context/ScaleContext';\n\nfunction TreeNodes({\n  nodesData,\n  levelHeight,\n  startY,\n  signalID,\n  labelOptions,\n  showLabels,\n}) {\n  const { scaleX } = useScale();\n  const buildTreeNodeAndEdge = useCallback(\n    ({ startX, _startX, ratio, multiplicityIndex, color }) => {\n      const edgeLevel = 2 * multiplicityIndex + 2;\n      const _startYEdge = startY + edgeLevel * levelHeight;\n      const _startYNode = startY + (edgeLevel + 1) * levelHeight;\n\n      return (\n        <g key={`treeNode_${signalID}_${startX}_${_startX}_${ratio}`}>\n          {/* ratio text */}\n          <text\n            textAnchor=\"middle\"\n            x={scaleX()(_startX) + labelOptions.distance}\n            y={_startYNode + 2 * (levelHeight / 3)}\n            fontSize={labelOptions.fontSize}\n            fill={color}\n            visibility={showLabels ? 'visible' : 'hidden'}\n          >\n            {ratio}\n          </text>\n          {/* edge line */}\n          <line\n            x1={scaleX()(startX)}\n            y1={_startYEdge}\n            x2={scaleX()(_startX)}\n            y2={_startYNode}\n            stroke={color}\n          />\n          {/* node line */}\n          <line\n            x1={scaleX()(_startX)}\n            y1={_startYNode}\n            x2={scaleX()(_startX)}\n            y2={_startYNode + levelHeight}\n            stroke={color}\n          />\n        </g>\n      );\n    },\n    [\n      signalID,\n      labelOptions.distance,\n      labelOptions.fontSize,\n      scaleX,\n      showLabels,\n      startY,\n      levelHeight,\n    ],\n  );\n\n  return nodesData && nodesData.map((node) => buildTreeNodeAndEdge(node));\n}\n\nexport default TreeNodes;\n","import lodashGet from 'lodash/get';\n\nimport {\n  getMultiplicityNumber,\n  getPascal,\n} from '../../panels/extra/utilities/MultiplicityUtilities';\n\nimport { TREE_LEVEL_COLORS } from './TreeColors';\n\nconst createTreeNodes = (signal, spectrumData) => {\n  function buildTreeNodesData(\n    multiplicityIndex,\n    jIndices,\n    treeNodesData,\n    startX,\n  ) {\n    if (multiplicityIndex >= signal.multiplicity.length) {\n      return treeNodesData;\n    }\n    // re-use colors if needed\n    const color =\n      TREE_LEVEL_COLORS[multiplicityIndex % TREE_LEVEL_COLORS.length];\n\n    const jIndex = jIndices.findIndex(\n      (_jIndex) => _jIndex === multiplicityIndex,\n    );\n\n    const frequency = lodashGet(spectrumData, 'info.originFrequency', 0);\n    const coupling =\n      jIndex >= 0 && frequency > 0\n        ? signal.j[jIndex].coupling / frequency // convert to ppm\n        : null;\n\n    // in case of \"s\": no coupling constant and build one tree node only\n    if (!coupling) {\n      treeNodesData.push({\n        startX,\n        _startX: startX,\n        ratio: 1,\n        multiplicityIndex,\n        color,\n      });\n      // go to next multiplet in multiplicity string\n      buildTreeNodesData(\n        multiplicityIndex + 1,\n        jIndices,\n        treeNodesData,\n        startX,\n      );\n    } else {\n      // in case of other multiplets\n      const pascal = getPascal(\n        getMultiplicityNumber(signal.multiplicity.charAt(multiplicityIndex)),\n        0.5,\n      ); // @TODO for now we use the default spin of 1 / 2 only\n\n      let _startX =\n        pascal.length % 2 === 0\n          ? startX - (pascal.length / 2) * coupling + coupling / 2 // in case of even number of nodes\n          : startX - (pascal.length / 2 - 0.5) * coupling; // in case of odd number of nodes\n\n      pascal.forEach((ratio, k) => {\n        if (k > 0) {\n          _startX += coupling;\n        }\n        treeNodesData.push({\n          startX,\n          _startX,\n          ratio,\n          multiplicityIndex,\n          color,\n        });\n        // go to next multiplet in multiplicity string\n        buildTreeNodesData(\n          multiplicityIndex + 1,\n          jIndices,\n          treeNodesData,\n          _startX,\n        );\n      });\n    }\n\n    return treeNodesData;\n  }\n  return buildTreeNodesData;\n};\n//   [signal.multiplicity, signal.j, spectrumData],\n\nexport default createTreeNodes;\n","/** @jsxImportSource @emotion/react */\nimport lodashGet from 'lodash/get';\nimport { useMemo, useState, useEffect } from 'react';\n\nimport { useAssignment } from '../../assignment';\nimport { useChartData } from '../../context/ChartContext';\nimport { useScale } from '../../context/ScaleContext';\nimport { useHighlight } from '../../highlight';\nimport {\n  hasCouplingConstant,\n  checkMultiplicity,\n} from '../../panels/extra/utilities/MultiplicityUtilities';\nimport { options } from '../../toolbar/ToolTypes';\n\nimport LevelNode from './LevelNode';\nimport StringNode from './StringNode';\nimport TreeNodes from './TreeNodes';\nimport createTreeNodes from './buildTreeNode';\n\nconst styles = {\n  cursor: 'default',\n  opacity: 0.6,\n  strokeWidth: 1,\n};\n\nfunction MultiplicityTree({\n  rangeFrom,\n  rangeTo,\n  signal,\n  labelOptions = {\n    distance: 10,\n    fontSize: 11,\n  },\n}) {\n  const { scaleX, scaleY } = useScale();\n  const {\n    data: spectraData,\n    activeSpectrum,\n    selectedTool,\n    width,\n  } = useChartData();\n  const assignment = useAssignment(signal.id);\n  const highlight = useHighlight(\n    [assignment.id].concat(assignment.assigned.x || []),\n  );\n\n  const spectrumData = useMemo(\n    () => lodashGet(spectraData, `${activeSpectrum.index}`, null),\n    [activeSpectrum, spectraData],\n  );\n\n  const [xRange, setXRange] = useState({ x1: signal.delta, x2: signal.delta });\n  const [treeProps, setTreeProps] = useState({\n    width: 0,\n    height: 0,\n    levelHeight: 0,\n  });\n  const [drawInFullRange, setDrawInFullRange] = useState(false);\n  const [showLabels, setShowLabels] = useState(false);\n\n  useEffect(() => {\n    const _drawInFullRange = !checkMultiplicity(signal.multiplicity, ['m']);\n    const _treeWidth = _drawInFullRange\n      ? Math.abs(scaleX()(xRange.x1) - scaleX()(xRange.x2))\n      : Math.abs(scaleX()(xRange.x1) - scaleX()(xRange.x2)) +\n        labelOptions.distance;\n    const _treeHeight = _drawInFullRange ? _treeWidth / 3 : _treeWidth / 2;\n    // +2 because of multiplicity text and start level node before the actual tree starts\n    // 2* for levels between nodes (edges)\n    const _treeLevelHeight = _drawInFullRange\n      ? _treeHeight / (signal.multiplicity.length + 2)\n      : _treeHeight / (2 * signal.multiplicity.length + 2);\n\n    setTreeProps({\n      width: _treeWidth,\n      height: _treeHeight,\n      levelHeight: _treeLevelHeight,\n    });\n    setDrawInFullRange(_drawInFullRange);\n  }, [\n    labelOptions.distance,\n    scaleX,\n    signal.multiplicity,\n    xRange.x1,\n    xRange.x2,\n  ]);\n\n  useEffect(() => {\n    if (treeProps.width / width >= 0.1) {\n      setShowLabels(true);\n    } else {\n      setShowLabels(false);\n    }\n  }, [treeProps.width, width]);\n\n  const startY = useMemo(() => {\n    let yMax;\n    spectrumData.data.x.forEach((_x, i) => {\n      if (\n        _x >= rangeFrom &&\n        _x <= rangeTo &&\n        (!yMax || spectrumData.data.y[i] > yMax)\n      ) {\n        yMax = spectrumData.data.y[i];\n      }\n    });\n\n    return scaleY(spectrumData.id)(yMax) - treeProps.height - 30;\n  }, [\n    spectrumData.data.x,\n    spectrumData.data.y,\n    spectrumData.id,\n    scaleY,\n    treeProps.height,\n    rangeFrom,\n    rangeTo,\n  ]);\n\n  const treeNodesData = useMemo(() => {\n    const buildTreeNodesData = createTreeNodes(signal, spectrumData);\n    const jIndices = signal.multiplicity\n      .split('')\n      .map((_mult, i) => (hasCouplingConstant(_mult) ? i : undefined))\n      .filter((_i) => _i !== undefined);\n\n    return buildTreeNodesData(0, jIndices, [], signal.delta);\n  }, [signal, spectrumData]);\n\n  useEffect(() => {\n    if (drawInFullRange) {\n      setXRange({ x1: rangeFrom, x2: rangeTo });\n    } else {\n      const _xRange = { x1: signal.delta, x2: signal.delta };\n      treeNodesData.forEach((_treeNodeData) => {\n        if (_treeNodeData.startX < _xRange.x1) {\n          _xRange.x1 = _treeNodeData.startX;\n        }\n        if (_treeNodeData.startX > _xRange.x2) {\n          _xRange.x2 = _treeNodeData.startX;\n        }\n        if (_treeNodeData._startX < _xRange.x1) {\n          _xRange.x1 = _treeNodeData._startX;\n        }\n        if (_treeNodeData._startX > _xRange.x2) {\n          _xRange.x2 = _treeNodeData._startX;\n        }\n      });\n      setXRange(_xRange);\n    }\n  }, [\n    drawInFullRange,\n    rangeFrom,\n    rangeTo,\n    signal.delta,\n    signal.multiplicity,\n    treeNodesData,\n  ]);\n\n  const multiplicityTree = useMemo(() => {\n    const { levelHeight } = treeProps;\n    // first tree level\n    const firstLevelStartY = startY;\n    let _startY = firstLevelStartY;\n    // second tree level\n    const secondLevelStartY = startY + levelHeight;\n    _startY = secondLevelStartY;\n\n    // third tree level\n    _startY += levelHeight;\n\n    if (drawInFullRange) {\n      const _rangeFrom = scaleX()(rangeFrom);\n      const _rangeTo = scaleX()(rangeTo);\n\n      const pathData = `M ${_rangeFrom} ${\n        _startY + levelHeight\n      } ${_rangeFrom} ${_startY} ${scaleX()(\n        signal.delta,\n      )} ${_startY} ${_rangeTo} ${_startY} ${_rangeTo} ${\n        _startY + levelHeight\n      }`;\n\n      return (\n        <g>\n          <StringNode\n            signal={signal}\n            startY={firstLevelStartY}\n            levelHeight={levelHeight}\n            fontSize={labelOptions.fontSize}\n            showLabels={showLabels}\n          />\n          <LevelNode\n            signal={signal}\n            startY={secondLevelStartY}\n            levelHeight={levelHeight}\n          />\n          <path d={pathData} stroke=\"blue\" fill=\"none\" />\n        </g>\n      );\n    }\n\n    return (\n      <g>\n        <StringNode\n          signal={signal}\n          startY={firstLevelStartY}\n          levelHeight={levelHeight}\n          fontSize={labelOptions.fontSize}\n          showLabels={showLabels}\n        />\n        <LevelNode\n          signal={signal}\n          startY={secondLevelStartY}\n          levelHeight={levelHeight}\n        />\n        <TreeNodes\n          nodesData={treeNodesData}\n          signalID={treeNodesData}\n          showLabels={showLabels}\n          startY={startY}\n          labelOptions={labelOptions}\n          levelHeight={levelHeight}\n        />\n      </g>\n    );\n  }, [\n    treeProps,\n    startY,\n    drawInFullRange,\n    signal,\n    labelOptions,\n    showLabels,\n    treeNodesData,\n    scaleX,\n    rangeFrom,\n    rangeTo,\n  ]);\n\n  return (\n    <g\n      css={\n        highlight.isActive || assignment.isActive\n          ? { ...styles, opacity: 1, strokeWidth: 1.5 }\n          : styles\n      }\n      {...{\n        onMouseEnter: () => {\n          assignment.onMouseEnter('x');\n          highlight.show();\n        },\n        onMouseLeave: () => {\n          assignment.onMouseLeave('x');\n          highlight.hide();\n        },\n      }}\n      {...{\n        onClick:\n          selectedTool && selectedTool === options.editRange.id\n            ? null\n            : (e) => {\n                if (e.shiftKey) {\n                  e.stopPropagation();\n                  assignment.onClick('x');\n                }\n              },\n      }}\n    >\n      {multiplicityTree}\n    </g>\n  );\n}\n\nexport default MultiplicityTree;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useState, useEffect } from 'react';\n\nimport { checkRangeKind } from '../../../data/utilities/RangeUtilities';\nimport { useAssignment } from '../../assignment';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useScale } from '../../context/ScaleContext';\nimport { TYPES, useHighlight } from '../../highlight';\nimport { RESIZE_RANGE } from '../../reducer/types/Types';\nimport { options } from '../../toolbar/ToolTypes';\nimport Resizable from '../Resizable';\nimport MultiplicityTree from '../multiplicityTree/MultiplicityTree';\n\nconst stylesOnHover = css`\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  // // disabled because Resizable component appears now when hovering over it\n  // :hover .range-area {\n  //   height: 100%;\n  //   fill: #ff6f0057;\n  //   cursor: pointer;\n  // }\n\n  .delete-button {\n    visibility: hidden;\n  }\n`;\n\nconst stylesHighlighted = css`\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  .range-area {\n    height: 100%;\n    fill: #ff6f0057;\n  }\n  .delete-button {\n    visibility: visible;\n    cursor: pointer;\n  }\n`;\n\nfunction Range({ rangeData, showMultiplicityTrees, selectedTool }) {\n  const { id, from: rangeFrom, to: rangeTo, integral, signal } = rangeData;\n  const assignmentRange = useAssignment(id);\n  const highlightRange = useHighlight(\n    [assignmentRange.id].concat(assignmentRange.assigned.x || []),\n    TYPES.RANGE,\n  );\n  const [rangeBoundary, setRangeBoundary] = useState({\n    from: rangeFrom,\n    to: rangeTo,\n  });\n\n  const { scaleX } = useScale();\n  const dispatch = useDispatch();\n\n  const [reduceOpacity, setReduceOpacity] = useState(false);\n  const [isBlockedByEditing, setIsBlockedByEditing] = useState(false);\n\n  useEffect(() => {\n    if (selectedTool && selectedTool === options.editRange.id) {\n      setIsBlockedByEditing(true);\n    } else {\n      setIsBlockedByEditing(false);\n    }\n  }, [selectedTool]);\n\n  useEffect(() => {\n    setReduceOpacity(!checkRangeKind(rangeData));\n  }, [rangeData]);\n\n  const handleOnStopResizing = useCallback(\n    (resized) => {\n      dispatch({\n        type: RESIZE_RANGE,\n        data: { ...rangeData, ...resized },\n      });\n    },\n    [dispatch, rangeData],\n  );\n\n  const mouseEnterHandler = useCallback(() => {\n    assignmentRange.onMouseEnter('x');\n    highlightRange.show();\n  }, [assignmentRange, highlightRange]);\n  const mouseLeaveHandler = useCallback(() => {\n    assignmentRange.onMouseLeave('x');\n    highlightRange.hide();\n  }, [assignmentRange, highlightRange]);\n\n  const assignHandler = useCallback(\n    (e) => {\n      if (\n        selectedTool === options.rangesPicking.id &&\n        e.shiftKey &&\n        !isBlockedByEditing\n      ) {\n        assignmentRange.onClick('x');\n      }\n    },\n    [assignmentRange, isBlockedByEditing, selectedTool],\n  );\n\n  const dragHandler = useCallback((boundary) => {\n    setRangeBoundary((range) => ({ ...range, ...boundary }));\n  }, []);\n\n  const { from, to } = rangeBoundary;\n\n  return (\n    <g\n      // tabIndex=\"0\"\n      style={{ outline: 'none' }}\n      css={\n        isBlockedByEditing ||\n        highlightRange.isActive ||\n        assignmentRange.isActive\n          ? stylesHighlighted\n          : stylesOnHover\n      }\n      key={id}\n      onMouseEnter={mouseEnterHandler}\n      onMouseLeave={mouseLeaveHandler}\n      onClick={assignHandler}\n    >\n      <g transform={`translate(${scaleX()(to)},10)`}>\n        <rect\n          x=\"0\"\n          width={Math.abs(scaleX()(from) - scaleX()(to))}\n          height=\"6\"\n          className=\"range-area\"\n          fill=\"green\"\n          fillOpacity={\n            !reduceOpacity ||\n            highlightRange.isActive ||\n            assignmentRange.isActive\n              ? 1\n              : 0.4\n          }\n        />\n        <text\n          textAnchor=\"middle\"\n          x={Math.abs(scaleX()(from) - scaleX()(to)) / 2}\n          y=\"20\"\n          fontSize=\"10\"\n          fill=\"red\"\n          fillOpacity={\n            !reduceOpacity ||\n            highlightRange.isActive ||\n            assignmentRange.isActive\n              ? 1\n              : 0.6\n          }\n        >\n          {integral !== undefined ? integral.toFixed(2) : ''}\n        </text>\n      </g>\n      <Resizable\n        from={rangeData.from}\n        to={rangeData.to}\n        onDrop={handleOnStopResizing}\n        onDrag={dragHandler}\n      />\n      {showMultiplicityTrees && signal && signal.length > 0\n        ? signal.map((_signal) => (\n            <MultiplicityTree\n              rangeFrom={from}\n              rangeTo={to}\n              signal={_signal}\n              key={signal.id}\n            />\n          ))\n        : null}\n    </g>\n  );\n}\n\nexport default Range;\n","import { memo, useEffect, useState } from 'react';\n\nimport RangesWrapper from '../../hoc/RangesWrapper';\nimport Events from '../../utility/Events';\n\nimport Range from './Range';\n\nfunction Ranges({ ranges, displayerKey, selectedTool }) {\n  const [isMultiplicityTreesVisibile, showMultiplicityTrees] = useState(false);\n\n  useEffect(() => {\n    Events.on('showMultiplicityTrees', (flag) => {\n      showMultiplicityTrees(flag);\n    });\n  }, []);\n\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-1d)`}>\n      {ranges &&\n        ranges.values &&\n        ranges.values.map((range) => (\n          <Range\n            key={range.id}\n            rangeData={range}\n            selectedTool={selectedTool}\n            showMultiplicityTrees={isMultiplicityTreesVisibile}\n          />\n        ))}\n    </g>\n  );\n}\n\nexport default RangesWrapper(memo(Ranges));\n","import BaseLineZones from './BaseLineZones';\nimport ExclusionZones from './ExclusionZones';\nimport IntegralsSeries from './IntegralsSeries';\nimport LinesSeries from './LinesSeries';\nimport PeaksNotations from './PeaksNotations';\nimport XAxis from './XAxis';\nimport MultiAnalysisRanges from './multiAnalysis/MultiAnalysisRanges';\nimport Ranges from './ranges/Ranges';\n\nfunction Chart1D({ mode, width, height, margin, displayerKey }) {\n  return (\n    <svg\n      viewBox={`0 0 ${width} ${height}`}\n      width={width}\n      height={height}\n      id=\"nmrSVG\"\n    >\n      <defs>\n        <clipPath id={`${displayerKey}clip-chart-1d`}>\n          <rect\n            width={`${width - margin.left - margin.right}`}\n            height={`${height}`}\n            x={`${margin.left}`}\n            y={`${0}`}\n          />\n        </clipPath>\n      </defs>\n\n      <LinesSeries />\n      <IntegralsSeries />\n      <PeaksNotations />\n      <Ranges />\n      <MultiAnalysisRanges />\n      <BaseLineZones />\n      <ExclusionZones />\n\n      <g className=\"container\" style={{ pointerEvents: 'none' }}>\n        <XAxis showGrid mode={mode} />\n        {/* <YAxis label=\"PPM\" show /> */}\n      </g>\n    </svg>\n  );\n}\n\nexport default Chart1D;\n","import { createContext, useCallback, useContext } from 'react';\n\nconst HelpContext = createContext();\n\nexport const HelpProvider = HelpContext.Provider;\n\nexport function useHelptData() {\n  return useContext(HelpContext).helpState;\n}\nexport function useHelp() {\n  const context = useContext(HelpContext);\n\n  const show = useCallback(\n    (e) => {\n      const id = e.target.getAttribute('data-helpid');\n      if (id) {\n        e.target.style.cursor = 'help';\n        context.dispatch({ type: 'SHOW', id });\n\n        context.show(id, { delay: e.ctrlKey ? 0 : null });\n      }\n    },\n    [context],\n  );\n\n  const hide = useCallback(() => {\n    context.dispatch({ type: 'HIDE' });\n    context.clear();\n  }, [context]);\n\n  const onHover = {\n    onMouseEnter: show,\n    onMouseLeave: hide,\n  };\n\n  return { show, hide, onHover };\n}\n","export const groupBy = (array, fn) =>\n  array.reduce((result, item) => {\n    const key = fn(item);\n    if (!result[key]) result[key] = [];\n    result[key].push(item);\n    return result;\n  }, {});\n","export const initState = {\n  helpText: null,\n  helpObject: null,\n};\nexport default function helpReducer(state, action) {\n  switch (action.type) {\n    case 'SHOW': {\n      const helpText = state.data[action.id].text;\n      return { ...state, helpText };\n    }\n    case 'HIDE': {\n      return { ...state, helpText: null };\n    }\n    default: {\n      throw new Error(`unknown action type: ${action.type}`);\n    }\n  }\n}\n","import {\n  useReducer,\n  useRef,\n  useEffect,\n  useCallback,\n  Fragment,\n  useState,\n  memo,\n  useMemo,\n} from 'react';\nimport { createPortal } from 'react-dom';\nimport { FaTimes } from 'react-icons/fa';\nimport { Rnd } from 'react-rnd';\nimport { TransitionGroup } from 'react-transition-group';\n\nimport Transition from '../Transition';\nimport Wrapper from '../Wrapper';\nimport { groupBy } from '../helpers';\nimport { positions, transitions } from '../options';\n\nimport { HelpProvider } from './Context';\nimport helpReducer, { initState } from './Reducer';\n\nconst transitionStyles = {\n  [transitions.FADE]: {\n    entering: { opacity: 0 },\n    entered: { opacity: 1 },\n  },\n  [transitions.SCALE]: {\n    entering: { transform: 'scale(0)' },\n    entered: { transform: 'scale(1)' },\n    exiting: { transform: 'scale(0)' },\n    exited: { transform: 'scale(0)' },\n  },\n};\n\nconst styles = {\n  innerContainer: {\n    display: 'flex',\n    flexDirection: 'column',\n    width: '100%',\n    height: '100%',\n    borderRadius: '5px',\n    padding: '10px',\n  },\n  outerContainer: {\n    boxSizing: 'initial',\n    backgroundColor: 'rgba(255, 255, 255, 1)',\n    boxShadow: '0px 0px 0px 0px, rgba(0, 0, 0, 0.1) 0px 3px 5px',\n    pointerEvents: 'all',\n  },\n  closeButton: {\n    border: 'none',\n    color: 'red',\n    backgroundColor: 'transparent',\n    outline: 'none',\n  },\n};\n\nlet dealyTimeOut = null;\n\nfunction Provider({\n  children,\n  data,\n  offset,\n  position,\n  timeout,\n  delay,\n  type,\n  transition,\n  containerStyle,\n  wrapperRef,\n  multiple,\n  preventAutoHelp,\n}) {\n  const root = useRef();\n  const timersId = useRef([]);\n  const [modals, setModals] = useState([]);\n\n  useEffect(() => {\n    root.current = document.createElement('div');\n    const ref = root.current;\n    if (wrapperRef) {\n      wrapperRef.appendChild(ref);\n    }\n\n    const timersIdRef = timersId.current;\n\n    return () => {\n      timersIdRef.forEach(clearTimeout);\n      if (wrapperRef) {\n        wrapperRef.removeChild(ref);\n      }\n    };\n  }, [wrapperRef]);\n\n  const remove = useCallback((modal) => {\n    setModals((currentModals) => {\n      const lengthBeforeRemove = currentModals.length;\n      const filteredModals = currentModals.filter((a) => a.id !== modal.id);\n\n      if (lengthBeforeRemove > filteredModals.length && modal.options.onClose) {\n        modal.options.onClose();\n      }\n\n      return filteredModals;\n    });\n  }, []);\n\n  const show = useCallback(\n    async (helpid, options = { delay: null }) => {\n      if (!modals.some((m) => m.helpid === helpid)) {\n        try {\n          const id = Math.random().toString(36).substr(2, 9);\n\n          const modalOptions = {\n            position: options.position || position,\n            timeout,\n            type,\n            ...options,\n          };\n\n          const modal = {\n            helpid,\n            id,\n            options: modalOptions,\n          };\n\n          modal.close = () => remove(modal);\n\n          const startModal = () => {\n            if (modal.options.timeout) {\n              const timerId = setTimeout(() => {\n                remove(modal);\n                timersId.current.splice(timersId.current.indexOf(timerId), 1);\n              }, modal.options.timeout);\n\n              timersId.current.push(timerId);\n            }\n\n            setModals((state) => (multiple ? state.concat(modal) : [modal]));\n\n            if (modal.options.onOpen) modal.options.onOpen();\n          };\n\n          if (options.delay === 0) {\n            startModal();\n          } else if (!preventAutoHelp) {\n            dealyTimeOut = setTimeout(\n              () => {\n                startModal();\n              },\n              options.delay > 0 ? options.delay : delay,\n            );\n          }\n          return modal;\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.log(e);\n        }\n      }\n    },\n    [delay, modals, multiple, position, preventAutoHelp, remove, timeout, type],\n  );\n\n  const clear = useCallback(() => {\n    clearTimeout(dealyTimeOut);\n  }, []);\n\n  const parentStyle = useMemo(() => {\n    return wrapperRef\n      ? wrapperRef.getBoundingClientRect()\n      : {\n          top: 0,\n          left: 0,\n          width: window.innerWidth,\n          height: window.innerHeight,\n        };\n  }, [wrapperRef]);\n\n  const [helpState, dispatch] = useReducer(helpReducer, {\n    ...initState,\n    data,\n  });\n\n  const modalsByPosition = groupBy(\n    modals,\n    (modal) => modal.options && modal.options.position,\n  );\n\n  return (\n    <HelpProvider value={{ helpState, dispatch, show, clear }}>\n      {children}\n      {root.current &&\n        createPortal(\n          <Fragment>\n            {Object.keys(positions).map((key) => {\n              const _position = positions[key];\n\n              return (\n                <TransitionGroup\n                  appear\n                  key={_position}\n                  options={{ position, containerStyle }}\n                  containerStyle={parentStyle}\n                  component={Wrapper}\n                >\n                  {modalsByPosition[_position]\n                    ? modalsByPosition[_position].map((modal) => (\n                        <Transition\n                          type={transition}\n                          key={modal.id}\n                          transitionStyles={{\n                            ...transitionStyles,\n                            default: { width: '400px', height: '400px' },\n                          }}\n                        >\n                          <Rnd\n                            style={{\n                              margin: offset,\n                              ...styles.outerContainer,\n                            }}\n                            default={{\n                              x: 0,\n                              y: 0,\n                              width: 400,\n                              height: 400,\n                            }}\n                          >\n                            <div style={styles.innerContainer}>\n                              <div>\n                                <button\n                                  type=\"button\"\n                                  onClick={() => remove(modal)}\n                                  style={styles.closeButton}\n                                >\n                                  <FaTimes />\n                                </button>\n                              </div>\n                              {data[modal.helpid].filePath && (\n                                <div\n                                  style={{\n                                    cursor: 'default',\n                                    width: '100%',\n                                    height: '100%',\n                                  }}\n                                >\n                                  <iframe\n                                    title=\"Tool User Manual\"\n                                    src={data[modal.helpid].filePath}\n                                    frameBorder=\"0\"\n                                    scrolling=\"auto\"\n                                    style={{ width: '100%', height: '100%' }}\n                                  />\n                                </div>\n                              )}\n                            </div>\n                          </Rnd>\n                        </Transition>\n                      ))\n                    : null}\n                </TransitionGroup>\n              );\n            })}\n          </Fragment>,\n          root.current,\n        )}\n    </HelpProvider>\n  );\n}\n\nProvider.defaultProps = {\n  offset: '10px',\n  position: positions.TOP_RIGHT,\n  timeout: 0,\n  delay: 2000,\n  transition: transitions.SCALE,\n  containerStyle: {\n    zIndex: 100,\n  },\n  wrapperRef: null,\n  multiple: false,\n  preventAutoHelp: false,\n};\n\nexport default memo(Provider);\n","import { forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction FooterWarpper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      margin,\n      width,\n      height,\n      activeSpectrum,\n      data,\n      activeTab,\n    } = useChartData();\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        data={data}\n        activeSpectrum={activeSpectrum}\n        activeTab={activeTab}\n        margin={margin}\n        width={width}\n        height={height}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default FooterWarpper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\nimport { useContext, useCallback, Fragment, memo } from 'react';\nimport { BsCursor } from 'react-icons/bs';\nimport { IoPulseSharp } from 'react-icons/io5';\n\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useScale } from '../context/ScaleContext';\nimport { useHelptData } from '../elements/popup/Help';\nimport FooterWarpper from '../hoc/FooterWarpper';\nimport { useFormatNumberByNucleus } from '../utility/FormatNumber';\n\nconst styles = css`\n  display: flex;\n  flex-firection: row;\n  align-items: center;\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n  background-color: #f7f7f7;\n  height: 30px;\n  padding: 6px;\n  color: #8d0018;\n  position: absolute;\n  width: 100%;\n  bottom: 0;\n\n  .help {\n    font-size: 6px;\n    color: black;\n  }\n\n  div {\n    margin: 0px 10px;\n    display: inline-block;\n\n    .label {\n      font-size: 12px;\n      color: #4d4d4d;\n      font-weight: bold;\n    }\n    .value {\n      font-weight: bold;\n      font-size: 14px;\n      display: inline-block;\n    }\n    .unit {\n      font-weight: bold;\n      font-size: 10px;\n    }\n    .xvalue {\n      min-width: 50px;\n    }\n    .yvalue {\n      min-width: 80px;\n    }\n  }\n\n  .separator {\n    border-left: 2px solid gray;\n    margin: 0 20px;\n    width: 1px;\n    height: 100%;\n  }\n`;\n\nconst helpStyles = css`\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n  background-color: #f7f7f7;\n  height: 30px;\n  padding: 6px;\n  color: #8d0018;\n  position: absolute;\n  width: 100%;\n  bottom: 0;\n  span {\n    font-size: 10px;\n    color: black;\n    display: inline-block;\n    text-overflow: ellipsis;\n    width: 100%;\n    white-space: nowrap;\n    overflow: hidden;\n  }\n`;\n\nfunction FooterBanner({\n  margin,\n  width,\n  height,\n  activeSpectrum,\n  data,\n  activeTab,\n}) {\n  let position = useContext(MouseContext);\n  const { startX, endX, step } = useContext(BrushContext);\n  const { scaleX } = useScale();\n  const { helpText } = useHelptData();\n  const { originFrequency: frequency } = activeSpectrum\n    ? data[activeSpectrum.index].info\n    : {};\n\n  const format = useFormatNumberByNucleus(activeTab);\n\n  const getYValue = useCallback(\n    (xPosition) => {\n      if (activeSpectrum) {\n        const xIndex = xFindClosestIndex(\n          data[activeSpectrum.index].data.x,\n          scaleX().invert(xPosition),\n        );\n        return data[activeSpectrum.index].data.y[xIndex];\n      }\n      return 1;\n    },\n    [activeSpectrum, data, scaleX],\n  );\n\n  if (helpText) {\n    return (\n      <div css={helpStyles}>\n        <span className=\"help\">{helpText}</span>\n      </div>\n    );\n  }\n\n  if (\n    !position ||\n    position.y < margin.top ||\n    position.x < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return <div css={styles} />;\n  }\n\n  return (\n    <div css={styles}>\n      <BsCursor />\n      <div>\n        <span className=\"label\"> X :</span>\n        <span className=\"value\">{format(scaleX().invert(position.x))}</span>\n        <span className=\"unit\">ppm</span>\n      </div>\n      {activeSpectrum && frequency && (\n        <div>\n          <span className=\"label\"> X :</span>\n          <span className=\"value xvalue\">\n            {format(scaleX().invert(position.x) * frequency, 'hz')}\n          </span>\n          <span className=\"unit\">Hz</span>\n        </div>\n      )}\n\n      {step === 'brushing' && (\n        <div>\n          <span className=\"label\"> Δppm :</span>\n          <span className=\"value\">\n            {(scaleX().invert(startX) - scaleX().invert(endX)).toPrecision(6)}\n          </span>\n        </div>\n      )}\n      {activeSpectrum && (\n        <Fragment>\n          {frequency && step === 'brushing' && (\n            <div>\n              <span className=\"label\"> ΔHz :</span>\n              <span className=\"value\">\n                {(\n                  (scaleX().invert(startX) - scaleX().invert(endX)) *\n                  frequency\n                ).toPrecision(5)}\n              </span>\n            </div>\n          )}\n          {step === 'brushing' && (\n            <div>\n              <span className=\"label\"> ratio :</span>\n              <span className=\"value\">\n                {(\n                  (getYValue(startX) / (getYValue(endX) || Number.MIN_VALUE)) *\n                  100\n                ).toFixed(2)}\n                %\n              </span>\n            </div>\n          )}\n        </Fragment>\n      )}\n      {activeSpectrum && (\n        <Fragment>\n          <div className=\"separator\" />\n          <IoPulseSharp />\n          <div>\n            <span className=\"label\"> Y :</span>\n            <span className=\"value yvalue\">\n              {format(getYValue(position.x))}\n            </span>\n          </div>\n        </Fragment>\n      )}\n    </div>\n  );\n}\n\nexport default FooterWarpper(memo(FooterBanner));\n","import { xFindClosestIndex } from 'ml-spectra-processing';\nimport { useContext, useEffect, useMemo, useState } from 'react';\n\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { useScale } from '../context/ScaleContext';\nimport Events from '../utility/Events';\n\nconst styles = {\n  container: {\n    position: 'absolute',\n    left: '10px',\n    top: '10px',\n  },\n  value: {\n    width: '67px',\n    display: 'inline-block',\n    margin: '0 5px',\n    fontSize: '12px',\n  },\n  colorIndicator: {\n    width: '10px',\n    height: '1px',\n    borderBottom: `2px solid`,\n    display: 'inline-block',\n    marginBottom: '3px',\n  },\n  name: {\n    fontSize: '12px',\n  },\n};\n\nfunction YTracker({ datum }) {\n  const { scaleX } = useScale();\n  const position = useContext(MouseContext);\n\n  if (!scaleX || !position) {\n    return null;\n  }\n\n  const xIndex = xFindClosestIndex(datum.x, scaleX().invert(position.x));\n\n  return <span style={styles.value}>{datum.y[xIndex]}</span>;\n}\n\nfunction SpectraTracker() {\n  const { data, activeTab } = useChartData();\n  const [isVisible, ToggleVisiblility] = useState(false);\n  useEffect(() => {\n    Events.on('showYSpectraTrackers', (flag) => {\n      ToggleVisiblility(flag);\n    });\n\n    return () => Events.off('showYSpectraTrackers');\n  }, []);\n\n  const trackers = useMemo(() => {\n    return (\n      isVisible &&\n      data.map(\n        (datum) =>\n          datum.display.isVisible &&\n          datum.display.isVisibleInDomain &&\n          datum.info.nucleus === activeTab && (\n            <div style={{ display: 'block' }} key={datum.id}>\n              <span\n                style={{\n                  ...styles.colorIndicator,\n                  borderColor: datum.display.color,\n                }}\n              />\n              <YTracker datum={datum.data} />\n              <span style={styles.value}>{datum.display.name}</span>\n            </div>\n          ),\n        [],\n      )\n    );\n  }, [activeTab, data, isVisible]);\n\n  if (!isVisible) return null;\n\n  return <div style={styles.container}>{trackers}</div>;\n}\n\nexport default SpectraTracker;\n","import max from 'ml-array-max';\nimport { useContext, useEffect, useState } from 'react';\n\nimport { BrushContext } from '../../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../context/ChartContext';\nimport { useScale } from '../../context/ScaleContext';\nimport { options } from '../../toolbar/ToolTypes';\n\nconst styles = {\n  radius: 10,\n  borderColor: '#1f1f1f',\n  strokeWidth: 1,\n  fillOpacity: 0,\n  SVGPadding: 1,\n};\n\nfunction PeakPointer() {\n  const {\n    height,\n    width,\n    margin,\n    activeSpectrum,\n    data,\n    mode,\n    selectedTool,\n    verticalAlign,\n  } = useChartData();\n  const { scaleX, scaleY } = useScale();\n\n  let position = useContext(MouseContext);\n  const brushState = useContext(BrushContext);\n  const [closePeakPosition, setPosition] = useState();\n\n  useEffect(() => {\n    function getVerticalAlign() {\n      if (activeSpectrum) {\n        return verticalAlign.flag\n          ? verticalAlign.stacked\n            ? (activeSpectrum.index + 1) * verticalAlign.value\n            : 0\n          : 0;\n      }\n      return 0;\n    }\n\n    const getClosePeak = (xShift, mouseCoordinates) => {\n      if (\n        activeSpectrum &&\n        position &&\n        selectedTool === options.peakPicking.id\n      ) {\n        const range = [\n          scaleX().invert(mouseCoordinates.x - xShift),\n          scaleX().invert(mouseCoordinates.x + xShift),\n        ].sort(function (a, b) {\n          return a - b;\n        });\n\n        //get the active sepectrum data by looking for it by id\n        const spectrumData = data.find((d) => d.id === activeSpectrum.id);\n\n        const maxIndex =\n          spectrumData.data.x.findIndex((number) => number >= range[1]) - 1;\n        const minIndex = spectrumData.data.x.findIndex(\n          (number) => number >= range[0],\n        );\n\n        const yDataRange = spectrumData.data.y.slice(minIndex, maxIndex);\n        if (yDataRange && yDataRange.length > 0) {\n          const yValue = max(yDataRange);\n          const xIndex = yDataRange.findIndex((value) => value === yValue);\n          const xValue = spectrumData.data.x[minIndex + xIndex];\n          return {\n            x: scaleX()(xValue),\n            y: scaleY(activeSpectrum.id)(yValue) - getVerticalAlign(),\n            xIndex: minIndex + xIndex,\n          };\n        }\n      }\n      return null;\n    };\n\n    const candidatePeakPosition = getClosePeak(10, position);\n    setPosition(candidatePeakPosition);\n  }, [\n    activeSpectrum,\n    data,\n    mode,\n    position,\n    scaleX,\n    scaleY,\n    selectedTool,\n    verticalAlign,\n  ]);\n\n  if (\n    selectedTool !== options.peakPicking.id ||\n    !closePeakPosition ||\n    !activeSpectrum ||\n    brushState.step === 'brushing' ||\n    !position ||\n    position.y < margin.top ||\n    position.left < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return null;\n  }\n\n  return (\n    <div\n      key=\"peakPointer\"\n      style={{\n        cursor: 'crosshair',\n        transform: `translate(${closePeakPosition.x}px, ${closePeakPosition.y}px)`,\n        transformOrigin: 'top left',\n        position: 'absolute',\n        top: -(styles.radius + styles.SVGPadding),\n        left: -(styles.radius + styles.SVGPadding),\n        pointerEvents: 'none',\n        overflow: 'visible',\n      }}\n    >\n      <svg\n        width={styles.radius * 2 + styles.SVGPadding * 2}\n        height={styles.radius * 2 + styles.SVGPadding * 2}\n      >\n        <circle\n          cx={styles.radius + styles.SVGPadding}\n          cy={styles.radius + styles.SVGPadding}\n          r={styles.radius}\n          stroke={styles.borderColor}\n          strokeWidth={styles.strokeWidth}\n          fillOpacity={styles.fillOpacity}\n        />\n        <line\n          x1={styles.radius + styles.SVGPadding}\n          y1={styles.SVGPadding}\n          x2={styles.radius + styles.SVGPadding}\n          y2={styles.radius * 2 + styles.SVGPadding}\n          stroke={styles.borderColor}\n          strokeWidth={styles.strokeWidth}\n        />\n        <line\n          x1={styles.SVGPadding}\n          y1={styles.radius + styles.SVGPadding}\n          x2={styles.radius * 2 + styles.SVGPadding}\n          y2={styles.radius + styles.SVGPadding}\n          stroke={styles.borderColor}\n          strokeWidth={styles.strokeWidth}\n        />\n      </svg>\n    </div>\n  );\n}\n\nexport default PeakPointer;\n","import { useChartData } from '../../context/ChartContext';\nimport { useScale } from '../../context/ScaleContext';\nimport { options } from '../../toolbar/ToolTypes';\n\nconst styles = {\n  container: {\n    transformOrigin: 'top left',\n    position: 'absolute',\n    top: '0px',\n    left: '0px',\n    width: 1,\n    backgroundColor: 'red',\n  },\n};\n\nfunction VerticalIndicator() {\n  const { height, selectedTool, pivot } = useChartData();\n  const { scaleX } = useScale();\n\n  if (options.phaseCorrection.id !== selectedTool) return null;\n  return (\n    <div\n      style={{\n        ...styles.container,\n        transform: `translate(${scaleX()(pivot)}px, 0px)`,\n        height: height,\n      }}\n    />\n  );\n}\n\nexport default VerticalIndicator;\n","import { useContext, useCallback, useMemo } from 'react';\n\nimport { BrushContext } from '../../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../context/ChartContext';\nimport { useScale } from '../../context/ScaleContext';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\n\nconst style = {\n  cursor: 'crosshair',\n  transformOrigin: 'bottom right',\n  position: 'absolute',\n  top: '-18px',\n  left: '-30px',\n  pointerEvents: 'none',\n  overflow: 'visible',\n  userSelect: 'none',\n};\n\nfunction XLabelPointer() {\n  const { height, width, margin, data, activeSpectrum } = useChartData();\n  const { scaleX } = useScale();\n\n  const position = useContext(MouseContext);\n  const brushState = useContext(BrushContext);\n  const activeSpectrumData = useMemo(() => {\n    const spectrumData = activeSpectrum\n      ? data.find((d) => d.id === activeSpectrum.id)\n      : null;\n    return spectrumData;\n  }, [activeSpectrum, data]);\n  const format = useFormatNumberByNucleus(\n    activeSpectrumData && activeSpectrumData.info.nucleus,\n  );\n\n  const getXValue = useCallback(\n    (xVal) => {\n      if (activeSpectrumData) {\n        const xInvert = scaleX().invert(xVal);\n        return format(xInvert);\n      }\n    },\n    [activeSpectrumData, format, scaleX],\n  );\n\n  if (\n    !activeSpectrum ||\n    brushState.step === 'brushing' ||\n    !position ||\n    position.y < margin.top ||\n    position.x < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return null;\n  }\n  return (\n    <div\n      key=\"xLabelPointer\"\n      style={{\n        ...style,\n        transform: `translate(${position.x}px, ${position.y}px)`,\n      }}\n    >\n      <span>{getXValue(position.x)}</span>\n    </div>\n  );\n}\n\nexport default XLabelPointer;\n","import { useCallback, Fragment, useEffect, useState, useReducer } from 'react';\nimport { useSize, useDebounce } from 'react-use';\n\nimport { BrushTracker } from '../EventsTrackers/BrushTracker';\nimport { MouseTracker } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport { ScaleProvider } from '../context/ScaleContext';\nimport { useModal } from '../elements/popup/Modal';\nimport Spinner from '../loader/Spinner';\nimport MultipletAnalysisModal from '../modal/MultipletAnalysisModal';\nimport { ZoomType } from '../reducer/actions/Zoom';\nimport {\n  scaleInitialState,\n  scaleReducer,\n  SET_SCALE,\n} from '../reducer/scaleReducer';\nimport {\n  ADD_INTEGRAL,\n  ADD_PEAKS,\n  ADD_BASE_LINE_ZONE,\n  BRUSH_END,\n  FULL_ZOOM_OUT,\n  CHANGE_INTEGRAL_ZOOM,\n  SET_ZOOM_FACTOR,\n  ADD_PEAK,\n  SET_VERTICAL_INDICATOR_X_POSITION,\n  SET_DIMENSIONS,\n  ADD_RANGE,\n  ANALYZE_SPECTRA,\n  ADD_EXCLUSION_ZONE,\n} from '../reducer/types/Types';\nimport BrushXY, { BRUSH_TYPE } from '../tool/BrushXY';\nimport CrossLinePointer from '../tool/CrossLinePointer';\nimport { options } from '../toolbar/ToolTypes';\nimport Events from '../utility/Events';\n\nimport Chart1D from './Chart1D';\nimport FooterBanner from './FooterBanner';\nimport SpectraTracker from './SpectraTracker';\nimport PeakPointer from './tool/PeakPointer';\nimport VerticalIndicator from './tool/VerticalIndicator';\nimport XLabelPointer from './tool/XLabelPointer';\n\nfunction Viewer1D({ emptyText = undefined }) {\n  const {\n    display: { general },\n  } = usePreferences();\n  const state = useChartData();\n  const {\n    selectedTool,\n    isLoading,\n    data,\n    mode,\n    width: widthProp,\n    height: heightProp,\n    margin,\n    activeSpectrum,\n    xDomain,\n    xDomains,\n    yDomain,\n    yDomains,\n    verticalAlign,\n    displayerKey,\n  } = state;\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const [scaleState, dispatchScale] = useReducer(\n    scaleReducer,\n    scaleInitialState,\n  );\n\n  useEffect(() => {\n    if (xDomain.length > 0 && yDomain.length > 0 && widthProp && heightProp) {\n      dispatchScale({\n        type: SET_SCALE,\n        payload: {\n          yDomain,\n          yDomains,\n          xDomain,\n          xDomains,\n          margin,\n          height: heightProp,\n          width: widthProp,\n          verticalAlign,\n          mode,\n        },\n      });\n    }\n  }, [\n    heightProp,\n    margin,\n    mode,\n    verticalAlign,\n    widthProp,\n    xDomain,\n    xDomains,\n    yDomain,\n    yDomains,\n  ]);\n\n  const handelBrushEnd = useCallback(\n    (brushData) => {\n      const propagateEvent = () => {\n        const { startX, endX } = brushData;\n        const startXPPM = scaleState.scaleX().invert(startX);\n        const endXPPM = scaleState.scaleX().invert(endX);\n        Events.emit('brushEnd', {\n          ...brushData,\n          range: [startXPPM, endXPPM].sort(),\n        });\n      };\n\n      if (brushData.altKey) {\n        switch (selectedTool) {\n          case options.rangesPicking.id: {\n            if (!general.disableMultipletAnalysis) {\n              modal.show(\n                <MultipletAnalysisModal\n                  data={data}\n                  activeSpectrum={activeSpectrum}\n                  scaleX={scaleState.scaleX}\n                  {...brushData}\n                />,\n                {\n                  onClose: () => {\n                    modal.close();\n                  },\n                },\n              );\n            }\n            break;\n          }\n          default:\n            break;\n        }\n      } else if (brushData.shiftKey) {\n        switch (selectedTool) {\n          case options.integral.id:\n            dispatch({\n              type: ADD_INTEGRAL,\n              ...brushData,\n            });\n            break;\n          case options.rangesPicking.id:\n            dispatch({\n              type: ADD_RANGE,\n              ...brushData,\n            });\n            break;\n          case options.multipleSpectraAnalysis.id:\n            dispatch({\n              type: ANALYZE_SPECTRA,\n              ...brushData,\n            });\n            break;\n\n          case options.peakPicking.id:\n            dispatch({\n              type: ADD_PEAKS,\n              ...brushData,\n            });\n            break;\n\n          case options.baseLineCorrection.id:\n            dispatch({\n              type: ADD_BASE_LINE_ZONE,\n              zone: { from: brushData.startX, to: brushData.endX },\n            });\n            break;\n\n          case options.exclusionZones.id:\n            dispatch({\n              type: ADD_EXCLUSION_ZONE,\n              payload: { from: brushData.startX, to: brushData.endX },\n            });\n            break;\n\n          default:\n            propagateEvent(brushData);\n\n            break;\n        }\n      } else {\n        switch (selectedTool) {\n          default:\n            if (selectedTool != null) {\n              dispatch({ type: BRUSH_END, ...brushData });\n            }\n            break;\n        }\n      }\n    },\n    [scaleState, selectedTool, general, modal, data, activeSpectrum, dispatch],\n  );\n\n  const handelOnDoubleClick = useCallback(() => {\n    dispatch({ type: FULL_ZOOM_OUT, zoomType: ZoomType.STEP_HROZENTAL });\n  }, [dispatch]);\n\n  const handleZoom = useCallback(\n    (event) => {\n      switch (selectedTool) {\n        case options.integral.id:\n          dispatch({ type: CHANGE_INTEGRAL_ZOOM, ...event });\n          break;\n\n        default:\n          dispatch({ type: SET_ZOOM_FACTOR, ...event });\n\n          return;\n      }\n    },\n    [dispatch, selectedTool],\n  );\n\n  const mouseClick = useCallback(\n    (position) => {\n      const propagateEvent = () => {\n        const xPPM = scaleState.scaleX().invert(position.x);\n        Events.emit('mouseClick', {\n          ...position,\n          xPPM,\n        });\n      };\n\n      if (position.shiftKey) {\n        switch (selectedTool) {\n          case options.peakPicking.id:\n            dispatch({\n              type: ADD_PEAK,\n              mouseCoordinates: position,\n            });\n            break;\n          default:\n            break;\n        }\n      } else {\n        switch (selectedTool) {\n          case options.phaseCorrection.id:\n            dispatch({\n              type: SET_VERTICAL_INDICATOR_X_POSITION,\n              position: position.x,\n            });\n            break;\n          case 'editRange':\n            if (position.shiftKey) {\n              propagateEvent();\n            }\n            break;\n\n          default:\n        }\n      }\n    },\n    [dispatch, scaleState, selectedTool],\n  );\n\n  const [sizedNMRChart, { width, height }] = useSize(() => {\n    return (\n      <Fragment>\n        <Spinner isLoading={isLoading} emptyText={emptyText} />\n\n        {scaleState.scaleX && scaleState.scaleY && data && data.length > 0 && (\n          <BrushTracker\n            onBrush={handelBrushEnd}\n            onDoubleClick={handelOnDoubleClick}\n            onClick={mouseClick}\n            onZoom={handleZoom}\n            style={{\n              width: '100%',\n              height: '100%',\n              margin: 'auto',\n              position: 'relative',\n              overflow: 'hidden',\n            }}\n          >\n            <MouseTracker\n              style={{ width: '100%', height: `100%`, position: 'absolute' }}\n            >\n              <SpectraTracker />\n              <CrossLinePointer />\n              <BrushXY brushType={BRUSH_TYPE.X} />\n              <XLabelPointer />\n              <PeakPointer />\n              <VerticalIndicator />\n              <FooterBanner />\n              <Chart1D\n                width={widthProp}\n                height={heightProp}\n                margin={margin}\n                mode={mode}\n                displayerKey={displayerKey}\n              />\n            </MouseTracker>\n          </BrushTracker>\n        )}\n      </Fragment>\n    );\n  }, []);\n\n  const [finalSize, setFinalSize] = useState();\n  useDebounce(() => setFinalSize({ width, height }), 400, [width, height]);\n  useEffect(() => {\n    if (finalSize && isFinite(finalSize.width) && isFinite(finalSize.height)) {\n      dispatch({\n        type: SET_DIMENSIONS,\n        ...finalSize,\n      });\n    }\n  }, [dispatch, finalSize]);\n\n  return <ScaleProvider value={scaleState}>{sizedNMRChart}</ScaleProvider>;\n}\n\nexport default Viewer1D;\n","import { useChartData } from '../context/ChartContext';\n\nfunction ContoursWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const { data, displayerKey } = useChartData();\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        data={data}\n        displayerKey={displayerKey}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return (props) => {\n    return <Wrapper {...props} />;\n  };\n}\nexport default ContoursWrapper;\n","const LAYOUT = {\n  TOP_1D: 'TOP_1D',\n  LEFT_1D: 'LEFT_1D',\n  CENTER_2D: 'CENTER_2D',\n};\n\nfunction get2DDimensionLayout({ width, height, margin }) {\n  return {\n    CENTER_2D: {\n      startX: margin.left,\n      startY: margin.top,\n      endX: width - margin.right,\n      endY: height - margin.bottom,\n    },\n    TOP_1D: {\n      startX: margin.left,\n      startY: 0,\n      endX: width - margin.right,\n      endY: margin.top,\n    },\n    LEFT_1D: {\n      startX: 0,\n      startY: margin.top,\n      endX: margin.left,\n      endY: height - margin.bottom,\n    },\n  };\n}\n\nfunction getLayoutID(dimension, brushData) {\n  for (const key of Object.keys(dimension)) {\n    if (\n      brushData.startX >= dimension[key].startX &&\n      brushData.startX <= dimension[key].endX &&\n      brushData.startY >= dimension[key].startY &&\n      brushData.startY <= dimension[key].endY\n    ) {\n      return key;\n    }\n  }\n  return null;\n}\n\nexport { LAYOUT, get2DDimensionLayout, getLayoutID };\n","import { scaleLinear } from 'd3';\n\nimport { LAYOUT } from './DimensionLayout';\n\n/***\n * @param {object} props\n * @param {number}  props.width\n * @param {number}  props.margin\n * @param {number}  props.xDomain\n */\n\nfunction get2DXScale(props) {\n  const { width, margin, xDomain } = props;\n  return scaleLinear(xDomain, [width - margin.right, margin.left]);\n}\n\n/***\n * props {height,margin,yDomain}\n */\n/***\n * @param {any} props\n * @param {number}  props.height\n * @param {number}  props.margin\n * @param {number}  props.yDomain\n */\nfunction get2DYScale(props, reverse = false) {\n  const { height, margin, yDomain } = props;\n  return scaleLinear(\n    yDomain,\n    reverse\n      ? [height - margin.bottom, margin.top]\n      : [margin.top, height - margin.bottom],\n  );\n}\n\nfunction get1DXScale(props, layout) {\n  if (![LAYOUT.TOP_1D, LAYOUT.LEFT_1D].includes(layout)) {\n    throw new Error(\n      `layout is required and must be ${LAYOUT.TOP_1D} or ${LAYOUT.LEFT_1D}  `,\n    );\n  }\n\n  switch (layout) {\n    case LAYOUT.TOP_1D: {\n      const { width, margin, xDomain } = props;\n      return scaleLinear(xDomain, [width - margin.right, margin.left]);\n    }\n    case LAYOUT.LEFT_1D: {\n      const { height, margin, yDomain } = props;\n      return scaleLinear(yDomain, [height - margin.bottom, margin.top]);\n    }\n    default:\n      break;\n  }\n}\n\nfunction get1DYScale(yDomain, height, margin = 10) {\n  return scaleLinear(yDomain, [height - margin, margin]);\n}\n\nexport { get2DXScale, get2DYScale, get1DXScale, get1DYScale };\n","import get from 'lodash/get';\nimport { memo, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport ContoursWrapper from '../hoc/ContoursWrapper';\n\nimport { get2DXScale, get2DYScale } from './utilities/scale';\n\nfunction ContoursPaths({ id: spectrumID, sign, color }) {\n  const {\n    margin,\n    width,\n    height,\n    xDomain,\n    yDomain,\n    contours,\n    activeSpectrum,\n  } = useChartData();\n\n  const preferences = usePreferences();\n\n  const isActive = useMemo(() => {\n    return activeSpectrum === null\n      ? true\n      : spectrumID === activeSpectrum.id\n      ? true\n      : false;\n  }, [activeSpectrum, spectrumID]);\n\n  function buildContourPath(data) {\n    const _scaleX = get2DXScale({ margin, width, xDomain });\n    const _scaleY = get2DYScale({ margin, height, yDomain });\n    let path = '';\n    for (let i = 0; i < data.length; i++) {\n      if (data[i].lines) {\n        const lines = data[i].lines;\n        if (lines.length < 1e6) {\n          for (let i = 0; i < lines.length; i += 4) {\n            path += `M${_scaleX(lines[i])} ${_scaleY(lines[i + 1])} `;\n            path += `L${_scaleX(lines[i + 2])} ${_scaleY(lines[i + 3])} `;\n          }\n        }\n      } else {\n        path += `M${_scaleX(data[i][0].x)} ${_scaleY(data[i][0].y)} `;\n        for (let j = 1; j < data[i].length; j++) {\n          path += `L${_scaleX(data[i][j].x)} ${_scaleY(data[i][j].y)} `;\n        }\n      }\n    }\n    if (!path) path = 'M0 0 ';\n    path += 'Z';\n\n    return path;\n  }\n  const data = useMemo(() => {\n    return get(contours, `${spectrumID}.${sign}`, []);\n  }, [contours, sign, spectrumID]);\n  return (\n    <path\n      fill=\"none\"\n      stroke={color}\n      strokeWidth=\"1\"\n      style={{\n        opacity: isActive\n          ? 1\n          : get(preferences, 'controllers.dimmedSpectraTransparency', 0.1),\n      }}\n      d={buildContourPath(data)}\n    />\n  );\n}\n\nfunction Contours({ data, displayerKey }) {\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-2d)`} className=\"contours\">\n      {data\n        .filter((datum) => datum.info.dimension === 2)\n        .map((datum, index) => (\n          <g key={`${datum.id + index}`}>\n            {datum.display.isPositiveVisible && (\n              <ContoursPaths\n                id={datum.id}\n                sign=\"positive\"\n                color={datum.display.positiveColor}\n              />\n            )}\n            {datum.display.isNegativeVisible && (\n              <ContoursPaths\n                id={datum.id}\n                sign=\"negative\"\n                color={datum.display.negativeColor}\n              />\n            )}\n          </g>\n        ))}\n    </g>\n  );\n}\n\nexport default ContoursWrapper(memo(Contours));\n","export const DEFAULT_YAXIS_SHIFT_VALUE = 20;\n\nexport const DISPLAYER_MODE = {\n  DM_1D: '1D',\n  DM_2D: '2D',\n};\n\nexport const MARGIN = {\n  '2D': { top: 100, right: 50, bottom: 70, left: 100 },\n  '1D': {\n    top: 10,\n    right: 10,\n    bottom: 70,\n    left: 10,\n  },\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useState, useEffect, useMemo } from 'react';\n\nimport { SignalKindsToInclude } from '../../data/constants/SignalsKinds';\nimport { useChartData } from '../context/ChartContext';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\n\nimport { get2DXScale, get2DYScale } from './utilities/scale';\n\nconst lineStyle = css`\n  stroke: lightgrey;\n  opacity: 0.7;\n`;\n\nfunction IndicationLines({ axis, show }) {\n  const {\n    data,\n    activeTab,\n    margin,\n    width,\n    height,\n    xDomain,\n    yDomain,\n    displayerMode,\n  } = useChartData();\n  const [deltas1D, setDeltas1D] = useState([]);\n\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n\n  useEffect(() => {\n    const split = activeTab.split(',');\n    if (displayerMode === DISPLAYER_MODE.DM_2D && split.length === 2) {\n      const nucleus = axis === 'X' ? split[0] : axis === 'Y' ? split[1] : null;\n      if (nucleus !== null) {\n        const ranges = data\n          .filter(\n            (_datum) =>\n              _datum.info.dimension === 1 &&\n              _datum.display.isVisible === true &&\n              _datum.info.nucleus === nucleus &&\n              _datum.info.experiment === '1d',\n          )\n          .map((_datum) => _datum.ranges.values)\n          .flat();\n        const deltas = ranges\n          .map((_range) =>\n            _range.signal\n              .filter((_signal) =>\n                SignalKindsToInclude.some((_kind) => _signal.kind === _kind),\n              )\n              .map((_signal) => _signal.delta),\n          )\n          .flat();\n        setDeltas1D(deltas);\n      } else {\n        setDeltas1D([]);\n      }\n    } else {\n      setDeltas1D([]);\n    }\n  }, [activeTab, axis, data, displayerMode]);\n\n  const indicationLines = useMemo(() => {\n    if (show === true && deltas1D.length > 0) {\n      const lines = deltas1D.map((_delta, i) => {\n        return axis === 'X' ? (\n          <line\n            css={lineStyle}\n            // eslint-disable-next-line react/no-array-index-key\n            key={`indicationLine${axis}${i}`}\n            x1={scaleX(_delta)}\n            x2={scaleX(_delta)}\n            y1={scaleY(yDomain[0])}\n            y2={scaleY(yDomain[1])}\n          />\n        ) : axis === 'Y' ? (\n          <line\n            css={lineStyle}\n            // eslint-disable-next-line react/no-array-index-key\n            key={`indicationLine${axis}${i}`}\n            x1={scaleX(xDomain[0])}\n            x2={scaleX(xDomain[1])}\n            y1={scaleY(_delta)}\n            y2={scaleY(_delta)}\n          />\n        ) : null;\n      });\n      return lines;\n    }\n  }, [axis, deltas1D, scaleX, scaleY, show, xDomain, yDomain]);\n\n  return <g>{indicationLines}</g>;\n}\n\nexport default IndicationLines;\n","import { xyReduce } from 'ml-spectra-processing';\nimport { useMemo, memo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get1DYScale, get2DYScale } from './utilities/scale';\n\nfunction Left1DChart({ margin: marignValue, data: spectrum }) {\n  const {\n    height: originHeight,\n    margin,\n    yDomain,\n    yDomains,\n    displayerKey,\n  } = useChartData();\n\n  const height = margin.left;\n\n  const paths = useMemo(() => {\n    if (spectrum) {\n      const scaleX = get2DYScale({\n        height: originHeight,\n        yDomain: [yDomain[0], yDomain[1]],\n        margin,\n      });\n      const scaleY = get1DYScale(yDomains[spectrum.id], height, marignValue);\n\n      const { x, y } = spectrum.data;\n      const pathPoints = xyReduce(\n        { x, y },\n        {\n          from: yDomain[0],\n          to: yDomain[1],\n        },\n      );\n      const lastXIndex = pathPoints.x.length - 1;\n      const lastYIndex = pathPoints.y.length - 1;\n      let path = `M  ${scaleY(pathPoints.y[lastYIndex])} ${scaleX(\n        lastXIndex,\n      )} `;\n      path += pathPoints.x\n        .slice(0, lastXIndex)\n        .reduceRight((accumulator, point, index) => {\n          accumulator += ` L  ${scaleY(pathPoints.y[index])} ${scaleX(point)}`;\n          return accumulator;\n        }, '');\n      return path;\n    } else {\n      return null;\n    }\n  }, [height, margin, marignValue, originHeight, spectrum, yDomain, yDomains]);\n\n  const mainHeight = originHeight - margin.bottom - margin.top;\n\n  if (!mainHeight || !height) return null;\n\n  return (\n    <svg\n      viewBox={`0 0 ${height} ${mainHeight + margin.top}`}\n      width={height}\n      height={mainHeight + margin.top}\n    >\n      <defs>\n        <clipPath id={`${displayerKey}clip-left`}>\n          <rect width={height} height={mainHeight} x=\"0\" y={margin.top} />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-left)`}>\n        <path className=\"line\" stroke=\"black\" fill=\"none\" d={paths} />\n      </g>\n    </svg>\n  );\n}\n\nLeft1DChart.defaultProps = {\n  margin: 10,\n};\n\nexport default memo(Left1DChart);\n","import { xyReduce } from 'ml-spectra-processing';\nimport { useMemo, memo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get1DYScale, get2DXScale } from './utilities/scale';\n\nfunction Top1DChart({ margin: marginProps, data: spectrum }) {\n  const {\n    width,\n    margin: originMargin,\n    xDomain,\n    yDomains,\n    displayerKey,\n  } = useChartData();\n\n  const height = originMargin.top;\n\n  const paths = useMemo(() => {\n    if (spectrum) {\n      const scaleX = get2DXScale({ width, xDomain, margin: originMargin });\n\n      const scaleY = get1DYScale(yDomains[spectrum.id], height, marginProps);\n\n      const { x, y } = spectrum.data;\n      const pathPoints = xyReduce(\n        { x, y },\n        {\n          from: xDomain[0],\n          to: xDomain[1],\n        },\n      );\n\n      let path = `M ${scaleX(pathPoints.x[0])} ${scaleY(pathPoints.y[0])} `;\n      path += pathPoints.x.slice(1).reduce((accumulator, point, i) => {\n        accumulator += ` L ${scaleX(point)} ${scaleY(pathPoints.y[i + 1])}`;\n        return accumulator;\n      }, '');\n      return path;\n    } else {\n      return null;\n    }\n  }, [height, marginProps, originMargin, spectrum, width, xDomain, yDomains]);\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return (\n    <svg viewBox={`0 0 ${width} ${height}`} width={width} height={height}>\n      <defs>\n        <clipPath id={`${displayerKey}clip-top`}>\n          <rect\n            width={width - originMargin.left - originMargin.right}\n            height={height}\n            x={originMargin.left}\n            y={`${0}`}\n          />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-top)`}>\n        <path\n          className=\"line\"\n          stroke=\"red\"\n          fill=\"none\"\n          strokeWidth=\"1px\"\n          d={paths}\n        />\n      </g>\n    </svg>\n  );\n}\n\nTop1DChart.defaultProps = {\n  margin: 10,\n};\n\nexport default memo(Top1DChart);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport * as d3 from 'd3';\nimport PropTypes from 'prop-types';\nimport { useEffect, useRef, useMemo, memo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get2DXScale } from './utilities/scale';\n\nconst axisStyles = css`\n  user-select: none;\n\n  path,\n  line {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    shape-rendering: crispEdges;\n    user-select: none;\n  }\n`;\n\nfunction XAxis({ show, label, margin: marginProps }) {\n  const state = useChartData();\n  const {\n    xDomain,\n    height,\n    width,\n    margin,\n    tabActiveSpectrum,\n    activeTab,\n  } = state;\n\n  const refAxis = useRef();\n\n  useEffect(() => {\n    const xAxis = d3.axisBottom().ticks(8).tickFormat(d3.format('0'));\n\n    if (show) {\n      const scaleX = get2DXScale({ width, margin, xDomain });\n      d3.select(refAxis.current).call(xAxis.scale(scaleX));\n    }\n  }, [\n    activeTab,\n    height,\n    margin,\n    margin.bottom,\n    margin.left,\n    margin.right,\n    margin.top,\n    show,\n    tabActiveSpectrum,\n    width,\n    xDomain,\n  ]);\n\n  const Axis = useMemo(\n    () =>\n      show &&\n      show === true && (\n        <g\n          className=\"x\"\n          css={axisStyles}\n          transform={`translate(0,${\n            height - (margin.bottom + marginProps.bottom)\n          })`}\n          ref={refAxis}\n        >\n          <text fill=\"#000\" x={width - 60} y=\"20\" dy=\"0.71em\" textAnchor=\"end\">\n            {label}\n          </text>\n        </g>\n      ),\n\n    [height, label, margin.bottom, marginProps.bottom, show, width],\n  );\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return Axis;\n}\n\nXAxis.propTypes = {\n  margin: PropTypes.shape({\n    top: PropTypes.number.isRequired,\n    right: PropTypes.number.isRequired,\n    bottom: PropTypes.number.isRequired,\n    left: PropTypes.number.isRequired,\n  }),\n  show: PropTypes.bool,\n  label: PropTypes.string,\n};\n\nXAxis.defaultProps = {\n  show: true,\n  label: 'δ [ppm]',\n  margin: { right: 100, top: 0, left: 0, bottom: 0 },\n};\n\nexport default memo(XAxis);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport * as d3 from 'd3';\nimport { Fragment, useEffect, useRef, useMemo, memo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get2DYScale } from './utilities/scale';\n\nconst axisStyles = css`\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  path,\n  line {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    shape-rendering: crispEdges;\n    user-select: 'none';\n    -webkit-user-select: none; /* Chrome all / Safari all */\n    -moz-user-select: none; /* Firefox all */\n  }\n`;\n\nfunction YAxis({ show, label, margin: marginProps }) {\n  const refAxis = useRef();\n  const state = useChartData();\n  const {\n    yDomain,\n    width,\n    height,\n    activeTab,\n    tabActiveSpectrum,\n    margin,\n  } = state;\n\n  useEffect(() => {\n    const axis = d3.axisRight().ticks(8).tickFormat(d3.format('0'));\n\n    if (show && yDomain) {\n      const scaleY = get2DYScale({ height, yDomain, margin });\n\n      d3.select(refAxis.current).call(axis.scale(scaleY));\n    }\n  }, [show, yDomain, activeTab, tabActiveSpectrum, height, margin]);\n\n  const Axis = useMemo(\n    () =>\n      show &&\n      show === true && (\n        <Fragment>\n          <g\n            className=\"y\"\n            css={axisStyles}\n            transform={`translate(${width - marginProps.right})`}\n            ref={refAxis}\n          >\n            <text\n              fill=\"#000\"\n              x={-marginProps.top}\n              y={-(marginProps.right - 5)}\n              dy=\"0.71em\"\n              transform=\"rotate(-90)\"\n              textAnchor=\"end\"\n            >\n              {label}\n            </text>\n          </g>\n        </Fragment>\n      ),\n\n    [label, marginProps.right, marginProps.top, show, width],\n  );\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return Axis;\n}\n\nYAxis.defaultProps = {\n  show: true,\n  label: '',\n  margin: { right: 50, top: 0, bottom: 0, left: 0 },\n};\n\nexport default memo(YAxis);\n","import { useMemo, memo, forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\n\nfunction ZonesWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      data,\n      activeSpectrum,\n      xDomain,\n      yDomain,\n      activeTab,\n      tabActiveSpectrum,\n      displayerKey,\n    } = useChartData();\n    const preferences = usePreferences();\n\n    const { zones = {}, info = {}, display = {} } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const datum = data.find((datum) => datum.id === activeSpectrum.id) || {\n          zones: {},\n          info: {},\n          display: {},\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, data]);\n\n    const nucleus = useMemo(() => {\n      if (tabActiveSpectrum && Object.keys(tabActiveSpectrum).length > 0) {\n        return Object.keys(tabActiveSpectrum);\n      }\n      return null;\n    }, [tabActiveSpectrum]);\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        zones={zones}\n        display={display}\n        info={info}\n        xDomain={xDomain}\n        yDomain={yDomain}\n        preferences={preferences}\n        activeTab={activeTab}\n        nucleus={nucleus}\n        displayerKey={displayerKey}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return memo(\n    forwardRef((props, ref) => {\n      return <Wrapper {...props} forwardedRef={ref} />;\n    }),\n  );\n}\nexport default ZonesWrapper;\n","import { DatumKind } from '../constants/SignalsKinds';\n\nconst getDiaIDs = (zone, axis) => {\n  return [].concat(\n    zone[axis].diaID || [],\n    zone.signal\n      ? zone.signal.map((_signal) => _signal[axis].diaID || []).flat()\n      : [],\n  );\n};\n\nconst getPubIntegral = (zone, axis) => {\n  return getDiaIDs(zone, axis).length;\n};\n\nconst setPubIntegral = (zone, axis) => {\n  zone[axis].pubIntegral = getPubIntegral(zone, axis);\n  if (zone[axis].pubIntegral === 0) {\n    delete zone[axis].pubIntegral;\n  }\n};\n\nconst resetDiaIDs = (zone, axis) => {\n  delete zone[axis].diaID;\n  delete zone.pubIntegral;\n  zone.signal.forEach((_signal) => {\n    delete _signal[axis].diaID;\n  });\n  return zone;\n};\n\nconst checkZoneKind = (zone) => {\n  return zone.kind === DatumKind.signal;\n};\n\nconst checkSignalKinds = (zone, kinds) => {\n  return !zone.signal.some(\n    (_signal) => _signal.kind === undefined || !kinds.includes(_signal.kind),\n  );\n};\n\nconst unlink = (zone, isOnZoneLevel, signalIndex, axis) => {\n  if (isOnZoneLevel !== undefined && axis !== undefined) {\n    if (isOnZoneLevel === true) {\n      delete zone[axis].diaID;\n    } else if (signalIndex !== undefined) {\n      delete zone.signal[signalIndex][axis].diaID;\n    }\n    setPubIntegral(zone, axis);\n  } else if (axis !== undefined) {\n    resetDiaIDs(zone, axis);\n    setPubIntegral(zone, axis);\n  } else {\n    ['x', 'y'].forEach((key) => {\n      resetDiaIDs(zone, key);\n      setPubIntegral(zone, key);\n    });\n  }\n  return zone;\n};\n\nconst unlinkInAssignmentData = (assignmentData, zones, axis) => {\n  const ids = zones.reduce((acc, zone) => {\n    acc.push(zone.id);\n    if (zone.signal) {\n      acc.concat(zone.signal.map((signal) => signal.id, []));\n    }\n    return acc;\n  }, []);\n\n  if (axis) {\n    assignmentData.dispatch({\n      type: 'REMOVE_ALL',\n      payload: { id: ids, axis },\n    });\n  } else {\n    assignmentData.dispatch({\n      type: 'REMOVE_ALL',\n      payload: { id: ids, axis: 'x' },\n    });\n    assignmentData.dispatch({\n      type: 'REMOVE_ALL',\n      payload: { id: ids, axis: 'y' },\n    });\n  }\n};\n\nexport {\n  checkSignalKinds,\n  checkZoneKind,\n  getDiaIDs,\n  getPubIntegral,\n  resetDiaIDs,\n  unlink,\n  unlinkInAssignmentData,\n};\n","const ConcatenationString = '___';\n\nconst buildID = (prefix, suffix) => {\n  return `${prefix}${ConcatenationString}${suffix}`;\n};\n\nexport { buildID, ConcatenationString };\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get2DXScale, get2DYScale } from './utilities/scale';\n\nconst lineStyle = css`\n  stroke: green;\n  stroke-width: 2;\n  opacity: 0.5;\n`;\n\nfunction SignalDeltaLine({ delta, axis, show }) {\n  const { margin, width, height, xDomain, yDomain } = useChartData();\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n\n  const line = useMemo(() => {\n    return show === true ? (\n      axis === 'X' ? (\n        <line\n          css={lineStyle}\n          key={`signalLine_${delta}_X`}\n          x1={scaleX(delta)}\n          x2={scaleX(delta)}\n          y1={scaleY(yDomain[0])}\n          y2={scaleY(yDomain[1])}\n        />\n      ) : axis === 'Y' ? (\n        <line\n          css={lineStyle}\n          key={`signalLine_${delta}_Y`}\n          x1={scaleX(xDomain[0])}\n          x2={scaleX(xDomain[1])}\n          y1={scaleY(delta)}\n          y2={scaleY(delta)}\n        />\n      ) : null\n    ) : null;\n  }, [axis, delta, scaleX, scaleY, show, xDomain, yDomain]);\n\n  return <g>{line}</g>;\n}\n\nexport default SignalDeltaLine;\n","/** @jsxImportSource @emotion/react */\n\nimport { useMemo } from 'react';\n\nimport { buildID } from '../../../data/utilities/Concatenation';\nimport { useHighlight } from '../../highlight';\nimport SignalDeltaLine from '../SignalDeltaLine';\n\nfunction SignalCrosshair({ signal }) {\n  const highlightIDsX = useMemo(() => {\n    return [buildID(signal.id, 'Crosshair'), buildID(signal.id, 'Crosshair_X')];\n  }, [signal.id]);\n  const highlightIDsY = useMemo(() => {\n    return [buildID(signal.id, 'Crosshair'), buildID(signal.id, 'Crosshair_Y')];\n  }, [signal.id]);\n  const highlightX = useHighlight(highlightIDsX);\n  const highlightY = useHighlight(highlightIDsY);\n\n  return (\n    <g>\n      <SignalDeltaLine\n        delta={signal.x.delta}\n        axis=\"X\"\n        show={highlightX.isActive}\n      />\n      <SignalDeltaLine\n        delta={signal.y.delta}\n        axis=\"Y\"\n        show={highlightY.isActive}\n      />\n    </g>\n  );\n}\n\nexport default SignalCrosshair;\n","/** @jsxImportSource @emotion/react */\n\nimport { memo, useState, useEffect, useCallback } from 'react';\n\nimport { buildID } from '../../../data/utilities/Concatenation';\nimport { useAssignment } from '../../assignment';\nimport { useChartData } from '../../context/ChartContext';\nimport { useHighlightData, useHighlight } from '../../highlight';\nimport { get2DXScale, get2DYScale } from '../utilities/scale';\n\nimport SignalCrosshair from './SignalCrosshair';\n\nconst Signal = memo(({ signal, isVisible }) => {\n  const { margin, width, height, xDomain, yDomain } = useChartData();\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n\n  const buildIDs = useCallback((id) => {\n    return [id].concat(buildID(id, 'X'), buildID(id, 'Y'));\n  }, []);\n\n  const assignment = useAssignment(signal.id);\n  const highlight = useHighlight(buildIDs(assignment.id));\n  const highlightData = useHighlightData();\n\n  const [isHighlighted, setIsHighlighted] = useState(false);\n\n  useEffect(() => {\n    if (\n      highlightData.highlight.highlighted.some((_highlighted) =>\n        buildIDs(signal.id).includes(_highlighted),\n      ) ||\n      assignment.isActive\n    ) {\n      setIsHighlighted(true);\n    } else {\n      setIsHighlighted(false);\n    }\n  }, [\n    assignment.isActive,\n    buildIDs,\n    highlightData.highlight.highlighted,\n    signal.id,\n  ]);\n\n  if (!signal) return null;\n\n  return (\n    <g\n      className=\"zone-signal\"\n      onMouseEnter={() => {\n        assignment.onMouseEnter();\n        highlight.show();\n      }}\n      onMouseLeave={() => {\n        assignment.onMouseLeave();\n        highlight.hide();\n      }}\n    >\n      {isVisible.signals && (\n        <g>\n          <circle\n            key={signal.id}\n            cx={scaleX(signal.x.delta)}\n            cy={scaleY(signal.y.delta)}\n            r={isHighlighted ? 6 : 4}\n            fill={isHighlighted ? 'green' : 'darkgreen'}\n          />\n          <SignalCrosshair signal={signal} />\n        </g>\n      )}\n      <g className=\"zone-signal-peak\">\n        {isVisible.peaks &&\n          signal.peak.map((peak, i) => (\n            <circle\n              key={`${signal.id + i}`}\n              cx={scaleX(peak.x)}\n              cy={scaleY(peak.y)}\n              r={2}\n              fill=\"black\"\n            />\n          ))}\n      </g>\n    </g>\n  );\n});\n\nexport default Signal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useState, useEffect } from 'react';\n\nimport { checkZoneKind } from '../../../data/utilities/ZoneUtilities';\nimport { useAssignment } from '../../assignment';\nimport { useChartData } from '../../context/ChartContext';\nimport { TYPES, useHighlight } from '../../highlight';\nimport { get2DXScale, get2DYScale } from '../utilities/scale';\n\nimport Signal from './Signal';\n\nconst stylesOnHover = css`\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  // // disabled because Resizable component appears now when hovering over it\n  // :hover .range-area {\n  //   height: 100%;\n  //   fill: #ff6f0057;\n  //   cursor: pointer;\n  // }\n\n  .delete-button {\n    visibility: hidden;\n  }\n`;\n\nconst stylesHighlighted = css`\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  .Integral-area {\n    // height: 100%;\n    fill: #ff6f0057;\n  }\n  .delete-button {\n    visibility: visible;\n    cursor: pointer;\n  }\n`;\n\nconst Zone = ({ zoneData, isVisible }) => {\n  const { x, y, id, signal } = zoneData;\n  const assignmentZone = useAssignment(id);\n  const highlightZone = useHighlight([assignmentZone.id], TYPES.ZONE);\n  const { margin, width, height, xDomain, yDomain } = useChartData();\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n  const { from: x1, to: x2 } = x;\n  const { from: y1, to: y2 } = y;\n\n  const [reduceOpacity, setReduceOpacity] = useState(false);\n\n  useEffect(() => {\n    setReduceOpacity(!checkZoneKind(zoneData));\n  }, [zoneData]);\n\n  return (\n    <g\n      css={\n        highlightZone.isActive || assignmentZone.isActive\n          ? stylesHighlighted\n          : stylesOnHover\n      }\n      key={id}\n      onMouseEnter={() => {\n        assignmentZone.onMouseEnter();\n        highlightZone.show();\n      }}\n      onMouseLeave={() => {\n        assignmentZone.onMouseLeave();\n        highlightZone.hide();\n      }}\n    >\n      {isVisible.zones && (\n        <g transform={`translate(${scaleX(x2)},${scaleY(y1)})`}>\n          <rect\n            x=\"0\"\n            width={scaleX(x1) - scaleX(x2)}\n            height={scaleY(y2) - scaleY(y1)}\n            className=\"Integral-area\"\n            fill=\"#0000000f\"\n            stroke={reduceOpacity ? '#343a40' : 'darkgreen'}\n            strokeWidth={reduceOpacity ? '0' : '1'}\n          />\n        </g>\n      )}\n      {signal.map((_signal, i) => (\n        <Signal key={`${id + i}`} signal={_signal} isVisible={isVisible} />\n      ))}\n    </g>\n  );\n};\n\nZone.defaultProps = {\n  onDelete: () => null,\n};\n\nexport default Zone;\n","import { useEffect, useState } from 'react';\n\nimport ZonesWrapper from '../../hoc/ZonesWrapper';\nimport Events from '../../utility/Events';\n\nimport Zone from './Zone';\n\nconst Zones = ({ zones, display, displayerKey }) => {\n  const [isVisible, setVisibility] = useState({\n    zones: true,\n    signals: true,\n    peaks: true,\n  });\n  useEffect(() => {\n    Events.on('onZonesVisibilityChange', ({ key }) => {\n      setVisibility((prevVisiblity) => ({\n        ...prevVisiblity,\n        [key]: !prevVisiblity[key],\n      }));\n    });\n  }, []);\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-2d)`} className=\"2D-Zones\">\n      {display.isVisible &&\n        zones.values.map((zone) => (\n          <g className=\"zone\" key={zone.id}>\n            <Zone zoneData={zone} isVisible={isVisible} />\n          </g>\n        ))}\n    </g>\n  );\n};\n\nexport default ZonesWrapper(Zones);\n","import PropsTypes from 'prop-types';\nimport { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport Contours from './Contours';\nimport IndicationLines from './IndicationLines';\nimport Left1DChart from './Left1DChart';\nimport Top1DChart from './Top1DChart';\nimport XAxis from './XAxis';\nimport YAxis from './YAxis';\nimport Zones from './zones/Zones';\n\nfunction Chart2D({ data }) {\n  const { width, height, margin, displayerKey } = useChartData();\n\n  const chart2d = useMemo(() => {\n    return (\n      <svg\n        viewBox={`0 0 ${width} ${height}`}\n        width={width}\n        height={height}\n        id=\"nmrSVG\"\n      >\n        <defs>\n          <clipPath id={`${displayerKey}clip-chart-2d`}>\n            <rect\n              width={width - margin.left - margin.right}\n              height={height - margin.top - margin.bottom}\n              x={margin.left}\n              y={margin.top}\n            />\n          </clipPath>\n        </defs>\n        <rect\n          width={width - margin.left - margin.right}\n          height={height - margin.top - margin.bottom}\n          x={margin.left}\n          y={margin.top}\n          stroke=\"black\"\n          strokeWidth=\"1\"\n          fill=\"transparent\"\n        />\n        {data && data[0] && <Top1DChart data={data[0]} />}\n        {data && data[1] && <Left1DChart data={data[1]} />}\n        <Contours />\n        <Zones />\n        <IndicationLines axis=\"X\" show />\n        <IndicationLines axis=\"Y\" show />\n\n        <g className=\"container\" style={{ pointerEvents: 'none' }}>\n          <XAxis />\n          <YAxis />\n        </g>\n      </svg>\n    );\n  }, [\n    width,\n    height,\n    displayerKey,\n    margin.left,\n    margin.right,\n    margin.top,\n    margin.bottom,\n    data,\n  ]);\n\n  return chart2d;\n}\nChart2D.defaultProps = {\n  onDimensionChange: () => null,\n};\n\nChart2D.propsTypes = {\n  onDimensionChange: PropsTypes.func.isRequired,\n};\n\nexport default Chart2D;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\nimport { useContext, useMemo, Fragment } from 'react';\nimport { MF } from 'react-mf';\n\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { options } from '../toolbar/ToolTypes';\nimport { useFormatNumberByNucleus } from '../utility/FormatNumber';\n\nimport { getLayoutID, LAYOUT } from './utilities/DimensionLayout';\nimport { get2DXScale, get1DYScale, get2DYScale } from './utilities/scale';\n\nconst styles = css`\n  display: flex;\n  flex-firection: row;\n  align-items: center;\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n  background-color: #f7f7f7;\n  height: 30px;\n  padding: 6px;\n  color: #8d0018;\n  position: absolute;\n  width: 100%;\n  bottom: 0;\n  div {\n    margin: 0px 10px;\n    display: inline-block;\n\n    .label {\n      font-size: 12px;\n      color: #4d4d4d;\n      font-weight: bold;\n    }\n    .value {\n      font-weight: bold;\n      font-size: 14px;\n    }\n    .unit {\n      font-weight: bold;\n      font-size: 10px;\n    }\n  }\n`;\nfunction FooterBanner({ layout, data1D }) {\n  const position = useContext(MouseContext);\n  const { startX, endX, startY, endY, step } = useContext(BrushContext);\n  const {\n    margin,\n    width,\n    height,\n    activeSpectrum,\n    xDomain,\n    yDomain,\n    yDomains,\n    activeTab,\n    data,\n    selectedTool,\n  } = useChartData();\n\n  const trackID =\n    position &&\n    getLayoutID(layout, {\n      startX: position.x,\n      startY: position.y,\n    });\n\n  const nucleuses = activeTab.split(',');\n  const [formatX, formatY] = useFormatNumberByNucleus(nucleuses);\n\n  const scaleX = useMemo(() => {\n    if (!data1D || data1D.length === 0) {\n      return get2DXScale({ width, margin, xDomain });\n    }\n    if (selectedTool !== options.slicingTool.id) {\n      switch (trackID) {\n        case LAYOUT.TOP_1D:\n        case LAYOUT.CENTER_2D: {\n          return get2DXScale({ width, margin, xDomain });\n        }\n        case LAYOUT.LEFT_1D: {\n          return get2DYScale({ height, margin, yDomain });\n        }\n        default:\n          return null;\n      }\n    }\n    return null;\n  }, [data1D, height, margin, selectedTool, trackID, width, xDomain, yDomain]);\n\n  const scaleY = useMemo(() => {\n    if (!data1D || data1D.length === 0) {\n      return get2DYScale({ height, margin, yDomain });\n    }\n    if (selectedTool !== options.slicingTool.id) {\n      switch (trackID) {\n        case LAYOUT.CENTER_2D: {\n          return get2DYScale({ height, margin, yDomain });\n        }\n        case LAYOUT.TOP_1D: {\n          return data1D[0]\n            ? get1DYScale(yDomains[data1D[0].id], margin.top)\n            : null;\n        }\n        case LAYOUT.LEFT_1D: {\n          return data1D[1]\n            ? get1DYScale(yDomains[data1D[1].id], margin.left)\n            : null;\n        }\n        default:\n          return null;\n      }\n    }\n    return null;\n  }, [data1D, height, margin, selectedTool, trackID, yDomain, yDomains]);\n\n  if (\n    !activeSpectrum ||\n    !position ||\n    position.y < 10 ||\n    position.x < 10 ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return <div css={styles} />;\n  }\n  const getRealYValue = (cordinate) => {\n    let index = null;\n    if (trackID === LAYOUT.TOP_1D) {\n      index = 0;\n    } else if (trackID === LAYOUT.LEFT_1D) {\n      index = 1;\n    }\n    if (index != null && scaleX != null) {\n      const xIndex = xFindClosestIndex(\n        data1D[index].data.x,\n        scaleX.invert(cordinate),\n      );\n      return data1D[index].data.y[xIndex];\n    }\n    return 1;\n  };\n\n  const getXValue = (x = null) => {\n    if (scaleX != null) {\n      switch (trackID) {\n        case LAYOUT.CENTER_2D:\n        case LAYOUT.TOP_1D: {\n          return scaleX.invert(x ? x : position.x);\n        }\n        case LAYOUT.LEFT_1D: {\n          return scaleX.invert(x ? x : position.y);\n        }\n        default:\n          return 0;\n      }\n    }\n    return 0;\n  };\n\n  const getYValue = () => {\n    if (scaleY != null) {\n      switch (trackID) {\n        case LAYOUT.CENTER_2D:\n        case LAYOUT.TOP_1D: {\n          return scaleY.invert(position.y);\n        }\n        case LAYOUT.LEFT_1D: {\n          return scaleY.invert(position.x);\n        }\n        default:\n          return 0;\n      }\n    }\n    return 0;\n  };\n\n  const getRation = () => {\n    switch (trackID) {\n      case LAYOUT.TOP_1D: {\n        return (\n          (getRealYValue(startX) / (getRealYValue(endX) || Number.MIN_VALUE)) *\n          100\n        ).toFixed(2);\n      }\n      case LAYOUT.LEFT_1D: {\n        return (\n          (getRealYValue(startY) / (getRealYValue(endY) || Number.MIN_VALUE)) *\n          100\n        ).toFixed(2);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  const getDeltaX = () => {\n    switch (trackID) {\n      case LAYOUT.TOP_1D: {\n        return (getXValue(startX) - getXValue(endX)).toPrecision(6);\n      }\n      case LAYOUT.LEFT_1D: {\n        return (getXValue(startY) - getXValue(endY)).toPrecision(6);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  const getLabel = (label2d, labelld, nucleus) => {\n    return trackID === LAYOUT.CENTER_2D ? (\n      <Fragment>\n        {label2d} ( <MF mf={nucleus} /> )\n      </Fragment>\n    ) : (\n      labelld\n    );\n  };\n\n  const getZValue = () => {\n    if (trackID === LAYOUT.CENTER_2D) {\n      const { maxX, maxY, minX, minY, z } = data[activeSpectrum.index].data;\n\n      const xStep = (maxX - minX) / (z[0].length - 1);\n      const yStep = (maxY - minY) / (z.length - 1);\n      const xIndex = Math.floor((getXValue() - minX) / xStep);\n      const yIndex = Math.floor((getYValue() - minY) / yStep);\n\n      if (xIndex < 0 || xIndex >= z[0].length) return 0;\n      if (yIndex < 0 || yIndex >= z.length) return 0;\n\n      return z[yIndex][xIndex];\n    }\n    return 0;\n  };\n\n  return (\n    <div css={styles}>\n      <div>\n        <span className=\"label\">{getLabel('F2', 'X', nucleuses[0])} :</span>\n        <span className=\"value\">{formatX(getXValue())}</span>\n        <span className=\"unit\">ppm</span>\n      </div>\n\n      <div>\n        <span className=\"label\">{getLabel('F1', 'Y', nucleuses[1])} :</span>\n        <span className=\"value\">{formatY(getYValue())}</span>\n        <span className=\"unit\">ppm</span>\n      </div>\n      <div>\n        <span className=\"label\">Intensity :</span>\n        <span className=\"value\">{getZValue()}</span>\n      </div>\n      {step === 'brushing' && (\n        <div>\n          <span className=\"label\"> Δppm :</span>\n          <span className=\"value\">{getDeltaX()}</span>\n        </div>\n      )}\n\n      {step === 'brushing' && (\n        <div>\n          <span className=\"label\"> ratio :</span>\n          <span className=\"value\">{getRation()}%</span>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default FooterBanner;\n","import { useContext, useMemo } from 'react';\n\nimport { BrushContext } from '../../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../context/ChartContext';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\nimport { getLayoutID, LAYOUT } from '../utilities/DimensionLayout';\nimport { get2DXScale, get2DYScale, get1DYScale } from '../utilities/scale';\n\nconst style = {\n  cursor: 'crosshair',\n  transformOrigin: 'bottom right',\n  position: 'absolute',\n  top: '-18px',\n  left: '-88px',\n  fontWeight: 'bold',\n  pointerEvents: 'none',\n  overflow: 'visible',\n  userSelect: 'none',\n  width: '85px',\n  textAlign: 'right',\n};\n\nfunction XYLabelPointer({ layout, data1D }) {\n  const position = useContext(MouseContext);\n  const { step } = useContext(BrushContext);\n  const {\n    margin,\n    width,\n    height,\n    activeSpectrum,\n    xDomain,\n    yDomain,\n    yDomains,\n    activeTab,\n  } = useChartData();\n\n  const trackID =\n    position &&\n    getLayoutID(layout, {\n      startX: position.x,\n      startY: position.y,\n    });\n\n  const nucleuses = activeTab.split(',');\n  const [formatX, formatY] = useFormatNumberByNucleus(nucleuses);\n\n  const scaleX = useMemo(() => {\n    if (!data1D || data1D.length === 0) {\n      return get2DXScale({ width, margin, xDomain });\n    }\n    switch (trackID) {\n      case LAYOUT.TOP_1D:\n      case LAYOUT.CENTER_2D: {\n        return get2DXScale({ width, margin, xDomain });\n      }\n      case LAYOUT.LEFT_1D: {\n        return get2DYScale({ height, margin, yDomain });\n      }\n      default:\n        return null;\n    }\n  }, [data1D, height, margin, trackID, width, xDomain, yDomain]);\n\n  const scaleY = useMemo(() => {\n    if (!data1D || data1D.length === 0) {\n      return get2DYScale({ height, margin, yDomain });\n    }\n\n    switch (trackID) {\n      case LAYOUT.CENTER_2D: {\n        return get2DYScale({ height, margin, yDomain });\n      }\n      case LAYOUT.TOP_1D: {\n        return data1D[0]\n          ? get1DYScale(yDomains[data1D[0].id], margin.top)\n          : null;\n      }\n      case LAYOUT.LEFT_1D: {\n        return data1D[1]\n          ? get1DYScale(yDomains[data1D[1].id], margin.left)\n          : null;\n      }\n      default:\n        return null;\n    }\n  }, [data1D, height, margin, trackID, yDomain, yDomains]);\n\n  if (\n    !activeSpectrum ||\n    step === 'brushing' ||\n    !position ||\n    position.y < margin.top ||\n    position.x < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return null;\n  }\n\n  const getXValue = (x = null) => {\n    switch (trackID) {\n      case LAYOUT.CENTER_2D:\n      case LAYOUT.TOP_1D: {\n        return scaleX.invert(x ? x : position.x);\n      }\n      case LAYOUT.LEFT_1D: {\n        return scaleX.invert(x ? x : position.y);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  const getYValue = () => {\n    switch (trackID) {\n      case LAYOUT.CENTER_2D:\n      case LAYOUT.TOP_1D: {\n        return scaleY.invert(position.y);\n      }\n      case LAYOUT.LEFT_1D: {\n        return scaleY.invert(position.x);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  return (\n    <div\n      key=\"xLabelPointer\"\n      style={{\n        ...style,\n        transform: `translate(${position.x}px, ${position.y}px)`,\n      }}\n    >\n      <span>{formatY(getYValue())}</span>\n      <span style={{ color: 'gray' }}>{','}</span>\n      <span style={{ color: 'red' }}>{formatX(getXValue())}</span>\n    </div>\n  );\n}\n\nexport default XYLabelPointer;\n","const BASE62 = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\n\nconst LENGTH = 8;\n\nexport default function generateID() {\n  let id = '';\n  for (let i = 0; i < LENGTH; i++) {\n    id += BASE62.charAt(Math.floor(Math.random() * 62));\n  }\n  return id;\n}\n","import { Filters } from './Filters';\nimport generateID from './utilities/generateID';\n\nexport interface Filter {\n  id: string;\n  name: string;\n  label: string;\n  isDeleteAllow: boolean;\n  flag: boolean;\n  value: any;\n}\n\n/***\n * @param {object} Filters [{name:'',options:{}},{...}]\n */\nfunction applyFilter(datum, filters: any[] = []) {\n  let isReduced = false;\n  for (let filter of filters) {\n    const filterOption = {\n      name: filter.name,\n      label: Filters[filter.name].name,\n      value: filter.options,\n    };\n    const previousFilter = lookupForFilter(datum, filter.name);\n    if (previousFilter) {\n      const reduceResult = Filters[filter.name].reduce(\n        previousFilter.value,\n        filterOption.value,\n      );\n      if (reduceResult.once) {\n        if (!isReduced) {\n          isReduced = true;\n        }\n        if (reduceResult.reduce != null && reduceResult.reduce !== undefined) {\n          replaceFilter(datum, previousFilter.id, reduceResult.reduce);\n        }\n      } else {\n        addFilter(\n          datum,\n          filterOption,\n          Object.prototype.hasOwnProperty.call(filter, 'isDeleteAllow')\n            ? filter.isDeleteAllow\n            : true,\n        );\n      }\n    } else {\n      addFilter(\n        datum,\n        filterOption,\n        Object.prototype.hasOwnProperty.call(filter, 'isDeleteAllow')\n          ? filter.isDeleteAllow\n          : true,\n      );\n    }\n  }\n  if (isReduced) {\n    if (filters.length === 1 && isLastFilter(datum, filters[0].name)) {\n      Filters[filters[0].name].apply(datum, filters[0].options);\n    } else {\n      reapplyFilters(datum);\n    }\n  } else {\n    for (let filter of filters) {\n      Filters[filter.name].apply(datum, filter.options);\n    }\n  }\n}\n\nfunction isLastFilter(datum, id) {\n  const index = datum.filters.findIndex((f) => f.name === id);\n  if (datum.filters.length === index + 1) {\n    return true;\n  }\n  return false;\n}\n\nfunction lookupForFilter(datum, filterName) {\n  return datum.filters.find((f) => f.name === filterName);\n}\n\nfunction reapplyFilters(datum, filters: any = null) {\n  const _filters = filters ? filters : datum.filters;\n  enableFilter(datum, null, null, _filters);\n}\n\n// id filter id\nfunction enableFilter(datum, id, checked, filters = null) {\n  datum.filters = datum.filters.slice(0);\n  if (id) {\n    datum.filters = datum.filters.map((filter) => {\n      return { ...filter, flag: filter.id === id ? checked : filter.flag };\n    }, []);\n  }\n  datum.data = { ...datum.data, ...datum.originalData };\n  datum.info = { ...datum.info, ...datum.originalInfo };\n  const _filters = filters ? filters : datum.filters;\n  for (let filterIndex in _filters) {\n    const filter = datum.filters[filterIndex];\n    datum.filters[filterIndex] = {\n      ...datum.filters[filterIndex],\n      error: null,\n    };\n\n    if (filter.flag) {\n      try {\n        Filters[filter.name].apply(datum, filter.value);\n      } catch (error) {\n        datum.filters[filterIndex] = {\n          ...datum.filters[filterIndex],\n          error: error.message,\n        };\n      }\n    }\n  }\n}\nfunction deleteFilter(datum, id) {\n  datum.filters = datum.filters.slice(0);\n  datum.filters = datum.filters.filter((filter) => filter.id !== id);\n  datum.data = { ...datum.data, ...datum.originalData };\n  datum.info = { ...datum.info, ...datum.originalInfo };\n\n  for (let filterIndex in datum.filters) {\n    const filter = datum.filters[filterIndex];\n    datum.filters[filterIndex] = {\n      ...datum.filters[filterIndex],\n      error: null,\n    };\n\n    if (filter.flag) {\n      try {\n        Filters[filter.name].apply(datum, filter.value);\n      } catch (error) {\n        datum.filters[filterIndex] = {\n          ...datum.filters[filterIndex],\n          error: error.message,\n        };\n      }\n    }\n  }\n}\n\nfunction addFilter(datum, filter, isDeleteAllow = true) {\n  const id = generateID();\n  datum.filters = datum.filters.slice(0);\n  delete filter.isSnapshot;\n  datum.filters.push({\n    ...filter,\n    id: id,\n    flag: true,\n    isDeleteAllow,\n  });\n}\n\nfunction replaceFilter(datum, filterID, value) {\n  datum.filters = datum.filters.slice(0);\n  const index = datum.filters.findIndex((f) => f.id === filterID);\n  delete datum.filters[index].isSnapshot;\n  datum.filters[index] = {\n    ...datum.filters[index],\n    value,\n  };\n}\n\nexport { applyFilter, reapplyFilters, enableFilter, addFilter, deleteFilter };\n","export const COLORS = [\n  '#C10020',\n  '#007D34',\n  '#803E75',\n  '#FF6800',\n  '#B32851',\n  '#7F180D',\n  '#232C16',\n  '#A6BDD7',\n  '#CEA262',\n  '#817066',\n  '#FF8E00',\n  '#F6768E',\n  '#00538A',\n  '#FF7A5C',\n  '#53377A',\n  '#FFB300',\n  '#F4C800',\n  '#93AA00',\n  '#593315',\n  '#F13A13',\n];\n\nconst color2D = {\n  cosy: { positiveColor: 'darkblue', negativeColor: 'blue' },\n  roesy: { positiveColor: '#e75480', negativeColor: 'yellow' },\n  noesy: { positiveColor: '#e75480', negativeColor: 'yellow' },\n  tocsy: { positiveColor: 'green', negativeColor: 'yellow' },\n  hsqc: { positiveColor: 'black', negativeColor: 'yellow' },\n  hmbc: { positiveColor: 'darkviolet', negativeColor: 'yellow' },\n};\n\nconst hasPredefine2DColor = (experiment) => {\n  return color2D[experiment] ? true : false;\n};\n\nconst get2DColor = (experiment, colors = []) => {\n  if (!color2D[experiment]) {\n    const positiveColor = getColor(false, colors);\n    const negativeColor = adjustAlpha(positiveColor, 50);\n    return { positiveColor, negativeColor };\n  }\n  return color2D[experiment];\n};\n\nconst percentToHex = (p) => {\n  const percent = Math.max(0, Math.min(100, p));\n  const intValue = Math.round((percent / 100) * 255);\n  const hexValue = intValue.toString(16);\n  return percent === 100 ? '' : hexValue.padStart(2, '0');\n};\n\nconst adjustAlpha = (color, factor) => {\n  return color + percentToHex(factor);\n};\n\nconst getColor = (isRandom = false, usedColors = [], opacity = 100) => {\n  const resetColors = COLORS.filter((c) => !usedColors.includes(c));\n  if (resetColors.length > 0 && !isRandom) {\n    return resetColors[0] + percentToHex(opacity);\n  } else {\n    const lum = -0.25;\n    let hex = String(\n      `#${Math.random().toString(16).slice(2, 8).toUpperCase()}`,\n    ).replace(/[^0-9a-f]/gi, '');\n    if (hex.length < 6) {\n      hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n    }\n    let rgb = '#';\n    let c;\n    let i;\n    for (i = 0; i < 3; i++) {\n      c = parseInt(hex.substr(i * 2, 2), 16);\n      c = Math.round(Math.min(Math.max(0, c + c * lum), 255)).toString(16);\n      rgb += `00${c}`.substr(c.length);\n    }\n\n    return rgb + percentToHex(opacity);\n  }\n};\nexport { percentToHex, adjustAlpha, hasPredefine2DColor, get2DColor };\nexport default getColor;\n","import { xAbsoluteMedian } from 'ml-spectra-processing';\nimport { xyAutoRangesPicking } from 'nmr-processing';\n\nlet defaultPeakPickingOptions = {\n  minMaxRatio: 0.05,\n  realTopDetection: true,\n  maxCriteria: true,\n  smoothY: false,\n  nH: 100,\n  compile: true,\n  frequencyCluster: 16,\n  clean: true,\n  keepPeaks: true,\n  sgOptions: { windowSize: 7, polynomial: 3 },\n};\n\nexport default function autoRangesDetection(datum1D, options = {}) {\n  // we calculate the noise but this could be improved\n  let noiseLevel = xAbsoluteMedian(datum1D.data.re);\n\n  let { re, x } = datum1D.data;\n\n  const { originFrequency, nucleus } = datum1D.info;\n\n  const { windowFromIndex, windowToIndex, peakPicking } = options;\n\n  const peakPickingOptions = {\n    ...defaultPeakPickingOptions,\n    ...peakPicking,\n  };\n\n  const rangesOptions = {\n    frequency: originFrequency,\n    nucleus,\n    noiseLevel: 3 * noiseLevel,\n  };\n\n  if (windowFromIndex !== undefined && windowToIndex !== undefined) {\n    x = x.slice(windowFromIndex, windowToIndex);\n    re = re.slice(windowFromIndex, windowToIndex);\n  }\n\n  const ranges = xyAutoRangesPicking(\n    { x, y: re },\n    {\n      peakPicking: peakPickingOptions,\n      ranges: rangesOptions,\n    },\n  );\n  return ranges;\n}\n","import { xGetFromToIndex } from 'ml-spectra-processing';\nimport { analyseMultiplet } from 'multiplet-analysis';\n\nconst detectSignal = (x, re, from, to, frequency) => {\n  const { fromIndex, toIndex } = xGetFromToIndex(x, {\n    from: from,\n    to: to,\n  });\n  const data = {\n    x: x.slice(fromIndex, toIndex),\n    y: re.slice(fromIndex, toIndex),\n  };\n\n  const result = analyseMultiplet(data, {\n    frequency: frequency,\n    takeBestPartMultiplet: true,\n    symmetrizeEachStep: true,\n  });\n\n  return {\n    multiplicity: result.j.map((j) => j.multiplicity).join(''),\n    kind: 'signal',\n    delta: result.chemShift,\n    j: result.j,\n  };\n};\n\nexport default detectSignal;\n","import max from 'ml-array-max';\nimport { xyIntegration, xyMinYPoint, xyMaxYPoint } from 'ml-spectra-processing';\n\nimport { Filters as FiltersTypes } from '../Filters';\nimport * as FiltersManager from '../FiltersManager';\nimport { DatumKind, SignalKindsToInclude } from '../constants/SignalsKinds';\nimport { checkSignalKinds } from '../utilities/RangeUtilities';\nimport generateID from '../utilities/generateID';\nimport get1dColor from '../utilities/getColor';\n\nimport autoRangesDetection from './autoRangesDetection';\nimport detectSignal from './detectSignal';\n\nexport const usedColors1D: Array<string> = [];\n\nexport interface File {\n  binary: ArrayBuffer;\n  name: string;\n  extension?: string;\n}\n\nexport interface Data1D {\n  y: Array<number>;\n  x: Array<number>;\n  re: Array<number>;\n  im: Array<number>;\n}\n\nexport interface Display {\n  name: string;\n  color: string;\n  isVisible: boolean;\n  isPeaksMarkersVisible: boolean;\n  isRealSpectrumVisible: boolean;\n  isVisibleInDomain: boolean;\n}\n\nexport interface Info {\n  nucleus: Array<string>;\n  isFid: boolean;\n  isComplex: boolean;\n  dimension: number;\n  isFt: boolean;\n}\nexport interface Peak {\n  id: string;\n  delta: number;\n  originDelta: number;\n  width: number;\n}\nexport interface Peaks {\n  values: Array<Partial<Peak>>;\n  options: any;\n}\nexport interface Integral {\n  id: string;\n  originFrom: number;\n  originTo: number;\n  from: number;\n  to: number;\n  absolute: number;\n  integral: number;\n  kind: string;\n}\nexport interface Integrals {\n  values: Array<Partial<Integral>>;\n  options: Partial<{ sum: number }>;\n}\n\nexport interface Signal {\n  id: string;\n  kind: string;\n  originDelta?: number;\n  delta: number;\n  multiplicity: string;\n  peak?: Array<Partial<{ x: number; intensity: number; width: number }>>;\n}\nexport interface Range {\n  id: string;\n  originFrom?: number;\n  originTo?: number;\n  from: number;\n  to: number;\n  absolute: number;\n  integral: number;\n  kind: string;\n  signal?: Array<Partial<Signal>>;\n}\n\nexport interface Ranges {\n  values: Array<Partial<Range>>;\n  options: Partial<{ sum: number }>;\n}\n\nexport interface Source {\n  jcampURL: string;\n  file: File;\n}\n\nexport interface Datum1D {\n  id: string | number;\n  source: Partial<Source>;\n  display: Partial<Display>;\n  info: Partial<Info>;\n  originalInfo?: Partial<Info>;\n  meta: any;\n  data: Data1D;\n  originalData?: Data1D;\n  peaks: Peaks;\n  integrals: Integrals;\n  ranges: Ranges;\n  filters: Array<Partial<FiltersManager.Filter>>;\n}\n\nexport function initiateDatum1D(options: any): Datum1D {\n  const datum: any = {};\n  datum.shiftX = options.shiftX || 0;\n  datum.id = options.id || generateID();\n  datum.source = Object.assign(\n    {\n      jcampURL: null,\n      file: {\n        binary: null,\n        name: '',\n        extension: '',\n      },\n    },\n    options.source,\n  );\n\n  datum.display = Object.assign(\n    {\n      name: options.display?.name ? options.display.name : generateID(),\n      color: 'black',\n      ...getColor(options),\n      isVisible: true,\n      isPeaksMarkersVisible: true,\n      isRealSpectrumVisible: true,\n      isVisibleInDomain: true,\n    },\n    options.display,\n  );\n\n  datum.info = Object.assign(\n    {\n      nucleus: '1H', // 1H, 13C, 19F, ...\n      isFid: false,\n      isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n      dimension: 1,\n    },\n    options.info,\n  );\n\n  datum.originalInfo = datum.info;\n\n  datum.meta = Object.assign({}, options.meta);\n  datum.data = Object.assign(\n    {\n      x: [],\n      re: [],\n      im: [],\n      y: [],\n    },\n    options.data,\n  );\n  datum.originalData = datum.data;\n\n  datum.peaks = Object.assign({ values: [], options: {} }, options.peaks);\n  // array of object {index: xIndex, xShift}\n  // in case the peak does not exactly correspond to the point value\n  // we can think about a second attributed `xShift`\n  datum.integrals = Object.assign(\n    { values: [], options: { sum: 100 } },\n    options.integrals,\n  ); // array of object (from: xIndex, to: xIndex)\n  datum.filters = Object.assign([], options.filters); //array of object {name: \"FilterName\", options: FilterOptions = {value | object} }\n  datum.ranges = Object.assign(\n    { values: [], options: { sum: 100 } },\n    options.ranges,\n  );\n\n  //reapply filters after load the original data\n  FiltersManager.reapplyFilters(datum);\n\n  preprocessing(datum);\n  (datum.data as Data1D).y = datum.data.re;\n  return datum;\n}\n\nfunction preprocessing(datum) {\n  if (\n    datum.info.isFid &&\n    datum.filters.findIndex((f) => f.name === FiltersTypes.digitalFilter.id) ===\n      -1\n  ) {\n    FiltersManager.applyFilter(datum, [\n      {\n        name: FiltersTypes.digitalFilter.id,\n        options: {\n          digitalFilterValue: datum.info.digitalFilter,\n        },\n        isDeleteAllow: false,\n      },\n    ]);\n  }\n}\n\nexport function toJSON(datum1D: Datum1D, forceIncludeData = false) {\n  return {\n    id: datum1D.id,\n    source: {\n      jcampURL: datum1D.source.jcampURL,\n    },\n    display: datum1D.display,\n    ...(!datum1D.source.jcampURL || forceIncludeData\n      ? {\n          data: datum1D.originalData,\n          info: datum1D.originalInfo,\n          meta: datum1D.meta,\n        }\n      : {}),\n    peaks: datum1D.peaks,\n    integrals: datum1D.integrals,\n    ranges: datum1D.ranges,\n    filters: datum1D.filters,\n  };\n}\n\nfunction getColor(options) {\n  if (options.display === undefined || options.display.color === undefined) {\n    const color = get1dColor(false, usedColors1D);\n    usedColors1D.push(color);\n    return { color };\n  }\n  return {};\n}\n\n// with mouse move\n/**\n *\n * @param {object<{x:Array<number>,re:Array<number>}>} data\n * @param  {object<{from:number,to:number}>} options\n */\nexport function lookupPeak(data, options) {\n  const { from, to } = options;\n  let minIndex = data.x.findIndex((number) => number >= from);\n  let maxIndex = data.x.findIndex((number) => number >= to) - 1;\n\n  if (minIndex > maxIndex) {\n    minIndex = maxIndex;\n    maxIndex = minIndex;\n  }\n  const dataRange = data.re.slice(minIndex, maxIndex);\n  if (dataRange && dataRange.length > 0) {\n    const yValue = max(dataRange);\n    const xIndex = dataRange.findIndex((value) => value === yValue);\n    const xValue = data.x[minIndex + xIndex];\n\n    return { x: xValue, y: yValue, xIndex: minIndex + xIndex };\n  }\n  return null;\n}\n\nexport function updateIntegralIntegrals(integrals) {\n  if (integrals.options.sum === undefined) {\n    integrals.options = { ...integrals.options, sum: 100 };\n  }\n  const countingCondition = (integral) => {\n    return integral.kind && SignalKindsToInclude.includes(integral.kind);\n  };\n  integrals.values = updateRelatives(\n    integrals.values,\n    integrals.options.sum,\n    'integral',\n    countingCondition,\n  );\n}\n\nexport function changeIntegralsRealtive(integrals, id, newIntegralValue) {\n  const integral = integrals.values.find((integral) => integral.id === id);\n  if (integral) {\n    const ratio = integral.absolute / newIntegralValue;\n    const { values, sum } = integrals.values.reduce(\n      (acc, integral, index) => {\n        const newIntegralValue = integral.absolute / ratio;\n        acc.sum += newIntegralValue;\n        acc.values[index] = {\n          ...integral,\n          integral: newIntegralValue,\n        };\n\n        return acc;\n      },\n      { values: [], sum: 0 },\n    );\n\n    integrals.values = values;\n    integrals.options.sum = sum;\n  }\n}\n\nfunction updateRelatives(values, sum, storageKey, countingCondition) {\n  const currentSum = values.reduce((previous, current) => {\n    return countingCondition && countingCondition(current) === true\n      ? (previous += Math.abs(current.absolute))\n      : previous;\n  }, 0);\n  const factor = currentSum > 0 ? sum / currentSum : 0.0;\n  return values.map((value) => {\n    return { ...value, [storageKey]: value.absolute * factor };\n  });\n}\n\nexport function updateIntegralRanges(datum) {\n  if (datum.ranges.options.sum === undefined) {\n    datum.ranges.options.sum = 100;\n  }\n  const countingCondition = (range) => {\n    return range.signal && checkSignalKinds(range, SignalKindsToInclude);\n  };\n  datum.ranges.values = updateRelatives(\n    datum.ranges.values,\n    datum.ranges.options.sum,\n    'integral',\n    countingCondition,\n  );\n}\n\nexport function detectRange(datum, options) {\n  const { from, to } = options;\n  const { x, re: y } = datum.data;\n\n  const absolute = xyIntegration({ x, y }, { from, to, reverse: true });\n  const min = xyMinYPoint({ x, y }, { from, to }).y;\n  const max = xyMaxYPoint({ x, y }, { from, to }).y;\n\n  const shiftX = getShiftX(datum);\n\n  return {\n    id: generateID(),\n    originFrom: from - shiftX,\n    originTo: to - shiftX,\n    from,\n    to,\n    absolute, // the real value,\n    min,\n    max,\n  };\n}\nexport function mapRanges(ranges, datum) {\n  const { x, re } = datum.data;\n  const shiftX = getShiftX(datum);\n\n  const error = (x[x.length - 1] - x[0]) / 10000;\n\n  return ranges.reduce((acc, newRange) => {\n    // check if the range is already exists\n    for (const { from, to } of datum.ranges.values) {\n      if (\n        Math.abs(newRange.from - from) < error &&\n        Math.abs(newRange.to - to) < error\n      ) {\n        return acc;\n      }\n    }\n\n    const absolute = xyIntegration(\n      { x, y: re },\n      { from: newRange.from, to: newRange.to, reverse: true },\n    );\n    const signal = newRange.signal.map((_signal) => {\n      return {\n        kind: 'signal',\n        id: generateID(),\n        originDelta: _signal.delta - shiftX,\n        ..._signal,\n      };\n    });\n    acc.push({\n      kind: newRange.signal[0].kind || DatumKind.signal,\n      originFrom: newRange.from - shiftX,\n      originTo: newRange.to - shiftX,\n      ...newRange,\n      id: generateID(),\n      absolute,\n      signal,\n    });\n\n    return acc;\n  }, []);\n}\n\nexport function detectRanges(datum, options) {\n  options.impurities = { solvent: datum.info.solvent };\n  const ranges = autoRangesDetection(datum, options);\n\n  datum.ranges.values = datum.ranges.values.concat(mapRanges(ranges, datum));\n  updateIntegralRanges(datum);\n}\n\nexport function changeRange(datum, range) {\n  const { from, to } = range;\n  const { x, re } = datum.data;\n\n  const index = datum.ranges.values.findIndex((i) => i.id === range.id);\n  const absolute = xyIntegration({ x, y: re }, { from, to, reverse: true });\n\n  if (index !== -1) {\n    datum.ranges.values[index] = {\n      ...datum.ranges.values[index],\n      originFrom: from,\n      originTo: to,\n      ...range,\n      absolute,\n    };\n    updateIntegralRanges(datum);\n  }\n}\n\nexport function addRange(datum, options) {\n  const { from, to } = options;\n  const { x, re } = datum.data;\n  const absolute = xyIntegration({ x, y: re }, { from, to, reverse: true });\n\n  const signals = detectSignal(x, re, from, to, datum.info.originFrequency);\n\n  try {\n    const range = {\n      id: generateID(),\n      from,\n      to,\n      absolute, // the real value,\n      signal: [{ id: generateID(), ...signals }],\n      kind: DatumKind.signal,\n    };\n    datum.ranges.values = datum.ranges.values.concat(mapRanges([range], datum));\n    updateIntegralRanges(datum);\n  } catch (e) {\n    throw new Error('Could not calculate the multiplicity');\n  }\n}\n\nexport function updateXShift(datum: Datum1D) {\n  const shiftX = getShiftX(datum);\n  updatePeaksXShift(datum, shiftX);\n  updateRangesXShift(datum, shiftX);\n  updateIntegralXShift(datum, shiftX);\n}\n\nexport function getShiftX(datum: Datum1D) {\n  const filter =\n    datum?.filters &&\n    datum?.filters.find((filter) => filter.name === FiltersTypes.shiftX.id);\n\n  return filter?.flag ? filter.value : 0;\n}\n\nexport function updatePeaksXShift(datum: Datum1D, shiftValue) {\n  datum.peaks.values = datum.peaks.values.map((peak) => ({\n    ...peak,\n    delta: peak.originDelta + shiftValue,\n  }));\n}\nexport function updateRangesXShift(datum: Datum1D, shiftValue) {\n  datum.ranges.values = datum.ranges.values.map((range) => ({\n    ...range,\n    from: range.originFrom + shiftValue,\n    to: range.originTo + shiftValue,\n    signal:\n      range?.signal &&\n      range.signal.map((s) => ({ ...s, delta: s.originDelta + shiftValue })),\n  }));\n}\nexport function updateIntegralXShift(datum: Datum1D, shiftValue) {\n  datum.integrals.values = datum.integrals.values.map((integral) => ({\n    ...integral,\n    from: integral.originFrom + shiftValue,\n    to: integral.originTo + shiftValue,\n  }));\n}\n\nexport function changeRangesRealtive(datum, rangeID, newRealtiveValue) {\n  const range = datum.ranges.values.find((range) => range.id === rangeID);\n  if (range) {\n    const ratio = range.absolute / newRealtiveValue;\n    datum.ranges.options.sum =\n      (newRealtiveValue / range.integral) * datum.ranges.options.sum;\n    datum.ranges.values = datum.ranges.values.map((range) => {\n      return {\n        ...range,\n        integral: range.absolute / ratio,\n      };\n    });\n  }\n}\n\nexport function changeRangeSignal(datum, rangeID, signalID, newSignalValue) {\n  let shiftValue = 0;\n  const rangeIndex = datum.ranges.values.findIndex(\n    (range) => range.id === rangeID,\n  );\n  if (rangeIndex !== -1) {\n    const signalIndex = datum.ranges.values[rangeIndex].signal.findIndex(\n      (signal) => signal.id === signalID,\n    );\n    shiftValue =\n      newSignalValue -\n      datum.ranges.values[rangeIndex].signal[signalIndex].delta;\n    datum.ranges.values[rangeIndex].signal[signalIndex].delta = newSignalValue;\n  }\n  return shiftValue;\n}\n","import { Conrec } from 'ml-conrec';\n\nexport const defaultContourOptions = {\n  positive: {\n    contourLevels: [0, 21],\n    numberOfLayers: 10,\n  },\n  negative: {\n    contourLevels: [0, 21],\n    numberOfLayers: 10,\n  },\n};\n\nexport default class Processing2D {\n  constructor(\n    minMax,\n    options = defaultContourOptions,\n    defaultLevel = {\n      positive: 10,\n      negative: 10,\n    },\n  ) {\n    this.options = options;\n    const { positive, negative } = defaultLevel;\n\n    this.currentLevelPositive = positive;\n    this.currentLevelNegative = negative;\n\n    const xs = getRange(minMax.minX, minMax.maxX, minMax.z[0].length);\n\n    const ys = getRange(minMax.minY, minMax.maxY, minMax.z.length);\n\n    this.conrec = new Conrec(minMax.z, { xs, ys, swapAxes: false });\n\n    this.median = minMax.noise;\n\n    this.minMax = minMax;\n  }\n\n  getLevel() {\n    return {\n      levelPositive: this.currentLevelPositive,\n      levelNegative: this.currentLevelNegative,\n    };\n  }\n\n  setLevel(levelPositive, levelNegative) {\n    this.currentLevelPositive = levelPositive;\n    this.currentLevelNegative = levelNegative;\n  }\n\n  setOptions(options) {\n    const positiveBoundary = options.positive.contourLevels;\n    const negativeBoundary = options.negative.contourLevels;\n\n    if (this.currentLevelPositive >= positiveBoundary[1]) {\n      this.currentLevelPositive = positiveBoundary[1];\n    } else if (this.currentLevelPositive <= positiveBoundary[0]) {\n      this.currentLevelPositive = positiveBoundary[0];\n    }\n\n    if (this.currentLevelNegative >= negativeBoundary[1]) {\n      this.currentLevelNegative = negativeBoundary[1];\n    } else if (this.currentLevelNegative <= negativeBoundary[0]) {\n      this.currentLevelNegative = negativeBoundary[0];\n    }\n\n    this.options = options;\n  }\n\n  wheel(value) {\n    const sign = Math.sign(value);\n    const positiveBoundary = this.options.positive.contourLevels;\n    const negativeBoundary = this.options.negative.contourLevels;\n\n    if (\n      (this.currentLevelPositive > positiveBoundary[0] && sign === -1) ||\n      (this.currentLevelPositive < positiveBoundary[1] && sign === 1)\n    ) {\n      this.currentLevelPositive += sign;\n    }\n\n    if (\n      (this.currentLevelNegative > negativeBoundary[0] && sign === -1) ||\n      (this.currentLevelNegative < negativeBoundary[1] && sign === 1)\n    ) {\n      this.currentLevelNegative += sign;\n    }\n  }\n\n  shiftWheel(value) {\n    const sign = Math.sign(value);\n    const [min, max] = this.options.positive.contourLevels;\n    if (\n      (this.currentLevelPositive === min && sign === -1) ||\n      (this.currentLevelPositive >= max && sign === 1)\n    ) {\n      return;\n    }\n\n    this.currentLevelPositive += sign;\n    return [];\n  }\n\n  drawContours() {\n    const zoomPositive = this.currentLevelPositive / 2 + 1;\n    const zoomNegative = this.currentLevelNegative / 2 + 1;\n    const {\n      positive: { numberOfLayers: numberOfPositiveLayer },\n      negative: { numberOfLayers: numberOfNegativeLayer },\n    } = this.options;\n    return {\n      positive: this.getContours(zoomPositive, {\n        nbLevels: numberOfPositiveLayer,\n      }),\n      negative: this.getContours(zoomNegative, {\n        negative: true,\n        nbLevels: numberOfNegativeLayer,\n      }),\n    };\n  }\n\n  getContours(zoomLevel, options = {}) {\n    const { negative = false, timeout = 2000, nbLevels = 10 } = options;\n\n    const max = Math.max(\n      Math.abs(this.minMax.maxZ),\n      Math.abs(this.minMax.minZ),\n    );\n\n    let _range = getRange(\n      this.median * 1 * Math.pow(2, zoomLevel),\n      max,\n      nbLevels,\n      2,\n    );\n\n    if (negative) {\n      _range = _range.map((value) => -value);\n    }\n    let contours = [];\n    try {\n      contours = this.conrec.drawContour({\n        contourDrawer: 'basic', // shape or basic\n        levels: _range,\n        timeout: timeout,\n      });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.log(e);\n      throw e;\n    }\n\n    return contours;\n  }\n}\n\nfunction getRange(min, max, length, exp) {\n  if (exp) {\n    let factors = [];\n\n    factors[0] = 0;\n\n    for (let i = 1; i <= length; i++) {\n      factors[i] = factors[i - 1] + (exp - 1) / Math.pow(exp, i);\n    }\n\n    const lastFactor = factors[length];\n\n    const result = new Array(length);\n\n    for (let i = 0; i < length; i++) {\n      result[i] = (max - min) * (1 - factors[i + 1] / lastFactor) + min;\n    }\n\n    return result;\n  } else {\n    const step = (max - min) / (length - 1);\n\n    return range(min, max + step / 2, step);\n  }\n}\n\nfunction range(from, to, step) {\n  const result = [];\n\n  for (let i = from; i < to; i += step) {\n    result.push(i);\n  }\n\n  return result;\n}\n","import { zoneToX } from 'ml-spectra-processing';\n\nimport { Filters } from '../Filters';\nimport * as FiltersManager from '../FiltersManager';\nimport { DatumKind } from '../constants/SignalsKinds';\nimport { initiateDatum1D } from '../data1d/Datum1D';\nimport generateID from '../utilities/generateID';\nimport { get2DColor } from '../utilities/getColor';\n\nimport Processing2D, { defaultContourOptions } from './Processing2D';\nimport autoZonesDetection from './autoZonesDetection';\n\nexport const usedColors2D: Array<string> = [];\n\nexport interface File {\n  binary: ArrayBuffer;\n  name: string;\n  extension?: string;\n}\n\nexport interface Source {\n  jcampURL: string;\n  file: File;\n}\n\nexport interface Data2D {\n  z: Array<Array<number>>;\n  minX: number;\n  minY: number;\n  maxX: number;\n  maxY: number;\n}\n\nexport interface ContourOptions {\n  positive: {\n    contourLevels: [number, number];\n    numberOfLayers: number;\n  };\n  negative: {\n    contourLevels: [number, number];\n    numberOfLayers: number;\n  };\n}\n\nexport interface Display {\n  name: string;\n  positiveColor: string;\n  negativeColor: string;\n  isVisible: boolean;\n  isPositiveVisible: boolean;\n  isNegativeVisible: boolean;\n  contourOptions: ContourOptions;\n  isVisibleInDomain: boolean;\n}\n\nexport interface Info {\n  nucleus: Array<string>;\n  isFid: boolean;\n  isComplex: boolean;\n  dimension: number;\n  isFt: boolean;\n}\n\nexport interface Signal {\n  id: number;\n  peak: any;\n  x: Partial<{\n    originDelta: number;\n    delta: number;\n    diaID: any;\n  }>;\n  y: Partial<{\n    originDelta: number;\n    delta: number;\n    diaID: any;\n  }>;\n  kind: string;\n}\n\nexport interface Zone {\n  id: number;\n  x: Partial<{ from: number; to: number }>;\n  y: Partial<{ from: number; to: number }>;\n  signal: Array<Signal>;\n  kind: string;\n}\n\nexport interface Zones {\n  values: Array<Partial<Zone>>;\n  options?: Partial<{ sum: number }>;\n}\n\nexport interface Datum2D {\n  id: string;\n  source: Partial<Source>;\n  display: Display;\n  info: Partial<Info>;\n  originalInfo?: Partial<Info>;\n  meta: any;\n  data: Data2D;\n  originalData?: Data2D;\n  zones: Zones;\n  filters: Array<Partial<FiltersManager.Filter>>;\n  processingController: Processing2D;\n}\n\nexport function initiateDatum2D(options: any): Datum2D {\n  const datum: any = {};\n\n  datum.id = options.id || generateID();\n  datum.source = Object.assign(\n    {\n      jcamp: null,\n      jcampURL: null,\n      original: [],\n    },\n    options.source,\n  );\n  datum.display = Object.assign(\n    {\n      name: options.display.name || generateID(),\n      positiveColor: 'red',\n      negativeColor: 'blue',\n      ...getColor(options),\n      isPositiveVisible: true,\n      isNegativeVisible: true,\n      isVisible: true,\n      contourOptions: defaultContourOptions,\n      dimension: 2,\n    },\n    options.display,\n  );\n\n  datum.info = Object.assign(\n    {\n      nucleus: ['1H', '1H'],\n      isFid: false,\n      isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n    },\n    options.info,\n  );\n\n  datum.originalInfo = datum.info;\n  datum.meta = Object.assign({}, options.meta);\n  datum.data = Object.assign(\n    {\n      z: [],\n      minX: 0,\n      minY: 0,\n      maxX: 0,\n      maxY: 0,\n    },\n    options.data,\n  );\n  datum.originalData = datum.data;\n  datum.filters = Object.assign([], options.filters);\n\n  datum.zones = Object.assign({ values: [], options: {} }, options.zones);\n\n  datum.processingController = new Processing2D(\n    datum.data,\n    datum.display.contourOptions,\n  );\n\n  //reapply filters after load the original data\n  FiltersManager.reapplyFilters(datum);\n\n  return datum;\n}\n\nexport function getShift(datum: Datum2D): { xShift: number; yShift: number } {\n  let shift: any = { xShift: 0, yShift: 0 };\n  if (datum?.filters) {\n    shift = datum.filters.reduce(\n      (acc, filter) => {\n        if (filter.name === Filters.shift2DX.id) {\n          acc.xShift = filter?.flag ? filter.value : 0;\n        }\n        if (filter.name === Filters.shift2DY.id) {\n          acc.yShift = filter?.flag ? filter.value : 0;\n        }\n        return acc;\n      },\n      { xShift: 0, yShift: 0 },\n    );\n  }\n\n  return shift;\n}\n\nfunction getColor(options) {\n  if (\n    options.display === undefined ||\n    options.display.negativeColor === undefined ||\n    options.display.positiveColor === undefined\n  ) {\n    const color = get2DColor(options.info.experiment, usedColors2D);\n    usedColors2D.push(color.positiveColor);\n    return color;\n  }\n  return {};\n}\n\nexport function toJSON(datum: Datum2D, forceIncludeData = false) {\n  return {\n    id: datum.id,\n    source: {\n      jcampURL: datum.source.jcampURL,\n    },\n    ...(!datum.source.jcampURL || forceIncludeData\n      ? {\n          data: datum.originalData,\n          info: datum.originalInfo,\n          meta: datum.meta,\n        }\n      : {}),\n    zones: datum.zones,\n    filters: datum.filters,\n    display: datum.display,\n  };\n}\n\n/** get 2d projection\n * @param {number} x in ppm\n * @param {number} y in ppm\n */\nexport function getSlice(spectrum, position) {\n  const data = spectrum.data;\n  const xStep = (data.maxX - data.minX) / (data.z[0].length - 1);\n  const yStep = (data.maxY - data.minY) / (data.z.length - 1);\n  const xIndex = Math.floor((position.x - data.minX) / xStep);\n  const yIndex = Math.floor((position.y - data.minY) / yStep);\n\n  if (xIndex < 0 || xIndex >= data.z[0].length) return;\n  if (yIndex < 0 || yIndex >= data.z.length) return;\n\n  let infoX = {\n    nucleus: spectrum.info.nucleus[0], // 1H, 13C, 19F, ...\n    isFid: false,\n    isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n    dimension: 1,\n  };\n\n  let dataX = {\n    x: zoneToX(\n      { from: spectrum.data.minX, to: spectrum.data.maxX },\n      spectrum.data.z[0].length,\n    ),\n    re: new Float64Array(spectrum.data.z[0].length),\n  };\n\n  for (let i = 0; i < spectrum.data.z[0].length; i++) {\n    dataX.re[i] += spectrum.data.z[yIndex][i];\n  }\n\n  let infoY = {\n    nucleus: spectrum.info.nucleus[1], // 1H, 13C, 19F, ...\n    isFid: false,\n    isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n    dimension: 1,\n  };\n\n  let dataY = {\n    x: zoneToX(\n      { from: spectrum.data.minY, to: spectrum.data.maxY },\n      spectrum.data.z.length,\n    ),\n    re: new Float64Array(spectrum.data.z.length),\n  };\n\n  let index = spectrum.data.z.length - 1;\n  for (let i = 0; i < spectrum.data.z.length; i++) {\n    dataY.re[i] += spectrum.data.z[index--][xIndex];\n  }\n\n  const horizontal = initiateDatum1D({ info: infoX, data: dataX });\n  const vertical = initiateDatum1D({ info: infoY, data: dataY });\n  return { horizontal, vertical };\n}\n\nexport function updateShift(datum: Datum2D) {\n  const { xShift, yShift } = getShift(datum);\n  updateZonesShift(datum, {\n    xShift,\n    yShift,\n  });\n}\n\nexport function updateZonesShift(datum: Datum2D, { xShift, yShift }) {\n  datum.zones.values = datum.zones.values.map((zone) => ({\n    ...zone,\n    signal: zone.signal?.map((signal) => ({\n      ...signal,\n      x: { ...signal.x, delta: signal.x.originDelta + xShift },\n      y: { ...signal.y, delta: signal.y.originDelta + yShift },\n    })),\n  }));\n}\n\n/**\n *\n * @param {number} zoneID\n * @param {object} signal\n * @param {number} signal.x\n * @param {number} signal.y\n * @param {string} signal.id\n */\nexport function changeZoneSignal(\n  datum,\n  zoneID,\n  newSignal,\n): { xShift: number; yShift: number } {\n  const zoneIndex = datum.zones.values.findIndex((zone) => zone.id === zoneID);\n  if (zoneIndex !== -1) {\n    const signalIndex = datum.zones.values[zoneIndex].signal.findIndex(\n      (s) => s.id === newSignal.id,\n    );\n    if (signalIndex !== -1) {\n      const originalSignal = datum.zones.values[zoneIndex].signal[signalIndex];\n      const xShift =\n        newSignal?.x || newSignal?.x === 0\n          ? newSignal.x - originalSignal.x.delta\n          : 0;\n      const yShift =\n        newSignal?.y || newSignal?.y === 0\n          ? newSignal.y - originalSignal.y.delta\n          : 0;\n\n      // if (newSignal.x) {\n      //   datum.zones.values[zoneIndex].signal[signalIndex].x.delta = newSignal.x;\n      // }\n      // if (newSignal.y) {\n      //   datum.zones.values[zoneIndex].signal[signalIndex].y.delta = newSignal.y;\n      // }\n      return { xShift, yShift };\n    }\n  }\n  return { xShift: 0, yShift: 0 };\n}\n\n/**\n *\n * @param {object} options\n * @param {object} options.selectedZone\n * @param {number} options.selectedZone.fromX\n * @param {number} options.selectedZone.fromY\n * @param {number} options.selectedZone.toX\n * @param {number} options.selectedZone.toY\n * @param {number} options.thresholdFactor\n * @param {boolean} options.convolutionByFFT\n */\nexport function detectZonesManual(datum, options) {\n  const signals = getDetectionZones(datum, options);\n  const { xShift, yShift } = getShift(datum);\n  for (let signal of signals) {\n    let { fromTo } = signal;\n    datum.zones.values.push({\n      id: generateID(),\n      x: fromTo[0],\n      y: fromTo[1],\n      signal: [\n        {\n          id: generateID(),\n          peak: signal.peaks,\n          x: {\n            originDelta: signal.shiftX - xShift,\n            delta: signal.shiftX,\n            diaID: [],\n          },\n          y: {\n            originDelta: signal.shiftY - yShift,\n            delta: signal.shiftY,\n            diaID: [],\n          },\n          kind: 'signal',\n        },\n      ],\n      kind: DatumKind.signal,\n    });\n  }\n}\n\n/** calculate the missing projection\n * @param {string[]} nucleus\n */\nexport function getMissingProjection(datum, nucleus) {\n  let index = datum.info.nucleus.indexOf(nucleus);\n  // temporary because nuclus was undefined;\n  if (index === -1) index = 0;\n\n  let info = {\n    nucleus: datum.info.nucleus[index], // 1H, 13C, 19F, ...\n    isFid: false,\n    isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n    dimension: 1,\n  };\n\n  let from = index === 0 ? datum.data.minX : datum.data.minY;\n  let to = index === 0 ? datum.data.maxX : datum.data.maxY;\n  let nbPoints = index === 0 ? datum.data.z.length : datum.data.z[0].length;\n\n  let projection = new Float64Array(nbPoints);\n  if (index === 1) {\n    for (let i = 0; i < datum.data.z.length; i++) {\n      for (let j = 0; j < datum.data.z[0].length; j++) {\n        projection[i] += datum.data.z[i][j];\n      }\n    }\n  } else {\n    for (let i = 0; i < datum.data.z[0].length; i++) {\n      // eslint-disable-next-line @typescript-eslint/prefer-for-of\n      for (let j = 0; j < datum.data.z.length; j++) {\n        projection[i] += datum.data.z[j][i];\n      }\n    }\n  }\n\n  let data = {\n    x: zoneToX({ from, to }, nbPoints),\n    re: projection,\n  };\n  const datum1D = initiateDatum1D({ info, data });\n  return datum1D;\n}\n/**\n *\n * @param {object} options\n * @param {object} options.selectedZone\n * @param {number} options.selectedZone.fromX\n * @param {number} options.selectedZone.fromY\n * @param {number} options.selectedZone.toX\n * @param {number} options.selectedZone.toY\n * @param {number} options.thresholdFactor\n * @param {boolean} options.convolutionByFFT\n */\nexport function getDetectionZones(datum, options) {\n  let dataMatrix = {};\n  if (options.selectedZone) {\n    dataMatrix = getSubMatrix(datum, options.selectedZone);\n  } else {\n    dataMatrix = datum.data;\n  }\n  options.info = datum.info;\n  return autoZonesDetection(dataMatrix, options);\n}\n/**\n *\n * @param {object} options\n * @param {object} options.selectedZone\n * @param {number} options.selectedZone.fromX\n * @param {number} options.selectedZone.fromY\n * @param {number} options.selectedZone.toX\n * @param {number} options.selectedZone.toY\n * @param {number} options.thresholdFactor\n * @param {boolean} options.convolutionByFFT\n */\nexport function detectZones(datum, options) {\n  const zones = getDetectionZones(datum, options);\n  const { xShift, yShift } = getShift(datum);\n\n  const { minX, maxX, minY, maxY } = datum.data;\n  const xError = Math.abs(maxX - minX) / 10000;\n  const yError = Math.abs(maxY - minY) / 10000;\n\n  const formattedZones = zones.reduce((acc, zone) => {\n    const [newXRange, newYRange] = zone.fromTo;\n\n    // check if the zone is already exists\n    for (const { x, y } of datum.zones.values) {\n      if (\n        Math.abs(newXRange.from - x.from) < xError &&\n        Math.abs(newXRange.to - x.to) < xError &&\n        Math.abs(newYRange.from - y.from) < yError &&\n        Math.abs(newYRange.to - y.to) < yError\n      ) {\n        return acc;\n      }\n    }\n\n    acc.push({\n      id: generateID(),\n      x: { from: newXRange.from, to: newXRange.to },\n      y: { from: newYRange.from, to: newYRange.to },\n      signal: [\n        {\n          id: generateID(),\n          peak: zone.peaks,\n          x: {\n            originDelta: zone.shiftX - xShift,\n            delta: zone.shiftX,\n            diaID: [],\n          },\n          y: {\n            originDelta: zone.shiftY - yShift,\n            delta: zone.shiftY,\n            diaID: [],\n          },\n          kind: 'signal',\n        },\n      ],\n      kind: DatumKind.signal,\n    });\n\n    return acc;\n  }, []);\n  datum.zones.values = datum.zones.values.concat(formattedZones);\n}\n\nexport function getSubMatrix(datum, selectedZone) {\n  const { fromX, toX, fromY, toY } = selectedZone;\n  const data = datum.data;\n  const xStep = (data.maxX - data.minX) / (data.z[0].length - 1);\n  const yStep = (data.maxY - data.minY) / (data.z.length - 1);\n  let xIndexFrom = Math.floor((fromX - data.minX) / xStep);\n  let yIndexFrom = Math.floor((fromY - data.minY) / yStep);\n  let xIndexTo = Math.floor((toX - data.minX) / xStep);\n  let yIndexTo = Math.floor((toY - data.minY) / yStep);\n\n  if (xIndexFrom > xIndexTo) [xIndexFrom, xIndexTo] = [xIndexTo, xIndexFrom];\n  if (yIndexFrom > yIndexTo) [yIndexFrom, yIndexTo] = [yIndexTo, yIndexFrom];\n\n  let dataMatrix: any = {\n    z: [],\n    maxX: data.minX + xIndexTo * xStep,\n    minX: data.minX + xIndexFrom * xStep,\n    maxY: data.minY + yIndexTo * yStep,\n    minY: data.minY + yIndexFrom * yStep,\n  };\n  let maxZ = Number.MIN_SAFE_INTEGER;\n  let minZ = Number.MAX_SAFE_INTEGER;\n\n  let nbXPoints = xIndexTo - xIndexFrom + 1;\n  for (let j = yIndexFrom; j < yIndexTo; j++) {\n    let row = new Float32Array(nbXPoints);\n    let xIndex = xIndexFrom;\n    for (let i = 0; i < nbXPoints; i++) {\n      row[i] = data.z[j][xIndex++];\n    }\n    for (let rowValue of row) {\n      if (maxZ < rowValue) maxZ = rowValue;\n      if (minZ > rowValue) minZ = rowValue;\n    }\n    dataMatrix.z.push(Array.from(row));\n  }\n  dataMatrix.minZ = minZ;\n  dataMatrix.maxZ = maxZ;\n  return dataMatrix;\n}\n","import { xyzAutoPeaksPicking } from 'nmr-processing';\n\nexport default function autoZonesDetection(data, options) {\n  const {\n    thresholdFactor,\n    clean,\n    maxPercentCutOff,\n    enhanceSymmetry,\n    convolutionByFFT,\n  } = options;\n\n  const { nucleus, originFrequency } = options.info;\n  const isHomoNuclear = nucleus[0] === nucleus[1];\n\n  let zones = xyzAutoPeaksPicking(data, {\n    isHomoNuclear,\n    nucleus,\n    observeFrequencies: originFrequency,\n    thresholdFactor,\n    clean,\n    maxPercentCutOff,\n    enhanceSymmetry,\n    convolutionByFFT,\n  });\n\n  return zones;\n}\n","import { extent, scaleLinear } from 'd3';\n/***\n * @param {number} width\n * @param {object} margin\n * @param {number} margin.right\n * @param {number} margin.left\n * @param {number[]} x\n * @returns {object={somain.scaleX}}\n\n */\nfunction getTopXScale(width, margin, x) {\n  const xDomain = extent(x);\n  const scaleX = scaleLinear(extent(x), [width - margin.right, margin.left]);\n  return {\n    xDomain,\n    scaleX,\n  };\n}\n/***\n * @param {number} width\n * @param {object} margin\n * @param {number} margin.bottom\n * @param {number} margin.top\n * @param {number[]} x\n * @returns {object={somain.scaleX}}\n */\nfunction getLeftXScale(height, margin, x) {\n  const xDomain = extent(x);\n  const scaleX = scaleLinear(extent(x), [height - margin.bottom, margin.top]);\n\n  return {\n    xDomain,\n    scaleX,\n  };\n}\n\n/***\n * @param {number} height\n * @param {number} margin\n * @param {number[]} y\n */\nfunction getYScale(height, y, margin = 10) {\n  return scaleLinear(extent(y), [height - margin, margin]);\n}\n\nexport { getTopXScale, getLeftXScale, getYScale };\n","import { xyReduce } from 'ml-spectra-processing';\nimport { useMemo, memo } from 'react';\n\nimport { useChartData } from '../../../context/ChartContext';\nimport { get2DXScale } from '../../utilities/scale';\n\nimport { getYScale } from './SliceScale';\n\nfunction HorizontalSliceChart({ margin: marginProps, data }) {\n  const { width, margin: originMargin, xDomain, displayerKey } = useChartData();\n\n  const height = originMargin.top;\n\n  const paths = useMemo(() => {\n    if (data) {\n      const { x, re: y } = data;\n      const scaleX = get2DXScale({ margin: originMargin, width, xDomain });\n\n      const scaleY = getYScale(height, y, marginProps);\n      const pathPoints = xyReduce(\n        { x, y },\n        {\n          from: xDomain[0],\n          to: xDomain[1],\n        },\n      );\n\n      let path = `M ${scaleX(pathPoints.x[0])} ${scaleY(pathPoints.y[0])} `;\n      path += pathPoints.x.slice(1).reduce((accumulator, point, i) => {\n        accumulator += ` L ${scaleX(point)} ${scaleY(pathPoints.y[i + 1])}`;\n        return accumulator;\n      }, '');\n      return path;\n    } else {\n      return null;\n    }\n  }, [data, height, marginProps, originMargin, width, xDomain]);\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return (\n    <svg viewBox={`0 0 ${width} ${height}`} width={width} height={height}>\n      <defs>\n        <clipPath id={`${displayerKey}clip-top`}>\n          <rect\n            width={width - originMargin.left - originMargin.right}\n            height={height}\n            x={originMargin.left}\n            y={`${0}`}\n          />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-top)`}>\n        <rect\n          width={width - originMargin.left - originMargin.right}\n          height={height}\n          x={originMargin.left}\n          y={`${0}`}\n          fillOpacity=\"0\"\n        />\n        <path className=\"line\" stroke=\"red\" fill=\"none\" d={paths} />\n      </g>\n    </svg>\n  );\n}\n\nHorizontalSliceChart.defaultProps = {\n  margin: 10,\n};\n\nexport default memo(HorizontalSliceChart);\n","import { xyReduce } from 'ml-spectra-processing';\nimport { useMemo, memo } from 'react';\n\nimport { useChartData } from '../../../context/ChartContext';\nimport { get2DYScale } from '../../utilities/scale';\n\nimport { getYScale } from './SliceScale';\n\nfunction VerticalSliceChart({ margin: marignValue, data }) {\n  const {\n    height: originHeight,\n    margin,\n    yDomain,\n    displayerKey,\n  } = useChartData();\n\n  const height = margin.left;\n\n  const paths = useMemo(() => {\n    if (data) {\n      const { x, re: y } = data;\n      const scaleX = get2DYScale({ height: originHeight, margin, yDomain });\n\n      const scaleY = getYScale(height, y, marignValue);\n\n      const pathPoints = xyReduce(\n        { x, y },\n        {\n          from: yDomain[0],\n          to: yDomain[1],\n        },\n      );\n      const lastXIndex = pathPoints.x.length - 1;\n      const lastYIndex = pathPoints.y.length - 1;\n      let path = `M  ${scaleY(pathPoints.y[lastYIndex])} ${scaleX(\n        lastXIndex,\n      )} `;\n      path += pathPoints.x\n        .slice(0, lastXIndex)\n        .reduceRight((accumulator, point, index) => {\n          accumulator += ` L  ${scaleY(pathPoints.y[index])} ${scaleX(point)}`;\n          return accumulator;\n        }, '');\n      return path;\n    } else {\n      return null;\n    }\n  }, [data, height, margin, marignValue, originHeight, yDomain]);\n\n  const mainHeight = originHeight - margin.bottom - margin.top;\n\n  if (!mainHeight || !height) return null;\n\n  return (\n    <svg\n      viewBox={`0 0 ${height} ${mainHeight + margin.top}`}\n      width={height}\n      height={mainHeight + margin.top}\n    >\n      <defs>\n        <clipPath id={`${displayerKey}clip-left`}>\n          <rect width={height} height={mainHeight} x=\"0\" y={margin.top} />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-left)`}>\n        <path className=\"line\" stroke=\"red\" fill=\"none\" d={paths} />\n      </g>\n    </svg>\n  );\n}\n\nVerticalSliceChart.defaultProps = {\n  margin: 10,\n};\n\nexport default memo(VerticalSliceChart);\n","import PropsTypes from 'prop-types';\nimport { useMemo } from 'react';\n\nimport { getSlice } from '../../../../data/data2d/Datum2D';\nimport { useMouseTracker } from '../../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../../context/ChartContext';\nimport { get2DXScale, get2DYScale } from '../../utilities/scale';\n\nimport HorizontalSliceChart from './HorizontalSliceChart';\nimport VerticalSliceChart from './VerticalSliceChart';\n\nfunction SlicingView() {\n  const {\n    width,\n    height,\n    margin,\n    activeSpectrum,\n    data: spectra,\n    xDomain,\n    yDomain,\n  } = useChartData();\n  const position = useMouseTracker();\n\n  const chart2d = useMemo(() => {\n    if (position && activeSpectrum.id) {\n      const { x, y } = position;\n      const scale2dX = get2DXScale({ margin, width, xDomain });\n      const scale2dY = get2DYScale({ margin, height, yDomain });\n      const data = getSlice(spectra[activeSpectrum.index], {\n        x: scale2dX.invert(x),\n        y: scale2dY.invert(y),\n      });\n      return (\n        <svg\n          viewBox={`0 0 ${width} ${height}`}\n          width={width}\n          height={height}\n          style={{\n            position: 'absolute',\n            backgroundColor: 'rgba(255,255,255,0.8)',\n          }}\n        >\n          {data && data.horizontal && (\n            <HorizontalSliceChart data={data.horizontal.data} />\n          )}\n          {data && data.vertical && (\n            <VerticalSliceChart data={data.vertical.data} />\n          )}\n        </svg>\n      );\n    }\n    return null;\n  }, [\n    position,\n    activeSpectrum.id,\n    activeSpectrum.index,\n    margin,\n    width,\n    xDomain,\n    height,\n    yDomain,\n    spectra,\n  ]);\n\n  if (!position) {\n    return null;\n  }\n\n  return chart2d;\n}\nSlicingView.defaultProps = {\n  onDimensionChange: () => null,\n};\n\nSlicingView.propsTypes = {\n  onDimensionChange: PropsTypes.func.isRequired,\n};\n\nexport default SlicingView;\n","import { useCallback, Fragment, useEffect, useState, useMemo } from 'react';\nimport { useSize, useDebounce } from 'react-use';\n\nimport { BrushTracker } from '../EventsTrackers/BrushTracker';\nimport { MouseTracker } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport Spinner from '../loader/Spinner';\nimport {\n  BRUSH_END,\n  FULL_ZOOM_OUT,\n  SET_DIMENSIONS,\n  SET_2D_LEVEL,\n  SET_ZOOM_FACTOR,\n  ADD_2D_ZONE,\n} from '../reducer/types/Types';\nimport BrushXY, { BRUSH_TYPE } from '../tool/BrushXY';\nimport CrossLinePointer from '../tool/CrossLinePointer';\nimport { options } from '../toolbar/ToolTypes';\n\nimport Chart2D from './Chart2D';\nimport FooterBanner from './FooterBanner';\nimport XYLabelPointer from './tools/XYLabelPointer';\nimport SlicingView from './tools/slicing/SlicingView';\nimport { get2DDimensionLayout, getLayoutID } from './utilities/DimensionLayout';\n\nfunction Viewer2D({ emptyText = undefined }) {\n  const state = useChartData();\n  const {\n    selectedTool,\n    isLoading,\n    data,\n    margin,\n    tabActiveSpectrum,\n    activeTab,\n  } = state;\n\n  const dispatch = useDispatch();\n\n  const spectrumData = useMemo(() => {\n    const nucleuses = activeTab.split(',');\n    return nucleuses.reduce((acc, n) => {\n      if (tabActiveSpectrum[n] && tabActiveSpectrum[n].id) {\n        const id = tabActiveSpectrum[n].id;\n        const spectrum = data.find(\n          (datum) => datum.id === id && !datum.info.isFid,\n        );\n        if (spectrum) {\n          acc.push(spectrum);\n        }\n      } else {\n        acc.push(null);\n      }\n      return acc;\n    }, []);\n  }, [activeTab, data, tabActiveSpectrum]);\n\n  const DIMENSION = get2DDimensionLayout(state);\n\n  const handelBrushEnd = useCallback(\n    (brushData) => {\n      const trackID = getLayoutID(DIMENSION, brushData);\n      if (trackID) {\n        if (brushData.altKey) {\n          switch (selectedTool) {\n            default:\n              break;\n          }\n        } else if (brushData.shiftKey) {\n          switch (selectedTool) {\n            case options.zone2D.id:\n              dispatch({ type: ADD_2D_ZONE, ...brushData });\n              break;\n            default:\n              break;\n          }\n        } else {\n          switch (selectedTool) {\n            default:\n              if (selectedTool != null) {\n                return dispatch({\n                  type: BRUSH_END,\n                  ...brushData,\n                  trackID: getLayoutID(DIMENSION, brushData),\n                });\n              }\n          }\n        }\n      }\n    },\n    [selectedTool, dispatch, DIMENSION],\n  );\n\n  const handelOnDoubleClick = useCallback(\n    (e) => {\n      const { x: startX, y: startY } = e;\n      const trackID = getLayoutID(DIMENSION, { startX, startY });\n      if (trackID) {\n        dispatch({ type: FULL_ZOOM_OUT, trackID });\n      }\n    },\n    [DIMENSION, dispatch],\n  );\n\n  const handleZoom = (wheelData) => {\n    const { x: startX, y: startY } = wheelData;\n    const trackID = getLayoutID(DIMENSION, { startX, startY });\n\n    if (trackID) {\n      if (trackID === 'CENTER_2D') {\n        dispatch({ type: SET_2D_LEVEL, ...wheelData });\n      } else {\n        dispatch({ type: SET_ZOOM_FACTOR, ...wheelData, trackID });\n      }\n    }\n  };\n\n  const mouseClick = useCallback(\n    (position) => {\n      // eslint-disable-next-line no-unused-vars\n      const { x, y } = position;\n      switch (selectedTool) {\n        default:\n          break;\n      }\n    },\n    [selectedTool],\n  );\n\n  const [sizedNMRChart, { width, height }] = useSize(() => {\n    return (\n      <Fragment>\n        <Spinner isLoading={isLoading} emptyText={emptyText} />\n\n        {data && data.length > 0 && (\n          <BrushTracker\n            onBrush={handelBrushEnd}\n            onDoubleClick={handelOnDoubleClick}\n            onClick={mouseClick}\n            onZoom={handleZoom}\n            style={{\n              width: '100%',\n              height: '100%',\n              margin: 'auto',\n              position: 'relative',\n              overflow: 'hidden',\n            }}\n          >\n            <MouseTracker\n              style={{ width: '100%', height: `100%`, position: 'absolute' }}\n            >\n              {selectedTool && selectedTool === options.slicingTool.id && (\n                <SlicingView />\n              )}\n\n              <CrossLinePointer />\n              {spectrumData && (\n                <XYLabelPointer data1D={spectrumData} layout={DIMENSION} />\n              )}\n\n              <BrushXY\n                brushType={BRUSH_TYPE.XY}\n                dimensionBorder={DIMENSION.CENTER_2D}\n              />\n              <>\n                {spectrumData && spectrumData[0] && (\n                  <BrushXY\n                    brushType={BRUSH_TYPE.X}\n                    dimensionBorder={DIMENSION.TOP_1D}\n                    height={margin.top}\n                  />\n                )}\n                {spectrumData && spectrumData[1] && (\n                  <BrushXY\n                    brushType={BRUSH_TYPE.Y}\n                    dimensionBorder={DIMENSION.LEFT_1D}\n                    width={margin.left}\n                  />\n                )}\n              </>\n              {spectrumData && (\n                <FooterBanner data1D={spectrumData} layout={DIMENSION} />\n              )}\n\n              <Chart2D data={spectrumData} />\n            </MouseTracker>\n          </BrushTracker>\n        )}\n      </Fragment>\n    );\n  }, []);\n\n  const [finalSize, setFinalSize] = useState();\n  useDebounce(() => setFinalSize({ width, height }), 400, [width, height]);\n  useEffect(() => {\n    if (finalSize && isFinite(finalSize.width) && isFinite(finalSize.height)) {\n      dispatch({\n        type: SET_DIMENSIONS,\n        ...finalSize,\n      });\n    }\n  }, [dispatch, finalSize]);\n\n  return sizedNMRChart;\n}\n\nexport default Viewer2D;\n","import { Component, CSSProperties, ErrorInfo } from 'react';\n\nconst styles: Record<string, CSSProperties> = {\n  container: {\n    margin: '25px',\n  },\n  header: {\n    backgroundColor: '#ffffff',\n    padding: '20px',\n    borderRadius: '10px',\n    fontSize: '30px',\n    textAlign: 'center',\n  },\n\n  body: {\n    whiteSpace: 'pre-wrap',\n    backgroundColor: 'white',\n    padding: '20px',\n    borderRadius: '10px',\n    color: 'red',\n  },\n};\n\nexport default class ErrorBoundary extends Component<\n  unknown,\n  { error: Error | null; errorInfo: ErrorInfo | null }\n> {\n  public constructor(props: unknown) {\n    super(props);\n    this.state = { error: null, errorInfo: null };\n  }\n\n  public componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    // Catch errors in any components below and re-render with error message\n    this.setState({\n      error: error,\n      errorInfo: errorInfo,\n    });\n    // You can also log error messages to an error reporting service here\n  }\n\n  public render() {\n    if (this.state.errorInfo && process.env.NODE_ENV === 'production') {\n      // Error path\n      return (\n        <div style={styles.container}>\n          <p style={styles.header}>Something went wrong.</p>\n          <details style={styles.body}>\n            {this.state.error}\n            <br />\n            {this.state.errorInfo.componentStack}\n          </details>\n        </div>\n      );\n    }\n    // Normally, just render children\n    return this.props.children;\n  }\n}\n","import { createContext, useContext } from 'react';\n\nconst AlertContext = createContext();\n\nexport const AlertProvider = AlertContext.Provider;\n\nexport const useAlert = () => {\n  return useContext(AlertContext);\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\n\nconst styles = css`\n  width: 40px;\n  height: 40px;\n  margin: 0 auto;\n  :after {\n    content: ' ';\n    display: block;\n    width: 30px;\n    height: 30px;\n    margin-top: 10px;\n    border-radius: 50%;\n    border: 4px solid;\n    border-color: #fff transparent #fff transparent;\n    animation: ring-animation 1s linear infinite;\n  }\n  @keyframes ring-animation {\n    0% {\n      transform: rotate(0deg);\n    }\n    100% {\n      transform: rotate(360deg);\n    }\n  }\n`;\n\nconst ProgressIndicator = () => {\n  return <div css={styles} />;\n};\n\nexport default ProgressIndicator;\n","import PropTypes from 'prop-types';\nimport {\n  Fragment,\n  useState,\n  useRef,\n  useEffect,\n  useCallback,\n  useMemo,\n} from 'react';\nimport { createPortal } from 'react-dom';\nimport { FaTimes } from 'react-icons/fa';\nimport { TransitionGroup } from 'react-transition-group';\n\nimport Transition from '../Transition';\nimport Wrapper from '../Wrapper';\nimport { groupBy } from '../helpers';\nimport { positions, transitions, types } from '../options';\n\nimport { AlertProvider } from './Context';\nimport ProgressIndicator from './ProgressIndicator';\n\nfunction Provider({\n  children,\n  wrapperRef,\n  offset,\n  position,\n  timeout,\n  type,\n  transition,\n  ...props\n}) {\n  const root = useRef(null);\n  const alertContext = useRef(null);\n  const timersId = useRef([]);\n  const [alerts, setAlerts] = useState([]);\n\n  useEffect(() => {\n    root.current = document.createElement('div');\n    const ref = root.current;\n    const timersIdRef = timersId.current;\n\n    if (wrapperRef) {\n      wrapperRef.appendChild(ref);\n    }\n    return () => {\n      if (ref) {\n        if (wrapperRef) {\n          timersIdRef.forEach(clearTimeout);\n\n          wrapperRef.removeChild(ref);\n        }\n      }\n    };\n  }, [wrapperRef]);\n\n  const remove = useCallback((alert) => {\n    setAlerts((currentAlerts) => {\n      const lengthBeforeRemove = currentAlerts.length;\n      const filteredAlerts = currentAlerts.filter((a) => a.id !== alert.id);\n\n      if (lengthBeforeRemove > filteredAlerts.length && alert.options.onClose) {\n        alert.options.onClose();\n      }\n\n      return filteredAlerts;\n    });\n  }, []);\n\n  const removeAll = useCallback(() => {\n    alertContext.current.alerts.forEach(remove);\n  }, [remove]);\n\n  const show = useCallback(\n    (message = '', options = {}) => {\n      const id = Math.random().toString(36).substr(2, 9);\n\n      const alertOptions = {\n        position: options.position || position,\n        timeout,\n        type,\n        backgroundColor: 'black',\n        color: 'white',\n        ...options,\n      };\n\n      const alert = {\n        id,\n        message,\n        options: alertOptions,\n      };\n\n      alert.close = () => remove(alert);\n\n      if (alert.options.timeout) {\n        const timerId = setTimeout(() => {\n          remove(alert);\n\n          timersId.current.splice(timersId.current.indexOf(timerId), 1);\n        }, alert.options.timeout);\n\n        timersId.current.push(timerId);\n      }\n\n      setAlerts((state) => state.concat(alert));\n      if (alert.options.onOpen) alert.options.onOpen();\n\n      return alert;\n    },\n    [position, remove, timeout, type],\n  );\n\n  const success = useCallback(\n    (message = '', options = {}) => {\n      options.type = types.SUCCESS;\n      options = { backgroundColor: '#28ba62', color: 'white', ...options };\n\n      return show(message, options);\n    },\n    [show],\n  );\n\n  const error = useCallback(\n    (message = '', options = {}) => {\n      options.type = types.ERROR;\n      options = { backgroundColor: '#cf3c4f', color: 'white', ...options };\n      return show(message, options);\n    },\n    [show],\n  );\n\n  const info = useCallback(\n    (message = '', options = {}) => {\n      options.type = types.INFO;\n      options.color = '#28ba62';\n      return show(message, options);\n    },\n    [show],\n  );\n\n  const showLoading = useCallback(\n    (message = 'Process in progress', options = {}) => {\n      options.type = types.PROGRESS_INDICATOR;\n      options.timeout = 0;\n      options.backgroundColor = '#232323';\n\n      return new Promise((resolve) => {\n        const alert = show(message, options);\n        setTimeout(() => {\n          resolve(() => remove(alert));\n        }, 500);\n      });\n    },\n    [remove, show],\n  );\n\n  const closeHandler = useCallback(\n    (alert) => {\n      remove(alert);\n    },\n    [remove],\n  );\n\n  const alertsByPosition = groupBy(alerts, (alert) => alert.options.position);\n\n  const parentStyle = useMemo(() => {\n    return wrapperRef\n      ? wrapperRef.getBoundingClientRect()\n      : {\n          top: 0,\n          left: 0,\n          width: window.innerWidth,\n          height: window.innerHeight,\n        };\n  }, [wrapperRef]);\n\n  return (\n    <AlertProvider\n      value={{\n        alerts,\n        show,\n        remove,\n        removeAll,\n        success,\n        error,\n        info,\n        showLoading,\n      }}\n    >\n      {children}\n      {root.current &&\n        createPortal(\n          <Fragment>\n            {Object.keys(positions).map((key) => {\n              const position = positions[key];\n\n              return (\n                <TransitionGroup\n                  appear\n                  key={position}\n                  options={{ position, zIndex: 999999 }}\n                  component={Wrapper}\n                  containerStyle={parentStyle}\n                  {...props}\n                >\n                  {alertsByPosition[position]\n                    ? alertsByPosition[position].map((alert) => (\n                        <Transition type={transition} key={alert.id}>\n                          <div\n                            style={{\n                              margin: offset,\n                              padding: '25px',\n                              borderRadius: '10px',\n                              pointerEvents: 'all',\n                              backgroundColor: alert.options.backgroundColor,\n                              color: alert.options.color,\n                              minHeight: '60px',\n                              position: 'relative',\n                            }}\n                            key={alert.id}\n                          >\n                            <button\n                              style={{\n                                position: 'absolute',\n                                right: '5px',\n                                top: '5px',\n                                border: 'none',\n                                backgroundColor: 'transparent',\n                                color: 'white',\n                              }}\n                              type=\"button\"\n                              onClick={() => closeHandler(alert)}\n                            >\n                              <FaTimes />\n                            </button>\n\n                            <span>{alert.message}</span>\n                            {alert.options.type ===\n                              types.PROGRESS_INDICATOR && <ProgressIndicator />}\n                          </div>\n                        </Transition>\n                      ))\n                    : null}\n                </TransitionGroup>\n              );\n            })}\n          </Fragment>,\n          root.current,\n        )}\n    </AlertProvider>\n  );\n}\n\nProvider.propTypes = {\n  offset: PropTypes.string,\n  position: PropTypes.oneOf(\n    Object.keys(positions).map((position) => positions[position]),\n  ),\n  timeout: PropTypes.number,\n  type: PropTypes.oneOf(Object.keys(types).map((type) => types[type])),\n  transition: PropTypes.oneOf(\n    Object.keys(transitions).map((transition) => transitions[transition]),\n  ),\n  containerStyle: PropTypes.object,\n  wrapperRef: PropTypes.object,\n  context: PropTypes.shape({\n    Provider: PropTypes.object,\n    Consumer: PropTypes.object,\n  }),\n};\n\nProvider.defaultProps = {\n  offset: '5px',\n  position: positions.BOTTOM_CENTER,\n  transition: transitions.FADE,\n  wrapperRef: null,\n  timeout: 3000,\n};\n\nexport default Provider;\n","import { initiateDatum1D } from './Datum1D';\n\nexport function fromBruker(result, options = {}) {\n  const { dependentVariables, info, meta } = result;\n  let data = getData(dependentVariables[0].components);\n  if (data.im) info.isComplex = true;\n\n  if (Array.isArray(info.nucleus)) info.nucleus = info.nucleus[0];\n\n  const datum1D = initiateDatum1D({\n    ...options,\n    info,\n    meta,\n    data,\n  });\n\n  return datum1D;\n}\n\nexport function fromCSD(result, options = {}) {\n  let dimension = result.dimensions[0];\n  let dependentVariables = result.dependentVariables;\n\n  let quantityName = dimension.quantityName;\n  let n = dimension.count;\n  let incr = dimension.increment.magnitude;\n  let origin = dimension.originOffset.magnitude;\n  let offset = dimension.coordinatesOffset.magnitude;\n\n  let buffer = dependentVariables[0].components[0];\n  let re = [];\n  let im = [];\n  for (let i = buffer.length - 1; i > 0; i -= 2) {\n    re.push(buffer[i - 1]);\n    im.push(buffer[i]);\n  }\n\n  let data = {};\n  let i, x0;\n  switch (quantityName) {\n    case 'frequency':\n      x0 = 0 + (offset / origin) * 1000000;\n      i = (incr / origin) * 1000000;\n      data.re = re;\n      data.im = im;\n      break;\n    case 'time':\n      x0 = origin;\n      i = incr;\n      data.re = re.reverse();\n      data.im = im.reverse().map((z) => -z);\n      break;\n    default:\n      break;\n  }\n\n  let scale = [];\n  for (let x = 0; x < n; x++) {\n    scale.push(x0 + x * i);\n  }\n\n  data.x = scale;\n\n  const datum1D = initiateDatum1D({\n    ...options,\n    data,\n  });\n  return datum1D;\n}\n\nexport function fromParsedJcamp(parsedJcamp, options = {}) {\n  const { dependentVariables, info, meta } = parsedJcamp;\n  let data = getData(dependentVariables[0].components);\n  if (Array.isArray(info.nucleus)) info.nucleus = info.nucleus[0];\n\n  const datum1D = initiateDatum1D({\n    ...options,\n    info,\n    meta,\n    data,\n  });\n\n  return datum1D;\n}\n\nfunction getData(spectra) {\n  let x =\n    spectra[0] && spectra[0].data && spectra[0].data.x ? spectra[0].data.x : [];\n  let re =\n    spectra[0] && spectra[0].data && spectra[0].data.y ? spectra[0].data.y : [];\n  let im =\n    spectra[1] && spectra[1].data && spectra[1].data.y\n      ? spectra[1].data.y\n      : null;\n\n  if (x[0] > x[1]) {\n    x.reverse();\n    re.reverse();\n    if (im) im.reverse();\n  }\n  return { x, re, im };\n}\n","import { initiateDatum2D } from './Datum2D';\n\nexport function fromParsedJcamp(parsedJcamp, options = {}) {\n  const { dependentVariables, info, meta } = parsedJcamp;\n  let data = dependentVariables[0].components;\n  const ob = initiateDatum2D({\n    ...options,\n    info,\n    meta,\n    data,\n  });\n  return ob;\n}\n\nexport function fromBruker(result, options = {}) {\n  const { dependentVariables, meta } = result;\n  let data = dependentVariables[0].components;\n  const datum2D = initiateDatum2D({\n    ...options,\n    meta,\n    data,\n  });\n\n  return datum2D;\n}\n\n// eslint-disable-next-line no-unused-vars\nexport function fromCSD(result, options = {}) {\n  const datum2D = initiateDatum2D({});\n  return datum2D;\n}\n","import { fromJEOL, fromJCAMP, fromBruker } from 'nmr-parser';\n\nimport * as Data1DManager from './data1d/Data1DManager';\nimport * as Datum1D from './data1d/Datum1D';\nimport * as Data2DManager from './data2d/Data2DManager';\nimport * as Datum2D from './data2d/Datum2D';\n\nexport function addJcampFromURL(spectra, jcampURL, options) {\n  // { credentials: 'include' }\n  return fetch(jcampURL)\n    .then((response) => response.arrayBuffer())\n    .then((jcamp) => {\n      addJcamp(spectra, jcamp, options);\n    });\n}\n\nexport function addJcamp(spectra, jcamp, options = {}) {\n  const entries = fromJCAMP(jcamp, {\n    noContour: true,\n    xy: true,\n    keepRecordsRegExp: /.*/,\n    profiling: true,\n  });\n  if (entries.length === 0) return;\n  // Should be improved when we have a more complex case\n  for (let entry of entries) {\n    let { dependentVariables } = entry;\n    if (\n      dependentVariables[0].components &&\n      (dependentVariables[0].components.length > 0 ||\n        dependentVariables[0].components.z.length)\n    ) {\n      addJcampSS(spectra, entry, options);\n    }\n  }\n}\n\nfunction addJcampSS(spectra, entry, options) {\n  const dimension = entry.info.dimension;\n  if (dimension === 1) {\n    spectra.push(Data1DManager.fromParsedJcamp(entry, options));\n  }\n  if (dimension === 2) {\n    spectra.push(Data2DManager.fromParsedJcamp(entry, options));\n  }\n}\n\nfunction addData(spectra, datum) {\n  const dimension = datum.info.dimension;\n  if (dimension === 1) {\n    spectra.push(Datum1D.initiateDatum1D(datum));\n  }\n  if (dimension === 2) {\n    spectra.push(Datum2D.initiateDatum2D(datum));\n  }\n}\n\nexport function addJDF(spectra, jdf, options = {}) {\n  // need to parse the jcamp\n  let converted = fromJEOL(jdf, {});\n  let info = converted.description;\n  let metadata = info.metadata;\n  delete info.metadata;\n  info.acquisitionMode = 0;\n  info.experiment = info.dimension === 1 ? '1d' : '2d';\n  info.type = 'NMR SPECTRUM';\n  info.nucleus = info.nucleus[0];\n  info.numberOfPoints = info.numberOfPoints[0];\n  info.acquisitionTime = info.acquisitionTime[0];\n\n  info.baseFrequency = info.baseFrequency[0];\n  info.frequencyOffset = info.frequencyOffset[0];\n\n  info.spectralWidthClipped = converted.application.spectralWidthClipped;\n\n  if (info.dimension === 1) {\n    if (converted.dependentVariables) {\n      spectra.push(\n        Data1DManager.fromCSD(converted, {\n          ...options,\n          display: { ...options.display },\n          info: info,\n          meta: metadata,\n        }),\n      );\n    }\n  }\n  if (info.dimension === 2 && info.isFt) {\n    spectra.push(\n      Data2DManager.fromCSD(converted, {\n        ...options,\n        display: { ...options.display },\n        info,\n      }),\n    );\n  }\n}\n\nexport async function fromJSON(data = []) {\n  const spectra = [];\n  let promises = [];\n\n  for (let datum of data) {\n    if (datum.source.jcampURL != null) {\n      promises.push(addJcampFromURL(spectra, datum.source.jcampURL, datum));\n    } else {\n      addData(spectra, datum);\n    }\n  }\n  await Promise.all(promises);\n  return spectra;\n}\n\nexport async function addBruker(options, data) {\n  const spectra = [];\n  let result = await fromBruker(data, { xy: true, noContours: true });\n\n  let entries = result;\n  for (let entry of entries) {\n    let { info, dependentVariables } = entry;\n    if (info.dimension === 1) {\n      if (dependentVariables[0].components) {\n        spectra.push(\n          Data1DManager.fromBruker(entry, {\n            ...options,\n            display: { ...options.display },\n          }),\n        );\n      }\n    } else if (info.dimension === 2) {\n      if (info.isFt) {\n        spectra.push(\n          Data2DManager.fromBruker(entry, {\n            ...options,\n            info,\n            display: { ...options.display },\n          }),\n        );\n      } else {\n        // in case of 2D FID spectrum\n      }\n    }\n  }\n  return spectra;\n}\n\n// handle zip files\nexport async function fromZip(zipFiles) {\n  const spectra = [];\n  for (let zipFile of zipFiles) {\n    await addBruker(\n      spectra,\n      { display: { name: zipFile.name } },\n      zipFile.binary,\n    );\n  }\n  return spectra;\n}\n\nexport function addJDFs(files) {\n  const spectra = [];\n  for (const file of files) {\n    addJDF(spectra, file.binary, {\n      display: {\n        name: file.name,\n      },\n      source: {\n        jcampURL: file.jcampURL ? file.jcampURL : null,\n        file,\n      },\n    });\n  }\n  return spectra;\n}\n\nexport function addJcamps(files) {\n  const spectra = [];\n  for (const file of files) {\n    addJcamp(spectra, file.binary, {\n      display: {\n        name: file.name,\n      },\n      source: {\n        jcampURL: file.jcampURL ? file.jcampURL : null,\n        file,\n      },\n    });\n  }\n  return spectra;\n}\n\nexport async function addMolfileFromURL(molfileURL) {\n  let molfile = await fetch(molfileURL).then((response) => response.text());\n  this.addMolfile(molfile);\n}\n\n/**\n *\n * @param {object} state\n */\nexport function toJSON(state, forceIncludeData = false) {\n  const {\n    data,\n    molecules,\n    preferences,\n    correlations,\n    multipleAnalysis,\n    exclusionZones,\n  } = state || {\n    data: [],\n    molecules: [],\n    preferences: {},\n    correlations: {},\n    multipleAnalysis: {},\n    exclusionZones: {},\n  };\n  const spectra = data.map((ob) => {\n    return ob.info.dimension === 1\n      ? Datum1D.toJSON(ob, forceIncludeData)\n      : Datum2D.toJSON(ob, forceIncludeData);\n  });\n\n  return {\n    spectra,\n    molecules,\n    preferences,\n    correlations,\n    multipleAnalysis,\n    exclusionZones,\n  };\n}\n","import { useState, useCallback, forwardRef } from 'react';\n\nconst CheckBox = forwardRef(function CheckBox(\n  { name = '', checked: checkProps, onChange = () => null, disabled },\n  ref,\n) {\n  const [checked, setCheck] = useState(checkProps);\n\n  const handleCheck = useCallback(\n    (e) => {\n      const _checked = !checked;\n      setCheck(_checked);\n      onChange(e);\n    },\n    [checked, onChange],\n  );\n\n  return (\n    <input\n      ref={ref}\n      type=\"checkbox\"\n      name={name}\n      id={name}\n      onChange={handleCheck}\n      defaultChecked={checkProps}\n      disabled={disabled}\n    />\n  );\n});\n\nCheckBox.defaultProps = {\n  onChange: function () {\n    return null;\n  },\n  name: '',\n  disabled: false,\n};\n\nexport default CheckBox;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport PropTypes from 'prop-types';\nimport { useCallback } from 'react';\n\nimport CheckBox from '../CheckBox';\n\nfunction FormikCheckBox({\n  label,\n  name,\n  onChange,\n  className,\n  reverse,\n  ...resProps\n}) {\n  const { values, setFieldValue } = useFormikContext();\n  const value = reverse ? !lodashGet(values, name) : lodashGet(values, name);\n\n  const changeHandler = useCallback(\n    (e) => {\n      e.persist();\n      onChange(e);\n      setFieldValue(name, reverse ? value : !value);\n    },\n    [name, onChange, reverse, setFieldValue, value],\n  );\n  return (\n    <div className={`${className} check-${value}`}>\n      <label htmlFor={name} className=\"checkbox-lable\">\n        {label}\n      </label>\n      <CheckBox\n        id={name}\n        name={name}\n        checked={value}\n        onChange={changeHandler}\n        className=\"checkbox\"\n        {...resProps}\n      />\n    </div>\n  );\n}\n\nFormikCheckBox.propTypes = {\n  label: PropTypes.string,\n  name: PropTypes.string,\n  className: PropTypes.string,\n  onChange: PropTypes.func,\n  reverse: PropTypes.bool,\n};\n\nFormikCheckBox.defaultProps = {\n  className: '',\n  onChange: () => null,\n  reverse: false,\n};\n\nexport default FormikCheckBox;\n","import { Formik } from 'formik';\nimport PropTypes from 'prop-types';\nimport { forwardRef } from 'react';\n\nconst FormikForm = forwardRef(function FormikForm(\n  { initialValues, onSubmit, validationSchema, children },\n  ref,\n) {\n  return (\n    <Formik\n      innerRef={ref}\n      initialValues={initialValues}\n      onSubmit={onSubmit}\n      validationSchema={validationSchema}\n    >\n      {() => <>{children}</>}\n    </Formik>\n  );\n});\n\nFormikForm.defaultProps = {\n  initialValues: {},\n  onSubmit: () => null,\n  validationSchema: null,\n};\nFormikForm.propTypes = {\n  initialValues: PropTypes.object,\n  onSubmit: PropTypes.func,\n  validationSchema: PropTypes.object,\n};\n\nexport default FormikForm;\n","import PropTypes from 'prop-types';\nimport { forwardRef, useState, useEffect, useCallback } from 'react';\n\nconst styles = {\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n  },\n  input: {\n    height: '100%',\n    width: '100px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px 0px 5px',\n    textAlign: 'center',\n  },\n};\n\nconst Input = forwardRef(function Input(\n  {\n    label,\n    value,\n    name,\n    style,\n    onChange,\n    onKeyDown,\n    checkValue,\n    type,\n    enableAutoSelect,\n    className,\n    format,\n    ...prop\n  },\n  ref,\n) {\n  const [val, setVal] = useState(value);\n  useEffect(() => {\n    setVal(value);\n  }, [value]);\n\n  useEffect(() => {\n    if (enableAutoSelect) {\n      ref.current.select();\n    }\n  }, [enableAutoSelect, ref]);\n\n  const getValue = useCallback(\n    (value) => {\n      const formatValue = format();\n      return formatValue(\n        type === 'number'\n          ? String(value).trim() === '-'\n            ? Number(0)\n            : Number(value)\n          : value,\n      );\n    },\n    [format, type],\n  );\n\n  const onChangeHandler = useCallback(\n    (e) => {\n      e.persist();\n      e.stopPropagation();\n      e.preventDefault();\n      function check(value) {\n        if (type === 'number') {\n          const pattern = /^(?:-?[0-9]*|[0-9]\\d*)(?:\\.\\d{0,20})?$/;\n          if (value.trim() === '' || pattern.test(value)) {\n            return true;\n          }\n          return false;\n        }\n        return true;\n      }\n      const _value = e.target.value;\n      if (check(_value) && checkValue(_value)) {\n        const formatValue = format();\n\n        setVal(formatValue(_value));\n        onChange({\n          ...e,\n          target: { name: e.target.name, value: getValue(_value) },\n        });\n      }\n    },\n    [checkValue, format, getValue, onChange, type],\n  );\n\n  const handleKeyDown = useCallback(\n    (event) => {\n      event.persist();\n      onKeyDown({\n        ...event,\n        target: { name: event.target.name, value: getValue(val) },\n      });\n    },\n    [getValue, onKeyDown, val],\n  );\n  const preventPropagate = useCallback((event) => {\n    event.stopPropagation();\n  }, []);\n\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'row',\n        alignItems: 'center',\n        ...(style && style.container ? style.container : {}),\n      }}\n    >\n      {label && (\n        <span\n          style={{\n            ...styles.label,\n            ...(style && style.label ? style.label : {}),\n          }}\n          className=\"label\"\n        >\n          {label}\n        </span>\n      )}\n      <input\n        {...prop}\n        ref={ref}\n        name={name}\n        style={{\n          ...styles.input,\n          ...(style && style.input ? style.input : {}),\n        }}\n        type=\"text\"\n        value={val}\n        onChange={onChangeHandler}\n        onKeyDown={handleKeyDown}\n        onKeyPress={preventPropagate}\n        onDoubleClick={(e) => e.stopPropagation()}\n        className={`input ${className}`}\n      />\n    </div>\n  );\n});\n\nInput.propTypes = {\n  label: PropTypes.string,\n  name: PropTypes.string,\n  value: PropTypes.any,\n  style: PropTypes.shape({\n    label: PropTypes.object,\n    input: PropTypes.object,\n    container: PropTypes.object,\n  }),\n  onChange: PropTypes.func,\n  checkValue: PropTypes.func,\n  onKeyDown: PropTypes.func,\n  className: PropTypes.string,\n  format: PropTypes.func,\n  type: PropTypes.oneOf(['text', 'number']),\n  enableAutoSelect: PropTypes.bool,\n};\n\nInput.defaultProps = {\n  style: {\n    label: {},\n    input: {},\n    container: {},\n  },\n  value: '',\n  onChange: () => {\n    return null;\n  },\n  checkValue: () => true,\n  onKeyDown: () => null,\n  type: 'text',\n  className: '',\n  enableAutoSelect: false,\n  format: () => (val) => val,\n};\n\nexport default Input;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport PropTypes from 'prop-types';\nimport { useCallback, useEffect, useMemo } from 'react';\n\nimport Input from '../Input';\n\nfunction FormikInput({\n  label,\n  name,\n  style,\n  onChange,\n  checkValue,\n  type,\n  className,\n  value,\n  format,\n  ...resProps\n}) {\n  const {\n    values,\n    handleChange,\n    setFieldValue,\n    errors,\n    touched,\n  } = useFormikContext();\n  const changeHandler = useCallback(\n    (e) => {\n      onChange(e);\n      handleChange(e);\n    },\n    [handleChange, onChange],\n  );\n\n  useEffect(() => {\n    if (value) {\n      setFieldValue(name, value);\n    }\n  }, [name, setFieldValue, value]);\n\n  const isInvalid = useMemo(() => {\n    return lodashGet(errors, name) && lodashGet(touched, name);\n  }, [errors, name, touched]);\n  return (\n    <Input\n      label={label}\n      name={name}\n      value={value ? value : lodashGet(values, name)}\n      onChange={changeHandler}\n      type={type}\n      style={{\n        ...style,\n        input: { ...style.input, ...(isInvalid && { borderColor: 'red' }) },\n      }}\n      checkValue={checkValue}\n      className={className}\n      format={format}\n      {...resProps}\n    />\n  );\n}\n\nFormikInput.propTypes = {\n  label: PropTypes.string,\n  name: PropTypes.string,\n  style: PropTypes.shape({\n    label: PropTypes.object,\n    input: PropTypes.object,\n  }),\n  onChange: PropTypes.func,\n  checkValue: PropTypes.func,\n  type: PropTypes.oneOf(['text', 'number']),\n  className: PropTypes.string,\n  value: PropTypes.any,\n  format: PropTypes.func,\n};\n\nFormikInput.defaultProps = {\n  style: {\n    label: {},\n    input: {},\n  },\n  onChange: () => {\n    return null;\n  },\n  checkValue: () => true,\n  type: 'text',\n  className: '',\n  value: null,\n  format: () => (val) => val,\n};\n\nexport default FormikInput;\n","import { css } from '@emotion/react';\n\nexport const ModalStyles = css`\n  overflow: auto;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n\n  .header {\n    text-align: center;\n    padding: 10px 0 10px 0px;\n    margin: 0px;\n    color: #005d9e;\n    place-items: normal;\n    text-transform: none;\n    background-color: #fcfcfc;\n  }\n\n  .tab-content {\n    width: 100%;\n  }\n  .row {\n    display: flex;\n  }\n\n  .inner-content {\n    padding: 15px 30px;\n    width: 100%;\n    overflow: auto;\n  }\n\n  button:focus {\n    outline: none;\n  }\n  button:hover {\n    color: #007bff;\n  }\n  .save-button:hover {\n    background-color: #ffffff;\n  }\n  .save-button {\n    border: none;\n    padding: 0 15px;\n    background-color: #ffffff5e;\n    border-radius: 5px;\n    height: 25px;\n  }\n\n  .footer-container {\n    display: flex;\n    align-items: flex-end;\n    justify-content: flex-end;\n    background: rgb(242, 242, 242);\n    background: -moz-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: -webkit-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=\"#f2f2f2\",endColorstr=\"#ffffff\",GradientType=1);\n    padding: 6px 15px;\n    height: 55px;\n  }\n\n  .section-header {\n    font-size: 13px;\n    color: #2ca8ff;\n    margin-bottom: 10px;\n    border-bottom: 0.55px solid #f9f9f9;\n    padding: 6px 2px;\n  }\n\n  .custom-label {\n    font-size: 12px;\n    font-weight: bold;\n    margin-right: 10px;\n    width: 120px;\n  }\n  .margin-10 {\n    margin: 10px 0;\n  }\n\n  .input {\n    font-size: 14px;\n    border-radius: 5px;\n    border: 1px solid #cccccc;\n    padding: 5px;\n    width: 100px;\n    margin-right: 10px;\n    height: initial !important;\n  }\n\n  .close-bt {\n    border: none;\n    color: red;\n    background-color: transparent;\n    outline: none;\n    position: absolute;\n    right: 10px;\n    top: 2px;\n    width: 30px;\n    height: 30px;\n  }\n`;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useRef } from 'react';\n\nimport CloseButton from '../elements/CloseButton';\nimport FormikCheckBox from '../elements/formik/FormikCheckBox';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\n\nimport { ModalStyles } from './ModalStyle';\n\nconst styles = css`\n  .row {\n    align-items: center;\n  }\n\n  .inner-content {\n    flex: 1;\n  }\n\n  .custom-label {\n    width: 80px;\n  }\n\n  .name {\n    width: 100% !important;\n    text-align: left !important;\n  }\n`;\n\nconst INITIAL_VALUE = {\n  name: '',\n  compressed: false,\n  pretty: false,\n  includeData: false,\n};\n\nfunction SaveAsModal({ onClose, onSave, name }) {\n  const refForm = useRef();\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (values) => {\n      onSave(values);\n      onClose();\n    },\n    [onClose, onSave],\n  );\n\n  return (\n    <div css={[ModalStyles, styles]}>\n      <div className=\"header handle\">\n        <span>Save as ... </span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <FormikForm\n          ref={refForm}\n          initialValues={{ ...INITIAL_VALUE, name }}\n          onSubmit={submitHandler}\n        >\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Name</span>\n            <FormikInput\n              label=\"\"\n              name=\"name\"\n              className=\"name\"\n              style={{\n                container: { width: '100%' },\n              }}\n            />\n          </div>\n\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Compressed</span>\n            <FormikCheckBox name=\"compressed\" />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Pretty Format</span>\n            <FormikCheckBox name=\"pretty\" />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Include Data</span>\n            <FormikCheckBox name=\"includeData\" />\n          </div>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <button type=\"button\" onClick={handleSave} className=\"save-button\">\n          Save\n        </button>\n        <button type=\"button\" onClick={onClose} className=\"save-button\">\n          Close\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default SaveAsModal;\n","export function getToFix(nucleusArray) {\n  if (!Array.isArray(nucleusArray)) nucleusArray = [nucleusArray];\n  let toFix = [];\n  for (let nucleus of nucleusArray) {\n    toFix.push(chooseDecimal(nucleus));\n  }\n  return toFix;\n}\n\nfunction chooseDecimal(nucleus) {\n  switch (nucleus.toUpperCase()) {\n    case '1H':\n      return 2;\n    case '13C':\n      return 1;\n    default:\n      return 1;\n  }\n}\n","import { getToFix } from './getToFix';\n\nexport function get1DSignals(data, labels, options = {}) {\n  const { prefix, nmrRecord } = options;\n  let str = '';\n  let nucleusArray = [];\n  let nbOneD = 0;\n  for (let spectrum of data) {\n    if (spectrum.info.dimension > 1) continue;\n\n    let ranges = spectrum.ranges.values || [];\n\n    let nucleus = spectrum.info.nucleus;\n    let counter = 1;\n    let subfix = '';\n    nucleusArray.forEach((e) => {\n      if (e === nucleus) counter++;\n    });\n    nucleusArray.push(nucleus);\n\n    if (counter > 1) subfix = `#${counter}`;\n\n    str += `${prefix}1D_${nucleus.toUpperCase()}${subfix}>`;\n\n    if (spectrum.info.frequency) {\n      str += `\\nLarmor=${Number(spectrum.info.frequency).toFixed(2)}\\\\`;\n    }\n\n    str += `\\nSpectrum_Jcamp=file:./jcamp_folder/1d/${spectrum.display.name}\\\\`;\n    if (spectrum.source.jcamp) {\n      nmrRecord.file(\n        `jcamp_folder/1d/${spectrum.display.name}`,\n        spectrum.source.jcamp,\n      );\n    }\n\n    let toFix = getToFix(nucleus)[0];\n\n    for (let range of ranges) {\n      let signals = range.signal; //.filter((s) => s.diaID && s.diaID.length);\n\n      for (let signal of signals) {\n        let { multiplicity } = signal;\n        if ((!multiplicity || multiplicity === 'm') && nucleus === '1H') {\n          str += `\\n${Number(range.from).toFixed(toFix)}-${Number(\n            range.to,\n          ).toFixed(toFix)}`;\n        } else if (signal.delta) {\n          str += `\\n${Number(signal.delta).toFixed(toFix)}`;\n        } else {\n          continue;\n        }\n\n        let signalLabel = '';\n\n        if (signal.diaID && signal.diaID.length > 0) {\n          signal.diaID.forEach((diaID, i, arr) => {\n            let separator = ', ';\n            if (i === arr.length - 1) separator = '';\n            let label = labels.byDiaID[diaID].label || diaID;\n            signalLabel += `(${label})${separator}`;\n          });\n          str += `, L=${signalLabel}`;\n        }\n\n        if (nucleus === '1H') {\n          if (signal.multiplicity) str += `, S=${signal.multiplicity}`;\n\n          let jCoupling = signal.j;\n          if (Array.isArray(jCoupling) && jCoupling.length) {\n            let separator = ', J=';\n            for (let i = 0; i < jCoupling.length; i++) {\n              str += `${separator}${Number(jCoupling[i].coupling).toFixed(3)}`;\n              if (jCoupling[i].diaID) {\n                let { diaID } = jCoupling[i];\n                if (!Array.isArray(diaID)) diaID = [diaID];\n                if (!diaID.length) continue;\n                let jCouple = labels[diaID[0]].label || String(diaID[0]);\n                str += `(${jCouple})`;\n              }\n              separator = ', ';\n            }\n          }\n          if (range.integral) {\n            str += `, E=${Number(range.integral).toFixed(toFix)}`;\n          } else if (range.pubIntegral) {\n            str += `, E=${range.putIntegral.toFixed(toFix)}`;\n          } else if (range.signal[0].nbAtoms !== undefined) {\n            str += `, E=${range.signal[0].nbAtoms}`;\n          }\n        }\n      }\n      if (signals.length) str += '\\\\';\n    }\n    str += '\\n';\n    nbOneD++;\n  }\n  if (nbOneD > 0) nmrRecord.folder('jcamp_folder/1d');\n  return str;\n}\n","export function getCouplingObserved(experiment) {\n  switch (experiment.toLowerCase()) {\n    case 'hsqc':\n    case 'cosy':\n      return '1J';\n    case 'hmbc':\n      return 'NJ';\n    default:\n      return 'NJ';\n  }\n}\n","import { getCouplingObserved } from './getCouplingObserved';\nimport { getToFix } from './getToFix';\n\nconst isArray = Array.isArray;\n\nexport function get2DSignals(data, labels, options = {}) {\n  let { prefix, nmrRecord } = options;\n  let { byDiaID } = labels;\n  let str = '';\n  let nucleusRecorded = [];\n  let nbTwoD = 0;\n  for (let spectrum of data) {\n    if (spectrum.info.dimension < 2) continue;\n\n    let { nucleus, experiment, pulseSequence } = spectrum.info;\n\n    if (experiment) prefix = `\\n> 2D ${experiment} <NMREDATA_2D_`;\n\n    nucleusRecorded.push(nucleus);\n\n    let couplingObserved = getCouplingObserved(experiment);\n    if (nucleus) {\n      str += `${prefix}${nucleus[1]}_${couplingObserved}_${nucleus[0]}>`;\n    }\n    let toFix = getToFix(nucleus);\n\n    str += `\\nLarmor=${Number(spectrum.info.baseFrequency[0]).toFixed(2)}\\\\`;\n\n    str += `\\nSpectrum_Jcamp=file:./jcamp_folder/2d/${spectrum.display.name}\\\\`;\n    if (spectrum.source.jcamp) {\n      nmrRecord.file(\n        `jcamp_folder/2d/${spectrum.display.name}`,\n        spectrum.source.jcamp,\n      );\n    }\n\n    if (experiment) str += `\\nCorType=${experiment} \\\\`;\n    if (pulseSequence) str += `\\nPulseProgram=${pulseSequence} \\\\`;\n\n    let zones = spectrum.zones.values || [];\n    for (let zone of zones) {\n      let signals = zone.signal;\n      for (let signal of signals) {\n        let { x, y, peak } = signal;\n        let xLabel = getAssignment(x, byDiaID, toFix[0]);\n        let yLabel = getAssignment(y, byDiaID, toFix[1]);\n        let intensity = Math.max(...peak.map((e) => e.z));\n        str += `\\n${xLabel}/${yLabel}, I=${intensity.toFixed(2)}\\\\`;\n      }\n    }\n    nbTwoD++;\n  }\n  if (nbTwoD > 0) nmrRecord.folder('jcamp_folder/2d');\n  return str;\n}\n\nfunction getAssignment(axis, labels, toFix) {\n  let { diaID, delta } = axis;\n  if (diaID) {\n    if (!isArray(diaID)) diaID = [diaID];\n    if (diaID.length < 1) return Number(delta).toFixed(toFix);\n    let label = diaID.map((diaID) => labels[diaID].label).join(',');\n    return diaID.length > 1 ? `(${label})` : label;\n  }\n  return Number(delta).toFixed(toFix);\n}\n","export function flat2DSignals(signals) {\n  let flattedSignal = [];\n  for (let i = 0; i < signals.length; i++) {\n    let { x, y } = signals[i];\n    flattedSignal.push(x, y);\n  }\n  return flattedSignal;\n}\n","import { getShortestPaths } from 'openchemlib-utils';\n\nimport { flat2DSignals } from './flat2DSignals';\nimport { getToFix } from './getToFix';\n\nexport function getLabels(data, options = {}) {\n  const { groupedDiaIDs, molecule } = options;\n\n  let connections = getShortestPaths(molecule, { toLabel: 'H', maxLength: 1 });\n\n  let byDiaID = {};\n  let byAssignNumber = {};\n  for (let spectrum of data) {\n    let { dimension, nucleus } = spectrum.info;\n    let toFix = getToFix(nucleus);\n\n    let [roiKey, flatSignals] =\n      dimension > 1 ? ['zones', flat2DSignals] : ['ranges', (s) => s || []];\n\n    let rois = spectrum[roiKey].values || [];\n    for (let roi of rois) {\n      let signals = flatSignals(roi.signal);\n      for (let i = 0; i < signals.length; i++) {\n        let diaIDs = signals[i].diaID || [];\n        for (let diaID of diaIDs) {\n          let delta = Number(signals[i].delta).toFixed(toFix[i % dimension]);\n          // get atomLabel\n          let groupedOclID = groupedDiaIDs.find((dia) => {\n            if (dia.oclID === diaID) return true;\n            return false;\n          });\n          // the addition of one in atom number it is because the atoms enumeration starts from zero\n\n          let labelOptions = {\n            atom: groupedOclID.atoms[0],\n            molecule,\n            connections,\n            atomLabel: groupedOclID.atomLabel,\n          };\n\n          byDiaID[diaID] = {\n            atoms: groupedOclID.atoms.map((e) => e + 1),\n            shift: delta,\n            label: createLabel(labelOptions),\n          };\n\n          for (let atom of groupedOclID.atoms) {\n            labelOptions.atom = atom;\n            byAssignNumber[atom] = {\n              shift: delta,\n              diaID,\n              label: createLabel(labelOptions),\n            };\n          }\n        }\n      }\n    }\n  }\n  return { byAssignNumber, byDiaID };\n}\n\nfunction createLabel(options) {\n  const { atom, molecule, atomLabel, connections } = options;\n  let label = '';\n  if (atomLabel !== 'C') {\n    let connectedTo = connections[atom];\n    let path = connectedTo.find((e) => e && e.length > 1);\n    let pLabel = `${atomLabel}${path[0] + 1}`;\n    let hLabel = `${molecule.getAtomLabel(path[1])}${path[1] + 1}`;\n    label = `${pLabel}${hLabel}`;\n  } else {\n    label = `${atomLabel}${atom + 1}`;\n  }\n  return label;\n}\n","import jszip from 'jszip';\nimport { getGroupedDiastereotopicAtomIDs } from 'openchemlib-utils';\nimport { Molecule as OCLMolecule } from 'openchemlib/full';\n\nimport { get1DSignals } from './util/get1DSignals';\nimport { get2DSignals } from './util/get2DSignals';\nimport { getLabels } from './util/getLabels';\n\nconst tags = {\n  solvent: 'SOLVENT',\n  temperature: 'TEMPERATURE',\n  assignment: 'ASSIGNMENT',\n  j: 'J',\n  signals: 'SIGNALS',\n  id: 'ID',\n};\n\nexport function toNmredata(state, options = {}) {\n  const {\n    data, // it would be changed depending of the final location\n    molecules,\n  } = state || {\n    data: [], // it would be changed depending of the final location\n    molecules: [],\n  };\n\n  const { id, prefix = '\\n> <NMREDATA_', filename = 'nmredata' } = options;\n\n  let sdfResult = '';\n  let nmrRecord = new jszip();\n\n  let molecule = OCLMolecule.fromMolfile(molecules[0].molfile);\n  molecule.addImplicitHydrogens();\n  let groupedDiaIDs = getGroupedDiastereotopicAtomIDs(molecule);\n\n  let groupedOptions = {\n    prefix,\n    molecule,\n    groupedDiaIDs,\n    nmrRecord,\n  };\n\n  sdfResult += molecule.toMolfile();\n  let labels = getLabels(data, groupedOptions);\n  sdfResult += `${prefix}VERSION>\\n1.1\\\\\\n`;\n  sdfResult += putTag(data, 'temperature', { prefix });\n  sdfResult += putTag(data, 'solvent', { prefix });\n\n  if (id) {\n    sdfResult += `${prefix + tags.id}>\\nid\\\\\\n`;\n  }\n\n  sdfResult += formatAssignments(labels.byDiaID, groupedOptions);\n  sdfResult += get1DSignals(data, labels, groupedOptions);\n  sdfResult += get2DSignals(data, labels, groupedOptions);\n  sdfResult += '\\n$$$$\\n';\n  nmrRecord.file(`${filename}.sdf`, sdfResult);\n  return nmrRecord;\n}\n\nfunction formatAssignments(labels, options) {\n  const { prefix } = options;\n  let str = `${prefix + tags.assignment}>\\n`;\n  for (let l in labels) {\n    let atoms = labels[l].atoms;\n    str += `${labels[l].label}, ${labels[l].shift}`; // change to add label\n    for (let atom of atoms) str += `, ${atom}`;\n    str += '\\\\\\n';\n  }\n  return str;\n}\n\nfunction putTag(spectra, tag, options = {}) {\n  const { prefix } = options;\n  let str = '';\n  for (let spectrum of spectra) {\n    if (spectrum.info[tag]) {\n      str += `${prefix + tags[tag]}>\\n${String(spectrum.info[tag])}\\\\\\n`;\n      break;\n    }\n  }\n  return str;\n}\n","import { useCallback } from 'react';\n\nimport { toJSON } from '../../data/SpectraManager';\nimport { useChartData } from '../context/ChartContext';\nimport { useAlert } from '../elements/popup/Alert';\nimport { positions, useModal } from '../elements/popup/Modal';\nimport SaveAsModal from '../modal/SaveAsModal';\nimport {\n  copyPNGToClipboard,\n  exportAsJSON,\n  exportAsNMRE,\n  exportAsPng,\n  exportAsSVG,\n} from '../utility/Export';\nimport { toNmredata } from '../utility/toNmredata';\n\nexport default function useExport() {\n  const modal = useModal();\n  const alert = useAlert();\n  const state = useChartData();\n\n  const saveToClipboardHandler = useCallback(async () => {\n    if (state.data.length > 0) {\n      const hideLoading = await alert.showLoading(\n        'Exporting as numrium process in progress',\n      );\n      setTimeout(() => {\n        copyPNGToClipboard('nmrSVG');\n        hideLoading();\n        alert.success('Image copied to clipboard');\n      }, 0);\n    }\n  }, [alert, state]);\n\n  const saveAsJSONHandler = useCallback(\n    async (spaceIndent = 0, isCompressed = true) => {\n      if (state.data.length > 0) {\n        const hideLoading = await alert.showLoading(\n          'Exporting as numrium process in progress',\n        );\n        setTimeout(async () => {\n          //exported file name by default will be the first spectrum name\n          const fileName = state.data[0]?.display?.name;\n          const exportedData = toJSON(state);\n          await exportAsJSON(exportedData, fileName, spaceIndent, isCompressed);\n          hideLoading();\n        }, 0);\n      }\n    },\n    [alert, state],\n  );\n\n  const saveAsNMREHandler = useCallback(async () => {\n    if (state.data.length > 0) {\n      const hideLoading = await alert.showLoading(\n        'Exporting as NMRE process in progress',\n      );\n      setTimeout(() => {\n        const fileName = state.data[0]?.display?.name;\n        const exportedData = toNmredata(state);\n        exportAsNMRE(exportedData, fileName);\n        hideLoading();\n      }, 0);\n    }\n  }, [alert, state]);\n\n  const saveAsSVGHandler = useCallback(async () => {\n    if (state.data.length > 0) {\n      const hideLoading = await alert.showLoading(\n        'Exporting as SVG process in progress',\n      );\n      setTimeout(() => {\n        const fileName = state.data[0]?.display?.name;\n        exportAsSVG(fileName, 'nmrSVG');\n        hideLoading();\n      }, 0);\n    }\n  }, [alert, state.data]);\n\n  const saveAsPNGHandler = useCallback(async () => {\n    if (state.data.length > 0) {\n      const hideLoading = await alert.showLoading(\n        'Exporting as PNG process in progress',\n      );\n      setTimeout(() => {\n        const fileName = state.data[0]?.display?.name;\n        exportAsPng(fileName, 'nmrSVG');\n        hideLoading();\n      }, 0);\n    }\n  }, [alert, state.data]);\n\n  const saveHandler = useCallback(\n    async (options) => {\n      const { name, pretty, compressed, includeData } = options;\n      const hideLoading = await alert.showLoading(\n        `Exporting as ${name}.numrium process in progress`,\n      );\n      setTimeout(async () => {\n        const exportedData = toJSON(state, includeData);\n        const spaceIndent = pretty ? 2 : 0;\n        await exportAsJSON(exportedData, name, spaceIndent, compressed);\n        hideLoading();\n      }, 0);\n    },\n    [alert, state],\n  );\n  const saveAsHandler = useCallback(async () => {\n    if (state.data.length > 0) {\n      const fileName = state.data[0]?.display?.name;\n      modal.show(<SaveAsModal name={fileName} onSave={saveHandler} />, {\n        isBackgroundBlur: false,\n        position: positions.TOP_CENTER,\n        width: 400,\n        height: 280,\n      });\n\n      // const hideLoading = await alert.showLoading(\n      //   'Exporting as PNG process in progress',\n      // );\n      // setTimeout(() => {\n      //   const fileName = state.data[0]?.display?.name;\n      //   exportAsPng(fileName, 'nmrSVG');\n      //   hideLoading();\n      // }, 0);\n    }\n  }, [modal, saveHandler, state.data]);\n\n  return {\n    saveToClipboardHandler,\n    saveAsJSONHandler,\n    saveAsNMREHandler,\n    saveAsSVGHandler,\n    saveAsPNGHandler,\n    saveAsHandler,\n  };\n}\n","import lodashDebounce from 'lodash/debounce';\nimport lodashMap from 'lodash/map';\nimport { useCallback, useRef, useState } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport { useAlert } from '../elements/popup/Alert';\nimport { ZoomType } from '../reducer/actions/Zoom';\nimport {\n  CHANGE_SPECTRUM_DISPLAY_VIEW_MODE,\n  FULL_ZOOM_OUT,\n  SET_SELECTED_TOOL,\n  SET_SPECTRUMS_VERTICAL_ALIGN,\n  TOGGLE_REAL_IMAGINARY_VISIBILITY,\n} from '../reducer/types/Types';\nimport { options } from '../toolbar/ToolTypes';\n\nexport default function useToolsFunctions() {\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const [isRealSpectrumShown, setIsRealSpectrumShown] = useState(false);\n\n  const debounceClickEventsRef = useRef({ clicks: [] });\n  const handleChangeOption = useCallback(\n    (selectedTool) => {\n      if (\n        [\n          options.peakPicking.id,\n          options.integral.id,\n          options.zone2D.id,\n        ].includes(selectedTool)\n      ) {\n        alert.show(\n          'Press Shift + Left Mouse button to select zone for integral and peak picking',\n        );\n      }\n      dispatch({ type: SET_SELECTED_TOOL, selectedTool });\n    },\n    [alert, dispatch],\n  );\n\n  const handleFullZoomOut = useCallback(() => {\n    if (debounceClickEventsRef.current.clicks.length === 0) {\n      dispatch({\n        type: FULL_ZOOM_OUT,\n        zoomType: ZoomType.HORIZONTAL,\n      });\n    }\n    const callback = lodashDebounce(() => {\n      debounceClickEventsRef.current.clicks = [];\n    }, 500);\n    debounceClickEventsRef.current.clicks.push(callback);\n\n    callback();\n\n    if (debounceClickEventsRef.current.clicks.length > 1) {\n      lodashMap(debounceClickEventsRef.current.clicks, (debounce) =>\n        debounce.cancel(),\n      );\n      debounceClickEventsRef.current.clicks = [];\n      dispatch({\n        type: FULL_ZOOM_OUT,\n      });\n    }\n  }, [dispatch, debounceClickEventsRef]);\n\n  const changeDisplayViewModeHandler = useCallback(() => {\n    dispatch({\n      type: CHANGE_SPECTRUM_DISPLAY_VIEW_MODE,\n    });\n  }, [dispatch]);\n\n  const changeSpectrumViewHandler = useCallback(() => {\n    dispatch({\n      type: TOGGLE_REAL_IMAGINARY_VISIBILITY,\n      isRealSpectrumVisible: !isRealSpectrumShown,\n    });\n    setIsRealSpectrumShown(!isRealSpectrumShown);\n  }, [dispatch, isRealSpectrumShown]);\n\n  const alignSpectrumsVerticallyHandler = useCallback(() => {\n    dispatch({\n      type: SET_SPECTRUMS_VERTICAL_ALIGN,\n    });\n  }, [dispatch]);\n\n  return {\n    handleChangeOption,\n    handleFullZoomOut,\n    changeDisplayViewModeHandler,\n    changeSpectrumViewHandler,\n    alignSpectrumsVerticallyHandler,\n    isRealSpectrumShown,\n  };\n}\n","import { useCallback, useEffect, useMemo } from 'react';\n\nimport checkModifierKeyActivated from '../../data/utilities/checkModifierKeyActivated';\nimport { useAssignmentData } from '../assignment';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { useLoader } from '../context/LoaderContext';\nimport { useAlert } from '../elements/popup/Alert';\nimport { TYPES, useHighlightData } from '../highlight/index';\nimport useExport from '../hooks/useExport';\nimport useToolsFunctions from '../hooks/useToolsFunctions';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\nimport {\n  SET_KEY_PREFERENCES,\n  APPLY_KEY_PREFERENCES,\n  DELETE_INTEGRAL,\n  DELETE_PEAK_NOTATION,\n  DELETE_RANGE,\n  DELETE_2D_ZONE,\n  DELETE_EXCLUSION_ZONE,\n} from '../reducer/types/Types';\nimport { options } from '../toolbar/ToolTypes';\n\nfunction KeysListenerTracker() {\n  const {\n    keysPreferences,\n    displayerMode,\n    overDisplayer,\n    data,\n  } = useChartData();\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const loader = useLoader();\n\n  const {\n    handleChangeOption,\n    handleFullZoomOut,\n    alignSpectrumsVerticallyHandler,\n    changeDisplayViewModeHandler,\n  } = useToolsFunctions();\n\n  const {\n    saveToClipboardHandler,\n    saveAsJSONHandler,\n    saveAsHandler,\n  } = useExport();\n\n  const { highlight } = useHighlightData();\n  const assignmentData = useAssignmentData();\n\n  const allow1DTool = useMemo(() => {\n    return displayerMode === DISPLAYER_MODE.DM_1D && data && data.length > 0;\n  }, [data, displayerMode]);\n\n  const allow2DTool = useMemo(() => {\n    return displayerMode === DISPLAYER_MODE.DM_2D && data && data.length > 0;\n  }, [data, displayerMode]);\n\n  const deleteHandler = useCallback(\n    (type, data) => {\n      switch (type) {\n        case TYPES.INTEGRAL: {\n          dispatch({\n            type: DELETE_INTEGRAL,\n            integralID: data.activeKey,\n          });\n          break;\n        }\n        case TYPES.PEAK: {\n          dispatch({\n            type: DELETE_PEAK_NOTATION,\n            data: { id: data.activeKey },\n          });\n          break;\n        }\n        case TYPES.RANGE: {\n          dispatch({\n            type: DELETE_RANGE,\n            payload: {\n              id: data.activeKey,\n              assignmentData,\n            },\n          });\n          break;\n        }\n        case TYPES.ZONE: {\n          dispatch({\n            type: DELETE_2D_ZONE,\n            payload: {\n              id: data.activeKey,\n              assignmentData,\n            },\n          });\n          break;\n        }\n        case TYPES.EXCLUSION_ZONE: {\n          dispatch({\n            type: DELETE_EXCLUSION_ZONE,\n            payload: {\n              id: data.activeKey,\n            },\n          });\n          break;\n        }\n        default:\n          break;\n      }\n    },\n    [assignmentData, dispatch],\n  );\n\n  const keysPreferencesListenerHandler = useCallback(\n    (e, num) => {\n      if (data && data.length > 0 && num >= 1 && num <= 9) {\n        if (e.shiftKey) {\n          dispatch({\n            type: SET_KEY_PREFERENCES,\n            keyCode: num,\n          });\n          alert.show(`Configuration Reset, press '${num}' again to reload it.`);\n        } else {\n          if (!checkModifierKeyActivated(e)) {\n            if (keysPreferences && keysPreferences[num]) {\n              dispatch({\n                type: APPLY_KEY_PREFERENCES,\n                keyCode: num,\n              });\n            } else {\n              dispatch({\n                type: SET_KEY_PREFERENCES,\n                keyCode: num,\n              });\n              alert.show(\n                `Configuration saved, press '${num}' again to reload it.`,\n              );\n            }\n          }\n        }\n      }\n    },\n    [alert, data, dispatch, keysPreferences],\n  );\n\n  const toolsListenerHandler = useCallback(\n    (e) => {\n      if (!e.shiftKey && !e.metaKey) {\n        switch (e.key) {\n          case 'f':\n            handleFullZoomOut();\n            break;\n          case 'z':\n          case 'Escape':\n            handleChangeOption(options.zoom.id);\n            break;\n          case 'r': {\n            if (allow1DTool) {\n              handleChangeOption(options.rangesPicking.id);\n            }\n            break;\n          }\n          case 'b': {\n            if (allow1DTool) {\n              handleChangeOption(options.baseLineCorrection.id);\n            }\n            break;\n          }\n          case 'p': {\n            if (allow1DTool) {\n              handleChangeOption(options.peakPicking.id);\n            }\n            break;\n          }\n          case 'i': {\n            const toolID = allow2DTool\n              ? options.zone2D.id\n              : allow1DTool\n              ? options.integral.id\n              : '';\n            handleChangeOption(toolID);\n            break;\n          }\n          case 'a': {\n            if (allow1DTool) {\n              handleChangeOption(options.phaseCorrection.id);\n            }\n            break;\n          }\n          default:\n        }\n      }\n\n      if (!e.shiftKey && !e.metaKey && !e.ctrlKey) {\n        switch (e.key) {\n          case 'c': {\n            if (allow1DTool) {\n              alignSpectrumsVerticallyHandler();\n            }\n            break;\n          }\n          case 's': {\n            if (allow1DTool) {\n              changeDisplayViewModeHandler();\n            }\n            break;\n          }\n          default:\n        }\n      }\n\n      if (!e.shiftKey && (e.metaKey || e.ctrlKey)) {\n        switch (e.key) {\n          case 'c':\n            saveToClipboardHandler();\n            e.preventDefault();\n            break;\n          case 's':\n            saveAsJSONHandler();\n            e.preventDefault();\n            break;\n          case 'o':\n            loader.open();\n            e.preventDefault();\n            break;\n          default:\n        }\n      }\n      if (e.shiftKey && (e.metaKey || e.ctrlKey)) {\n        switch (e.key) {\n          case 'S':\n            saveAsHandler();\n            e.preventDefault();\n            break;\n          default:\n        }\n      }\n    },\n    [\n      alignSpectrumsVerticallyHandler,\n      allow1DTool,\n      allow2DTool,\n      changeDisplayViewModeHandler,\n      handleChangeOption,\n      handleFullZoomOut,\n      loader,\n      saveAsHandler,\n      saveAsJSONHandler,\n      saveToClipboardHandler,\n    ],\n  );\n\n  const handleOnKeyDown = useCallback(\n    (e) => {\n      const {\n        highlighted: [activeKey],\n        type,\n      } = highlight;\n      if (\n        !['input', 'textarea'].includes(e.target.localName) &&\n        overDisplayer\n      ) {\n        const num = Number(e.code.substr(e.code.length - 1)) || 0;\n        if (num > 0) {\n          keysPreferencesListenerHandler(e, num);\n        } else {\n          if ([('Escape', 'Esc', 'Backspace')].includes(e.key) && type) {\n            deleteHandler(type, { activeKey });\n          } else {\n            toolsListenerHandler(e);\n          }\n        }\n      }\n    },\n    [\n      deleteHandler,\n      highlight,\n      keysPreferencesListenerHandler,\n      overDisplayer,\n      toolsListenerHandler,\n    ],\n  );\n\n  useEffect(() => {\n    document.addEventListener('keydown', handleOnKeyDown, true);\n\n    return () => document.removeEventListener('keydown', handleOnKeyDown, true);\n  }, [handleOnKeyDown]);\n\n  return null;\n}\n\nexport default KeysListenerTracker;\n","let baseURL = '';\n\nexport function setBaseUrl(newBaseUrl) {\n  baseURL = newBaseUrl;\n}\n\nfunction getHelpList() {\n  return {\n    zoomIn: {\n      text: 'Zoom Tool',\n      filePath: `${baseURL}/help/zoom-and-scale`,\n    },\n    peakPicking: {\n      text: 'peak picking tool',\n      filePath: `${baseURL}/help/peaks`,\n    },\n    integralPicking: {\n      text: 'integral tool',\n      filePath: `${baseURL}/help/integrations`,\n    },\n    fullScreen: {\n      text: 'Full Screen mode',\n      filePath: `${baseURL}/help/general`,\n    },\n    loadSpectrum: {\n      text: 'load spectrums',\n      filePath: `${baseURL}/help/loading-a-spectrum`,\n    },\n  };\n}\nexport default getHelpList;\n","import React from 'react';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nfunction ButtonToolTip({\n  children,\n  style,\n  onClick,\n  popupTitle,\n  popupPlacement,\n  ...props\n}) {\n  return (\n    <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n      <button style={style} type=\"button\" onClick={onClick} {...props}>\n        {children}\n      </button>\n    </ToolTip>\n  );\n}\n\nButtonToolTip.defaultProps = {\n  popupTitle: '',\n  popupPlacement: 'right',\n  style: {},\n  onClick: () => null,\n  disabled: false,\n};\n\nexport default ButtonToolTip;\n","import React from 'react';\n\nfunction Logo({ width = 100, height = 100 }) {\n  return (\n    <svg\n      style={{ width: width, height: height }}\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 752.34 221.73\"\n    >\n      <path\n        fill=\"#ea580c\"\n        fillRule=\"evenodd\"\n        d=\"M.64,31.7A31.67,31.67,0,0,1,54.72,9.29l0,0A31.66,31.66,0,0,1,64,31.7V190a13.39,13.39,0,0,0,26.77,0V54a31.7,31.7,0,0,1,31.7-31.7V40.58A13.38,13.38,0,0,0,109.13,54V190a31.71,31.71,0,0,1-63.41,0V31.7a13.29,13.29,0,0,0-3.88-9.46l0,0A13.41,13.41,0,0,0,19,31.7V164.82H.64Z\"\n      />\n      <path\n        fill=\"#2b143e\"\n        fillRule=\"evenodd\"\n        d=\"M154.21,54v68.17a13.34,13.34,0,0,0,3.89,9.47h0A13.39,13.39,0,0,0,181,122.14V99.32h-.06a31.63,31.63,0,0,1,9.29-22.38l0,0a31.65,31.65,0,0,1,44.8,0l0,0a31.58,31.58,0,0,1,9.3,22.39V118H226V99.32a13.3,13.3,0,0,0-3.89-9.46h0a13.44,13.44,0,0,0-18.93,0l0,0a13.3,13.3,0,0,0-3.83,8.19v24.09a31.7,31.7,0,0,1-54.11,22.42v0a31.66,31.66,0,0,1-9.3-22.4V54Z\"\n      />\n      <path\n        fill=\"#2b143e\"\n        fillRule=\"evenodd\"\n        d=\"M729.19,96.34c-8.65,0-14.26,3.17-17.67,8-3.41-5.12-8.78-8-16-8-8.16,0-13.52,3.17-16.32,7.31v-5.6H661V159h18.28V124.62c0-7.19,3.41-11.46,9.5-11.46,5.85,0,8.78,3.9,8.78,10V159h18.27V124.62c0-7.19,3.42-11.46,9.51-11.46,5.85,0,8.77,3.9,8.77,10V159h18.28V121.57C752.34,106.33,743.2,96.34,729.19,96.34Z\"\n      />\n      <path\n        fill=\"#2b143e\"\n        fillRule=\"evenodd\"\n        d=\"M629.26,98.05v33.26c0,8.66-4.63,12.56-11.33,12.56-5.85,0-10.6-3.54-10.6-11.09V98.05H589.05v37.41c0,16.45,10.48,25.22,22.79,25.22,8,0,14.13-2.92,17.42-7.43V159h18.28V98.05Z\"\n      />\n      <rect fill=\"#2b143e\" x=\"558.22\" y=\"98.05\" width=\"18.28\" height=\"60.93\" />\n      <path\n        fill=\"#2b143e\"\n        fillRule=\"evenodd\"\n        d=\"M567.36,92.68a11,11,0,1,0-11-11A11.08,11.08,0,0,0,567.36,92.68Z\"\n      />\n      <path\n        fill=\"#ea580c\"\n        fillRule=\"evenodd\"\n        d=\"M478.77,159H498V116.57L525.66,159H549.2l-22.3-34.75c5.45-2.13,8.12-4.14,11.48-8.86a31.07,31.07,0,0,0,6.07-18.26V94.62c0-10.61-3.45-15.93-9.28-21.78S520.75,63.09,510,63.09H478.71l.06,95.89Zm33.1-50.27h-6.46v-.06H498V82.19h10.87c4.67,0,9.44,1.38,11.94,3.81a12.84,12.84,0,0,1,3.81,9.2C524.58,102.52,518.92,108.71,511.87,108.71Z\"\n      />\n      <polygon\n        fill=\"#ea580c\"\n        fillRule=\"evenodd\"\n        points=\"372.91 60.8 372.91 158.98 392.16 158.98 392.16 119.23 419.91 157.41 447.61 119.23 447.61 158.98 466.87 158.98 466.87 60.8 419.91 125.22 372.91 60.8\"\n      />\n      <polygon\n        fill=\"#ea580c\"\n        fillRule=\"evenodd\"\n        points=\"283.89 61.04 283.89 159.1 303.14 159.1 303.14 105.85 361.01 160.93 361.01 62.83 341.67 62.83 341.67 116.08 283.89 61.04\"\n      />\n    </svg>\n  );\n}\n\nexport default Logo;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useEffect, useState } from 'react';\n\nimport CloseButton from '../elements/CloseButton';\nimport Logo from '../elements/Logo';\n\nasync function getData(url) {\n  try {\n    const response = await fetch(url);\n    return response.json();\n  } catch (e) {\n    return null;\n  }\n}\n\nconst baseUrl = 'https://api.github.com/repos/cheminfo/nmrium';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  user-select:\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 34px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    padding: 5px;\n\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n      user-select: none;\n\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    width: 100%;\n    height: 100%;\n    padding: 20px;\n  }\n\n  .center-container {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n  }\n  ul {\n    list-style-type: disc;\n    margin-left:20px;\n    }\n  span,li{\n    user-select: text;\n  }\n  span.title {\n    font-weight: bold;\n    color: #ea580c;\n  }\n  span.content {\n    color: #2b143e;\n    font-size: 14px;\n    text-align: left;\n  }\n\n  img {\n    width: 100px;\n  }\n\n  a {\n    color: #969696;\n  }\n\n  a:hover,\n  a:focus {\n    color: #00bcd4;\n  }\n\n  .separator {\n    border-bottom: 1px solid gray;\n    width: 15px;\n    height: 1px;\n    margin: 10px 0px;\n  }\n`;\n\nfunction AboutUsModal({ onClose }) {\n  const [info, setInfo] = useState();\n  useEffect(() => {\n    getData(`${baseUrl}/tags`).then((data) => {\n      setInfo(data);\n    });\n  }, []);\n\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>About Us</span>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div className=\"container\">\n        <div className=\"center-container\">\n          <Logo width={160} height={50} />\n          <span> {info && info[0].name}</span>\n\n          <span className=\"separator\" />\n\n          <a href=\"https://git.nmrium.org\" target=\"_blank\" rel=\"noreferrer\">\n            GibHub ( https://git.nmrium.org )\n          </a>\n        </div>\n        <div className=\"center-container\">\n          <span className=\"separator\" />\n          <span className=\"title\">About Us</span>\n          <span className=\"separator\" />\n        </div>\n\n        <span className=\"content\">\n          This project is developed by Zakodium Sàrl (Switzerland), the\n          University of Cologne (Germany), Johannes Gutenberg University Mainz\n          (Germany) and Universidad del Valle (Colombia).\n        </span>\n        <div className=\"center-container\">\n          <span className=\"separator\" />\n          <span className=\"title\">Funding is provided by</span>\n          <span className=\"separator\" />\n        </div>\n\n        <div className=\"content\">\n          <ul>\n            <li>\n              IDNMR grant, which part of the Scientific Library Services and\n              Information Systems (LIS) initiative of the DFG.\n            </li>\n            <li>Zakodium Sàrl (Switzerland).</li>\n            <li>Universidad del Valle (Cali, Colombia).</li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nAboutUsModal.defaultProps = {\n  onClose: () => {\n    return null;\n  },\n};\nexport default AboutUsModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\n\nimport getHelpData from '../constants/help';\nimport CloseButton from '../elements/CloseButton';\n\nconst styles = css`\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  .manual-header {\n    .title {\n      text-align: center;\n      padding: 10px 0 10px 0px;\n      margin: 0px;\n      color: #000000;\n      place-items: normal;\n      text-transform: none;\n      background-color: #fafafa;\n    }\n\n    .close-bt {\n      border: none;\n      color: red;\n      background-color: transparent;\n      outline: none;\n      position: absolute;\n      right: 15px;\n      top: 10px;\n    }\n  }\n  .main-content {\n    width: 100%;\n    height: 100%;\n    border: none;\n    padding-left: 5px;\n  }\n\n  .inner-container {\n    padding: 5px;\n    width: 100%;\n    height: 100%;\n  }\n\n  .tab-content {\n    width: 100%;\n  }\n`;\n\nfunction UserManualModal({ onClose }) {\n  const filePath = getHelpData().loadSpectrum.filePath;\n\n  return (\n    <div css={styles}>\n      <div className=\"manual-header handle\">\n        <h6 className=\"title\">User Manual</h6>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"main-content\">\n        <div className=\"inner-container\">\n          <iframe\n            title=\"General User Manual \"\n            src={filePath}\n            frameBorder=\"0\"\n            scrolling=\"auto\"\n            style={{ width: '100%', height: '100%' }}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default UserManualModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FaTimes } from 'react-icons/fa';\n\nconst styles = css`\n  border-radius: 50%;\n  width: 16px;\n  height: 16px;\n  background-color: transparent;\n  border: none;\n  padding: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  :hover {\n    background-color: red;\n    border-radius: 50%;\n\n    .icon {\n      color: white;\n    }\n  }\n\n  .icon {\n    color: #252525;\n    width: 8px;\n  }\n`;\n\nfunction DeleteButton({ onDelete, className = 'delete' }) {\n  return (\n    <button css={styles} className={className} type=\"button\" onClick={onDelete}>\n      <FaTimes className=\"icon\" />\n    </button>\n  );\n}\n\nexport default DeleteButton;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport { memo, useCallback } from 'react';\n\nimport DeleteButton from './DeleteButton';\n\nconst styles = (styles) => css`\n  position: relative;\n\n  .delete {\n    position: absolute;\n    top: 2px;\n    left: 2px;\n  }\n\n  ${styles}\n`;\n\nfunction Tab({\n  tabid,\n  tablabel,\n  activeTab,\n  onClick,\n  canDelete,\n  onDelete,\n  tabstyles,\n}) {\n  let className = 'tab-list-item';\n\n  // use tab identifier if given (higher priority)\n  if (activeTab === tabid) {\n    className += ' tab-list-active';\n  }\n\n  const clickHandler = useCallback(\n    (e) => {\n      onClick({ ...e, tablabel, tabid });\n    },\n    [onClick, tablabel, tabid],\n  );\n  const deleteHandler = useCallback(\n    (e) => {\n      // stop propagation here to not have set it\n      // as active tab too (via tab click event triggering)\n      e.stopPropagation();\n      onDelete({ ...e, tablabel, tabid });\n    },\n    [onDelete, tablabel, tabid],\n  );\n  return (\n    <li className={className} onClick={clickHandler} css={styles(tabstyles)}>\n      {canDelete && <DeleteButton onDelete={deleteHandler} />}\n      {tablabel}\n    </li>\n  );\n}\n\nTab.propTypes = {\n  activeTab: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  tablabel: PropTypes.string.isRequired,\n  onClick: PropTypes.func.isRequired,\n  tabid: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  canDelete: PropTypes.bool,\n};\n\nexport default memo(Tab);\n","export const positions = {\n  TOP: 'TOP',\n  LEFT: 'LEFT',\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport {\n  useState,\n  useCallback,\n  useEffect,\n  useMemo,\n  Children,\n  cloneElement,\n  memo,\n} from 'react';\n\nimport Tab from './Tab';\nimport { positions } from './options';\n\nconst topStyles = css`\n  height: 100%;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n\n  .tab-list {\n    border-bottom: 1px solid #ccc;\n    padding-left: 0;\n    margin: 0;\n  }\n\n  .tab-list li:first-of-type {\n    margin-left: 5px;\n  }\n\n  .tab-list li:hover {\n    background-color: #f7f7f7;\n  }\n\n  .tab-list-item {\n    display: inline-block;\n    list-style: none;\n    margin-bottom: -1px;\n    padding: 0.5rem 2rem;\n  }\n\n  .tab-list-active {\n    background-color: white;\n    border: solid #ccc;\n    border-width: 1px 1px 0 1px;\n  }\n\n  .tab-content {\n    height: 100%;\n    overflow: auto;\n  }\n`;\n\nconst leftStyles = css`\n  display: flex;\n  height: 100%;\n  width: 100%;\n  .tab-list {\n    border-right: 1px solid #ccc;\n    padding-left: 0;\n    margin: 0;\n  }\n\n  .tab-list li:hover {\n    background-color: #f7f7f7;\n  }\n\n  .tab-list li:first-of-type {\n    margin-top: 10px;\n  }\n\n  .tab-list-item {\n    display: block;\n    list-style: none;\n    margin-right: -1px;\n    padding: 0.5rem 0.75rem;\n  }\n\n  .tab-list-active {\n    background-color: white;\n    border: solid #ccc;\n    border-width: 1px 0px 1px 1px;\n  }\n\n  .tab-content {\n    height: 100%;\n    overflow: auto;\n  }\n`;\n\nfunction Tabs({\n  children,\n  onClick,\n  defaultTabID,\n  position,\n  canDelete,\n  onDelete,\n}) {\n  const [activeTab, setActiveTab] = useState();\n\n  useEffect(() => {\n    setActiveTab(defaultTabID);\n  }, [defaultTabID]);\n\n  const onClickTabHandler = useCallback(\n    (tab) => {\n      const { tablabel, tabid } = tab;\n      onClick({ tablabel, tabid });\n      // use tab identifier if given (higher priority)\n      setActiveTab(tabid);\n    },\n    [onClick],\n  );\n\n  const tabs = useMemo(() => {\n    return Children.map(children, (child) => {\n      const { tablabel, tabid, candelete, tabstyles } = child.props;\n      const deleteFlag = candelete\n        ? candelete.toLowerCase() === 'true'\n        : canDelete;\n      return (\n        <Tab\n          activeTab={activeTab}\n          key={tabid}\n          tablabel={tablabel}\n          onClick={onClickTabHandler}\n          tabid={tabid}\n          canDelete={deleteFlag}\n          onDelete={onDelete}\n          tabstyles={tabstyles}\n        />\n      );\n    });\n  }, [activeTab, canDelete, children, onClickTabHandler, onDelete]);\n\n  const tabsContent = useMemo(() => {\n    return Children.map(children, (child) => {\n      const { tabid, style } = child.props;\n      if (tabid !== activeTab) {\n        return cloneElement(child, { style: { display: 'none' } });\n      }\n      return cloneElement(child, {\n        style: { display: 'block', ...style },\n      });\n    });\n  }, [activeTab, children]);\n\n  const styles = useMemo(() => {\n    switch (position) {\n      case positions.TOP:\n        return topStyles;\n      case positions.LEFT:\n        return leftStyles;\n      default:\n        return topStyles;\n    }\n  }, [position]);\n\n  return (\n    <div className=\"tabs\" css={styles}>\n      <ol className=\"tab-list\">{tabs}</ol>\n      <div className=\"tab-content\">{tabsContent}</div>\n    </div>\n  );\n}\n\nTabs.defaultProps = {\n  onClick: () => null,\n  onDelete: () => null,\n  position: 'TOP',\n  canDelete: false,\n};\n\nTabs.propTypes = {\n  children: PropTypes.array.isRequired,\n  onClick: PropTypes.func,\n  position: PropTypes.oneOf(['TOP', 'LEFT']),\n  canDelete: PropTypes.bool,\n  onDelete: PropTypes.func,\n};\n\nexport default memo(Tabs);\n","import { produce } from 'immer';\nimport lodashMerge from 'lodash/merge';\n\nimport {\n  getLocalStorage,\n  removeData,\n  storeData,\n} from '../utility/LocalStorage';\n\nexport const INIT_PREFERENCES = 'INIT_PREFERENCES';\nexport const SET_PREFERENCES = 'SET_PREFERENCES';\nexport const SET_PANELS_PREFERENCES = 'SET_PANELS_PREFERENCES';\nconst LOCAL_STORGAE_VERSION = '1';\nexport const preferencesInitialState = {\n  basePreferences: {},\n  display: {\n    general: {\n      disableMultipletAnalysis: false,\n      hideSetSumFromMolecule: false,\n    },\n\n    panels: {\n      hideSpectraPanel: false,\n      hideInformationPanel: false,\n      hidePeaksPanel: false,\n      hideIntegralsPanel: false,\n      hideRangesPanel: false,\n      hideStructuresPanel: false,\n      hideFiltersPanel: false,\n      hideZonesPanel: false,\n      hideSummaryPanel: false,\n      hideMultipleSpectraAnalysisPanel: false,\n    },\n\n    toolBarButtons: {\n      hideZoomTool: false,\n      hideZoomOutTool: false,\n      hideImport: false,\n      hideExportAs: false,\n      hideSpectraStackAlignments: false,\n      hideSpectraCenterAlignments: false,\n      hideRealImaginary: false,\n      hidePeakTool: false,\n      hideIntegralTool: false,\n      hideAutoRangesTool: false,\n      hideZeroFillingTool: false,\n      hidePhaseCorrectionTool: false,\n      hideBaseLineCorrectionTool: false,\n      hideFFTTool: false,\n      hideMultipleSpectraAnalysisTool: false,\n    },\n  },\n  controllers: {\n    mws: { low: 2, high: 20 },\n    help: {\n      preventAutoHelp: true,\n    },\n    dimmedSpectraTransparency: 0.1,\n  },\n  formatting: {\n    nucleus: [\n      { key: '1H', name: '1H', ppm: '0.00', hz: '0.00' },\n      { key: '13C', name: '13C', ppm: '0.00', hz: '0.00' },\n      { key: '15N', name: '15N', ppm: '0.00', hz: '0.00' },\n      { key: '19F', name: '19F', ppm: '0.00', hz: '0.00' },\n      { key: '29Si', name: '29Si', ppm: '0.00', hz: '0.00' },\n      { key: '31P', name: '31P', ppm: '0.00', hz: '0.00' },\n    ],\n    nucleusByKey: {},\n    panels: {},\n  },\n  dispatch: null,\n};\n\nconst mapNucleus = (draft) => {\n  if (draft.formatting.nucleus && Array.isArray(draft.formatting.nucleus)) {\n    draft.formatting.nucleusByKey = draft.formatting.nucleus.reduce(\n      (acc, item) => {\n        acc[item.name.toLowerCase()] = item;\n        return { ...acc };\n      },\n      {},\n    );\n  }\n};\n\nexport function preferencesReducer(state, action) {\n  switch (action.type) {\n    case INIT_PREFERENCES: {\n      const nmrLocalStorageVersion = getLocalStorage(\n        'nmr-local-storage-version',\n        false,\n      );\n      if (\n        !nmrLocalStorageVersion ||\n        nmrLocalStorageVersion !== LOCAL_STORGAE_VERSION\n      ) {\n        removeData('nmr-general-settings');\n        storeData('nmr-local-storage-version', LOCAL_STORGAE_VERSION);\n      }\n\n      const localData = getLocalStorage('nmr-general-settings');\n\n      return produce(state, (draft) => {\n        if (action.payload) {\n          const { dispatch, ...resPreferences } = action.payload;\n          draft.basePreferences = resPreferences;\n          draft.display = resPreferences.display;\n          draft.dispatch = dispatch;\n          if (localData) {\n            Object.entries(localData).forEach(([k, v]) => {\n              draft[k] = lodashMerge(\n                v,\n                resPreferences[k] ? resPreferences[k] : {},\n              );\n            });\n            mapNucleus(draft, state);\n          }\n        }\n      });\n    }\n    case SET_PREFERENCES:\n      return produce(state, (draft) => {\n        if (action.payload) {\n          const data = action.payload;\n          draft.controllers = data.controllers;\n          draft.formatting = data.formatting;\n          draft.display.panels = data.display.panels;\n          mapNucleus(draft, data);\n        }\n      });\n    case SET_PANELS_PREFERENCES:\n      return produce(state, (draft) => {\n        if (action.payload) {\n          const { key, value } = action.payload;\n          draft.formatting.panels[key] = value;\n        }\n      });\n    default:\n      return state;\n  }\n}\n","import FormikCheckBox from '../../elements/formik/FormikCheckBox';\nimport FormikInput from '../../elements/formik/FormikInput';\n\nfunction ControllersTabContent() {\n  return (\n    <>\n      <p className=\"section-header\">Mouse Scroll Wheel Sensitivity</p>\n      <FormikInput type=\"number\" label=\"Low\" name=\"controllers.mws.low\" />\n      <FormikInput type=\"number\" label=\"high\" name=\"controllers.mws.high\" />\n      <p className=\"section-header\" style={{ marginTop: '40px' }}>\n        Show / Hide Panels\n      </p>\n      <FormikCheckBox\n        className=\"help-checkbox-element\"\n        label=\"Prevent automatic show help \"\n        name=\"controllers.help.preventAutoHelp\"\n      />\n\n      <p className=\"section-header\" style={{ marginTop: '40px' }}>\n        Spectra\n      </p>\n      <FormikInput\n        type=\"number\"\n        label=\"Transparency of Dimmed Spectra [ 0 - 1 ]\"\n        name=\"controllers.dimmedSpectraTransparency\"\n        checkValue={(value) => value >= 0 && value <= 1}\n      />\n    </>\n  );\n}\n\nexport default ControllersTabContent;\n","import lodashGet from 'lodash/get';\n\nimport FormikCheckBox from '../../elements/formik/FormikCheckBox';\n\nconst LIST = [\n  {\n    label: 'Spectra Panel',\n    name: 'display.panels.hideSpectraPanel',\n  },\n  {\n    label: 'Information Panel',\n    name: 'display.panels.hideInformationPanel',\n  },\n  {\n    label: 'Peaks Panel',\n    name: 'display.panels.hidePeaksPanel',\n  },\n  {\n    label: 'Integrals Panel',\n    name: 'display.panels.hideIntegralsPanel',\n  },\n  {\n    label: 'Ranges Panel',\n    name: 'display.panels.hideRangesPanel',\n  },\n  {\n    label: 'Structures Panel',\n    name: 'display.panels.hideStructuresPanel',\n  },\n  {\n    label: 'Filters Panel',\n    name: 'display.panels.hideFiltersPanel',\n  },\n  {\n    label: 'Zones Panel',\n    name: 'display.panels.hideZonesPanel',\n  },\n  {\n    label: 'Summary Panel',\n    name: 'display.panels.hideSummaryPanel',\n  },\n  {\n    label: 'Multiple Spectra Analysis Panel',\n    name: 'display.panels.hideMultipleSpectraAnalysisPanel',\n  },\n];\n\nfunction DisplayTabContent({ preferences }) {\n  return (\n    <>\n      <p className=\"section-header\">Show / Hide Panels</p>\n      {LIST.map(\n        (item) =>\n          !lodashGet(preferences, `basePreferences.${item.name}`, false) && (\n            <FormikCheckBox\n              key={item.name}\n              className=\"checkbox-element\"\n              label={item.label}\n              name={item.name}\n              reverse\n            />\n          ),\n      )}\n    </>\n  );\n}\n\nexport default DisplayTabContent;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { Fragment, useCallback, useMemo } from 'react';\nimport { FaPlus } from 'react-icons/fa';\n\nimport generateID from '../../../data/utilities/generateID';\nimport CloseButton from '../../elements/CloseButton';\nimport FormikInput from '../../elements/formik/FormikInput';\n\nconst styles = css`\n  .counter-col {\n    width: 30px;\n  }\n  .nucleus-label-col {\n    display: flex;\n    justify-content: center;\n    width: 80px;\n  }\n\n  .width-100 {\n    width: 100% !important;\n    margin: 0px !important;\n  }\n\n  .nucleus-format-input-col {\n    text-align: center;\n    width: 100px;\n  }\n\n  th {\n    font-size: 11px;\n    font-weight: 600;\n  }\n  .operation-container {\n    display: flex;\n  }\n  .add {\n    background-color: transparent;\n    border: 0;\n    outline: none;\n    svg {\n      font-szie: 14px;\n      fill: green;\n    }\n  }\n`;\nfunction FormattingTabContent() {\n  const { values, setFieldValue } = useFormikContext();\n  const nucleuses = useMemo(() => lodashGet(values, 'formatting.nucleus', []), [\n    values,\n  ]);\n\n  const deleteHandler = useCallback(\n    (index) => {\n      const nucleusesObject = nucleuses.splice(0, index);\n      setFieldValue('formatting.nucleus', nucleusesObject);\n    },\n    [nucleuses, setFieldValue],\n  );\n\n  const addNewNucleusFormatHandler = useCallback(() => {\n    const newFormat = {\n      key: generateID(),\n      name: '',\n      ppm: '0.00',\n      hz: '0.00',\n    };\n    const newNucleuses = [...nucleuses, newFormat];\n    setFieldValue('formatting.nucleus', newNucleuses);\n  }, [nucleuses, setFieldValue]);\n\n  return (\n    <Fragment>\n      <p className=\"section-header\">Formating according to Nucleus</p>\n      <div css={styles}>\n        <table>\n          <thead>\n            <tr>\n              <th className=\"counter-col\">#</th>\n              <th className=\"nucleus-label-col\">Nucleus </th>\n              <th className=\"nucleus-format-input-col\">δ (ppm)</th>\n              <th className=\"nucleus-format-input-col\">Coupling (Hz)</th>\n              <th className=\"nucleus-format-input-col\" />\n            </tr>\n          </thead>\n          <tbody>\n            {nucleuses &&\n              nucleuses.map((nucleus, index) => {\n                const num = index + 1;\n                return (\n                  <tr key={`${nucleus.key}`}>\n                    <td className=\"counter-col\">\n                      <span>{num} - </span>{' '}\n                    </td>\n                    <td className=\"nucleus-label-col\">\n                      <FormikInput\n                        name={`formatting.nucleus.${index}.name`}\n                        className=\"width-100\"\n                      />\n                    </td>\n                    <td className=\"nucleus-format-input-col\">\n                      <FormikInput\n                        name={`formatting.nucleus.${index}.ppm`}\n                        className=\"width-100\"\n                      />\n                    </td>\n                    <td className=\"nucleus-format-input-col\">\n                      <FormikInput\n                        name={`formatting.nucleus.${index}.hz`}\n                        className=\"width-100\"\n                      />\n                    </td>\n                    <td className=\"operation-container\">\n                      <CloseButton\n                        onClick={() => deleteHandler(index)}\n                        popupTitle={`remove ${nucleus.name}`}\n                        popupPlacement=\"right\"\n                      />\n                      {nucleuses.length === index + 1 && (\n                        <button\n                          className=\"add\"\n                          type=\"button\"\n                          onClick={addNewNucleusFormatHandler}\n                        >\n                          <FaPlus />\n                        </button>\n                      )}\n                    </td>\n                  </tr>\n                );\n              })}\n          </tbody>\n        </table>\n      </div>\n    </Fragment>\n  );\n}\n\nexport default FormattingTabContent;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useRef, useState } from 'react';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport CloseButton from '../../elements/CloseButton';\nimport { Tabs } from '../../elements/Tab';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport { SET_PREFERENCES } from '../../reducer/preferencesReducer';\nimport { useStateWithLocalStorage } from '../../utility/LocalStorage';\n\nimport ControllersTabContent from './ControllersTabContent';\nimport DisplayTabContent from './DisplayTabContent';\nimport FormattingTabContent from './FormattingTabContent';\n\nconst styles = css`\n  overflow: auto;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n\n  .header {\n    text-align: center;\n    padding: 10px 0 10px 0px;\n    margin: 0px;\n    color: #005d9e;\n    place-items: normal;\n    text-transform: none;\n    background-color: #fcfcfc;\n  }\n  .main-content {\n    width: 100%;\n    flex: 1;\n    overflow: auto;\n    border: none;\n  }\n\n  .tab-content {\n    width: 100%;\n  }\n\n  .inner-content {\n    padding: 15px 30px;\n    width: 100%;\n    overflow: auto;\n  }\n\n  button:focus {\n    outline: none;\n  }\n  button:hover {\n    color: #007bff;\n  }\n  .save-button:hover {\n    background-color: #ffffff;\n  }\n  .save-button {\n    border: none;\n    padding: 0 15px;\n    background-color: #ffffff5e;\n    border-radius: 5px;\n    height: 25px;\n  }\n\n  .footer-container {\n    display: flex;\n    align-items: flex-end;\n    justify-content: flex-end;\n    background: rgb(242, 242, 242);\n    background: -moz-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: -webkit-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=\"#f2f2f2\",endColorstr=\"#ffffff\",GradientType=1);\n    padding: 6px 15px;\n    height: 55px;\n  }\n\n  .section-header {\n    font-size: 13px;\n    color: #2ca8ff;\n    margin-bottom: 10px;\n    border-bottom: 0.55px solid #f9f9f9;\n    padding: 6px 2px;\n  }\n\n  .label {\n    font-size: 12px;\n    font-weight: bold;\n    margin-right: 10px;\n  }\n\n  .input {\n    font-size: 14px;\n    border-radius: 5px;\n    border: 1px solid #cccccc;\n    padding: 5px;\n    width: 100px;\n    margin-right: 10px;\n    height: initial !important;\n  }\n\n  .close-bt {\n    border: none;\n    color: red;\n    background-color: transparent;\n    outline: none;\n    position: absolute;\n    right: 10px;\n    top: 2px;\n    width: 30px;\n    height: 30px;\n  }\n\n  .checkbox-lable {\n    min-width: 300px;\n    display: inline-block;\n  }\n\n  .help-checkbox-element {\n    .checkbox-lable {\n      width: 260px;\n    }\n  }\n  .checkbox-element {\n    margin-bottom: 5px;\n  }\n`;\n\nfunction GeneralSettings({ onClose, onSave }) {\n  const [activeTab, setActiveTab] = useState('controllers');\n  const preferences = usePreferences();\n  const [, setSettingsData] = useStateWithLocalStorage('nmr-general-settings');\n  const refForm = useRef();\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (values) => {\n      // eslint-disable-next-line no-unused-vars\n      const { dispatch, basePreferences, ...resValues } = values;\n      setSettingsData(resValues);\n      preferences.dispatch({ type: SET_PREFERENCES, payload: values });\n      onSave();\n    },\n    [onSave, preferences, setSettingsData],\n  );\n\n  const tabChangeHandler = useCallback((tab) => {\n    setActiveTab(tab.tabid);\n  }, []);\n\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>General Settings</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"main-content\">\n        <FormikForm\n          ref={refForm}\n          initialValues={preferences}\n          onSubmit={submitHandler}\n        >\n          <Tabs\n            position=\"LEFT\"\n            defaultTabID={activeTab}\n            onClick={tabChangeHandler}\n          >\n            <div\n              className=\"inner-content\"\n              tablabel=\"Controllers\"\n              tabid=\"controllers\"\n            >\n              <ControllersTabContent />\n            </div>\n            <div\n              className=\"inner-content\"\n              tablabel=\"Formatting\"\n              tabid=\"formatting\"\n            >\n              <FormattingTabContent />\n            </div>\n            <div className=\"inner-content\" tablabel=\"Display\" tabid=\"display\">\n              <DisplayTabContent preferences={preferences} />\n            </div>\n          </Tabs>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <button type=\"button\" onClick={handleSave} className=\"save-button\">\n          Save\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default GeneralSettings;\n","import PropTypes from 'prop-types';\nimport { forwardRef, useCallback, useRef } from 'react';\n\nconst styles = {\n  container: {\n    display: 'flex',\n  },\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n    flex: '2',\n  },\n  inputContainer: {\n    flex: '4',\n    display: 'flex',\n    justifyContent: 'flex-start',\n  },\n  input: {\n    height: '100%',\n    width: '100px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px 0px 5px',\n    textAlign: 'center',\n  },\n};\n\nconst NumberInput = forwardRef(function NumberInput(\n  { label, name, defaultValue, style, onChange, onInput, pattern, step, min },\n  ref,\n) {\n  const localRef = useRef();\n  const changeHander = useCallback(\n    (e) => {\n      if (e.target.checkValidity()) {\n        if (e.target.value === '') {\n          onChange({ ...e, target: { ...e.target, value: defaultValue } });\n        } else {\n          onChange(e);\n        }\n      } else {\n        const _ref = ref ? ref : localRef;\n        _ref.current.value = defaultValue;\n      }\n    },\n    [defaultValue, onChange, ref],\n  );\n  return (\n    <div style={{ ...styles.container, ...style.container }}>\n      <span style={{ ...styles.label, ...style.label }}>{label}</span>\n      <div style={{ ...styles.inputContainer, ...style.inputContainer }}>\n        <input\n          ref={ref ? ref : localRef}\n          name={name}\n          style={{ ...styles.input, ...style.input }}\n          type=\"number\"\n          pattern={pattern}\n          defaultValue={defaultValue}\n          step={step}\n          onChange={changeHander}\n          onInput={onInput}\n          min={min}\n          key={defaultValue}\n        />\n      </div>\n    </div>\n  );\n});\n\nNumberInput.propTypes = {\n  pattern: PropTypes.string,\n  label: PropTypes.string,\n  name: PropTypes.string,\n  step: PropTypes.any,\n  min: PropTypes.any,\n  defaultValue: PropTypes.number,\n  style: PropTypes.shape({\n    container: PropTypes.object,\n    label: PropTypes.object,\n    inputContainer: PropTypes.object,\n    input: PropTypes.object,\n  }),\n  onChange: PropTypes.func,\n  onInput: PropTypes.func,\n};\n\nNumberInput.defaultProps = {\n  pattern: '^d*(.d{0,2})?$',\n  step: 'any',\n  min: 'any',\n  style: {\n    label: {},\n    input: {},\n    container: {},\n    inputContainer: {},\n  },\n  defaultValue: 0,\n  onChange: () => {\n    return null;\n  },\n  onInput: () => {\n    return null;\n  },\n};\n\nexport default NumberInput;\n","import { useCallback, useRef } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport CheckBox from '../elements/CheckBox';\nimport NumberInput from '../elements/NumberInput';\nimport { AUTO_PEAK_PICKING, RESET_SELECTED_TOOL } from '../reducer/types/Types';\n\nconst styles = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n    fontSize: '12px',\n  },\n  input: {\n    width: '50px',\n  },\n  inputContainer: {\n    flex: '2',\n  },\n  label: {\n    flex: '5',\n  },\n  actionButton: {\n    height: '100%',\n    width: '60px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px',\n    userSelect: 'none',\n  },\n};\n\nfunction AutoPeakPickingOptionPanel() {\n  const dispatch = useDispatch();\n  const minMaxRatioRef = useRef();\n  const maxNumberOfPeaksRef = useRef();\n  const noiseFactor = useRef();\n  const lookNegativeRef = useRef();\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: AUTO_PEAK_PICKING,\n      options: {\n        maxNumberOfPeaks: maxNumberOfPeaksRef.current.value,\n        minMaxRatio: minMaxRatioRef.current.value,\n        noiseFactor: noiseFactor.current.value,\n        lookNegative: lookNegativeRef.current.checked,\n      },\n    });\n  }, [dispatch]);\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  return (\n    <div style={styles.container}>\n      <NumberInput\n        ref={maxNumberOfPeaksRef}\n        label=\"Max Number Of Peaks:\"\n        name=\"maxNumberOfPeaks\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={50}\n      />\n      <NumberInput\n        ref={noiseFactor}\n        label=\"Noise factor\"\n        name=\"noiseFactor\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={3}\n      />\n      <NumberInput\n        ref={minMaxRatioRef}\n        label=\"Min Max Ratio:\"\n        name=\"minMaxRatio\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={0.1}\n        step=\"0.01\"\n      />\n\n      <div style={{ justifyItems: 'baseline', marginRight: '3px' }}>\n        <label\n          style={{ marginRight: '2px', lineHeight: 2, userSelect: 'none' }}\n          htmlFor=\"lookNegative\"\n        >\n          Detect Negative:\n        </label>\n        <CheckBox name=\"lookNegative\" ref={lookNegativeRef} />\n      </div>\n\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleApplyFilter}\n      >\n        Apply\n      </button>\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleCancelFilter}\n      >\n        Cancel\n      </button>\n    </div>\n  );\n}\n\nexport default AutoPeakPickingOptionPanel;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport { forwardRef, useCallback } from 'react';\n\nconst arrowDownIcon = `url('data:image/svg+xml;utf8,<svg  xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"960px\" height=\"560px\" viewBox=\"0 0 960 560\" enable-background=\"new 0 0 960 560\" xml:space=\"preserve\"><g id=\"Rounded_Rectangle_33_copy_4_1_\"><path d=\"M480,344.181L268.869,131.889c-15.756-15.859-41.3-15.859-57.054,0c-15.754,15.857-15.754,41.57,0,57.431l237.632,238.937c8.395,8.451,19.562,12.254,30.553,11.698c10.993,0.556,22.159-3.247,30.555-11.698l237.631-238.937c15.756-15.86,15.756-41.571,0-57.431s-41.299-15.859-57.051,0L480,344.181z\"/></g></svg>')`;\n\nconst Select = forwardRef(function Select(\n  { data, style, onChange, defaultValue, name },\n  ref,\n) {\n  const handleOnChanged = useCallback(\n    (e) => {\n      let value = e.target.value;\n      if (!isNaN(value)) {\n        value = Number(value);\n      }\n      onChange(value);\n    },\n    [onChange],\n  );\n\n  const styles = css`\n    position: relative;\n    padding: 0px 5px;\n    border: 0.55px solid #cacaca;\n    font-size: 14px;\n    width: ${style.width ? style.width - 5 : 115}px;\n    margin: 0;\n    height: 100%;\n    background: ${arrowDownIcon} no-repeat right white;\n    -webkit-appearance: none;\n    background-position-x: ${style.width ? style.width - 18 : 115 - 18}px;\n    background-size: 15px 15px;\n    border-radius: 5px;\n    margin: 0px 5px;\n    :focus,\n    input:focus {\n      outline: none;\n    }\n  `;\n\n  return (\n    <select\n      css={[styles, style]}\n      ref={ref}\n      name={name}\n      onChange={handleOnChanged}\n      defaultValue={defaultValue}\n    >\n      {data.map((d) => (\n        <option key={`${d.key}`} value={d.value}>\n          {d.label}\n        </option>\n      ))}\n    </select>\n  );\n});\n\nSelect.propTypes = {\n  onChange: PropTypes.func,\n  data: PropTypes.array.isRequired,\n  style: PropTypes.any,\n  defaultValue: PropTypes.any,\n  name: PropTypes.string,\n};\n\nSelect.defaultProps = {\n  onChange: function () {\n    return null;\n  },\n  style: { width: 100 },\n  name: '',\n};\n\nexport default Select;\n","import { useCallback, useRef, useState, Fragment } from 'react';\n\nimport { baselineAlgorithms } from '../../data/data1d/filter1d/baselineCorrection';\nimport { useDispatch } from '../context/DispatchContext';\nimport NumberInput from '../elements/NumberInput';\nimport Select from '../elements/Select';\nimport {\n  RESET_SELECTED_TOOL,\n  APPLY_BASE_LINE_CORRECTION_FILTER,\n} from '../reducer/types/Types';\n\nconst styles = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n  },\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n  },\n  actionButton: {\n    height: '100%',\n    width: '60px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px',\n    userSelect: 'none',\n  },\n};\n\nfunction BaseLineCorrectionPanel() {\n  const dispatch = useDispatch();\n  const algorithmRef = useRef();\n  const maxIterationsRef = useRef();\n  const toleranceRef = useRef();\n  const degreeRef = useRef();\n  const [algorithm, setAlgorithm] = useState('polynomial');\n\n  const handleApplyFilter = useCallback(() => {\n    let options = {};\n    switch (algorithm) {\n      case 'airpls':\n        options = {\n          algorithm: algorithmRef.current.value,\n          maxIterations: maxIterationsRef.current.value,\n          tolerance: toleranceRef.current.value,\n        };\n        break;\n      case 'polynomial':\n        options = {\n          algorithm: algorithmRef.current.value,\n          degree: degreeRef.current.value,\n        };\n        break;\n      default:\n        break;\n    }\n    dispatch({\n      type: APPLY_BASE_LINE_CORRECTION_FILTER,\n      options,\n    });\n  }, [algorithm, dispatch]);\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  const getAlgorithmsList = useCallback(() => {\n    return Object.keys(baselineAlgorithms).map((val) => {\n      return { key: val, label: baselineAlgorithms[val], value: val };\n    });\n  }, []);\n\n  const changeAlgorithmHandler = useCallback((val) => {\n    setAlgorithm(val);\n  }, []);\n\n  return (\n    <div style={styles.container}>\n      <span style={styles.label}>Algorithm: </span>\n      <Select\n        ref={algorithmRef}\n        data={getAlgorithmsList()}\n        style={{ marginLeft: 10, marginRight: 10 }}\n        onChange={changeAlgorithmHandler}\n        defaultValue=\"polynomial\"\n      />\n      {algorithm && algorithm === 'airpls' && (\n        <Fragment>\n          <NumberInput\n            label=\"maxIterations:\"\n            ref={maxIterationsRef}\n            name=\"maxIterations\"\n            defaultValue={100}\n          />\n          <NumberInput\n            label=\"tolerance:\"\n            ref={toleranceRef}\n            name=\"tolerance\"\n            defaultValue={0.001}\n          />\n        </Fragment>\n      )}\n\n      {algorithm && algorithm === 'autoPolynomial' && (\n        <NumberInput\n          label=\"degree:\"\n          ref={degreeRef}\n          name=\"degree\"\n          defaultValue={3}\n        />\n      )}\n\n      {algorithm && algorithm === 'polynomial' && (\n        <NumberInput\n          label=\"degree:\"\n          ref={degreeRef}\n          name=\"degree\"\n          defaultValue={3}\n        />\n      )}\n\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleApplyFilter}\n      >\n        Apply\n      </button>\n\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleCancelFilter}\n      >\n        Cancel\n      </button>\n    </div>\n  );\n}\n\nexport default BaseLineCorrectionPanel;\n","import { useCallback } from 'react';\n\nconst styles = {\n  container: {\n    width: '100%',\n    height: '100%',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    border: '0.55px solid #c7c7c7',\n    borderRadius: '5px',\n    userSelect: 'none',\n    backgroundColor: '#18ce0f14',\n    fontSize: '10px',\n    color: '#00801d',\n    margin: '0px 5px',\n    cursor: 'ew-resize',\n  },\n  label: {\n    whiteSpace: 'nowrap',\n    textOverflow: 'ellipsis',\n    overflow: 'hidden',\n    maxWidth: '100%',\n  },\n};\n\nlet stateValues = {\n  step: 'initial',\n};\n\nlet timerId = null;\nlet speedX = 1;\nlet oldX = 0;\nlet firstCalc = true;\nfunction calcSpeed(e) {\n  if (!firstCalc) {\n    speedX = e.clientX - oldX;\n    oldX = e.clientX;\n    setToZero();\n  } else {\n    oldX = e.clientX;\n    firstCalc = false;\n  }\n}\n\nfunction setToZero() {\n  clearTimeout(timerId);\n  timerId = setTimeout(() => {\n    speedX = 0;\n  }, 50);\n}\n\nfunction InputRange({\n  name,\n  minValue,\n  maxValue,\n  value: valueProps,\n  onChange,\n  label,\n  style,\n  className,\n  noPropagation,\n}) {\n  const mouseEnterHandler = useCallback(() => {\n    if (stateValues.step === 'moving' || stateValues.step === 'start') {\n      stateValues = {\n        ...stateValues,\n        step: stateValues.step === 'start' ? 'initial' : 'end',\n      };\n    }\n  }, []);\n\n  const mouseDownHandler = useCallback(\n    (event) => {\n      if (noPropagation) {\n        event.stopPropagation();\n      }\n\n      const boundingRect = event.currentTarget.getBoundingClientRect();\n      const x = event.clientX - boundingRect.x;\n      const y = event.clientY - boundingRect.y;\n      if (stateValues.step === 'initial' || stateValues.step === 'end') {\n        stateValues = {\n          startX: x,\n          startY: y,\n          startScreenX: event.screenX,\n          startScreenY: event.screenY,\n          boundingRect: event.currentTarget.getBoundingClientRect(),\n          step: 'start',\n          clientX: event.clientX,\n          clientY: event.clientY,\n        };\n      }\n\n      return false;\n    },\n    [noPropagation],\n  );\n\n  const mouseMoveCallback = (event) => {\n    if (stateValues.step === 'start' || stateValues.step === 'moving') {\n      const { screenX, screenY } = event;\n      stateValues = {\n        ...stateValues,\n        step: 'moving',\n        endX: stateValues.startX + screenX - stateValues.startScreenX,\n        endY: stateValues.startY + screenY - stateValues.startScreenY,\n      };\n      calcSpeed(event);\n      const valueRange = maxValue - minValue;\n      const positionDiff = stateValues.endX - stateValues.startX;\n      const value =\n        (Math.abs(positionDiff) * (Math.abs(speedX) > 3 ? valueRange : 5)) /\n        stateValues.boundingRect.width;\n\n      onChange({\n        value: speedX >= 0 ? valueProps + Math.abs(value) : valueProps - value,\n        name,\n      });\n    }\n  };\n\n  const mouseUpCallback = () => {\n    if (stateValues.step === 'moving' || stateValues.step === 'start') {\n      stateValues = {\n        ...stateValues,\n        step: stateValues.step === 'start' ? 'initial' : 'end',\n      };\n    }\n  };\n\n  return (\n    <div\n      style={{ ...styles.container, ...style }}\n      className={className}\n      onMouseMove={mouseMoveCallback}\n      onMouseUp={mouseUpCallback}\n      onMouseDown={mouseDownHandler}\n      onMouseEnter={mouseEnterHandler}\n    >\n      <span style={styles.label}>{label}</span>\n    </div>\n  );\n}\n\nInputRange.defaultProps = {\n  name: '',\n  minValue: 0,\n  maxValue: 50,\n  value: 0,\n  onChange: () => {\n    return null;\n  },\n  label: 'Drag to Change the value',\n  noPropagation: true,\n};\n\nexport default InputRange;\n","import { useCallback, useState } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport Input from '../elements/Input';\nimport InputRange from '../elements/InputRange';\nimport Select from '../elements/Select';\nimport {\n  APPLY_MANUAL_PHASE_CORRECTION_FILTER,\n  APPLY_AUTO_PHASE_CORRECTION_FILTER,\n  CALCULATE_MANUAL_PHASE_CORRECTION_FILTER,\n  RESET_SELECTED_TOOL,\n  APPLY_ABSOLUTE_FILTER,\n} from '../reducer/types/Types';\n\nconst styles = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n  },\n  input: {\n    width: '100px',\n  },\n  actionButton: {\n    height: '100%',\n    width: '60px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px',\n    userSelect: 'none',\n  },\n  select: {\n    marginLeft: '5px',\n    marginRight: '10px',\n    border: 'none',\n    height: '20px',\n  },\n};\n\nconst phaseCorrectionTypes = {\n  manual: 'manual',\n  automatic: 'automatic',\n  absolute: 'absolute',\n};\n\nconst algorithms = [\n  {\n    key: phaseCorrectionTypes.manual,\n    label: 'Manual',\n    value: phaseCorrectionTypes.manual,\n  },\n  {\n    key: phaseCorrectionTypes.automatic,\n    label: 'Automatic',\n    value: phaseCorrectionTypes.automatic,\n  },\n  {\n    key: phaseCorrectionTypes.absolute,\n    label: 'Absolute',\n    value: phaseCorrectionTypes.absolute,\n  },\n];\n\nfunction ManualPhaseCorrectionPanel() {\n  const dispatch = useDispatch();\n  const [value, setValue] = useState({ ph0: 0, ph1: 0, pivotIndex: 1 });\n  const [phaseCorrectionType, setPhaseCorrectionType] = useState(\n    phaseCorrectionTypes.manual,\n  );\n\n  const handleApplyFilter = useCallback(() => {\n    switch (phaseCorrectionType) {\n      case phaseCorrectionTypes.automatic: {\n        dispatch({\n          type: APPLY_AUTO_PHASE_CORRECTION_FILTER,\n        });\n        break;\n      }\n\n      case phaseCorrectionTypes.manual: {\n        dispatch({\n          type: APPLY_MANUAL_PHASE_CORRECTION_FILTER,\n          value: value,\n        });\n        break;\n      }\n      case phaseCorrectionTypes.absolute: {\n        dispatch({\n          type: APPLY_ABSOLUTE_FILTER,\n        });\n        break;\n      }\n      default:\n        break;\n    }\n  }, [dispatch, phaseCorrectionType, value]);\n\n  const handleInput = useCallback(\n    (e) => {\n      const fieldName = e.target.name;\n      if (e.target) {\n        const inputValue = e.target.value;\n\n        setValue((prevValue) => {\n          const _value = {\n            ...prevValue,\n            [fieldName]: inputValue,\n          };\n\n          if (inputValue !== '-') {\n            const newValue = {\n              ...value,\n              [fieldName]: inputValue - prevValue[fieldName],\n            };\n            for (let key in prevValue) {\n              if (prevValue[key] === newValue[key]) {\n                newValue[key] -= prevValue[key];\n              }\n            }\n\n            dispatch({\n              type: CALCULATE_MANUAL_PHASE_CORRECTION_FILTER,\n              value: newValue,\n            });\n          }\n\n          return _value;\n        });\n      }\n    },\n    [dispatch, value],\n  );\n\n  const handleRangeChange = useCallback(\n    (e) => {\n      const _value = { ...value, [e.name]: e.value };\n      let diff = {};\n      for (let key in value) {\n        diff[key] = _value[key] - value[key];\n      }\n      dispatch({\n        type: CALCULATE_MANUAL_PHASE_CORRECTION_FILTER,\n        value: diff,\n      });\n      setValue(_value);\n    },\n    [dispatch, value],\n  );\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  const onChangeHandler = useCallback((val) => {\n    setPhaseCorrectionType(val);\n  }, []);\n\n  return (\n    <div style={styles.container}>\n      <Select\n        onChange={onChangeHandler}\n        data={algorithms}\n        value={phaseCorrectionTypes.manual}\n        style={styles.select}\n      />\n\n      {phaseCorrectionType === phaseCorrectionTypes.manual && (\n        <>\n          <Input\n            label=\"PH0:\"\n            name=\"ph0\"\n            style={{ input: styles.input }}\n            onChange={handleInput}\n            value={value.ph0}\n            type=\"number\"\n          />\n          <Input\n            label=\"PH1:\"\n            name=\"ph1\"\n            style={{ input: styles.input }}\n            onChange={handleInput}\n            value={value.ph1}\n            type=\"number\"\n          />\n\n          <InputRange\n            name=\"ph0\"\n            value={value.ph0}\n            label=\"Change Ph0 By mouse click and drag\"\n            style={{ width: '20%' }}\n            onChange={handleRangeChange}\n          />\n          <InputRange\n            name=\"ph1\"\n            value={value.ph1}\n            label=\"Change Ph1 By mouse click and drag\"\n            style={{ width: '20%' }}\n            onChange={handleRangeChange}\n          />\n        </>\n      )}\n\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleApplyFilter}\n      >\n        Apply\n      </button>\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleCancelFilter}\n      >\n        Cancel\n      </button>\n      {/* <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleAutoFilter}\n      >\n        Auto\n      </button> */}\n    </div>\n  );\n}\n\nexport default ManualPhaseCorrectionPanel;\n","import { useCallback, useRef } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport CheckBox from '../elements/CheckBox';\nimport {\n  AUTO_RANGES_DETECTION,\n  RESET_SELECTED_TOOL,\n} from '../reducer/types/Types';\n\nconst styles = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n    fontSize: '12px',\n    alignItems: 'baseline',\n  },\n  input: {\n    height: '100%',\n    width: '50px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px 0px 5px',\n    textAlign: 'center',\n  },\n  actionButton: {\n    height: '100%',\n    minWidth: '60px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px',\n    userSelect: 'none',\n  },\n  hint: {\n    lineHeight: 2,\n    userSelect: 'none',\n    fontSize: '11px',\n  },\n};\n\nfunction RangesPickingOptionPanel() {\n  const dispatch = useDispatch();\n  const lookNegativeRef = useRef();\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: AUTO_RANGES_DETECTION,\n      options: {\n        peakPicking: {\n          minMaxRatio: 0.05,\n          nH: 100,\n          compile: true,\n          frequencyCluster: 16,\n          clean: true,\n          keepPeaks: true,\n          lookNegative: lookNegativeRef.current.checked,\n        },\n      },\n    });\n  }, [dispatch]);\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  return (\n    <div style={styles.container}>\n      <div style={{ justifyItems: 'baseline', margin: '0 10px' }}>\n        <label\n          style={{ marginRight: '2px', lineHeight: 2, userSelect: 'none' }}\n          htmlFor=\"lookNegative\"\n        >\n          Detect negative:\n        </label>\n        <CheckBox name=\"lookNegative\" ref={lookNegativeRef} />\n      </div>\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleApplyFilter}\n      >\n        Auto ranges picking\n      </button>\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleCancelFilter}\n      >\n        Cancel\n      </button>\n      <span style={styles.hint}>\n        Manual selection using SHIFT + select zone or click on Auto peak picking\n      </span>\n    </div>\n  );\n}\n\nexport default RangesPickingOptionPanel;\n","import { useCallback, useRef, useState } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport Select from '../elements/Select';\nimport {\n  APPLY_ZERO_FILLING_FILTER,\n  RESET_SELECTED_TOOL,\n} from '../reducer/types/Types';\n\nconst styles = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n  },\n\n  input: {\n    height: '100%',\n    width: '80px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px 0px 5px',\n    textAlign: 'center',\n  },\n  actionButton: {\n    height: '100%',\n    width: '60px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px',\n    userSelect: 'none',\n  },\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n  },\n};\n\nfunction generateSizes(start = 8, end = 21) {\n  let values = [];\n  for (let i = start; i <= end; i++) {\n    const result = 2 ** i;\n    values.push({\n      key: result,\n      label: formatNumber(result),\n      value: result,\n    });\n  }\n  return values;\n}\nfunction formatNumber(number) {\n  if (number >= 1024 * 1024) {\n    return `${number / (1024 * 1024)}M`;\n  } else if (number >= 1024) {\n    return `${number / 1024}K`;\n  } else {\n    return number;\n  }\n}\n\nconst Sizes = generateSizes();\n\nfunction ZeroFillingOptionsPanel() {\n  const dispatch = useDispatch();\n  const { data, activeSpectrum } = useChartData();\n  const sizeTextInputRef = useRef();\n  const [lineBroadeningValue, setLineBroadeningValue] = useState(1);\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: APPLY_ZERO_FILLING_FILTER,\n      value: {\n        zeroFillingSize: Number(sizeTextInputRef.current.value),\n        lineBroadeningValue: lineBroadeningValue,\n      },\n    });\n  }, [dispatch, lineBroadeningValue]);\n\n  const getDefaultValue = useCallback(() => {\n    if (data && activeSpectrum?.id) {\n      return (\n        2 ** Math.round(Math.log2(data[activeSpectrum.index].data.x.length))\n      );\n    }\n    return '';\n  }, [activeSpectrum, data]);\n\n  const handleInput = useCallback(\n    (e) => {\n      if (e.target) {\n        const _value = e.target.validity.valid\n          ? Number(e.target.value)\n          : lineBroadeningValue;\n        setLineBroadeningValue(_value);\n      }\n    },\n    [lineBroadeningValue],\n  );\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  return (\n    <div style={styles.container}>\n      <span style={styles.label}>Size: </span>\n      <Select\n        ref={sizeTextInputRef}\n        data={Sizes}\n        style={{ marginLeft: 10, marginRight: 10 }}\n        defaultValue={getDefaultValue()}\n      />\n      <span style={styles.label}>Line Broadening: </span>\n      <input\n        name=\"line-broadening\"\n        style={styles.input}\n        type=\"number\"\n        defaultValue={lineBroadeningValue}\n        onInput={handleInput}\n        pattern=\"^\\d*(\\.\\d{0,2})?$\"\n        step=\"any\"\n      />\n\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleApplyFilter}\n      >\n        Apply\n      </button>\n\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleCancelFilter}\n      >\n        Cancel\n      </button>\n    </div>\n  );\n}\n\nexport default ZeroFillingOptionsPanel;\n","import { useCallback, useRef } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport NumberInput from '../elements/NumberInput';\nimport {\n  RESET_SELECTED_TOOL,\n  AUTO_ZONES_DETECTION,\n} from '../reducer/types/Types';\nimport Events from '../utility/Events';\n\nconst styles = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n    fontSize: '12px',\n  },\n  input: {\n    width: '50px',\n  },\n  inputContainer: {\n    flex: '2',\n  },\n  label: {\n    flex: '5',\n  },\n  actionButton: {\n    height: '100%',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px',\n    userSelect: 'none',\n  },\n};\n\nfunction Zones2DOptionPanel() {\n  const dispatch = useDispatch();\n  const thresholdFactor = useRef();\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: AUTO_ZONES_DETECTION,\n      options: {\n        thresholdFactor: thresholdFactor.current.value,\n      },\n    });\n  }, [dispatch]);\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  const handleInput = useCallback((e) => {\n    if (e.target) {\n      const val = e.target.value;\n      Events.emit('noiseFactorChanged', val);\n    }\n  }, []);\n\n  return (\n    <div style={styles.container}>\n      <NumberInput\n        ref={thresholdFactor}\n        label=\"NoiseFactor\"\n        name=\"noiseFactor\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={1}\n        onChange={handleInput}\n      />\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleApplyFilter}\n      >\n        Auto Zones Picking\n      </button>\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleCancelFilter}\n      >\n        Cancel\n      </button>\n    </div>\n  );\n}\n\nexport default Zones2DOptionPanel;\n","/** @jsxImportSource @emotion/react */\n\nimport { css } from '@emotion/react';\nimport { SvgLogoNmrium } from 'cheminfo-font';\nimport { useMemo, useCallback } from 'react';\nimport {\n  FaRegWindowMaximize,\n  FaWrench,\n  FaQuestionCircle,\n} from 'react-icons/fa';\n\nimport { useChartData } from '../context/ChartContext';\nimport Button from '../elements/ButtonToolTip';\nimport { useAlert } from '../elements/popup/Alert';\nimport { useHelp } from '../elements/popup/Help';\nimport { useModal, positions } from '../elements/popup/Modal';\nimport AboutUsModal from '../modal/AboutUsModal';\nimport UserManualModal from '../modal/UserManualModal';\nimport GeneralSettings from '../modal/setting/GeneralSettings';\nimport { options } from '../toolbar/ToolTypes';\n\nimport AutoPeakPickingOptionPanel from './AutoPeakPickingOptionPanel';\nimport BaseLineCorrectionPanel from './BaseLineCorrectionPanel';\nimport ManualPhaseCorrectionPanel from './ManualPhaseCorrectionPanel';\nimport RangesPickingOptionPanel from './RangesPickingOptionPanel';\nimport ZeroFillingOptionsPanel from './ZeroFillingOptionsPanel';\nimport Zones2DOptionPanel from './Zones2DOptionPanel';\n\nconst headerStyle = css`\n  display: flex;\n  align-items: flex-start;\n  justify-content: flex-start;\n  height: 36px;\n  min-height: 36px;\n  border-width: 1px 1px 0px 1px;\n  border-style: solid;\n  border-color: rgb(213, 213, 213);\n  outline: none;\n  transition: background-color 0.2s ease-in 0s;\n  box-shadow: rgb(255, 255, 255) 0px 1px 0px 0px inset;\n  background: linear-gradient(rgb(255, 255, 255) 5%, rgb(246, 246, 246) 100%)\n    rgb(255, 255, 255);\n  color: rgb(102, 102, 102);\n  font-family: Arial;\n  font-weight: bold;\n  text-decoration: none;\n  text-shadow: rgb(255, 255, 255) 0px 1px 0px;\n\n  .toolOptionsPanel {\n    flex: 10;\n    padding: 0px;\n    margin: 0px;\n    height: 100%;\n  }\n\n  .windowButtonsContainer {\n    flex: 0.5;\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n    height: 100%;\n  }\n\n  .windowButton {\n    width: 30px;\n    height: 30px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    background-color: transparent;\n    border: none;\n  }\n  button:focus {\n    outline: 0;\n  }\n`;\n\nfunction Header({ isFullscreen, onMaximize }) {\n  const { selectedOptionPanel } = useChartData();\n  const modal = useModal();\n  const alert = useAlert();\n  const help = useHelp();\n\n  const selectedPanel = useMemo(() => {\n    switch (selectedOptionPanel) {\n      case options.zeroFilling.id:\n        return <ZeroFillingOptionsPanel />;\n      case options.phaseCorrection.id:\n        return <ManualPhaseCorrectionPanel />;\n      case options.peakPicking.id:\n        return <AutoPeakPickingOptionPanel />;\n      case options.rangesPicking.id:\n        return <RangesPickingOptionPanel />;\n      case options.baseLineCorrection.id:\n        return <BaseLineCorrectionPanel />;\n      case options.zone2D.id:\n        return <Zones2DOptionPanel />;\n      default:\n        break;\n    }\n  }, [selectedOptionPanel]);\n\n  const openGeneralSettingsHandler = useCallback(() => {\n    modal.show(\n      <GeneralSettings\n        onSave={() => {\n          alert.success('Settings saved successfully');\n          modal.close();\n        }}\n      />,\n      {\n        position: positions.TOP_CENTER,\n        enableResizing: true,\n        width: 600,\n        height: 400,\n      },\n    );\n  }, [alert, modal]);\n  const openUserManual = useCallback(() => {\n    modal.show(<UserManualModal />, {\n      isBackgroundBlur: false,\n      position: positions.TOP_CENTER,\n      enableResizing: true,\n      width: 800,\n      height: 600,\n    });\n  }, [modal]);\n\n  const openAboutUs = useCallback(() => {\n    modal.show(<AboutUsModal />, {\n      isBackgroundBlur: false,\n      position: positions.MIDDLE,\n      width: 500,\n      height: 480,\n    });\n  }, [modal]);\n\n  return (\n    <div css={headerStyle}>\n      <Button\n        popupTitle=\"About Us\"\n        popupPlacement=\"right\"\n        style={{ width: '36px' }}\n        onClick={openAboutUs}\n        className=\"windowButton\"\n      >\n        <SvgLogoNmrium />\n      </Button>\n      <div className=\"toolOptionsPanel\">{selectedPanel}</div>\n      <div className=\"windowButtonsContainer\">\n        <Button\n          popupTitle=\"User Manual\"\n          popupPlacement=\"left\"\n          onClick={openUserManual}\n          className=\"windowButton\"\n        >\n          <FaQuestionCircle />\n        </Button>\n        <Button\n          popupTitle=\"General Settings\"\n          popupPlacement=\"left\"\n          onClick={openGeneralSettingsHandler}\n          className=\"windowButton\"\n        >\n          <FaWrench />\n        </Button>\n        {!isFullscreen ? (\n          <Button\n            popupTitle=\"Full Screen\"\n            popupPlacement=\"left\"\n            onClick={onMaximize}\n            className=\"windowButton\"\n            data-helpid=\"fullScreen\"\n            {...help.onHover}\n          >\n            <FaRegWindowMaximize />\n          </Button>\n        ) : (\n          ''\n        )}\n      </div>\n    </div>\n  );\n}\n\nHeader.defaultProps = {\n  onMaximize: function () {\n    return null;\n  },\n};\n\nexport default Header;\n","export const FILES_TYPES = {\n  MOL: 'mol',\n  NMRIUM: 'nmrium',\n  JSON: 'json',\n  DX: 'dx',\n  JDX: 'jdx',\n  JDF: 'jdf',\n  ZIP: 'zip',\n  SDF: 'sdf',\n};\nexport const FILES_SIGNATURES = {\n  ZIP: '504b0304',\n};\n\nfunction getFileSignature(fileArrayBuffer) {\n  return new Uint8Array(fileArrayBuffer)\n    .slice(0, 4)\n    .reduce((acc, byte) => (acc += byte.toString(16).padStart(2, '0')), '');\n}\n\nasync function loadFile(file, options = { asBuffer: false }) {\n  const response = await fetch(file);\n  checkStatus(response);\n  const data = (await options.asBuffer)\n    ? response.arrayBuffer()\n    : response.text();\n  return data;\n}\n\nfunction checkStatus(response) {\n  if (!response.ok) {\n    throw new Error(`HTTP ${response.status} - ${response.statusText}`);\n  }\n  return response;\n}\n\nfunction getFileExtension(name) {\n  return name.replace(/^.*\\./, '').toLowerCase();\n}\n\nfunction getFileName(name) {\n  return name.substr(0, name.lastIndexOf('.'));\n}\n\nfunction extractFileMetaFromPath(path) {\n  const meta = path\n    // eslint-disable-next-line no-useless-escape\n    .replace(/^.*[\\\\\\/]/, '')\n    .split('.');\n\n  return { name: meta[0].toLowerCase(), extension: meta[1].toLowerCase() };\n}\n/**\n *\n * @param {Array<File>} acceptedFiles\n * @param {object} options\n * @param {boolean} options.asBuffer\n * @returns\n */\nfunction loadFiles(acceptedFiles, options = {}) {\n  return Promise.all(\n    [].map.call(acceptedFiles, (file) => {\n      return new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.onabort = (e) => reject(e);\n        reader.onerror = (e) => reject(e);\n        reader.onload = () => {\n          if (reader.result) {\n            const binary = reader.result;\n            const name = getFileName(file.name);\n            const extension = getFileExtension(file.name);\n            resolve({ binary, name, extension });\n          }\n        };\n        if (options.asBuffer) {\n          reader.readAsArrayBuffer(file);\n        } else {\n          reader.readAsBinaryString(file);\n        }\n      });\n    }),\n  );\n}\n\nasync function loadFilesFromZip(files, options = {}) {\n  const result = [];\n  for (const file of files) {\n    try {\n      const binary = await file.async(options.asBuffer ? 'uint8array' : 'text');\n      const name = getFileName(file.name);\n      const extension = getFileExtension(file.name);\n      result.push({ binary, name, extension });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.log(e);\n    }\n  }\n  return result;\n}\n\nexport {\n  loadFiles,\n  loadFilesFromZip,\n  loadFile,\n  getFileExtension,\n  getFileName,\n  extractFileMetaFromPath,\n  getFileSignature,\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport Zip from 'jszip';\nimport { useCallback } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport { FaUpload } from 'react-icons/fa';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { LoaderProvider } from '../context/LoaderContext';\nimport {\n  LOAD_MOL_FILE,\n  LOAD_JSON_FILE,\n  LOAD_JCAMP_FILE,\n  SET_LOADING_FLAG,\n  LOAD_ZIP_FILE,\n  LOAD_JDF_FILE,\n  LOAD_NMREDATA_FILE,\n} from '../reducer/types/Types';\nimport {\n  FILES_TYPES,\n  FILES_SIGNATURES,\n  getFileExtension,\n  getFileSignature,\n  loadFiles,\n  loadFilesFromZip,\n} from '../utility/FileUtility';\n\nconst style = css`\n  height: 100%;\n  background-color: #b5b5b599;\n  position: absolute;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-flow: column;\n  z-index: 99999;\n\n  p {\n    color: white;\n    background-color: rgb(104, 104, 104);\n    padding: 1.5%;\n    border-radius: 30px;\n    margin: 0px;\n  }\n\n  svg {\n    stroke-width: 0;\n    font-size: 3rem !important;\n    fill: white;\n  }\n`;\n\nconst containerStyle = css`\n  border: 0.55px #e6e6e6 solid;\n  display: flex;\n  flex: 1;\n  flex-direction: 'column';\n  height: 100%;\n`;\n\nfunction DropZone(props) {\n  const { width, height } = useChartData();\n  const dispatch = useDispatch();\n  const loadsubFilesfromZip = useCallback(\n    (extractedfiles, uniqueFileExtensions) => {\n      for (let extension of uniqueFileExtensions) {\n        const selectedFilesByExtensions = extractedfiles.filter(\n          (file) => getFileExtension(file.name) === extension,\n        );\n\n        switch (extension) {\n          case FILES_TYPES.MOL:\n            loadFilesFromZip(selectedFilesByExtensions).then((files) =>\n              dispatch({ type: LOAD_MOL_FILE, files }),\n            );\n            break;\n          case FILES_TYPES.NMRIUM:\n          case FILES_TYPES.JSON:\n            loadFilesFromZip(selectedFilesByExtensions, {\n              asBuffer: true,\n            }).then((files) => {\n              if (selectedFilesByExtensions.length === 1) {\n                const decoder = new TextDecoder('utf8');\n                files[0].binary = decoder.decode(files[0].binary);\n                dispatch({ type: LOAD_JSON_FILE, files });\n              } else {\n                dispatch({ type: SET_LOADING_FLAG, isLoading: false });\n                // eslint-disable-next-line no-alert\n                alert('You can add only one json file');\n              }\n            });\n            break;\n          case FILES_TYPES.JDX:\n          case FILES_TYPES.DX:\n            loadFilesFromZip(selectedFilesByExtensions, {\n              asBuffer: true,\n            }).then((files) => dispatch({ type: LOAD_JCAMP_FILE, files }));\n\n            break;\n          case FILES_TYPES.JDF:\n            loadFilesFromZip(selectedFilesByExtensions, {\n              asBuffer: true,\n            }).then((files) => dispatch({ type: LOAD_JDF_FILE, files }));\n            break;\n          case FILES_TYPES.SDF:\n            dispatch({ type: LOAD_NMREDATA_FILE, files: extractedfiles });\n            break;\n          default:\n            break;\n        }\n      }\n    },\n    [dispatch],\n  );\n\n  const loadFilesHandler = useCallback(\n    (files) => {\n      const uniqueFileExtensions = [\n        ...new Set(files.map((file) => getFileExtension(file.name))),\n      ];\n\n      for (let extension of uniqueFileExtensions) {\n        const selectedFilesByExtensions = files.filter(\n          (file) => getFileExtension(file.name) === extension,\n        );\n\n        switch (extension) {\n          case FILES_TYPES.MOL:\n            loadFiles(selectedFilesByExtensions).then(\n              (files) => {\n                dispatch({ type: LOAD_MOL_FILE, files });\n              },\n              (err) => {\n                // eslint-disable-next-line no-alert\n                alert(err);\n              },\n            );\n            break;\n          case FILES_TYPES.NMRIUM:\n          case FILES_TYPES.JSON:\n            if (selectedFilesByExtensions.length === 1) {\n              loadFiles(selectedFilesByExtensions, { asBuffer: true }).then(\n                async (files) => {\n                  const fileSignature = getFileSignature(files[0].binary);\n                  if (fileSignature === FILES_SIGNATURES.ZIP) {\n                    const unzipResult = await Zip.loadAsync(files[0].binary);\n                    loadsubFilesfromZip(Object.values(unzipResult.files), [\n                      FILES_TYPES.NMRIUM,\n                    ]);\n                  } else {\n                    const decoder = new TextDecoder('utf8');\n                    files[0].binary = decoder.decode(files[0].binary);\n                    dispatch({ type: LOAD_JSON_FILE, files });\n                  }\n                },\n                (err) => {\n                  // eslint-disable-next-line no-alert\n                  alert(err);\n                },\n              );\n            } else {\n              // eslint-disable-next-line no-alert\n              alert('You can add only one json file');\n            }\n\n            break;\n\n          case FILES_TYPES.JDX:\n          case FILES_TYPES.DX:\n            loadFiles(selectedFilesByExtensions, { asBuffer: true }).then(\n              (files) => {\n                dispatch({ type: LOAD_JCAMP_FILE, files });\n              },\n              (err) => {\n                // eslint-disable-next-line no-alert\n                alert(err);\n              },\n            );\n            break;\n          case FILES_TYPES.JDF:\n            loadFiles(selectedFilesByExtensions, { asBuffer: true }).then(\n              (files) => {\n                dispatch({ type: LOAD_JDF_FILE, files });\n              },\n              (err) => {\n                // eslint-disable-next-line no-alert\n                alert(err);\n              },\n            );\n            break;\n          case FILES_TYPES.ZIP:\n            loadFiles(selectedFilesByExtensions, { asBuffer: true }).then(\n              async (files) => {\n                for (const zipFile of files) {\n                  const unzipResult = await Zip.loadAsync(zipFile.binary);\n\n                  const uniqueFileExtensions = [\n                    ...new Set(\n                      Object.values(unzipResult.files).map((file) =>\n                        getFileExtension(file.name),\n                      ),\n                    ),\n                  ];\n                  const isNotZip = uniqueFileExtensions.some(\n                    (ex) =>\n                      FILES_TYPES[ex.toUpperCase()] && ex !== FILES_TYPES.ZIP,\n                  );\n                  if (isNotZip) {\n                    loadsubFilesfromZip(\n                      Object.values(unzipResult.files),\n                      uniqueFileExtensions,\n                    );\n                  } else {\n                    dispatch({ type: LOAD_ZIP_FILE, files });\n                  }\n                }\n              },\n              (err) => {\n                // eslint-disable-next-line no-alert\n                alert(err);\n              },\n            );\n            break;\n          default:\n            dispatch({ type: SET_LOADING_FLAG, isLoading: false });\n            // eslint-disable-next-line no-alert\n            alert(\n              'The file extension must be zip, dx, jdx, json, mol or nmrium.',\n            );\n            break;\n        }\n      }\n    },\n    [dispatch, loadsubFilesfromZip],\n  );\n\n  const onDrop = useCallback(\n    (droppedFiles) => {\n      dispatch({ type: SET_LOADING_FLAG, isLoading: true });\n      loadFilesHandler(droppedFiles);\n    },\n    [dispatch, loadFilesHandler],\n  );\n\n  const {\n    getRootProps,\n    getInputProps,\n    isDragActive,\n    open: openImportDialog,\n  } = useDropzone({\n    onDrop,\n    noClick: true,\n  });\n\n  const open = useCallback(() => {\n    openImportDialog();\n  }, [openImportDialog]);\n\n  return (\n    <LoaderProvider value={{ open }}>\n      <div {...getRootProps()} css={containerStyle}>\n        <input {...getInputProps()} />\n        {isDragActive && (\n          <div\n            css={style}\n            style={{ width: `${width + 41}px`, height: `${height}px` }}\n          >\n            <FaUpload />\n            <p>Drop your files here</p>\n          </div>\n        )}\n        {props.children}\n      </div>\n    </LoaderProvider>\n  );\n}\n\nexport default DropZone;\n","import { useState, useRef, useEffect, useCallback } from 'react';\n\nlet timer = 0;\nlet delay = 200;\nlet prevent = false;\n\nconst styles = {\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    margin: '0px',\n    userSelect: 'none',\n  },\n  button: {\n    cursor: 'pointer',\n    padding: '5px 12px',\n    display: 'flex',\n    alignItems: 'center',\n    fontSize: '11px',\n    border: 'none',\n    outline: 'none',\n    transition: 'background-color 0.2s ease-in',\n\n    boxShadow: 'inset 0px 1px 0px 0px #ffffff',\n    background: 'linear-gradient(to bottom, #f0f0f0 5%, #e1e1e1 100%)',\n    filter:\n      'progid:DXImageTransform.Microsoft.gradient(startColorstr=\"#f0f0f0\", endColorstr=\"#e1e1e1\",GradientType=0)',\n    backgroundColor: '#ffffff',\n    color: '#2d2d2d',\n    fontFamily: 'Arial',\n    fontWeight: 'bold',\n    textDecoration: 'none',\n    textShadow: '0px 1px 0px #ffffff',\n    borderTop: '0.55px  solid #d5d5d5',\n  },\n  buttonTitle: {\n    padding: 0,\n    margin: 0,\n  },\n  content: {\n    backgroundColor: 'white',\n    maxHeight: '0',\n    overflow: 'hidden',\n    flex: '1 1 1px',\n  },\n};\n\nexport const triggerSource = {\n  click: 1,\n  dbClick: 2,\n};\n\nfunction AccordionItem({ title, children, index, isOpen, onOpen, style }) {\n  const [active, setActiveState] = useState(null);\n\n  const refContent = useRef();\n  const refContainer = useRef();\n  const toggleAccordion = useCallback(\n    (e) => {\n      timer = setTimeout(function () {\n        if (!prevent) {\n          onOpen(index, { source: triggerSource.click, shiftKey: e.shiftKey });\n        }\n        prevent = false;\n      }, delay);\n    },\n    [index, onOpen],\n  );\n\n  const dbClickHandler = useCallback(\n    (e) => {\n      e.persist();\n      clearTimeout(timer);\n      prevent = true;\n      onOpen(index, { source: triggerSource.dbClick, shiftKey: e.shiftKey });\n    },\n    [index, onOpen],\n  );\n\n  useEffect(() => {\n    setActiveState(isOpen ? { backgroundColor: '#ccc' } : null);\n  }, [isOpen]);\n\n  return (\n    <div\n      ref={refContainer}\n      style={{\n        ...styles.container,\n        flex: active == null ? 0 : '1 1 1px',\n        transition: isOpen ? 'flex 0.2s ease' : '',\n      }}\n      className=\"custom-accordion\"\n    >\n      <button\n        type=\"button\"\n        style={styles.button}\n        onClick={toggleAccordion}\n        onDoubleClick={dbClickHandler}\n      >\n        <p style={styles.buttonTitle}>{title}</p>\n      </button>\n      <div\n        ref={refContent}\n        style={{\n          ...styles.content,\n          maxHeight: active == null ? 0 : '100%',\n          ...style,\n        }}\n      >\n        {children}\n      </div>\n    </div>\n  );\n}\n\nAccordionItem.defaultProps = {\n  onOpen: function () {\n    return null;\n  },\n};\n\nexport default AccordionItem;\n","import {\n  useState,\n  useRef,\n  useCallback,\n  useMemo,\n  useEffect,\n  Children,\n  cloneElement,\n} from 'react';\n\nimport { triggerSource } from './AccordionItem';\n\nconst styles = {\n  container: {\n    height: '100%',\n    width: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n  },\n};\nlet forcedOpenedElements = [];\nlet alwaysOpen = null;\nfunction Accordion({ children, defaultOpenIndex = 0 }) {\n  const [elements, setElements] = useState([]);\n  const refContainer = useRef();\n\n  const handleOpen = useCallback(\n    (index, trigger) => {\n      let el = elements.slice();\n      if (trigger.source === triggerSource.click) {\n        el = el.map((e, i) => (i === index && alwaysOpen !== index ? !e : e));\n      } else {\n        el = el.map((e, i) => (i === index ? true : false));\n        if (trigger.shiftKey) {\n          if (alwaysOpen === index) {\n            alwaysOpen = null;\n          } else {\n            alwaysOpen = index;\n          }\n        } else {\n          alwaysOpen = null;\n        }\n      }\n\n      forcedOpenedElements = el;\n      setElements(el);\n    },\n    [elements],\n  );\n\n  const mappedChildren = useMemo(() => {\n    return Children.map(children, (child, index) => {\n      return (\n        child &&\n        cloneElement(child, {\n          onOpen: handleOpen,\n          index,\n          isOpen: elements && elements[index],\n        })\n      );\n    });\n  }, [children, elements, handleOpen]);\n\n  useEffect(() => {\n    if (defaultOpenIndex != null) {\n      setElements((prevState) => {\n        if (prevState.length > 0) {\n          return prevState.map((e, i) =>\n            !forcedOpenedElements[i]\n              ? i === defaultOpenIndex\n                ? true\n                : false\n              : e,\n          );\n        }\n        forcedOpenedElements = Array(children.length)\n          .fill(false)\n          .map((e) => e);\n\n        return Array(children.length)\n          .fill(false)\n          .map((e, i) => (i === defaultOpenIndex ? true : e));\n      });\n    }\n  }, [children.length, defaultOpenIndex]);\n\n  return (\n    <div ref={refContainer} style={styles.container}>\n      {mappedChildren}\n    </div>\n  );\n}\n\nexport default Accordion;\n","import { css } from '@emotion/react';\n\nconst HighlightedRowStyle = css`\n  background-color: #ff6f0057;\n`;\n\nconst ConstantlyHighlightedRowStyle = css`\n  background-color: #f5f5dc;\n`;\n\nconst ReactTableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  // height: 100%;\n  font-size: 12px;\n\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n\n  th {\n    position: sticky;\n    background-color: white;\n    z-index: 2;\n    top: 0;\n  }\n  th,\n  td {\n    margin: 0;\n    padding: 0.15rem 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n    }\n  }\n`;\n\nexport { ReactTableStyle, HighlightedRowStyle, ConstantlyHighlightedRowStyle };\n","/** @jsxImportSource @emotion/react */\n\nimport { memo } from 'react';\nimport { useTable, useSortBy, useFlexLayout } from 'react-table';\n\nimport { ReactTableStyle } from './Style';\n\nfunction ReactTableFlexLayout({ data, columns, onMouseDown }) {\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n  } = useTable(\n    {\n      columns,\n      data,\n    },\n    useSortBy,\n    useFlexLayout,\n  );\n  return (\n    <table {...getTableProps()} css={ReactTableStyle}>\n      <thead>\n        {headerGroups.map((headerGroup) => (\n          <tr\n            key={headerGroup.getHeaderGroupProps().key}\n            {...headerGroup.getHeaderGroupProps()}\n          >\n            {headerGroup.headers.map((column) => (\n              <th\n                key={column.getHeaderProps().key}\n                {...column.getHeaderProps(column.getSortByToggleProps())}\n              >\n                {column.render('Header')}\n                <span>\n                  {column.isSorted ? (column.isSortedDesc ? ' ▼' : ' ▲') : ''}\n                </span>\n              </th>\n            ))}\n          </tr>\n        ))}\n      </thead>\n      <tbody\n        {...getTableBodyProps()}\n        style={{ display: 'block', height: '100%', overflowY: 'auto' }}\n      >\n        {rows.map((row) => {\n          prepareRow(row);\n          return (\n            <tr\n              key={row.getRowProps().key}\n              {...row.getRowProps()}\n              onMouseDown={onMouseDown}\n            >\n              {row.cells.map((cell) => {\n                return (\n                  <td\n                    key={cell.getCellProps().key}\n                    {...cell.getCellProps()}\n                    style={{ ...cell.getCellProps().style, padding: '0px' }}\n                  >\n                    {cell.render('Cell')}\n                  </td>\n                );\n              })}\n            </tr>\n          );\n        })}\n      </tbody>\n    </table>\n  );\n}\n\nReactTableFlexLayout.defaultProps = {\n  onMouseDown: () => {\n    return null;\n  },\n};\n\nexport default memo(ReactTableFlexLayout);\n","import { forwardRef, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction InfoWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const { data, activeSpectrum } = useChartData();\n\n    const { info = {}, meta = {} } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const datum = data.find((datum) => datum.id === activeSpectrum.id) || {\n          info: {},\n          meta: {},\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, data]);\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent {...rest} info={info} meta={meta} ref={forwardedRef} />\n    );\n  };\n\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default InfoWrapper;\n","import { useState, useCallback, useEffect, memo, useMemo, useRef } from 'react';\n\nimport ReactTableFlexLayout from '../elements/ReactTable/ReactTableFlexLayout';\nimport InfoWrapper from '../hoc/InfoWrapper';\n\nconst styles = {\n  container: {\n    height: '100%',\n  },\n  tableContainer: {\n    height: 'calc(100% - 30px)',\n    overflow: 'auto',\n    display: 'block',\n  },\n\n  searchInput: {\n    width: '100%',\n    borderRadius: '5px',\n    border: '0.55px solid gray',\n    padding: '5px',\n    marginBottom: '2px',\n  },\n};\n\n// information panel\nfunction InformationPanel({ info, meta }) {\n  const [information, setInformation] = useState({});\n  const [matches, setMatchesData] = useState([]);\n  const searchRef = useRef();\n\n  const handleSearch = useCallback(\n    (e) => {\n      const values = Object.keys(information).filter((key) =>\n        key\n          .toLowerCase()\n          .includes(e.target ? e.target.value.toLowerCase() : e.toLowerCase()),\n      );\n      setMatchesData(values);\n    },\n    [information],\n  );\n\n  useEffect(() => {\n    if (searchRef.current) {\n      handleSearch(searchRef.current.value);\n    }\n  }, [handleSearch, searchRef]);\n\n  useEffect(() => {\n    if (info && meta) {\n      const keys = Object.keys(info).concat(Object.keys(meta));\n      setMatchesData(keys);\n      setInformation({\n        ...info,\n        ...meta,\n      });\n    }\n  }, [info, meta]);\n\n  const columns = useMemo(\n    () => [\n      {\n        Header: 'Parameter',\n        sortType: 'basic',\n        minWidth: 100,\n        width: 20,\n        maxWidth: 20,\n        Cell: ({ row }) => (\n          <p style={{ padding: '5px', backgroundColor: 'white' }}>\n            {row.original}\n          </p>\n        ),\n      },\n      {\n        Header: 'Value',\n        sortType: 'basic',\n        resizable: true,\n        Cell: ({ row }) => (\n          <p\n            style={{\n              backgroundColor: '#efefef',\n              height: '100%',\n              padding: '5px',\n              fontFamily: 'monospace',\n              whiteSpace: 'pre',\n              overflow: 'hidden',\n            }}\n          >\n            {information[row.original].toString()}\n          </p>\n        ),\n      },\n    ],\n    [information],\n  );\n\n  return (\n    <div style={styles.container}>\n      <div>\n        <input\n          type=\"text\"\n          style={styles.searchInput}\n          placeholder=\"Search for parameter...\"\n          onChange={handleSearch}\n          ref={searchRef}\n        />\n      </div>\n      <div style={styles.tableContainer}>\n        <ReactTableFlexLayout data={matches} columns={columns} />\n      </div>\n    </div>\n  );\n}\n\nexport default InfoWrapper(memo(InformationPanel));\n","import { forwardRef, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\n\nfunction IntegralsWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      data,\n      activeSpectrum,\n      xDomain,\n      activeTab,\n      tabActiveSpectrum,\n      molecules,\n    } = useChartData();\n    const preferences = usePreferences();\n\n    const { integrals = {}, info = {} } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const datum = data.find((datum) => datum.id === activeSpectrum.id) || {\n          integrals: {},\n          info: {},\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, data]);\n\n    const nucleus = useMemo(() => {\n      if (tabActiveSpectrum && Object.keys(tabActiveSpectrum).length > 0) {\n        return Object.keys(tabActiveSpectrum);\n      }\n      return null;\n    }, [tabActiveSpectrum]);\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        integrals={integrals}\n        info={info}\n        xDomain={xDomain}\n        preferences={preferences}\n        activeTab={activeTab}\n        nucleus={nucleus}\n        molecules={molecules}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default IntegralsWrapper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useRef, useCallback } from 'react';\n\nimport CloseButton from '../../elements/CloseButton';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  width: 450px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    display: flex;\n    margin: 30px 5px;\n    input,\n    button {\n      padding: 5px;\n      border: 1px solid gray;\n      border-radius: 5px;\n      height: 36px;\n      margin: 2px;\n    }\n    input {\n      flex: 10;\n    }\n    button {\n      flex: 2;\n      color: white;\n      background-color: gray;\n    }\n  }\n`;\n\nfunction NumberInput({ onSave, onClose, header }) {\n  const valueReft = useRef();\n\n  const saveHandler = useCallback(() => {\n    onSave(valueReft.current.value);\n  }, [onSave]);\n\n  const handleKeyDown = useCallback(\n    (event) => {\n      if (event.key === 'Enter') {\n        onSave(valueReft.current.value);\n      }\n    },\n    [onSave],\n  );\n\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>{header}</span>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div className=\"container\">\n        <input\n          ref={valueReft}\n          type=\"number\"\n          placeholder=\"Enter the new value\"\n          onKeyDown={handleKeyDown}\n        />\n        <button type=\"button\" onClick={saveHandler}>\n          Set\n        </button>\n      </div>\n    </div>\n  );\n}\n\nNumberInput.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n  onClose: () => {\n    return null;\n  },\n};\nexport default NumberInput;\n","/** @jsxImportSource @emotion/react */\n\nimport { css } from '@emotion/react';\nimport {\n  useState,\n  Children,\n  useMemo,\n  useEffect,\n  useCallback,\n  memo,\n} from 'react';\nimport { FaAngleLeft } from 'react-icons/fa';\nimport { useMeasure } from 'react-use';\n\nfunction Arrow({ direction, onClick }) {\n  return (\n    <div\n      onClick={onClick}\n      css={css`\n        display: flex;\n        position: absolute;\n        top: calc(50% - 18px);\n        ${direction === 'right' ? `right: 25px` : `left: 25px`};\n        height: 36px;\n        width: 36px;\n        justify-content: center;\n        background: white;\n        border-radius: 50%;\n        cursor: pointer;\n        align-items: center;\n        border: none;\n        transition: transform ease-in 0.1s;\n        &:hover {\n          transform: scale(1.2);\n          background-color: #607d8b;\n          color: white;\n        }\n        img {\n          transform: translateX(${direction === 'left' ? '-2' : '2'}px);\n          &:focus {\n            outline: 0;\n          }\n        }\n      `}\n    >\n      <FaAngleLeft\n        style={{ transform: `scaleX(${direction === 'right' ? '-1' : '1'})` }}\n      />\n    </div>\n  );\n}\n\nconst transition = 0.45;\n\nfunction NextPrev({ children, loop, defaultIndex, onChange }) {\n  const [ref, { width }] = useMeasure();\n  const [activeIndex, setActiveIndex] = useState(0);\n  useEffect(() => {\n    setActiveIndex(defaultIndex);\n  }, [defaultIndex]);\n\n  const Sliders = useMemo(\n    () =>\n      Children.map(children, (child) => {\n        return (\n          <div\n            key={child.key}\n            css={css`\n              width: ${width}px;\n              height: 100%;\n            `}\n          >\n            {child}\n          </div>\n        );\n      }),\n    [children, width],\n  );\n\n  const nextHandler = useCallback(() => {\n    setActiveIndex((preActiveIndex) => {\n      if (preActiveIndex === Sliders.length - 1) {\n        onChange(preActiveIndex);\n\n        if (loop) {\n          return 0;\n        } else {\n          return preActiveIndex;\n        }\n      }\n\n      const nextIndex = preActiveIndex + 1;\n      onChange(nextIndex);\n\n      return nextIndex;\n    });\n  }, [Sliders.length, loop, onChange]);\n\n  const prevHandler = useCallback(() => {\n    setActiveIndex((preActiveIndex) => {\n      if (preActiveIndex === 0) {\n        onChange(preActiveIndex);\n        if (loop) {\n          return 0;\n        } else {\n          return preActiveIndex;\n        }\n      }\n      const prevIndex = preActiveIndex - 1;\n\n      onChange(prevIndex);\n\n      return prevIndex;\n    });\n  }, [loop, onChange]);\n\n  if (!width && !Sliders) return null;\n  return (\n    <div\n      css={css`\n        position: relative;\n        height: 100%;\n        width: 100%;\n        margin: 0 auto;\n        overflow: hidden;\n      `}\n      ref={ref}\n    >\n      <div\n        css={css`\n          transform: translateX(-${width * activeIndex}px);\n          transition: transform ease-out ${transition}s;\n          height: 100%;\n          width: ${width * Sliders.length}px;\n          display: flex;\n        `}\n      >\n        {Sliders}\n      </div>\n\n      {activeIndex !== 0 && <Arrow direction=\"left\" onClick={prevHandler} />}\n      {activeIndex !== Sliders.length - 1 && (\n        <Arrow direction=\"right\" onClick={nextHandler} />\n      )}\n    </div>\n  );\n}\n\nNextPrev.defaultProps = {\n  loop: false,\n  defaultIndex: 0,\n  onChange: () => null,\n};\nexport default memo(NextPrev);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useState } from 'react';\nimport MF from 'react-mf/lib/components/MF';\nimport { MolfileSvgRenderer } from 'react-ocl/full';\n\nimport NextPrev from './NextPrev';\n\nconst toolbarStyle = css`\n  display: flex;\n  flex-direction: row;\n  border-top: 0.55px solid rgb(240, 240, 240);\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n  padding: 0px 5px;\n\n  p {\n    margin: 0;\n    text-align: right;\n    width: 100%;\n    line-height: 22px;\n    padding: 0px 10px;\n  }\n`;\n\nconst moleculeContainerStyle = css`\n  width: 450px;\n\n  .slider {\n    height: 180px;\n    width: 100%;\n    padding: 0px;\n    height: 180px;\n    width: 100%;\n    padding: 0px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n  }\n  .slider p {\n    width: 100%;\n    margin: 0 auto;\n    display: block;\n    position: relative;\n    text-align: center;\n  }\n  .slider svg polygon {\n    fill: gray !important;\n  }\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 36px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n`;\n\nfunction MoleculeSelection({ molecules, onChange }) {\n  const [currentIndex, setCurrentIndex] = useState();\n\n  useEffect(() => {\n    if (molecules && molecules.length > 0) {\n      setCurrentIndex(0);\n    }\n  }, [molecules]);\n\n  const onChangeHandler = useCallback(\n    (slideIndex) => {\n      setCurrentIndex(slideIndex);\n      onChange(slideIndex);\n    },\n    [onChange],\n  );\n\n  return (\n    <div>\n      <div css={toolbarStyle}>\n        <p>\n          {molecules &&\n            molecules.length > 0 &&\n            `${+(currentIndex + 1)} / ${molecules.length}`}{' '}\n        </p>\n      </div>\n      <div css={moleculeContainerStyle}>\n        <NextPrev onChange={onChangeHandler}>\n          {molecules &&\n            molecules.map((mol, index) => (\n              <div key={mol.key} className=\"slider\">\n                <div>\n                  <MolfileSvgRenderer\n                    id={`molSVG${index}`}\n                    width={120}\n                    molfile={mol.molfile}\n                  />\n                </div>\n                <p>\n                  <MF mf={mol.mf} /> - {mol.mw.toFixed(2)}\n                </p>\n              </div>\n            ))}\n        </NextPrev>\n      </div>\n    </div>\n  );\n}\n\nMoleculeSelection.defaultProps = {\n  onChange: () => {\n    return null;\n  },\n};\n\nexport default MoleculeSelection;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useState, useEffect, useMemo } from 'react';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport MoleculeSelection from '../../elements/MoleculeSelection';\n\nconst selectMoleculeContainerStyle = css`\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n`;\n\nconst optionalTextStyle = css`\n  display: flex;\n  flex-direction: column;\n  padding: 5px;\n\n  .optional {\n    margin-top: 5px;\n    margin-bottom: 5px;\n    padding: 0px 10px;\n\n    text-align: center;\n    font-size: 18px;\n    font-weight: bold;\n  }\n  .optional2 {\n    margin-top: 5px;\n    margin-bottom: 25px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n`;\n\nconst moleculeContainerStyle = css`\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 36px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .newSumText {\n    margin-top: 15px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n`;\n\nfunction SelectMolecule({ onSave, molecules, element }) {\n  const [currentIndex, setCurrentIndex] = useState();\n  const {\n    display: { general, panels },\n  } = usePreferences();\n\n  const newSum = useMemo(() => {\n    return element &&\n      molecules &&\n      molecules.length > 0 &&\n      currentIndex !== undefined &&\n      molecules[currentIndex].atoms[element]\n      ? molecules[currentIndex].atoms[element]\n      : 0;\n  }, [currentIndex, element, molecules]);\n\n  useEffect(() => {\n    if (molecules && molecules.length > 0) {\n      setCurrentIndex(0);\n    }\n  }, [molecules]);\n\n  const saveSelectMoleculeHandler = useCallback(\n    (e) => {\n      e.preventDefault();\n      onSave(newSum);\n    },\n    [newSum, onSave],\n  );\n\n  const onChangeMoleculeSelectionHandler = useCallback((index) => {\n    setCurrentIndex(index);\n  }, []);\n\n  return !general.hideSetSumFromMolecule &&\n    !panels.hideStructuresPanel &&\n    element &&\n    molecules &&\n    molecules.length > 0 ? (\n    <div css={selectMoleculeContainerStyle}>\n      <div css={optionalTextStyle}>\n        <p className=\"optional\">OR</p>\n        <p className=\"optional2\">Select a molecule as reference!</p>\n      </div>\n      <div css={moleculeContainerStyle}>\n        <MoleculeSelection\n          molecules={molecules}\n          onChange={onChangeMoleculeSelectionHandler}\n        />\n        <button type=\"button\" onClick={saveSelectMoleculeHandler}>\n          Set\n        </button>\n        <p className=\"newSumText\">\n          New sum for {element} will be {newSum}!\n        </p>\n      </div>\n    </div>\n  ) : null;\n}\n\nSelectMolecule.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n};\nexport default SelectMolecule;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport NumberInput from './NumberInput';\nimport SelectMolecule from './SelectMolecule';\n\nconst modalContainer = css`\n  display: flex;\n  flex-direction: column;\n  padding: 5px;\n`;\n\nfunction ChangeSumModal({ onSave, onClose, header, molecules, element }) {\n  const saveInputValueHandler = useCallback(\n    (inputValue) => {\n      onSave(inputValue);\n    },\n    [onSave],\n  );\n\n  const saveSelectMoleculeHandler = useCallback(\n    (sum) => {\n      onSave(sum);\n    },\n    [onSave],\n  );\n\n  return (\n    <div css={modalContainer}>\n      <NumberInput\n        onSave={saveInputValueHandler}\n        onClose={onClose}\n        header={header}\n      />\n\n      <SelectMolecule\n        onSave={saveSelectMoleculeHandler}\n        molecules={molecules}\n        element={element}\n      />\n    </div>\n  );\n}\n\nChangeSumModal.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n  onClose: () => {\n    return null;\n  },\n};\nexport default ChangeSumModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo, useCallback, useState } from 'react';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst styles = css`\n  background-color: transparent;\n  border: none;\n  border-radius: 5px;\n\n  &:hover {\n    background-color: lightgray;\n  }\n\n  &.toggle-active {\n    background-color: gray;\n    color: white;\n  }\n`;\n\nfunction ToggleButton({\n  children,\n  style,\n  onClick,\n  popupTitle,\n  popupPlacement,\n  defaultValue,\n  disabled,\n}) {\n  const [flag, Toggle] = useState(defaultValue);\n\n  const toggleHandler = useCallback(() => {\n    onClick(!flag);\n\n    Toggle(!flag);\n  }, [onClick, flag]);\n  return (\n    <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n      <button\n        disabled={disabled}\n        css={styles}\n        style={style}\n        className={flag ? 'toogle toggle-active' : 'toggle'}\n        type=\"button\"\n        onClick={toggleHandler}\n      >\n        {children}\n      </button>\n    </ToolTip>\n  );\n}\n\nToggleButton.defaultProps = {\n  popupTitle: '',\n  popupPlacement: 'right',\n  style: {},\n  defaultValue: false,\n  onClick: () => null,\n  disabled: false,\n};\n\nexport default memo(ToggleButton);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo } from 'react';\nimport { FaRegTrashAlt, FaCog, FaFilter } from 'react-icons/fa';\n\nimport ToggleButton from '../../elements/ToggleButton';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\n\nconst styles = css`\n  \n  display: flex;\n  flex-direction: row;\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n  padding: 0px 5px;\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n\n  button:disabled{\n    opacity:0.6;\n  }\n  \n  .counter-label {\n    margin: 0;\n    text-align: right;\n    width: 100%;\n    line-height: 22px;\n    padding: 0px 10px;\n  }\n\n  filter-button{\n    borderRadius: 5px;\n    marginTop: 3px;\n    marginLeft: 5px;\n    color: black;\n    backgroundColor: transparent;\n    border: none;\n    height: 16px;\n    width: 18px;\n    fontSize: 12px;\n    padding: 0;\n  },\n\n`;\n\nfunction DefaultPanelHeader({\n  counter,\n  onDelete,\n  deleteToolTip,\n  onFilter,\n  filterToolTip,\n  filterIsActive,\n  counterFiltered,\n  children,\n  onSettingClick,\n  showSettingButton,\n  canDelete,\n}) {\n  return (\n    <div css={styles}>\n      {canDelete && (\n        <ToolTip title={deleteToolTip} popupPlacement=\"right\">\n          <button type=\"button\" onClick={onDelete} disabled={counter === 0}>\n            <FaRegTrashAlt />\n          </button>\n        </ToolTip>\n      )}\n\n      {/* Optional if there is no filter needed, e.g. in spectra panel */}\n      {onFilter && filterToolTip ? (\n        <ToggleButton\n          popupTitle={filterToolTip}\n          popupPlacement=\"right\"\n          onClick={onFilter}\n          // defaultValue={filterIsActive && filterIsActive === true}\n        >\n          <FaFilter style={{ pointerEvents: 'none', fontSize: '12px' }} />\n        </ToggleButton>\n      ) : null}\n\n      {children}\n\n      {counter ? (\n        <p className=\"counter-label\">\n          [{' '}\n          {filterIsActive &&\n          filterIsActive === true &&\n          counterFiltered !== undefined\n            ? `${counterFiltered}/${counter}`\n            : counter}{' '}\n          ]\n        </p>\n      ) : (\n        <p style={{ flex: 1 }} />\n      )}\n      {showSettingButton && (\n        <ToolTip title=\"preferences\" popupPlacement=\"left\">\n          <button type=\"button\" onClick={onSettingClick}>\n            <FaCog />\n          </button>\n        </ToolTip>\n      )}\n    </div>\n  );\n}\n\nDefaultPanelHeader.defaultProps = {\n  counter: 0,\n  onDelete: () => null,\n  deleteToolTip: 'Delete',\n  onFilter: () => null,\n  filterToolTip: '',\n  filterIsActive: false,\n  counterFiltered: 0,\n  onSettingClick: () => null,\n  showSettingButton: false,\n  canDelete: true,\n};\n\nexport default memo(DefaultPanelHeader);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport { memo } from 'react';\nimport { FaCheck } from 'react-icons/fa';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst styles = css`\n  background-color: transparent;\n  border: none;\n  height: 100%;\n  svg {\n    fill: green;\n    font-size: 16px;\n  }\n`;\nfunction SaveButton({\n  onClick,\n  popupTitle,\n  popupPlacement,\n  disabled,\n  className,\n}) {\n  return (\n    <div className={className}>\n      <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n        <button\n          css={styles}\n          type=\"button\"\n          onClick={onClick}\n          disabled={disabled}\n          className={className}\n        >\n          <FaCheck />\n        </button>\n      </ToolTip>\n    </div>\n  );\n}\n\nSaveButton.defaultProps = {\n  onClick: () => null,\n  popupTitle: 'Save',\n  popupPlacement: 'left',\n  disabled: false,\n  className: '',\n};\nSaveButton.propTypes = {\n  onClick: PropTypes.func,\n  popupTitle: PropTypes.string,\n  popupPlacement: PropTypes.string,\n  disabled: PropTypes.bool,\n  className: PropTypes.string,\n};\n\nexport default memo(SaveButton);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo } from 'react';\n\nimport CloseButton from '../../elements/CloseButton';\nimport SaveButton from '../../elements/SaveButton';\n\nconst styles = css`\n  display: flex;\n  flex-direction: row-reverse;\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n  button:disabled {\n    opacity: 0.6;\n  }\n`;\nfunction PreferencesHeader({ onClose, onSave }) {\n  return (\n    <div css={styles}>\n      <CloseButton onClick={onClose} popupTitle=\"close Preferences\" />\n      <SaveButton onClick={onSave} popupTitle=\"save Preferences\" />\n    </div>\n  );\n}\n\nexport default memo(PreferencesHeader);\n","import {\n  forwardRef,\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useRef,\n  useState,\n} from 'react';\n\nimport Input from './Input';\n\nconst EditableColumn = forwardRef(function EditableColumn(\n  { onSave, value, type, style, onEditStart, editStatus },\n  ref,\n) {\n  const [enabled, enableEdit] = useState();\n  const refInput = useRef();\n\n  useEffect(() => {\n    enableEdit(editStatus);\n  }, [editStatus]);\n\n  useImperativeHandle(ref, () => ({\n    startEdit: () => {\n      enableEdit(true);\n    },\n    closeEdit: () => {\n      enableEdit(false);\n    },\n  }));\n\n  const editModeHandler = useCallback(\n    (flag, event = null) => {\n      if (!flag) {\n        if (event.keyCode === 13) {\n          // when press Enter\n          onSave(event);\n          enableEdit(flag);\n        } else if (event.keyCode === 27) {\n          // when press Escape\n          enableEdit(flag);\n        }\n      } else {\n        onEditStart(event);\n        enableEdit(flag);\n      }\n    },\n    [onEditStart, onSave],\n  );\n\n  return (\n    <div\n      style={{ display: 'table', width: '100%', height: '100%', ...style }}\n      onDoubleClick={(event) => editModeHandler(true, event)}\n    >\n      {!enabled && (\n        <span style={{ display: 'table-cell', verticalAlign: 'middle' }}>\n          {value}\n        </span>\n      )}\n      {enabled && (\n        <div style={{ display: 'table-cell', verticalAlign: 'middle' }}>\n          <Input\n            enableAutoSelect\n            ref={refInput}\n            value={value}\n            type={type}\n            onKeyDown={(e) => editModeHandler(false, e)}\n          />\n        </div>\n      )}\n    </div>\n  );\n});\n\nEditableColumn.defaultProps = {\n  onSave: () => null,\n  onEditStart: () => null,\n  type: 'text',\n  editStatus: false,\n};\n\nexport default EditableColumn;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  forwardRef,\n  useState,\n  useImperativeHandle,\n  useCallback,\n  useRef,\n  useEffect,\n} from 'react';\nimport { createPortal } from 'react-dom';\n\nimport { useGlobal } from '../context/GlobalContext';\n\nconst styles = css`\n  box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.25);\n  padding: 0px;\n  margin: 0px;\n  border-radius: 2px;\n  display: flex;\n  flex-direction: column;\n  position: fixed;\n  z-index: 99999;\n  padding: 2px;\n  background-color: white;\n  width: 150px;\n  button {\n    background-color: transparent;\n    border: none;\n    border-bottom: 0.55px solid #f0f0f0;\n    font-size: 11px;\n    padding: 5px;\n    text-align: left;\n    outline: none;\n  }\n  button:hover {\n    background-color: #fafafa;\n    outline: none;\n  }\n\n  button:active {\n    background-color: #eaeaea;\n    outline: none;\n  }\n\n  button:last-of-type {\n    border: none;\n  }\n`;\nfunction ContextMenu({ context }, ref) {\n  const [position, setPosition] = useState({ lef: 0, top: 0 });\n  const { rootRef, elementsWraperRef } = useGlobal();\n  const [data, setData] = useState();\n  const [isVisible, show] = useState();\n  const [sourceElement, setSourceElement] = useState(null);\n  const root = useRef();\n\n  useEffect(() => {\n    root.current = document.createElement('div');\n    if (elementsWraperRef) {\n      elementsWraperRef.appendChild(root.current);\n    }\n    return () => {\n      if (root.current && elementsWraperRef) {\n        elementsWraperRef.removeChild(root.current);\n      }\n    };\n  }, [elementsWraperRef]);\n\n  const contextMenuHandler = (event) => {\n    event.preventDefault();\n    setSourceElement(event.target.parentElement);\n    show(true);\n    const clickX = event.clientX;\n    const clickY = event.clientY;\n\n    const screenW = window.innerWidth;\n    const screenH = window.innerHeight;\n    const rootW = 150;\n    const rootH = 0;\n\n    const right = screenW - clickX > rootW;\n    let left = !right;\n    let top = screenH - clickY > rootH;\n    const bottom = !top;\n    if (right) {\n      left = `${clickX + 5}px`;\n    }\n\n    if (left) {\n      left = `${clickX - rootW - 5}px`;\n    }\n\n    if (top) {\n      top = `${clickY + 5}px`;\n    }\n\n    if (bottom) {\n      top = `${clickY - rootH - 5}px`;\n    }\n\n    setPosition({ left, top });\n  };\n\n  useImperativeHandle(ref, () => ({\n    handleContextMenu: (e, _data) => {\n      setData(_data);\n      contextMenuHandler(e);\n    },\n  }));\n\n  const clickHandler = useCallback(\n    (event, click) => {\n      event.preventDefault();\n      click(data);\n      show(false);\n    },\n    [data],\n  );\n\n  useEffect(() => {\n    const _handleGlobalClick = (event) => {\n      const wasOutside =\n        sourceElement &&\n        event.target.parentElement &&\n        !event.target.parentElement.isSameNode(sourceElement);\n      if (wasOutside && isVisible) show(false);\n    };\n    if (rootRef) {\n      rootRef.addEventListener('click', _handleGlobalClick);\n    }\n    return () => {\n      if (rootRef) {\n        rootRef.removeEventListener('click', _handleGlobalClick);\n      }\n    };\n  }, [isVisible, ref, rootRef, sourceElement]);\n\n  if (!isVisible) {\n    return null;\n  }\n\n  return (\n    root.current &&\n    createPortal(\n      context && (\n        <div ref={ref} css={[styles, position]}>\n          {context.map((c, index) => (\n            <button\n              // eslint-disable-next-line react/no-array-index-key\n              key={index}\n              type=\"button\"\n              onClick={(e) => clickHandler(e, c.onClick)}\n            >\n              {c.label}\n            </button>\n          ))}\n        </div>\n      ),\n      root.current,\n    )\n  );\n}\n\nexport default forwardRef(ContextMenu);\n","const ReactTableHeader = ({ headerGroups }) => {\n  return (\n    <thead>\n      {headerGroups.map((headerGroup) => (\n        <tr\n          key={headerGroup.getHeaderGroupProps().key}\n          {...headerGroup.getHeaderGroupProps()}\n        >\n          {headerGroup.headers.map((column) => (\n            <th\n              key={column.getHeaderProps().key}\n              {...column.getHeaderProps(column.getSortByToggleProps())}\n            >\n              {column.render('Header')}\n              <span>\n                {column.isSorted ? (column.isSortedDesc ? ' ▼' : ' ▲') : ''}\n              </span>\n            </th>\n          ))}\n        </tr>\n      ))}\n    </thead>\n  );\n};\n\nexport default ReactTableHeader;\n","/** @jsxImportSource @emotion/react */\n\nimport { useHighlight } from '../../../highlight/index';\nimport { HighlightedRowStyle, ConstantlyHighlightedRowStyle } from '../Style';\n\nconst ReactTableRow = ({ row, onContextMenu }) => {\n  const highlight = useHighlight([\n    Object.prototype.hasOwnProperty.call(row.original, 'id')\n      ? row.original.id\n      : '',\n  ]);\n\n  return (\n    <tr\n      onContextMenu={onContextMenu}\n      key={row.getRowProps().key}\n      css={\n        highlight.isActive\n          ? HighlightedRowStyle\n          : Object.prototype.hasOwnProperty.call(\n              row.original,\n              'isConstantlyHighlighted',\n            ) && row.original.isConstantlyHighlighted === true\n          ? ConstantlyHighlightedRowStyle\n          : null\n      }\n      {...row.getRowProps()}\n      {...highlight.onHover}\n    >\n      {row.cells.map((cell) => {\n        const { minWidth, maxWidth, width, padding } = cell.column;\n        return (\n          <td\n            key={cell.key}\n            {...cell.getCellProps()}\n            onContextMenu={(e) => {\n              e.preventDefault();\n\n              return false;\n            }}\n            style={{ minWidth, maxWidth, width, padding }}\n          >\n            {cell.render('Cell')}\n          </td>\n        );\n      })}\n    </tr>\n  );\n};\n\nexport default ReactTableRow;\n","/** @jsxImportSource @emotion/react */\n\nimport PropTypes from 'prop-types';\nimport { Fragment, useRef, useCallback, memo } from 'react';\nimport { useTable, useSortBy } from 'react-table';\n\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport ContextMenu from '../ContextMenu';\n\nimport ReactTableHeader from './Elements/ReactTableHeader';\nimport ReactTableRow from './Elements/ReactTableRow';\nimport { ReactTableStyle } from './Style';\n\nfunction ReactTable({ data, columns, context }) {\n  const contextRef = useRef();\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n  } = useTable(\n    {\n      columns,\n      data,\n    },\n    useSortBy,\n  );\n\n  const contextMenuHandler = useCallback(\n    (e, row) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, row.original);\n      }\n    },\n    [contextRef],\n  );\n  return (\n    <Fragment>\n      <table {...getTableProps()} css={ReactTableStyle}>\n        <ReactTableHeader headerGroups={headerGroups} />\n        <tbody {...getTableBodyProps()}>\n          {rows.map((row) => {\n            prepareRow(row);\n            return (\n              <ReactTableRow\n                key={row.key}\n                row={row}\n                {...row.getRowProps()}\n                onContextMenu={(e) => contextMenuHandler(e, row)}\n              />\n            );\n          })}\n        </tbody>\n      </table>\n      <ContextMenu ref={contextRef} context={context} />\n    </Fragment>\n  );\n}\n\nReactTable.propTypes = {\n  context: PropTypes.arrayOf(\n    PropTypes.shape({\n      label: PropTypes.string,\n      onClick: PropTypes.func,\n    }),\n  ),\n};\nReactTable.defaultProps = {\n  context: null,\n};\n\nexport default memo(ReactTable);\n","// placeholder for empty tables if no data is available to show (e.g. peaks, integrals, ranges)\nfunction NoTableData() {\n  return (\n    <p\n      style={{\n        textAlign: 'center',\n        width: '100%',\n        fontSize: '11px',\n        padding: '5px',\n        color: 'gray',\n      }}\n    >\n      No Data\n    </p>\n  );\n}\nexport default NoTableData;\n","import lodashGet from 'lodash/get';\nimport { useCallback, useMemo, memo, useRef, useEffect } from 'react';\nimport { FaRegTrashAlt } from 'react-icons/fa';\n\nimport { SignalKinds } from '../../../data/constants/SignalsKinds';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useGlobal } from '../../context/GlobalContext';\nimport EditableColumn from '../../elements/EditableColumn';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport Select from '../../elements/Select';\nimport IntegralsWrapper from '../../hoc/IntegralsWrapper';\nimport {\n  DELETE_INTEGRAL,\n  CHANGE_INTEGRAL_DATA,\n  CHANGE_INTEGRAL_RELATIVE,\n} from '../../reducer/types/Types';\nimport formatNumber from '../../utility/FormatNumber';\nimport { getValue } from '../../utility/LocalStorage';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport { integralDefaultValues } from '../extra/preferences/defaultValues';\n\nconst selectStyle = { marginLeft: 10, marginRight: 10, border: 'none' };\n\nfunction IntegralTable({\n  integrals,\n  info,\n  activeTab,\n  xDomain,\n  enableFilter,\n  onFilter,\n  preferences,\n}) {\n  const dispatch = useDispatch();\n  const relativeRefs = useRef([]);\n  const { rootRef } = useGlobal();\n  const deleteIntegralHandler = useCallback(\n    (e, row) => {\n      e.preventDefault();\n      e.stopPropagation();\n      const params = row.original;\n      dispatch({\n        type: DELETE_INTEGRAL,\n        integralID: params.id,\n      });\n    },\n    [dispatch],\n  );\n  const changeIntegralDataHandler = useCallback(\n    (value, row) => {\n      const data = { ...row.original, kind: value };\n      dispatch({\n        type: CHANGE_INTEGRAL_DATA,\n        data,\n      });\n    },\n    [dispatch],\n  );\n  const defaultColumns = useMemo(\n    () => [\n      {\n        orderIndex: 1,\n        Header: '#',\n        Cell: ({ row }) => row.index + 1,\n        width: 10,\n      },\n\n      {\n        orderIndex: 2,\n        Header: 'From',\n        accessor: 'from',\n        sortType: 'basic',\n        resizable: true,\n        Cell: ({ row }) => row.original.from.toFixed(2),\n      },\n      {\n        orderIndex: 3,\n        Header: 'To',\n        accessor: 'to',\n        sortType: 'basic',\n        resizable: true,\n        Cell: ({ row }) => row.original.to.toFixed(2),\n      },\n      {\n        orderIndex: 6,\n        Header: 'Kind',\n        accessor: 'kind',\n        sortType: 'basic',\n        resizable: true,\n        Cell: ({ row }) => (\n          <Select\n            onChange={(value) => changeIntegralDataHandler(value, row)}\n            data={SignalKinds}\n            style={selectStyle}\n            defaultValue={row.original.kind}\n          />\n        ),\n      },\n      {\n        orderIndex: 7,\n        Header: '',\n        width: '1%',\n        maxWidth: '24px',\n        minWidth: '24px',\n        id: 'delete-button',\n        Cell: ({ row }) => (\n          <button\n            type=\"button\"\n            className=\"delete-button\"\n            onClick={(e) => deleteIntegralHandler(e, row)}\n          >\n            <FaRegTrashAlt />\n          </button>\n        ),\n      },\n    ],\n    [changeIntegralDataHandler, deleteIntegralHandler],\n  );\n\n  const saveRealtiveHandler = useCallback(\n    (event, row) => {\n      dispatch({\n        type: CHANGE_INTEGRAL_RELATIVE,\n        value: event.target.value,\n        id: row.id,\n      });\n    },\n    [dispatch],\n  );\n  const editStartHander = useCallback((index) => {\n    relativeRefs.current.forEach((ref, i) => {\n      if (index !== i && ref) {\n        ref.closeEdit();\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    if (rootRef) {\n      rootRef.addEventListener('mousedown', editStartHander);\n    }\n    return () => {\n      if (rootRef) {\n        rootRef.removeEventListener('mousedown', editStartHander);\n      }\n    };\n  }, [editStartHander, rootRef]);\n\n  const tableColumns = useMemo(() => {\n    const setCustomColumn = (array, index, columnLabel, cellHandler) => {\n      array.push({\n        orderIndex: index,\n        Header: columnLabel,\n        sortType: 'basic',\n        Cell: ({ row }) => cellHandler(row),\n      });\n    };\n\n    const integralsPreferences = getValue(\n      preferences,\n      `formatting.panels.integrals.[${activeTab}]`,\n    );\n    let cols = [...defaultColumns];\n    if (\n      lodashGet(\n        integralsPreferences,\n        'showAbsolute',\n        integralDefaultValues.showAbsolute,\n      )\n    ) {\n      setCustomColumn(cols, 4, 'Absolute', (row) =>\n        formatNumber(\n          row.original.absolute,\n          lodashGet(\n            integralsPreferences,\n            'absoluteFormat',\n            integralDefaultValues.absoluteFormat,\n          ),\n        ),\n      );\n    }\n    if (\n      lodashGet(\n        integralsPreferences,\n        'showRelative',\n        integralDefaultValues.showRelative,\n      )\n    ) {\n      const n = activeTab && activeTab.replace(/[0-9]/g, '');\n      setCustomColumn(cols, 5, `Relative ${n}`, (row) => {\n        const formattedNumber = formatNumber(\n          row.original.integral,\n          lodashGet(\n            integralsPreferences,\n            'relativeFormat',\n            integralDefaultValues.relativeFormat,\n          ),\n        );\n        return (\n          <EditableColumn\n            onEditStart={() => editStartHander(row.index)}\n            ref={(ref) => (relativeRefs.current[row.index] = ref)}\n            value={formattedNumber}\n            onSave={(event) => saveRealtiveHandler(event, row.original)}\n            type=\"number\"\n          />\n        );\n      });\n    }\n\n    return cols.sort(\n      (object1, object2) => object1.orderIndex - object2.orderIndex,\n    );\n  }, [\n    activeTab,\n    defaultColumns,\n    editStartHander,\n    preferences,\n    saveRealtiveHandler,\n  ]);\n\n  const tableData = useMemo(() => {\n    function isInRange(from, to) {\n      const factor = 10000;\n      to = to * factor;\n      from = from * factor;\n      return (\n        (to >= xDomain[0] * factor && from <= xDomain[1] * factor) ||\n        (from <= xDomain[0] * factor && to >= xDomain[1] * factor)\n      );\n    }\n    if (info.dimension === 1 && integrals && integrals.values) {\n      const _integrals = enableFilter\n        ? integrals.values.filter((integral) =>\n            isInRange(integral.from, integral.to),\n          )\n        : integrals.values;\n\n      return _integrals.map((integral) => {\n        return {\n          ...integral,\n          isConstantlyHighlighted: isInRange(integral.from, integral.to),\n        };\n      });\n    }\n    return [];\n  }, [enableFilter, info.dimension, integrals, xDomain]);\n\n  useEffect(() => {\n    onFilter(tableData.length);\n  }, [tableData, onFilter]);\n\n  return tableData && tableData.length > 0 ? (\n    <ReactTable data={tableData} columns={tableColumns} />\n  ) : (\n    <NoTableData />\n  );\n}\n\nexport default IntegralsWrapper(memo(IntegralTable));\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, memo, useState } from 'react';\nimport { ChromePicker } from 'react-color';\n\nconst style = css`\n  display: flex;\n  margin: 5px 0px;\n\n.inputLabel{\n  flex: 2;\n  font-size: 11px;\n  font-weight: bold;\n  color: #232323;\n}\n\n.input {\n  width: '60%',\n  text-align: 'center',\n}\n\n.color{\n  width: 36px;\n  height: 14px;\n  border-radius: 2px;\n}\n\n.swatch{\n  padding: 5px;\n  background: #fff;\n  border-radius: 1px;\n  box-shadow: 0 0 0 1px rgba(0,0,0,.1);\n  display: inline-block;\n  cursor: pointer;\n}\n.color-popover {\n  position: absolute;\n  z-index: 2;\n}\n\n.cover {\n  position: fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n}\n  .chrome-picker {\n    border-radius: none !important;\n    width: 200px !important;\n    height: 60px !important;\n    display: flex;\n\n\n  }\n  .chrome-picker > div:first-of-type {\n    padding: 0px !important;\n\n  }\n  .chrome-picker > div:last-child >  div:first-of-type {\n    width: 120px;\n\n  }\n  .chrome-picker > div:last-child >  div:last-child {\n    display:none !important;\n  }\n`;\n\nfunction ColorInput({ label, onColorChange, name, value }) {\n  const [displayColorPicker, showColorPicker] = useState(false);\n  const [color, setColor] = useState(value);\n\n  const handleClick = useCallback(() => {\n    showColorPicker(!displayColorPicker);\n  }, [displayColorPicker]);\n\n  const handleClose = useCallback(() => {\n    showColorPicker(false);\n  }, []);\n\n  const handleOnColorChanged = useCallback(\n    (colorEvent) => {\n      const hex = `${colorEvent.hex}${Math.round(\n        colorEvent.rgb.a * 255,\n      ).toString(16)}`;\n      setColor(hex);\n      onColorChange({ ...colorEvent, hex, name });\n    },\n    [name, onColorChange],\n  );\n\n  return (\n    <div css={style}>\n      <span className=\"inputLabel\">{label}</span>\n      <div style={{ flex: 4 }}>\n        <div className=\"swatch\" onClick={handleClick}>\n          <div className=\"color\" style={{ backgroundColor: color }} />\n          <input type=\"hidden\" value={color} name={name} />\n        </div>\n        {displayColorPicker ? (\n          <div className=\"color-popover\">\n            <div className=\"cover\" onClick={handleClose} />\n            <ChromePicker\n              color={{ hex: color }}\n              onChangeComplete={handleOnColorChanged}\n            />\n          </div>\n        ) : null}\n      </div>\n    </div>\n  );\n}\n\nColorInput.defaultProps = {\n  value: '#000000',\n  label: 'Color: ',\n  onColorChange: () => null,\n};\n\nexport default memo(ColorInput);\n","import { memo, useState } from 'react';\n\nimport Input from '../../../elements/Input';\n\nconst styles = {\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n    alignItems: 'center',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '60%',\n    textAlign: 'center',\n  },\n};\n\nfunction ColumnFormatField({\n  label,\n  checkControllerName,\n  checked,\n  format,\n  formatControllerName,\n  inputChangeHandler,\n  groupID,\n}) {\n  const [_checked, setChecked] = useState(Boolean(checked));\n\n  return (\n    <div style={styles.row}>\n      <span style={styles.inputLabel}>{label}</span>\n      <div\n        style={{\n          flex: 4,\n          display: 'flex',\n          flexDirection: 'row',\n          alignItems: 'center',\n        }}\n      >\n        <input\n          type=\"checkbox\"\n          onChange={(e) => setChecked(e.target.checked)}\n          style={{ margin: '0px 5px' }}\n          defaultChecked={_checked}\n        />\n        <input\n          name={`${groupID}-${checkControllerName}`}\n          type=\"hidden\"\n          value={_checked}\n        />\n        <Input\n          style={{ container: styles.input }}\n          name={`${groupID}-${formatControllerName}`}\n          type=\"text\"\n          onChange={inputChangeHandler}\n          value={format ? format : ''}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default memo(ColumnFormatField);\n","import lodashGet from 'lodash/get';\nimport lodashSet from 'lodash/set';\nimport {\n  useEffect,\n  useState,\n  useCallback,\n  forwardRef,\n  useImperativeHandle,\n  useRef,\n} from 'react';\nimport { MF } from 'react-mf';\n\nimport ColorInput from '../../elements/ColorInput';\nimport NumberInput from '../../elements/NumberInput';\nimport { useAlert } from '../../elements/popup/Alert';\nimport IntegralsWrapper from '../../hoc/IntegralsWrapper';\nimport { SET_PANELS_PREFERENCES } from '../../reducer/preferencesReducer';\nimport {\n  useStateWithLocalStorage,\n  getValue as getValueByKeyPath,\n} from '../../utility/LocalStorage';\nimport ColumnFormatField from '../extra/preferences/ColumnFormatField';\nimport { integralDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles = {\n  container: {\n    padding: 10,\n    backgroundColor: '#f1f1f1',\n    height: '100%',\n    flex: 1,\n  },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '30%',\n    textAlign: 'center',\n  },\n};\n\nconst formatFields = [\n  {\n    id: 1,\n    label: 'Absolute :',\n    checkController: 'showAbsolute',\n    formatController: 'absoluteFormat',\n    defaultFormat: '0.00',\n  },\n  {\n    id: 2,\n    label: 'Relative :',\n    checkController: 'showRelative',\n    formatController: 'relativeFormat',\n    defaultFormat: '00.00',\n  },\n];\nfunction IntegralsPreferences({ nucleus, preferences }, ref) {\n  const alert = useAlert();\n  const [, setSettingsData] = useStateWithLocalStorage('nmr-general-settings');\n\n  const [settings, setSetting] = useState(null);\n  const formRef = useRef();\n\n  useEffect(() => {\n    const integralsPreferences = getValueByKeyPath(\n      preferences,\n      'formatting.panels.integrals',\n    );\n\n    if (integralsPreferences) {\n      setSetting(integralsPreferences);\n    }\n  }, [preferences]);\n\n  const saveToLocalStorgate = (values) => {\n    setSettingsData(values, 'formatting.panels.integrals');\n  };\n\n  const saveHandler = useCallback(\n    (values, showMessage = false) => {\n      preferences.dispatch({\n        type: SET_PANELS_PREFERENCES,\n        payload: { key: 'integrals', value: values },\n      });\n      if (showMessage) {\n        alert.success('Integrals preferences saved successfully');\n      }\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(ref, () => ({\n    saveSetting() {\n      if (typeof formRef.current.requestSubmit === 'function') {\n        formRef.current.requestSubmit();\n      } else {\n        formRef.current.dispatchEvent(\n          new Event('submit', { cancelable: true }),\n        );\n      }\n    },\n  }));\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    const form = event.target;\n    const formData = new FormData(form);\n    let values = {};\n    for (const field of formData.entries()) {\n      const keys = field[0].split('-').join('.');\n      const val = ['true', 'false'].includes(field[1])\n        ? field[1] === 'true'\n        : field[1];\n      values = lodashSet(values, keys, val);\n    }\n    saveHandler(values, true);\n    saveToLocalStorgate(values);\n  };\n\n  const getValue = useCallback(\n    (...params) => {\n      if (settings) {\n        const value =\n          params[0] === null\n            ? settings[params[1]]\n            : lodashGet(settings, params.join('.'));\n        return value ? value : null;\n      } else {\n        const keyIndex = params.length - 1;\n        return integralDefaultValues[params[keyIndex]];\n      }\n    },\n    [settings],\n  );\n  return (\n    <div style={styles.container}>\n      <form onSubmit={handleSubmit} ref={formRef}>\n        <div style={styles.groupContainer}>\n          <p style={styles.header}>General</p>\n          <ColorInput name=\"color\" value={`${getValue(null, 'color')}`} />\n          <NumberInput\n            name=\"strokeWidth\"\n            label=\"stroke width :\"\n            style={{\n              label: { fontSize: '11px', fontWeight: 'bold', color: '#232323' },\n              input: {\n                width: '60%',\n                textAlign: 'center',\n                borderRadius: '5px',\n              },\n            }}\n            defaultValue={Number(getValue(null, 'strokeWidth'))}\n            min={1}\n            pattern=\"[1-9]*\"\n          />\n        </div>\n\n        {nucleus &&\n          nucleus.map((nucleusLabel) => (\n            <div key={nucleusLabel} style={styles.groupContainer}>\n              <p style={styles.header}>\n                <MF mf={nucleusLabel} />\n              </p>\n              {formatFields.map((field) => (\n                <ColumnFormatField\n                  key={field.id}\n                  label={field.label}\n                  checked={getValue(nucleusLabel, field.checkController)}\n                  format={getValue(nucleusLabel, field.formatController)}\n                  checkControllerName={field.checkController}\n                  formatControllerName={field.formatController}\n                  groupID={nucleusLabel}\n                />\n              ))}\n            </div>\n          ))}\n      </form>\n    </div>\n  );\n}\n\nexport default IntegralsWrapper(forwardRef(IntegralsPreferences));\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { SvgNmrSum } from 'cheminfo-font';\nimport lodashGet from 'lodash/get';\nimport { useCallback, useMemo, useState, useRef, memo, Fragment } from 'react';\nimport ReactCardFlip from 'react-card-flip';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useModal } from '../../elements/popup/Modal';\nimport IntegralsWrapper from '../../hoc/IntegralsWrapper';\nimport ChangeSumModal from '../../modal/changeSum/ChangeSumModal';\nimport {\n  DELETE_INTEGRAL,\n  CHANGE_INTEGRAL_SUM,\n} from '../../reducer/types/Types';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport IntegralTable from './IntegralTable';\nimport IntegralsPreferences from './IntegralsPreferences';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n\n  .sum-button {\n    width: 22px;\n    height: 22px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n`;\n\nfunction IntegralPanel({ integrals, activeTab, molecules }) {\n  const [filterIsActive, setFilterIsActive] = useState(false);\n  const [integralsCounter, setIntegralsCounter] = useState(0);\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef();\n\n  const yesHandler = useCallback(() => {\n    dispatch({ type: DELETE_INTEGRAL, integralID: null });\n  }, [dispatch]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All records will be deleted, Are You sure?',\n      buttons: [{ text: 'Yes', handler: yesHandler }, { text: 'No' }],\n    });\n  }, [modal, yesHandler]);\n\n  const changeIntegralSumHandler = useCallback(\n    (value) => {\n      if (value !== undefined) {\n        dispatch({ type: CHANGE_INTEGRAL_SUM, value });\n      }\n\n      modal.close();\n    },\n    [dispatch, modal],\n  );\n\n  const currentSum = useMemo(() => {\n    return lodashGet(integrals, 'options.sum', null);\n  }, [integrals]);\n\n  const showChangeIntegralSumModal = useCallback(() => {\n    modal.show(\n      <ChangeSumModal\n        onClose={() => modal.close()}\n        onSave={changeIntegralSumHandler}\n        header={\n          currentSum\n            ? `Set new Integrals Sum (Current: ${Number(currentSum).toFixed(\n                2,\n              )})`\n            : 'Set new Integrals Sum'\n        }\n        molecules={molecules}\n        element={activeTab ? activeTab.replace(/[0-9]/g, '') : null}\n      />,\n    );\n  }, [activeTab, changeIntegralSumHandler, currentSum, modal, molecules]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n\n  const changedHandler = useCallback((val) => {\n    setIntegralsCounter(val);\n  }, []);\n\n  return (\n    <Fragment>\n      <div css={styles}>\n        {!isFlipped && (\n          <DefaultPanelHeader\n            counter={integralsCounter}\n            onDelete={handleDeleteAll}\n            deleteToolTip=\"Delete All Integrals\"\n            onFilter={handleOnFilter}\n            filterToolTip={\n              filterIsActive\n                ? 'Show all integrals'\n                : 'Hide integrals out of view'\n            }\n            filterIsActive={filterIsActive}\n            counterFiltered={integralsCounter}\n            showSettingButton=\"true\"\n            onSettingClick={settingsPanelHandler}\n          >\n            <ToolTip\n              title={\n                currentSum\n                  ? `Change Integrals Sum (${Number(currentSum).toFixed(2)})`\n                  : 'Change Integrals Sum'\n              }\n              popupPlacement=\"right\"\n            >\n              <button\n                className=\"sum-button\"\n                type=\"button\"\n                onClick={showChangeIntegralSumModal}\n              >\n                <SvgNmrSum />\n              </button>\n            </ToolTip>\n          </DefaultPanelHeader>\n        )}\n        {isFlipped && (\n          <PreferencesHeader\n            onSave={saveSettingHandler}\n            onClose={settingsPanelHandler}\n          />\n        )}\n        <div style={{ height: '100%', overflow: 'hidden' }}>\n          <ReactCardFlip\n            isFlipped={isFlipped}\n            infinite\n            containerStyle={{ overflow: 'hidden', height: '100%' }}\n          >\n            <div style={{ overflow: 'auto', height: '100%', display: 'block' }}>\n              <IntegralTable\n                enableFilter={filterIsActive}\n                onFilter={changedHandler}\n              />\n            </div>\n            <IntegralsPreferences ref={settingRef} />\n          </ReactCardFlip>\n        </div>\n      </div>\n    </Fragment>\n  );\n}\n\nexport default IntegralsWrapper(memo(IntegralPanel));\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useState, useCallback, useRef } from 'react';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst menuStyles = css`\n  .menu {\n    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.5);\n    padding: 0px;\n    margin: 0px;\n    border-radius: 5px;\n    display: flex;\n    flex-direction: column;\n    position: absolute;\n    z-index: 99999;\n    padding: 2px;\n    background-color: white;\n\n    button:hover {\n      background-color: #fafafa;\n    }\n  }\n\n  .menu-cover {\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    z-index: 1;\n  }\n\n  .menu-item {\n    background-color: transparent;\n    border: none;\n    border-bottom: 0.55px solid whitesmoke;\n    height: 35px;\n    outline: outline;\n    display: table-cell;\n    vertical-align: middle;\n    text-align: left;\n    padding: 0 10px;\n\n    svg {\n      display: inline-block;\n    }\n\n    :focus {\n      outline: none !important;\n    }\n    span {\n      font-size: 10px;\n      padding: 0px 10px;\n    }\n  }\n`;\n\nfunction MenuItem({ icon, label, onClick }) {\n  return (\n    <button type=\"button\" className=\"menu-item\" onClick={onClick}>\n      {icon}\n      <span>{label}</span>\n    </button>\n  );\n}\n\nfunction MenuList({ items, boxBounding, onClick }) {\n  return (\n    <div\n      className=\"menu\"\n      style={{\n        transform: `translate(${boxBounding.width}px, -${boxBounding.height}px) `,\n      }}\n    >\n      {items &&\n        items.map((item) => {\n          return (\n            <MenuItem\n              key={`${item.id}`}\n              {...item}\n              onClick={() => onClick(item)}\n            />\n          );\n        })}\n    </div>\n  );\n}\n\nfunction MenuButton({\n  style,\n  component,\n  toolTip = '',\n  className,\n  items = [],\n  onClick = () => null,\n}) {\n  const menuButtonRef = useRef();\n  const [isShown, showMenu] = useState(false);\n\n  const closeMenuButton = useCallback(() => {\n    showMenu(false);\n  }, []);\n\n  const handleClick = useCallback(() => {\n    showMenu((flag) => !flag);\n  }, []);\n  const clickHandler = useCallback(\n    (e) => {\n      showMenu(false);\n      onClick(e);\n    },\n    [onClick],\n  );\n\n  return (\n    <div style={{ height: 'auto' }} css={menuStyles}>\n      <button\n        ref={menuButtonRef}\n        type=\"button\"\n        css={style}\n        onClick={handleClick}\n        className={className}\n        style={{ boxSizing: 'border-box' }}\n      >\n        <ToolTip title={toolTip} popupPlacement=\"right\">\n          {component}\n        </ToolTip>\n      </button>\n      {isShown && (\n        <MenuList\n          items={items}\n          boxBounding={menuButtonRef.current.getBoundingClientRect()}\n          onClick={clickHandler}\n        />\n      )}\n\n      {isShown && <div className=\"menu-cover\" onClick={closeMenuButton} />}\n    </div>\n  );\n}\n\nexport default MenuButton;\n","import { useMemo, memo, forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction MoleculeWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      data,\n      activeSpectrum,\n      molecules,\n      displayerMode,\n      activeTab,\n    } = useChartData();\n\n    const { ranges = {}, zones = {} } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const datum = data.find((datum) => datum.id === activeSpectrum.id) || {\n          ranges: {},\n          zones: {},\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, data]);\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        ranges={ranges}\n        zones={zones}\n        molecules={molecules}\n        displayerMode={displayerMode}\n        activeTab={activeTab}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return memo(\n    forwardRef((props, ref) => {\n      return <Wrapper {...props} forwardedRef={ref} />;\n    }),\n  );\n}\nexport default MoleculeWrapper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useState, useEffect, useCallback } from 'react';\nimport { StructureEditor } from 'react-ocl/full';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport { Modal } from '../elements/popup/Modal';\nimport { SET_MOLECULE, ADD_MOLECULE } from '../reducer/types/Types';\n\nconst modalButtonStyle = css`\n  -moz-box-shadow: inset 0px 1px 0px 0px #ffffff;\n  -webkit-box-shadow: inset 0px 1px 0px 0px #ffffff;\n  box-shadow: inset 0px 1px 0px 0px #ffffff;\n  background: -webkit-gradient(\n    linear,\n    left top,\n    left bottom,\n    color-stop(0.05, #ffffff),\n    color-stop(1, #f6f6f6)\n  );\n  background: -moz-linear-gradient(top, #ffffff 5%, #f6f6f6 100%);\n  background: -webkit-linear-gradient(top, #ffffff 5%, #f6f6f6 100%);\n  background: -o-linear-gradient(top, #ffffff 5%, #f6f6f6 100%);\n  background: -ms-linear-gradient(top, #ffffff 5%, #f6f6f6 100%);\n  background: linear-gradient(to bottom, #ffffff 5%, #f6f6f6 100%);\n  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffffff', endColorstr='#f6f6f6',GradientType=0);\n  background-color: #ffffff;\n  border: 0.55px solid #dcdcdc;\n  display: inline-block;\n  cursor: pointer;\n  color: #666666;\n  font-weight: bold;\n  padding: 6px 24px;\n  text-decoration: none;\n  text-shadow: 0px 1px 0px #ffffff;\n\n  :hover {\n    background: -webkit-gradient(\n      linear,\n      left top,\n      left bottom,\n      color-stop(0.05, #f6f6f6),\n      color-stop(1, #ffffff)\n    );\n    background: -moz-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: -webkit-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: -o-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: -ms-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: linear-gradient(to bottom, #f6f6f6 5%, #ffffff 100%);\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#f6f6f6', endColorstr='#ffffff',GradientType=0);\n    background-color: #f6f6f6;\n  }\n`;\n\nfunction MoleculeStructureEditorModal(props) {\n  const { onClose, open, selectedMolecule } = props;\n  const [molfile, setMolfile] = useState(null);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (selectedMolecule) {\n      setMolfile(selectedMolecule.molfile);\n    } else {\n      setMolfile(null);\n    }\n  }, [selectedMolecule, open]);\n\n  const cb = useCallback(\n    (newMolfile) => {\n      setMolfile(newMolfile);\n    },\n    [setMolfile],\n  );\n\n  const handleClose = useCallback(() => {\n    onClose();\n  }, [onClose]);\n\n  const handleSave = useCallback(() => {\n    if (selectedMolecule) {\n      dispatch({ type: SET_MOLECULE, molfile, key: selectedMolecule.key });\n      onClose('replace');\n    } else {\n      dispatch({ type: ADD_MOLECULE, molfile });\n      onClose('new');\n    }\n  }, [dispatch, selectedMolecule, molfile, onClose]);\n\n  const styles = {\n    footer: {\n      display: 'flex',\n      alignItems: 'flex-end',\n      justifyContent: 'flex-end',\n      margin: 5,\n    },\n  };\n\n  return (\n    <Modal open={open} onClose={handleClose}>\n      <StructureEditor\n        initialMolfile={selectedMolecule && selectedMolecule.molfile}\n        svgMenu\n        fragment={false}\n        onChange={cb}\n      />\n      <div style={styles.footer}>\n        <button type=\"button\" css={modalButtonStyle} onClick={handleClose}>\n          Close\n        </button>\n        <button type=\"button\" css={modalButtonStyle} onClick={handleSave}>\n          Save\n        </button>\n      </div>\n    </Modal>\n  );\n}\n\nexport default MoleculeStructureEditorModal;\n","/* eslint-disable prefer-named-capture-group */\n/* eslint-disable react/no-danger */\n\nfunction IsotopesViewer({ value = '', ...othersProps }) {\n  return (\n    <div\n      {...othersProps}\n      dangerouslySetInnerHTML={{\n        __html: value.replace(/([0-9]+)/g, '<sup>$1</sup>'),\n      }}\n    />\n  );\n}\n\nexport default IsotopesViewer;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, useEffect } from 'react';\n\nimport Select from '../Select';\n\nconst FormikSelect = function FormikSelect({\n  name,\n  value,\n  onChange,\n  ...resProps\n}) {\n  const { values, setFieldValue } = useFormikContext();\n  const changeHandler = useCallback(\n    (value) => {\n      onChange(value);\n      setFieldValue(name, value);\n    },\n    [name, onChange, setFieldValue],\n  );\n\n  useEffect(() => {\n    if (value) {\n      setFieldValue(name, value);\n    }\n  }, [name, setFieldValue, value]);\n\n  return (\n    <Select\n      name={name}\n      defaultValue={value ? value : lodashGet(values, name)}\n      onChange={changeHandler}\n      {...resProps}\n    />\n  );\n};\n// eslint-disable-next-line react/forbid-foreign-prop-types\nFormikSelect.propTypes = Select.propTypes;\nFormikSelect.defaultProps = Select.defaultProps;\n\nexport default FormikSelect;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useRef } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport CloseButton from '../elements/CloseButton';\nimport IsotopesViewer from '../elements/IsotopesViewer';\nimport FormikCheckBox from '../elements/formik/FormikCheckBox';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\nimport FormikSelect from '../elements/formik/FormikSelect';\nimport { PREDICT_SPECTRA, SET_LOADING_FLAG } from '../reducer/types/Types';\n\nimport { ModalStyles } from './ModalStyle';\n\nconst styles = css`\n  .row {\n    align-items: center;\n  }\n\n  .inner-content {\n    flex: 1;\n  }\n\n  .custom-label {\n    width: 155px;\n  }\n`;\n\nconst FREQUENCIES = [\n  { key: 1, value: 60, label: '60 MHz' },\n  { key: 2, value: 100, label: '100 MHz' },\n  { key: 3, value: 200, label: '200 MHz' },\n  { key: 4, value: 300, label: '300 MHz' },\n  { key: 5, value: 400, label: '400 MHz' },\n  { key: 6, value: 500, label: '500 MHz' },\n  { key: 7, value: 600, label: '600 MHz' },\n  { key: 8, value: 800, label: '800 MHz' },\n  { key: 9, value: 1000, label: '1000 MHz' },\n  { key: 10, value: 1200, label: '1200 MHz' },\n];\n\nconst INITIAL_VALUE = {\n  '1h': { from: -1, to: 12 },\n  '13c': { from: -5, to: 220 },\n  frequency: 400,\n  spectra: {\n    '1h': true,\n    '13c': false,\n    cosy: false,\n    hsqc: false,\n    hmbc: false,\n  },\n};\n\nfunction PredictSpectraModal({ onClose, molfile }) {\n  const refForm = useRef();\n  const dispatch = useDispatch();\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (values) => {\n      dispatch({\n        type: SET_LOADING_FLAG,\n        isLoading: true,\n      });\n      dispatch({\n        type: PREDICT_SPECTRA,\n        payload: { mol: molfile, options: values },\n      });\n      onClose();\n    },\n    [dispatch, molfile, onClose],\n  );\n\n  return (\n    <div css={[ModalStyles, styles]}>\n      <div className=\"header handle\">\n        <span>Predict Spectra</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <FormikForm\n          ref={refForm}\n          initialValues={INITIAL_VALUE}\n          onSubmit={submitHandler}\n        >\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Spectrometer Frequency :</span>\n\n            <FormikSelect\n              data={FREQUENCIES}\n              style={{ width: 290, height: 30, margin: 0 }}\n              name=\"frequency\"\n            />\n          </div>\n          <div className=\"row margin-10\">\n            <IsotopesViewer value=\"1H\" className=\"custom-label\" />\n            <FormikInput\n              label=\"From\"\n              name=\"1h.from\"\n              type=\"number\"\n              style={{ label: { padding: '0 10px 0 0' } }}\n            />\n            <FormikInput\n              label=\"To\"\n              name=\"1h.to\"\n              type=\"number\"\n              style={{ label: { padding: '0 10px' } }}\n            />\n          </div>\n          <div className=\"row margin-10\">\n            <IsotopesViewer value=\"13C\" className=\"custom-label\" />\n            <FormikInput\n              label=\"From\"\n              name=\"13c.from\"\n              type=\"number\"\n              style={{ label: { padding: '0 10px 0 0' } }}\n            />\n            <FormikInput\n              label=\"To\"\n              name=\"13c.to\"\n              type=\"number\"\n              style={{ label: { padding: '0 10px' } }}\n            />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Spectra </span>\n          </div>\n          <div\n            className=\"row margin-10\"\n            style={{ justifyContent: 'space-between' }}\n          >\n            <div className=\"row\">\n              <FormikCheckBox name=\"spectra.1h\" />\n              <IsotopesViewer value=\"1H\" style={{ padding: ' 0 10px' }} />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox disabled name=\"spectra.13c\" />\n              <IsotopesViewer value=\"13C\" style={{ padding: ' 0 10px' }} />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox disabled name=\"spectra.cosy\" />\n              <IsotopesViewer value=\"cosy\" style={{ padding: ' 0 10px' }} />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox disabled name=\"spectra.hsqc\" />\n              <IsotopesViewer value=\"HSQC\" style={{ padding: ' 0 10px' }} />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox disabled name=\"spectra.hmbc\" />\n              <IsotopesViewer value=\"HMBC\" style={{ padding: ' 0 10px' }} />\n            </div>\n          </div>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <button type=\"button\" onClick={handleSave} className=\"save-button\">\n          Start Predicting\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default PredictSpectraModal;\n","import { DISPLAYER_MODE } from '../../reducer/core/Constants';\n\nconst extractFromAtom = (atom, elements, activeAxis) => {\n  if (elements.length > 0 && Object.keys(atom).length > 0) {\n    const dim = activeAxis === 'x' ? 0 : activeAxis === 'y' ? 1 : undefined;\n    if (dim !== undefined) {\n      if (elements[dim] === atom.atomLabel) {\n        // take always oclID if atom type is same as element of activeTab)\n        return { oclIDs: [atom.oclID], nbAtoms: atom.nbAtoms };\n      }\n      if (elements[dim] === 'H') {\n        // if we are in proton spectrum and use then the IDs of attached hydrogens of an atom\n        return {\n          oclIDs: atom.hydrogenOCLIDs,\n          nbAtoms: atom.nbAtoms * atom.nbHydrogens,\n        };\n      }\n    } else {\n      return {\n        oclIDs: [atom.oclID].concat(atom.hydrogenOCLIDs),\n        nbAtoms: atom.nbAtoms + atom.nbAtoms * atom.nbHydrogens,\n      };\n    }\n  }\n\n  return { oclIDs: [], nbAtoms: 0 };\n};\n\nconst findDatumAndSignalIndex = (spectraData, id) => {\n  // if datum could be found then the id is on range/zone level\n  let datum = spectraData.find((_datum) => _datum.id === id);\n  let signalIndex;\n  if (!datum) {\n    // figure out the datum via id\n    for (let i = 0; i < spectraData.length; i++) {\n      signalIndex = spectraData[i].signal.findIndex(\n        (_signal) => _signal.id === id,\n      );\n      if (signalIndex >= 0) {\n        datum = spectraData[i];\n        break;\n      }\n    }\n  }\n\n  return { datum, signalIndex };\n};\n\nconst getHighlightsOnHover = (assignmentData, oclIDs, spectraData) => {\n  // set all IDs to highlight when hovering over an atom from assignment data\n  let highlights = [];\n  for (let key in assignmentData.assignment.assignment) {\n    let datum, signalIndex;\n    let stop = false;\n    if (\n      assignmentData.assignment.assignment[key].x &&\n      assignmentData.assignment.assignment[key].x.some((_assigned) =>\n        oclIDs.includes(_assigned),\n      )\n    ) {\n      highlights = highlights.concat(\n        assignmentData.assignment.assignment[key].x,\n      );\n      const result = findDatumAndSignalIndex(spectraData, key);\n      datum = result.datum;\n      signalIndex = result.signalIndex;\n      stop = true;\n    }\n    if (\n      assignmentData.assignment.assignment[key].y &&\n      assignmentData.assignment.assignment[key].y.some((_assigned) =>\n        oclIDs.includes(_assigned),\n      )\n    ) {\n      highlights = highlights.concat(\n        assignmentData.assignment.assignment[key].y,\n      );\n      const result = findDatumAndSignalIndex(spectraData, key);\n      datum = result.datum;\n      signalIndex = result.signalIndex;\n      stop = true;\n    }\n    if (datum) {\n      highlights.push(datum.id);\n      if (signalIndex !== undefined) {\n        highlights.push(datum.signal[signalIndex].id);\n      }\n    }\n    if (stop) {\n      break;\n    }\n  }\n  return highlights;\n};\n\nconst getCurrentDiaIDsToHighlight = (assignmentData, displayerMode) => {\n  const assignmentOnHover = assignmentData.assignment.isOnHover\n    ? assignmentData.assignment.assignment[assignmentData.assignment.onHoverID]\n    : null;\n\n  const axisOnHover = assignmentData.assignment.isOnHover\n    ? assignmentData.assignment.onHoverAxis\n    : null;\n\n  return assignmentOnHover\n    ? displayerMode === DISPLAYER_MODE.DM_1D\n      ? assignmentOnHover.x || []\n      : displayerMode === DISPLAYER_MODE.DM_2D\n      ? axisOnHover\n        ? axisOnHover === 'x'\n          ? assignmentOnHover.x || []\n          : axisOnHover === 'y'\n          ? assignmentOnHover.y || []\n          : (assignmentOnHover.x || []).concat(assignmentOnHover.y || [])\n        : (assignmentOnHover.x || []).concat(assignmentOnHover.y || [])\n      : []\n    : [];\n};\n\nconst toggleDiaIDs = (diaID, atomInformation) => {\n  let _diaID = diaID ? diaID.slice() : [];\n  if (atomInformation.oclIDs.length === 1) {\n    if (_diaID.includes(atomInformation.oclIDs[0])) {\n      _diaID = _diaID.filter((_id) => _id !== atomInformation.oclIDs[0]);\n    } else {\n      for (let i = 0; i < atomInformation.nbAtoms; i++) {\n        _diaID.push(atomInformation.oclIDs[0]);\n      }\n    }\n  } else if (atomInformation.oclIDs.length > 1) {\n    atomInformation.oclIDs.forEach((_oclID) => {\n      if (_diaID.includes(_oclID)) {\n        _diaID = _diaID.filter((_id) => _id !== _oclID);\n      } else {\n        _diaID.push(_oclID);\n      }\n    });\n  }\n  return _diaID;\n};\n\nexport {\n  extractFromAtom,\n  findDatumAndSignalIndex,\n  getCurrentDiaIDsToHighlight,\n  getHighlightsOnHover,\n  toggleDiaIDs,\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { SvgNmrFt } from 'cheminfo-font';\nimport OCL from 'openchemlib/full';\nimport { useState, useCallback, useMemo, useEffect, memo } from 'react';\nimport {\n  FaPlus,\n  FaPaste,\n  FaRegTrashAlt,\n  FaFileExport,\n  FaDownload,\n  FaFileImage,\n  FaCopy,\n} from 'react-icons/fa';\nimport { MF } from 'react-mf';\nimport OCLnmr from 'react-ocl-nmr';\nimport { useMeasure } from 'react-use';\n\nimport { ConcatenationString } from '../../../data/utilities/Concatenation';\nimport { useAssignmentData, useAssignment } from '../../assignment';\nimport { useDispatch } from '../../context/DispatchContext';\nimport ButtonToolTip from '../../elements/ButtonToolTip';\nimport MenuButton from '../../elements/MenuButton';\nimport NextPrev from '../../elements/NextPrev';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { positions, useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport { useHighlightData } from '../../highlight';\nimport MoleculeWrapper from '../../hoc/MoleculeWrapper';\nimport MoleculeStructureEditorModal from '../../modal/MoleculeStructureEditorModal';\nimport PredictSpectraModal from '../../modal/PredictSpectraModal';\nimport { DISPLAYER_MODE } from '../../reducer/core/Constants';\nimport {\n  ADD_MOLECULE,\n  DELETE_MOLECULE,\n  SET_DIAID_RANGE,\n  SET_DIAID_ZONE,\n  SET_MOLECULE,\n} from '../../reducer/types/Types';\nimport {\n  copyTextToClipboard,\n  copyPNGToClipboard,\n  exportAsSVG,\n} from '../../utility/Export';\n\nimport {\n  extractFromAtom,\n  findDatumAndSignalIndex,\n  getCurrentDiaIDsToHighlight,\n  getHighlightsOnHover,\n  toggleDiaIDs,\n} from './Utilities';\n\nconst panelContainerStyle = css`\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  width: 100%;\n  height: 100%;\n`;\n\nconst toolbarStyle = css`\n  display: flex;\n  flex-direction: row;\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n  padding: 0px 5px;\n\n  button svg {\n    fill: #4e4e4e;\n  }\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n\n  p {\n    margin: 0;\n    text-align: right;\n    width: 100%;\n    line-height: 22px;\n    padding: 0px 10px;\n  }\n`;\n\nconst moleculeContainerStyle = css`\n  width: 100%;\n  height: 100%;\n\n  .slider {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    height: 100%;\n    padding: 0px;\n    .mol-svg-container {\n      height: calc(100% - 25px);\n      width: 100%;\n      div {\n        width: 100%;\n        height: 100%;\n      }\n    }\n\n    p {\n      width: 100%;\n      margin: 0 auto;\n      display: block;\n      position: relative;\n      text-align: center;\n    }\n\n    svg polygon {\n      fill: gray !important;\n    }\n  }\n`;\n\nconst MOL_EXPORT_MENU = [\n  {\n    id: 'molfile',\n    icon: <FaCopy />,\n    label: 'Copy as molfile',\n  },\n  {\n    id: 'png',\n    icon: <FaFileImage />,\n    label: 'Copy as PNG',\n  },\n  {\n    id: 'svg',\n    icon: <FaDownload />,\n    label: 'Export as SVG',\n  },\n];\n\nfunction MoleculePanel({ zones, ranges, molecules, activeTab, displayerMode }) {\n  const [refContainer, { width, height }] = useMeasure();\n  const [open, setOpen] = useState(false);\n  const [currentMolfile, setCurrentMolfile] = useState();\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [onAtomHoverHighlights, setOnAtomHoverHighlights] = useState([]);\n  const [onAtomHoverAction, setOnAtomHoverAction] = useState(null);\n\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const modal = useModal();\n\n  const highlightData = useHighlightData();\n  const assignmentData = useAssignmentData();\n  const [elements, setElements] = useState([]);\n\n  useEffect(() => {\n    if (activeTab) {\n      const split = activeTab.split(',');\n      if (split.length === 1) {\n        setElements([activeTab.replace(/[0-9]/g, '')]);\n      } else if (split.length === 2) {\n        setElements(split.map((nucleus) => nucleus.replace(/[0-9]/g, '')));\n      }\n    } else {\n      setElements([]);\n    }\n  }, [activeTab]);\n\n  const activeAssignment = useAssignment(\n    assignmentData.assignment.activeID !== undefined\n      ? assignmentData.assignment.activeID\n      : ConcatenationString, // dummy value\n  );\n\n  const data = useMemo(() => {\n    if (zones || ranges) {\n      if (displayerMode === DISPLAYER_MODE.DM_1D && ranges && ranges.values) {\n        return ranges.values;\n      } else if (\n        displayerMode === DISPLAYER_MODE.DM_2D &&\n        zones &&\n        zones.values\n      ) {\n        return zones.values;\n      }\n    }\n    return [];\n  }, [displayerMode, ranges, zones]);\n\n  const assignedDiaIDs = useMemo(() => {\n    const assignedDiaID = { x: [], y: [] };\n    for (let id in assignmentData.assignment.assignment) {\n      if (assignmentData.assignment.assignment[id].x) {\n        assignedDiaID.x.push(...assignmentData.assignment.assignment[id].x);\n      }\n      if (assignmentData.assignment.assignment[id].y) {\n        assignedDiaID.y.push(...assignmentData.assignment.assignment[id].y);\n      }\n    }\n    // with its structure it's prepared for showing assigned IDs per axis\n    return assignedDiaID;\n  }, [assignmentData.assignment]);\n\n  // used for atom highlighting for now, until we would like to highlight atoms per axis separately\n  const assignedDiaIDsMerged = useMemo(\n    () => assignedDiaIDs.x.concat(assignedDiaIDs.y),\n    [assignedDiaIDs.x, assignedDiaIDs.y],\n  );\n\n  const toggleAssignment = useCallback(\n    (diaID, atomInformation) => {\n      // 1. one atom can only be assigned to one range/zone/signal\n      // 2. check whether an atom is already assigned to a range to allow toggling the assignment\n      if (\n        assignedDiaIDsMerged.some((_oclID) =>\n          atomInformation.oclIDs.includes(_oclID),\n        ) &&\n        !diaID.some((_oclID) => atomInformation.oclIDs.includes(_oclID))\n      ) {\n        alert.info('Atom is already assigned to another signal!');\n        return diaID;\n      }\n\n      return toggleDiaIDs(diaID, atomInformation);\n    },\n    [alert, assignedDiaIDsMerged],\n  );\n\n  const handleOnClickAtom = useCallback(\n    (atom) => {\n      if (activeAssignment.isActive) {\n        const atomInformation = extractFromAtom(\n          atom,\n          elements,\n          activeAssignment.activeAxis,\n        );\n        if (atomInformation.nbAtoms > 0) {\n          // save assignment in assignment hook\n          atomInformation.oclIDs.forEach((_oclID) => {\n            activeAssignment.toggle(_oclID);\n          });\n          // save assignment (diaIDs) in range/zone data\n          const { datum, signalIndex } = findDatumAndSignalIndex(\n            data,\n            activeAssignment.id,\n          );\n          if (datum) {\n            // determine the level of setting the diaID array (range vs. signal level) and save there\n            let _diaID = [];\n            // on range/zone level\n            if (signalIndex === undefined) {\n              if (displayerMode === DISPLAYER_MODE.DM_1D) {\n                _diaID = toggleAssignment(datum.diaID || [], atomInformation);\n              } else if (displayerMode === DISPLAYER_MODE.DM_2D) {\n                _diaID = toggleAssignment(\n                  datum[activeAssignment.activeAxis].diaID || [],\n                  atomInformation,\n                );\n              }\n            } else if (datum.signal && datum.signal[signalIndex]) {\n              // on signal level\n              if (displayerMode === DISPLAYER_MODE.DM_1D) {\n                _diaID = toggleAssignment(\n                  datum.signal[signalIndex].diaID || [],\n                  atomInformation,\n                );\n              } else if (displayerMode === DISPLAYER_MODE.DM_2D) {\n                _diaID = toggleAssignment(\n                  datum.signal[signalIndex][activeAssignment.activeAxis]\n                    .diaID || [],\n                  atomInformation,\n                );\n              }\n            }\n            if (displayerMode === DISPLAYER_MODE.DM_1D) {\n              dispatch({\n                type: SET_DIAID_RANGE,\n                payload: {\n                  rangeData: datum,\n                  diaID: _diaID,\n                  signalIndex,\n                },\n              });\n            } else if (displayerMode === DISPLAYER_MODE.DM_2D) {\n              dispatch({\n                type: SET_DIAID_ZONE,\n                payload: {\n                  zoneData: datum,\n                  diaID: _diaID,\n                  axis: activeAssignment.activeAxis,\n                  signalIndex,\n                },\n              });\n            }\n          }\n        } else {\n          alert.info(\n            'Not assigned! Different atom type or no attached hydrogens found!',\n          );\n        }\n      }\n    },\n    [\n      activeAssignment,\n      alert,\n      data,\n      dispatch,\n      displayerMode,\n      elements,\n      toggleAssignment,\n    ],\n  );\n\n  const currentDiaIDsToHighlight = useMemo(() => {\n    return getCurrentDiaIDsToHighlight(assignmentData, displayerMode);\n  }, [assignmentData, displayerMode]);\n\n  useEffect(() => {\n    if (onAtomHoverAction) {\n      if (onAtomHoverAction === 'show') {\n        highlightData.dispatch({\n          type: 'SHOW',\n          payload: { convertedHighlights: onAtomHoverHighlights },\n        });\n      } else if (onAtomHoverAction === 'hide') {\n        highlightData.dispatch({\n          type: 'HIDE',\n          payload: { convertedHighlights: onAtomHoverHighlights },\n        });\n        setOnAtomHoverHighlights([]);\n      }\n      setOnAtomHoverAction(null);\n    }\n  }, [onAtomHoverAction, onAtomHoverHighlights, highlightData]);\n\n  const handleOnAtomHover = useCallback(\n    (atom) => {\n      const oclIDs = extractFromAtom(\n        atom,\n        elements,\n        activeAssignment.activeAxis,\n      ).oclIDs;\n      // on enter the atom\n      if (oclIDs.length > 0) {\n        // set all IDs to highlight when hovering over an atom from assignment data\n        const highlights = getHighlightsOnHover(assignmentData, oclIDs, data);\n        setOnAtomHoverHighlights(highlights);\n        setOnAtomHoverAction('show');\n      } else {\n        // on leave the atom\n        setOnAtomHoverAction('hide');\n      }\n    },\n    [activeAssignment.activeAxis, assignmentData, data, elements],\n  );\n\n  const handleClose = useCallback(\n    (e) => {\n      setOpen(false);\n      if (e === 'new') {\n        setCurrentIndex(molecules.length);\n      }\n    },\n    [molecules.length],\n  );\n\n  const handleOpen = useCallback((event, key, molfile) => {\n    if (molfile) {\n      setCurrentMolfile({ molfile, key });\n    } else {\n      setCurrentMolfile(null);\n    }\n    setOpen(true);\n  }, []);\n\n  const handlePaste = useCallback(() => {\n    navigator.clipboard.readText().then((molfile) => {\n      dispatch({ type: ADD_MOLECULE, molfile });\n    });\n  }, [dispatch]);\n\n  const handleDelete = useCallback(() => {\n    if (molecules[currentIndex] && molecules[currentIndex].key) {\n      setCurrentIndex(0);\n      dispatch({\n        type: DELETE_MOLECULE,\n        payload: { key: molecules[currentIndex].key, assignmentData },\n      });\n    }\n  }, [molecules, currentIndex, assignmentData, dispatch]);\n\n  const saveAsSVGHandler = useCallback(() => {\n    exportAsSVG('molFile', `molSVG${currentIndex}`);\n  }, [currentIndex]);\n\n  const saveAsPNGHandler = useCallback(() => {\n    copyPNGToClipboard(`molSVG${currentIndex}`);\n    alert.success('MOL copied as PNG to clipboard');\n  }, [alert, currentIndex]);\n\n  const saveAsMolHandler = useCallback(() => {\n    if (molecules[currentIndex]) {\n      const flag = copyTextToClipboard(molecules[currentIndex].molfile);\n      if (flag) {\n        alert.success('MOLFile copied to clipboard');\n      } else {\n        alert.error('copied not completed');\n      }\n    }\n  }, [alert, currentIndex, molecules]);\n\n  const handleReplaceMolecule = useCallback(\n    (key, molfile) => {\n      dispatch({ type: SET_MOLECULE, molfile, key });\n    },\n    [dispatch],\n  );\n\n  const openPredicSpectraModal = useCallback(() => {\n    modal.show(\n      <PredictSpectraModal\n        onSave={() => {\n          modal.close();\n        }}\n        molfile={molecules[currentIndex]}\n      />,\n      {\n        position: positions.TOP_CENTER,\n        enableResizing: true,\n        width: 600,\n        height: 350,\n      },\n    );\n  }, [modal, molecules, currentIndex]);\n\n  const exportHandler = useCallback(\n    ({ id }) => {\n      switch (id) {\n        case 'molfile':\n          saveAsMolHandler();\n          break;\n        case 'png':\n          saveAsPNGHandler();\n          break;\n        case 'svg':\n          saveAsSVGHandler();\n          break;\n        default:\n          break;\n      }\n    },\n    [saveAsMolHandler, saveAsPNGHandler, saveAsSVGHandler],\n  );\n\n  return (\n    <div css={panelContainerStyle}>\n      <div css={toolbarStyle}>\n        <MenuButton\n          component={<FaFileExport />}\n          toolTip=\"Export As\"\n          items={MOL_EXPORT_MENU}\n          onClick={exportHandler}\n        />\n\n        <ToolTip title=\"Paste molfile\" popupPlacement=\"left\">\n          <button className=\"bar-button\" type=\"button\" onClick={handlePaste}>\n            <FaPaste />\n          </button>\n        </ToolTip>\n        <ToolTip title=\"Add Molecule\" popupPlacement=\"left\">\n          <button className=\"bar-button\" type=\"button\" onClick={handleOpen}>\n            <FaPlus />\n          </button>\n        </ToolTip>\n        <ToolTip title=\"Delete Molecule\" popupPlacement=\"left\">\n          <button className=\"bar-button\" type=\"button\" onClick={handleDelete}>\n            <FaRegTrashAlt />\n          </button>\n        </ToolTip>\n        <ButtonToolTip\n          popupTitle=\"Predict Spectra\"\n          popupPlacement=\"left\"\n          onClick={openPredicSpectraModal}\n          disabled={!molecules || molecules.length === 0}\n        >\n          <SvgNmrFt />\n        </ButtonToolTip>\n        <p>\n          {molecules &&\n            molecules.length > 0 &&\n            `${+(currentIndex + 1)} / ${molecules.length}`}{' '}\n        </p>\n      </div>\n      <div css={moleculeContainerStyle}>\n        <NextPrev\n          onChange={(slideIndex) => setCurrentIndex(slideIndex)}\n          defaultIndex={currentIndex}\n        >\n          {molecules && molecules.length > 0 ? (\n            molecules.map((mol, index) => (\n              <div\n                className=\"slider\"\n                key={mol.key}\n                onDoubleClick={(event) =>\n                  handleOpen(event, mol.key, mol.molfile)\n                }\n                style={{\n                  backgroundColor: (index + 1) % 2 !== 0 ? '#fafafa' : 'white',\n                }}\n              >\n                <div className=\"mol-svg-container\" ref={refContainer}>\n                  <OCLnmr\n                    OCL={OCL}\n                    id={`molSVG${index}`}\n                    width={width > 0 ? width : 100}\n                    height={height > 0 ? height : 100}\n                    molfile={mol.molfile}\n                    setMolfile={(molfile) =>\n                      handleReplaceMolecule(mol.key, molfile)\n                    }\n                    setSelectedAtom={handleOnClickAtom}\n                    atomHighlightColor={\n                      currentDiaIDsToHighlight &&\n                      currentDiaIDsToHighlight.length > 0\n                        ? 'red'\n                        : '#FFD700'\n                    }\n                    atomHighlightOpacity={0.35}\n                    highlights={\n                      currentDiaIDsToHighlight &&\n                      currentDiaIDsToHighlight.length > 0\n                        ? currentDiaIDsToHighlight\n                        : assignedDiaIDsMerged\n                    }\n                    setHoverAtom={handleOnAtomHover}\n                  />\n                </div>\n                <p>\n                  <MF mf={mol.mf} /> - {mol.mw.toFixed(2)}\n                </p>\n              </div>\n            ))\n          ) : (\n            <div\n              style={{ width: '100%', height: '100%' }}\n              onClick={handleOpen}\n            />\n          )}\n        </NextPrev>\n\n        <MoleculeStructureEditorModal\n          open={open}\n          onClose={handleClose}\n          selectedMolecule={currentMolfile}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default MoleculeWrapper(memo(MoleculePanel));\n","import lodashGet from 'lodash/get';\nimport isEmpty from 'lodash/isEmpty';\n\nimport generateChar from '../utilities/generateChar';\n\nimport { detectRange } from './Datum1D';\n\nexport const COLUMNS_TYPES = {\n  NORMAL: 'NORMAL',\n  FORMULA: 'FORMULA',\n};\n\nlet reservedColumnsNames = {};\n\nfunction addColumnKey(spectraAnalysis, nucleus, columnProps, columnKey) {\n  const index = Object.keys(spectraAnalysis[nucleus].options.columns).length;\n  const key = columnKey ? columnKey : generateChar(index).toUpperCase();\n  spectraAnalysis[nucleus].options.columns[key] = columnProps;\n  return key;\n}\n\nexport function getColumns(spectraAnalysis, nucleus) {\n  return spectraAnalysis[nucleus].options.columns;\n}\n\nexport function getValue(colKey, columns, data) {\n  return data[columns[colKey].valueKey];\n}\n\nexport function getSpectraAnalysis(spectra, options) {\n  const { from, to, nucleus } = options;\n  return spectra.reduce(\n    (acc, datum) => {\n      if (\n        datum.info.dimension === 1 &&\n        datum.info.nucleus === nucleus &&\n        !datum.info.isFid\n      ) {\n        const range = detectRange(datum, { from, to });\n        acc.sum += range.absolute;\n        acc.values.push({ SID: datum.id, ...range });\n      }\n      return acc;\n    },\n    { values: [], sum: 0 },\n  );\n}\n\nfunction init(spectraAnalysis, nucleus) {\n  if (spectraAnalysis[nucleus] === undefined) {\n    spectraAnalysis[nucleus] = {\n      options: {\n        sum: 100,\n        code: null,\n        columns: {},\n      },\n      values: {},\n    };\n  }\n}\n\nexport function changeColumnValueKey(\n  spectraAnalysis,\n  nucleus,\n  columnKey,\n  newKey,\n) {\n  spectraAnalysis[nucleus].options.columns[columnKey].valueKey = newKey;\n\n  spectraAnalysis[nucleus].values = refreshCalculation(\n    spectraAnalysis,\n    nucleus,\n  );\n}\n\nexport function setColumn(\n  spectraAnalysis,\n  nucleus,\n  { columns: inputColumns, code },\n) {\n  init(spectraAnalysis, nucleus);\n  spectraAnalysis[nucleus].options.code = code;\n  spectraAnalysis[nucleus].options.columns = Object.values(inputColumns).reduce(\n    (acc, value) => {\n      const data = { ...value };\n      delete data.tempKey;\n      acc[value.tempKey] = data;\n      return acc;\n    },\n    {},\n  );\n\n  const { columns: newColumns } = spectraAnalysis[nucleus].options;\n\n  let data = Object.entries(spectraAnalysis[nucleus].values).reduce(\n    (outerAcc, [spectraKey, spectra]) => {\n      outerAcc[spectraKey] = Object.keys(inputColumns).reduce((acc, key) => {\n        const newKey = inputColumns[key].tempKey;\n        if (spectra[key]) {\n          acc[newKey] = spectra[key];\n        }\n        return acc;\n      }, {});\n      return outerAcc;\n    },\n    {},\n  );\n\n  data = Object.entries(data).reduce((acc, spectra) => {\n    acc[spectra[0]] = Object.keys(newColumns).reduce((acc, key) => {\n      const isFormula = newColumns[key].type === COLUMNS_TYPES.FORMULA;\n      acc[key] = isFormula\n        ? {\n            colKey: key,\n            value: calculate(\n              newColumns,\n              data[spectra[0]],\n              newColumns[key].formula,\n            ),\n          }\n        : { ...spectra[1][key], colKey: key };\n\n      return acc;\n    }, {});\n\n    return acc;\n  }, {});\n  spectraAnalysis[nucleus].values = data;\n}\n\nfunction refreshByRow(row, columns) {\n  return Object.keys(columns).reduce((acc, key) => {\n    if (columns[key].type === COLUMNS_TYPES.FORMULA) {\n      acc[key] = {\n        colKey: key,\n        ...row,\n        value: calculate(columns, row, columns[key].formula),\n      };\n    }\n\n    return acc;\n  }, {});\n}\n\nfunction refreshCalculation(spectraAnalysis, nucleus) {\n  const { columns } = spectraAnalysis[nucleus].options;\n\n  const data = Object.entries(spectraAnalysis[nucleus].values).reduce(\n    (acc, spectra) => {\n      const [id, row] = spectra;\n      acc[id] = {\n        ...row,\n        ...refreshByRow(row, columns),\n      };\n      return acc;\n    },\n    {},\n  );\n\n  return data;\n}\n\nexport function analyzeSpectra(spectra, spectraAnalysis, options) {\n  const { from, to, nucleus, columnKey = null } = options;\n  init(spectraAnalysis, nucleus);\n  const colKey = addColumnKey(\n    spectraAnalysis,\n    nucleus,\n    {\n      type: COLUMNS_TYPES.NORMAL,\n      valueKey: 'relative',\n      from,\n      to,\n      index: 1,\n    },\n    columnKey,\n  );\n\n  const { sum } = spectraAnalysis[nucleus].options;\n\n  const { values: result, sum: spectraSum } = getSpectraAnalysis(spectra, {\n    from,\n    to,\n    nucleus,\n  });\n\n  const prevNucleusData = lodashGet(spectraAnalysis, `${nucleus}.values`, {});\n\n  let data = result.reduce((acc, row) => {\n    const factor = spectraSum > 0 ? sum / spectraSum : 0.0;\n\n    acc[row.SID] = {\n      ...prevNucleusData[row.SID],\n      [colKey]: {\n        colKey,\n        ...row,\n        relative: Math.abs(row.absolute) * factor,\n      },\n    };\n    return acc;\n  }, {});\n\n  spectraAnalysis[nucleus].values = data;\n  spectraAnalysis[nucleus].values = refreshCalculation(\n    spectraAnalysis,\n    nucleus,\n  );\n}\n\nexport function deleteSpectraAnalysis(spectraAnalysis, colKey, nucleus) {\n  const result = Object.entries(spectraAnalysis[nucleus].values).reduce(\n    (acc, item) => {\n      delete item[1][colKey];\n      if (item[1] && Object.keys(item[1]).length > 0) {\n        acc[item[0]] = item[1];\n        return acc;\n      }\n      return acc;\n    },\n    {},\n  );\n\n  delete spectraAnalysis[nucleus].options.columns[colKey];\n  spectraAnalysis[nucleus].values = result;\n  spectraAnalysis[nucleus].values = refreshCalculation(\n    spectraAnalysis,\n    nucleus,\n  );\n\n  if (isEmpty(spectraAnalysis[nucleus].values)) {\n    reservedColumnsNames[nucleus] = [];\n  }\n}\n\nfunction calculate(columns, data, formula = 'A+B') {\n  const array = formula.split(/\\+|-|\\*|\\/|%|\\(|\\)/);\n\n  const variables = [];\n\n  for (let i of array) {\n    const l = i.trim();\n    if (columns[l]) {\n      variables.push(l);\n    }\n  }\n\n  const params = variables.map((key) =>\n    data[key] ? data[key][columns[key].valueKey] : null,\n  );\n\n  let result;\n  try {\n    // eslint-disable-next-line no-new-func\n    result = new Function(...variables, `return ${formula}`)(...params);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n    result = new Error(`Invalid Formula ( ${formula} ) `);\n  }\n  return result;\n}\nexport function getDataAsString(spectraAnalysis, nucleus) {\n  if (spectraAnalysis && spectraAnalysis[nucleus]) {\n    const {\n      values,\n      options: { columns },\n    } = spectraAnalysis[nucleus];\n\n    let result = '';\n\n    for (const letter in columns) {\n      result += `${letter}\\t`;\n    }\n    result += '\\n';\n\n    for (const spectrum of Object.values(values)) {\n      for (const letter in columns) {\n        result += `${spectrum[letter][columns[letter].valueKey]}\\t`;\n      }\n      result += '\\n';\n    }\n    return result;\n  }\n  return null;\n}\n","export default function getChar(index) {\n  const aPotions = 'a'.charCodeAt(0);\n  const zPostion = 'z'.charCodeAt(0);\n  const len = zPostion - aPotions + 1;\n\n  let chartResult = '';\n  while (index >= 0) {\n    chartResult = String.fromCharCode((index % len) + aPotions) + chartResult;\n    index = Math.floor(index / len) - 1;\n  }\n  return chartResult;\n}\n","const REFERENCES = {\n  '1H': {\n    tms: {\n      from: -0.1,\n      to: 0.1,\n      nbPeaks: 1,\n      delta: 0,\n    },\n    tsp: {\n      from: -0.1,\n      to: 0.1,\n      nbPeaks: 1,\n      delta: 0,\n    },\n    glucose: {\n      from: 5.18,\n      to: 5.28,\n      nbPeaks: 2,\n      delta: 5.23,\n    },\n  },\n  '13C': {},\n};\n\nfunction getRange(options = {}) {\n  const { nucleus = '1H', reference = 'tms' } = options;\n\n  if (!REFERENCES[nucleus]) {\n    throw new Error('Nucleus not found: ', nucleus);\n  }\n\n  let info = REFERENCES[nucleus][reference.toLowerCase()];\n\n  if (!info) {\n    throw new Error('Reference not found: ', reference);\n  }\n\n  return {\n    from: info.delta - 0.05,\n    to: info.delta + 0.05,\n    delta: info.delta,\n    nbPeaks: info.nbPeaks,\n  };\n}\n\nexport { REFERENCES, getRange };\n","/** @jsxImportSource @emotion/react */\nimport { useCallback, useEffect, useMemo, useRef } from 'react';\n\nimport { REFERENCES } from '../../data/constants/References';\nimport { useDispatch } from '../context/DispatchContext';\nimport CloseButton from '../elements/CloseButton';\nimport Select from '../elements/Select';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\nimport { ALIGN_SPECTRA } from '../reducer/types/Types';\nimport Events from '../utility/Events';\n\nimport { ModalStyles } from './ModalStyle';\n\nconst baseList = [{ key: 1, value: 'manual', label: 'Manual' }];\n\nfunction AlignSpectraModal({ onClose, nucleus }) {\n  const refForm = useRef();\n  const dispatch = useDispatch();\n  const List = useMemo(() => {\n    const list = REFERENCES[nucleus]\n      ? Object.entries(REFERENCES[nucleus]).map(\n          (item) => ({\n            key: item[0],\n            value: item[0],\n            label: item[0],\n          }),\n          [],\n        )\n      : [];\n\n    return baseList.concat(list);\n  }, [nucleus]);\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (values) => {\n      dispatch({ type: ALIGN_SPECTRA, payload: values });\n      onClose();\n    },\n    [dispatch, onClose],\n  );\n\n  useEffect(() => {\n    Events.on('brushEnd', (event) => {\n      const [from, to] = event.range;\n      refForm.current.setValues({ ...refForm.current.values, from, to });\n    });\n\n    return () => {\n      Events.off('brushEnd');\n    };\n  }, []);\n\n  const optionChangeHandler = useCallback(\n    (id) => {\n      const value = REFERENCES[nucleus][id];\n      const { delta = 0, ...resValues } = value || { delta: 0 };\n      refForm.current.setValues({\n        ...refForm.current.values,\n        targetX: delta,\n        ...resValues,\n      });\n    },\n    [nucleus],\n  );\n\n  return (\n    <div css={ModalStyles}>\n      <div className=\"header handle\">\n        <span>Spectra calibration</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <FormikForm\n          ref={refForm}\n          initialValues={{ from: -1, to: 1, nbPeaks: 1, targetX: 0 }}\n          onSubmit={submitHandler}\n        >\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Options :</span>\n\n            <Select\n              data={List}\n              style={{ width: 270, height: 30, marginBottom: '20px' }}\n              onChange={optionChangeHandler}\n            />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Range :</span>\n            <FormikInput label=\"From : \" name=\"from\" type=\"number\" />\n            <FormikInput label=\"To :\" name=\"to\" type=\"number\" />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Number of Peaks : </span>\n            <FormikInput name=\"nbPeaks\" type=\"number\" />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Target PPM :</span>\n            <FormikInput name=\"targetX\" type=\"number\" />\n          </div>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <button type=\"button\" onClick={handleSave} className=\"save-button\">\n          Done\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default AlignSpectraModal;\n","/** @jsxImportSource @emotion/react */\nimport { useCallback, useEffect, useRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport CloseButton from '../elements/CloseButton';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\nimport Events from '../utility/Events';\nimport { exportAsMatrix } from '../utility/Export';\n\nimport { ModalStyles } from './ModalStyle';\n\nconst INITIAL_VALUE = { from: -1, to: 1, nbPoints: 1024 };\n\nfunction ExportAsMatrixModal({ onClose }) {\n  const refForm = useRef();\n  const { data } = useChartData();\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (options) => {\n      exportAsMatrix(data, options, 'fileName');\n      onClose();\n    },\n    [data, onClose],\n  );\n\n  useEffect(() => {\n    Events.on('brushEnd', (event) => {\n      const [from, to] = event.range;\n      refForm.current.setValues({ ...refForm.current.values, from, to });\n    });\n\n    return () => {\n      Events.off('brushEnd');\n    };\n  }, []);\n\n  return (\n    <div css={ModalStyles}>\n      <div className=\"header handle\">\n        <span>Export spectra as a Matrix</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <FormikForm\n          ref={refForm}\n          initialValues={INITIAL_VALUE}\n          onSubmit={submitHandler}\n        >\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Range :</span>\n            <FormikInput label=\"From : \" name=\"from\" type=\"number\" />\n            <FormikInput label=\"To :\" name=\"to\" type=\"number\" />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Number of Points : </span>\n            <FormikInput name=\"nbPoints\" type=\"number\" />\n          </div>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <button type=\"button\" onClick={handleSave} className=\"save-button\">\n          Export Now\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default ExportAsMatrixModal;\n","import React, { forwardRef } from 'react';\n\nimport { useChartData } from '../../context/ChartContext';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikInput from '../../elements/formik/FormikInput';\n\nfunction EquallySpacedFilter({ onSubmit }, ref) {\n  const { xDomain } = useChartData();\n  return (\n    <FormikForm\n      ref={ref}\n      initialValues={{\n        from: xDomain[0],\n        to: xDomain[1],\n        numberOfPoints: 1024,\n      }}\n      onSubmit={onSubmit}\n    >\n      <div className=\"row margin-10\">\n        <span className=\"custom-label\">Range :</span>\n        <FormikInput label=\"From : \" name=\"from\" type=\"number\" />\n        <FormikInput label=\"To :\" name=\"to\" type=\"number\" />\n      </div>\n      <div className=\"row margin-10\">\n        <span className=\"custom-label\">Number of points :</span>\n        <FormikInput label=\"\" name=\"numberOfPoints\" type=\"number\" />\n      </div>\n    </FormikForm>\n  );\n}\n\nexport default forwardRef(EquallySpacedFilter);\n","import React, { forwardRef } from 'react';\n\nimport { useChartData } from '../../context/ChartContext';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikInput from '../../elements/formik/FormikInput';\n\nfunction FromToFilter({ onSubmit }, ref) {\n  const { xDomain } = useChartData();\n  return (\n    <FormikForm\n      ref={ref}\n      initialValues={{ from: xDomain[0], to: xDomain[1] }}\n      onSubmit={onSubmit}\n    >\n      <div className=\"row margin-10\">\n        <span className=\"custom-label\">Range :</span>\n        <FormikInput label=\"From : \" name=\"from\" type=\"number\" />\n        <FormikInput label=\"To :\" name=\"to\" type=\"number\" />\n      </div>\n    </FormikForm>\n  );\n}\n\nexport default forwardRef(FromToFilter);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\n\nimport { Filters } from '../../../data/Filters';\nimport { REFERENCES } from '../../../data/constants/References';\nimport { useDispatch } from '../../context/DispatchContext';\nimport CloseButton from '../../elements/CloseButton';\nimport Select from '../../elements/Select';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport { APPLY_MULTIPLE_SPECTRA_FILTER } from '../../reducer/types/Types';\nimport Events from '../../utility/Events';\nimport { ModalStyles } from '../ModalStyle';\n\nimport EquallySpacedFilter from './EquallySpacedFilter';\nimport FromToFilter from './FromToFilter';\n\nconst baseList = [\n  { key: 0, value: 0, label: 'Select Filter' },\n  {\n    key: Filters.fromTo.id,\n    value: Filters.fromTo.id,\n    label: Filters.fromTo.name,\n  },\n  {\n    key: Filters.equallySpaced.id,\n    value: Filters.equallySpaced.id,\n    label: Filters.equallySpaced.name,\n  },\n  {\n    key: Filters.standardDeviation.id,\n    value: Filters.standardDeviation.id,\n    label: Filters.standardDeviation.name,\n  },\n  {\n    key: Filters.centerMean.id,\n    value: Filters.centerMean.id,\n    label: Filters.centerMean.name,\n  },\n  {\n    key: Filters.pareto.id,\n    value: Filters.pareto.id,\n    label: Filters.pareto.name,\n  },\n];\n\nconst styles = css`\n  .row {\n    align-items: center;\n  }\n`;\n\nfunction MultipleSpectraFiltersModal({ onClose, nucleus }) {\n  const refForm = useRef();\n  const dispatch = useDispatch();\n  const [filter, setFilter] = useState(0);\n  const List = useMemo(() => {\n    const list = REFERENCES[nucleus]\n      ? Object.entries(REFERENCES[nucleus]).map(\n          (item) => ({\n            key: item[0],\n            value: item[0],\n            label: item[0],\n          }),\n          [],\n        )\n      : [];\n\n    return baseList.concat(list);\n  }, [nucleus]);\n  const handleSave = useCallback(() => {\n    if (refForm.current) {\n      refForm.current.submitForm();\n    }\n  }, []);\n\n  const submitHandler = useCallback(\n    (options) => {\n      dispatch({\n        type: APPLY_MULTIPLE_SPECTRA_FILTER,\n        payload: [{ name: filter, options }],\n      });\n\n      onClose();\n    },\n    [dispatch, filter, onClose],\n  );\n\n  useEffect(() => {\n    Events.on('brushEnd', (event) => {\n      const [from, to] = event.range;\n      if (refForm.current) {\n        refForm.current.setValues({ ...refForm.current.values, from, to });\n      }\n    });\n\n    return () => {\n      Events.off('brushEnd');\n    };\n  }, []);\n\n  const filterChangeHandler = useCallback((id) => {\n    setFilter(id);\n  }, []);\n\n  const filterOptions = useMemo(() => {\n    switch (filter) {\n      case Filters.fromTo.id:\n        return <FromToFilter onSubmit={submitHandler} ref={refForm} />;\n      case Filters.equallySpaced.id:\n        return <EquallySpacedFilter onSubmit={submitHandler} ref={refForm} />;\n      default:\n        break;\n    }\n  }, [filter, submitHandler]);\n\n  return (\n    <div css={[ModalStyles, styles]}>\n      <div className=\"header handle\">\n        <span>Spectra calibration</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <div className=\"row margin-10\">\n          <span className=\"custom-label\">Filter :</span>\n\n          <Select\n            data={List}\n            style={{ width: 275, height: 30, margin: 0 }}\n            onChange={filterChangeHandler}\n          />\n        </div>\n        {filterOptions || (\n          <FormikForm\n            ref={refForm}\n            initialValues={{}}\n            onSubmit={submitHandler}\n          />\n        )}\n      </div>\n      <div className=\"footer-container\">\n        <button type=\"button\" onClick={handleSave} className=\"save-button\">\n          Done\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default MultipleSpectraFiltersModal;\n","import { css } from '@emotion/react';\n\nexport default css`\n  code[class*='language-'],\n  pre[class*='language-'] {\n    color: black;\n    background: none;\n    text-shadow: 0 1px white;\n    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n    font-size: 1em;\n    text-align: left;\n    white-space: pre;\n    word-spacing: normal;\n    word-break: normal;\n    word-wrap: normal;\n    line-height: 1.5;\n\n    -moz-tab-size: 4;\n    -o-tab-size: 4;\n    tab-size: 4;\n\n    -webkit-hyphens: none;\n    -moz-hyphens: none;\n    -ms-hyphens: none;\n    hyphens: none;\n  }\n\n  pre[class*='language-']::-moz-selection,\n  pre[class*='language-'] ::-moz-selection,\n  code[class*='language-']::-moz-selection,\n  code[class*='language-'] ::-moz-selection {\n    text-shadow: none;\n    background: #b3d4fc;\n  }\n\n  pre[class*='language-']::selection,\n  pre[class*='language-'] ::selection,\n  code[class*='language-']::selection,\n  code[class*='language-'] ::selection {\n    text-shadow: none;\n    background: #b3d4fc;\n  }\n\n  @media print {\n    code[class*='language-'],\n    pre[class*='language-'] {\n      text-shadow: none;\n    }\n  }\n\n  /* Code blocks */\n  pre[class*='language-'] {\n    padding: 1em;\n    margin: 0.5em 0;\n    overflow: auto;\n  }\n\n  :not(pre) > code[class*='language-'],\n  pre[class*='language-'] {\n    background: #f5f2f0;\n  }\n\n  /* Inline code */\n  :not(pre) > code[class*='language-'] {\n    padding: 0.1em;\n    border-radius: 0.3em;\n    white-space: normal;\n  }\n\n  .token.comment,\n  .token.prolog,\n  .token.doctype,\n  .token.cdata {\n    color: slategray;\n  }\n\n  .token.punctuation {\n    color: #999;\n  }\n\n  .token.namespace {\n    opacity: 0.7;\n  }\n\n  .token.property,\n  .token.tag,\n  .token.boolean,\n  .token.number,\n  .token.constant,\n  .token.symbol,\n  .token.deleted {\n    color: #905;\n  }\n\n  .token.selector,\n  .token.attr-name,\n  .token.string,\n  .token.char,\n  .token.builtin,\n  .token.inserted {\n    color: #690;\n  }\n\n  .token.operator,\n  .token.entity,\n  .token.url,\n  .language-css .token.string,\n  .style .token.string {\n    color: #9a6e3a;\n    /* This background color was intended by the author of this theme. */\n    background: hsla(0, 0%, 100%, 0.5);\n  }\n\n  .token.atrule,\n  .token.attr-value,\n  .token.keyword {\n    color: #07a;\n  }\n\n  .token.function,\n  .token.class-name {\n    color: #dd4a68;\n  }\n\n  .token.regex,\n  .token.important,\n  .token.variable {\n    color: #e90;\n  }\n\n  .token.important,\n  .token.bold {\n    font-weight: bold;\n  }\n  .token.italic {\n    font-style: italic;\n  }\n\n  .token.entity {\n    cursor: help;\n  }\n`;\n","export default function calculate(code, args = null) {\n  try {\n    // eslint-disable-next-line no-new-func\n    return new Function('args', `return ${code}`)(args);\n  } catch (e) {\n    return e;\n  }\n}\n","/** @jsxImportSource @emotion/react */\nimport { useFormikContext } from 'formik';\nimport { highlight, languages } from 'prismjs/components/prism-core';\n// eslint-disable-next-line import/no-unassigned-import\nimport 'prismjs/components/prism-clike';\n// eslint-disable-next-line import/no-unassigned-import\nimport 'prismjs/components/prism-javascript';\nimport { memo, useCallback, useEffect, useState } from 'react';\nimport Editor from 'react-simple-code-editor';\n\nimport prismStyles from '../../elements/styles/prism';\nimport Eval from '../../utility/Evaluate';\n\nconst initCode = `function run(data) {\n\n  return JSON.stringify(data,undefined, 2);\n  \n}(args);\n`;\n\nfunction MulipleAnalysisCodeEditor({ data }) {\n  const { values, setFieldValue } = useFormikContext();\n  const [code, setCode] = useState(values.code ? values.code : initCode);\n  const [result, setResult] = useState('');\n\n  useEffect(() => {\n    const evalResult = Eval(code, data);\n    if (evalResult instanceof Error) {\n      setResult(evalResult.message);\n    } else {\n      setFieldValue('code', code);\n      setResult(evalResult);\n    }\n  }, [code, data, setFieldValue]);\n\n  const valueChangeHandler = useCallback((code) => {\n    setCode(code);\n  }, []);\n  const highlightHandler = useCallback((code) => {\n    try {\n      return highlight(code, languages.js);\n    } catch (e) {\n      return null;\n    }\n  }, []);\n\n  return (\n    <div style={{ marginTop: '20px' }} css={prismStyles}>\n      <Editor\n        value={code}\n        onValueChange={valueChangeHandler}\n        highlight={highlightHandler}\n        padding={10}\n        style={{\n          fontFamily: '\"Fira code\", \"Fira Mono\", monospace',\n          fontSize: 12,\n          backgroundColor: '#fcfcfc',\n          marginBottom: '10px',\n          minHeight: '100px',\n          overflow: 'auto',\n          maxHeight: '200px',\n        }}\n      />\n      <p style={{ marginBottom: '5px' }}>Result:</p>\n\n      <Editor\n        value={result}\n        onValueChange={(code) => code}\n        highlight={highlightHandler}\n        padding={10}\n        style={{\n          border: '0.55px solid #f3f3f3',\n          fontFamily: '\"Fira code\", \"Fira Mono\", monospace',\n          fontSize: 12,\n          marginBottom: '10px',\n          minHeight: '100px',\n          overflow: 'auto',\n          maxHeight: '200px',\n        }}\n      />\n    </div>\n  );\n}\n\nexport default memo(MulipleAnalysisCodeEditor);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  forwardRef,\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { FaPlus } from 'react-icons/fa';\nimport * as Yup from 'yup';\n\nimport { COLUMNS_TYPES } from '../../../data/data1d/MulitpleAnalysis';\nimport { useDispatch } from '../../context/DispatchContext';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikInput from '../../elements/formik/FormikInput';\nimport { SET_ANALYZE_SPECTRA_COLUMNS } from '../../reducer/types/Types';\n\nimport MulipleAnalysisCodeEditor from './MulipleAnalysisCodeEditor';\n\nconst styles = css`\n  width: 100%;\n  thead {\n    border-bottom: 1px solid lightgray;\n    background-color: #fafafa;\n    font-size: 12px;\n  }\n\n  td,\n  th {\n    padding: 3px 5px;\n    text-align: center;\n  }\n\n  .operation-col {\n    width: 30px;\n  }\n\n  .input {\n    // border: 0.55px solid rgb(237 237 237) !important;\n    height: 25px !important;\n    width: 100% !important;\n    margin: 0 !important;\n    // text-transform: uppercase;\n  }\n\n  .input.disbale {\n    background-color: #e8e8e8;\n    border-radius: 5px;\n  }\n\n  .label,\n  .index {\n    width: 100px;\n  }\n\n  .counter {\n    width: 50px;\n  }\n\n  .add {\n    background-color: transparent;\n    border: 0;\n    outline: none;\n    svg {\n      font-szie: 14px;\n      fill: green;\n    }\n  }\n`;\nconst MultipleSpectraAnalysisPreferences = forwardRef(\n  function MultipleSpectraAnalysisPreferences({ data, onAfterSave }, ref) {\n    const dispatch = useDispatch();\n    const refForm = useRef();\n    const [columns, setColumns] = useState({});\n\n    useImperativeHandle(ref, () => ({\n      saveSetting() {\n        refForm.current.submitForm();\n      },\n    }));\n\n    useEffect(() => {\n      const result = Object.keys(data.columns).reduce((acc, key) => {\n        acc[key] = { ...data.columns[key], tempKey: key };\n        return acc;\n      }, {});\n      setColumns(result);\n      refForm.current.setValues({ columns: result, code: data.code });\n    }, [data]);\n\n    const columnsKeys = useMemo(() => {\n      return Object.keys(columns);\n    }, [columns]);\n\n    const preferncesSchema = useMemo(() => {\n      function columnSchema() {\n        return columnsKeys.reduce((acc, key) => {\n          acc[key] = Yup.object().shape({\n            tempKey: Yup.string()\n              .required()\n              .test('unique', 'must be unique column name', (colmnName) => {\n                const formData = refForm.current.values.columns;\n                return (\n                  Object.keys(formData).reduce((acc, colKey) => {\n                    if (formData[colKey].tempKey === colmnName) {\n                      acc.push(colmnName);\n                    }\n                    return acc;\n                  }, []).length === 1\n                );\n              }),\n            ...(columns[key].type === COLUMNS_TYPES.FORMULA\n              ? { formula: Yup.string().required() }\n              : {}),\n            index: Yup.string().required(),\n          });\n          return acc;\n        }, {});\n      }\n\n      //   console.log(columnSchema());\n\n      return Yup.object().shape({\n        columns: Yup.object().shape(columnSchema()),\n      });\n    }, [columns, columnsKeys, refForm]);\n\n    const submitHandler = useCallback(\n      (values) => {\n        onAfterSave(true);\n        const result = Object.entries(values.columns).reduce(\n          (acc, [key, value]) => {\n            acc[key] = { ...columns[key], ...value };\n            return acc;\n          },\n          {},\n        );\n        dispatch({\n          type: SET_ANALYZE_SPECTRA_COLUMNS,\n          payload: { code: values.code, columns: result },\n        });\n      },\n      [columns, dispatch, onAfterSave],\n    );\n\n    const addNewColumn = useCallback((index) => {\n      setColumns((prevData) => {\n        return {\n          ...prevData,\n          [`temp${index}`]: {\n            tempKey: '',\n            type: 'FORMULA',\n            valueKey: 'value',\n            formula: '',\n            index: index,\n          },\n        };\n      });\n    }, []);\n\n    return (\n      <FormikForm\n        ref={refForm}\n        initialValues={{ columns, code: null }}\n        validationSchema={preferncesSchema}\n        onSubmit={submitHandler}\n      >\n        {columnsKeys && (\n          <table css={styles}>\n            <thead>\n              <tr>\n                <th className=\"counter\">#</th>\n                <th className=\"label\">Label</th>\n                <th>value</th>\n                <th className=\"index\">index</th>\n              </tr>\n            </thead>\n            <tbody>\n              {columnsKeys.map((key, index) => {\n                return (\n                  <tr key={key}>\n                    <td className=\"counter\">{index + 1}</td>\n                    <td className=\"label\">\n                      <FormikInput\n                        key={key}\n                        name={`columns.${key}.tempKey`}\n                        value={columns[key].tempKey}\n                      />\n                    </td>\n                    <td>\n                      {columns[key].type === COLUMNS_TYPES.FORMULA ? (\n                        <FormikInput\n                          name={`columns.${key}.formula`}\n                          value={columns[key].formula}\n                        />\n                      ) : (\n                        <div className=\"input disbale\" />\n                      )}\n                    </td>\n                    <td className=\"index\">\n                      <FormikInput\n                        name={`columns.${key}.index`}\n                        value={columns[key].index}\n                      />\n                    </td>\n                    <td className=\"operation-col\">\n                      {columnsKeys.length === index + 1 && (\n                        <button\n                          className=\"add\"\n                          type=\"button\"\n                          onClick={() => addNewColumn(index + 1)}\n                        >\n                          <FaPlus />\n                        </button>\n                      )}\n                    </td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        )}\n        <MulipleAnalysisCodeEditor data={data} />\n      </FormikForm>\n    );\n  },\n);\n\nMultipleSpectraAnalysisPreferences.defaultProps = {\n  onAfterSave: () => false,\n};\nexport default MultipleSpectraAnalysisPreferences;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\n\nconst styles = css`\n  background-color: white;\n  position: absolute;\n  height: auto;\n  z-index: 99999999999999;\n  box-shadow: 0 19px 38px rgba(0, 0, 0, 0.3), 0 15px 12px rgba(0, 0, 0, 0.22);\n  border-radius: 10px;\n  margin-bottom: 20px;\n\n  ul {\n    list-style-type: none;\n    padding: 0;\n    margin: 0;\n\n    li {\n      padding: 10px 30px;\n      text-align: center;\n      color: black;\n      border-bottom: 0.55px solid lightgoldenrodyellow;\n      min-width: 150px;\n    }\n\n    li:last-of-type {\n      border-bottom: none;\n    }\n\n    li:hover {\n      background-color: gray;\n      color: white;\n    }\n  }\n`;\n\nfunction DropDownList({ data = [], onSelect }) {\n  return (\n    <div css={styles}>\n      <ul>\n        {data.map((item, i) => (\n          <li key={item.key} onClick={() => onSelect(i)}>\n            {item.label}\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n\nexport default DropDownList;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport { FaEllipsisH } from 'react-icons/fa';\n\nimport { useGlobal } from '../../context/GlobalContext';\n\nimport DropDownList from './DropDownList';\n\nconst styles = css`\n  // position: absolute;\n  padding: 2px;\n  border-radius: 10px;\n  width: auto;\n  display: inline-block;\n  border: 0.55px solid lightgray;\n  font-size: 10px;\n\n  button {\n    text-transform: Capitalize;\n  }\n`;\n\nfunction DropDownButton({ data, selectedKey, onSelect, formatSelectedValue }) {\n  const [open, setOpen] = useState(false);\n  const [value, setValue] = useState(selectedKey);\n  const { rootRef } = useGlobal();\n\n  const drop = useRef(null);\n  const handleClick = useCallback(\n    (e) => {\n      if (!e.target.closest(`.${drop.current.className}`) && open) {\n        setTimeout(() => {\n          setOpen(false);\n        }, 0);\n      }\n    },\n    [open],\n  );\n  useEffect(() => {\n    if (rootRef) {\n      rootRef.addEventListener('click', handleClick);\n    }\n    return () => rootRef.removeEventListener('click', handleClick);\n  }, [handleClick, open, rootRef]);\n\n  const selectHandler = useCallback(\n    (index) => {\n      setValue(data[index].label);\n      onSelect(data[index].key);\n    },\n    [data, onSelect],\n  );\n\n  return (\n    <div className=\"dropdown\" ref={drop} css={styles}>\n      <button type=\"button\" onClick={() => setOpen((open) => !open)}>\n        {!value ? <FaEllipsisH /> : formatSelectedValue(value)}\n      </button>\n      {open && <DropDownList data={data} onSelect={selectHandler} />}\n    </div>\n  );\n}\n\nDropDownButton.defaultProps = {\n  data: null,\n  formatSelectedValue: (val) => val,\n  value: null,\n};\n\nexport default DropDownButton;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport { COLUMNS_TYPES } from '../../../data/data1d/MulitpleAnalysis';\nimport { useDispatch } from '../../context/DispatchContext';\nimport DeleteButton from '../../elements/Tab/DeleteButton';\nimport DropDownButton from '../../elements/dropDownButton/DropDownButton';\nimport { DELETE_ANALYZE_SPECTRA_RANGE } from '../../reducer/types/Types';\n\nconst styles = (styles) => css`\n  position: relative;\n\n  .delete {\n    position: absolute;\n    right: 0px;\n    top: 0px;\n  }\n\n  .container {\n    display: flex;\n    flex-direction: column;\n    padding: 0;\n    margin: 0;\n  }\n  .dropDown-container {\n    justify-content: flex-start;\n    align-items: flex-start;\n  }\n  .label-container {\n    flex: 1;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n    min-height: 45px;\n  }\n\n  .label {\n    text-align: center;\n  }\n\n  ${styles}\n`;\n\nconst columnsFilters = [\n  { key: 'relative', label: 'Relative' },\n  { key: 'absolute', label: 'Absolute' },\n  { key: 'min', label: 'Min Intensity' },\n  { key: 'max', label: 'Max Intensity' },\n];\n\nfunction ColumnHeader({ charLabel, rangeLabel, data, onColumnFilter }) {\n  const dispatch = useDispatch();\n\n  const deleteHandler = useCallback(() => {\n    dispatch({ type: DELETE_ANALYZE_SPECTRA_RANGE, colKey: charLabel });\n  }, [charLabel, dispatch]);\n\n  return (\n    <div css={styles}>\n      <div className=\"container\">\n        {data.type === COLUMNS_TYPES.NORMAL && (\n          <div className=\"dropDown-container\">\n            <DropDownButton\n              data={columnsFilters}\n              formatSelectedValue={(value) =>\n                value ? value.substr(0, 3) : value\n              }\n              selectedKey={data.valueKey}\n              onSelect={onColumnFilter}\n            />\n          </div>\n        )}\n        <div className=\"label-container\">\n          <span className=\"label\"> {charLabel}</span>\n          <span className=\"label\">{rangeLabel}</span>\n        </div>\n      </div>\n      <DeleteButton onDelete={deleteHandler} />\n    </div>\n  );\n}\n\nexport default ColumnHeader;\n","import lodashGet from 'lodash/get';\nimport { useMemo, memo, useCallback, Fragment } from 'react';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport { FILTER_SPECTRA_COLUMN } from '../../reducer/types/Types';\nimport Eval from '../../utility/Evaluate';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\nimport NoTableData from '../extra/placeholder/NoTableData';\n\nimport ColumnHeader from './ColumnHeader';\n\nfunction MultipleSpectraAnalysisTable({ data, activeTab }) {\n  const format = useFormatNumberByNucleus(activeTab);\n\n  const codeEvaluation = useMemo(() => {\n    const code = lodashGet(data, 'code', '');\n    return Eval(code, data);\n  }, [data]);\n\n  const dispatch = useDispatch();\n\n  const columnFilterHandler = useCallback(\n    (columnKey, valueKey) => {\n      dispatch({\n        type: FILTER_SPECTRA_COLUMN,\n        payload: {\n          columnKey,\n          valueKey,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const tableColumns = useMemo(() => {\n    const initColumns = [\n      {\n        Header: '#',\n        index: 0,\n        Cell: ({ row }) => row.index + 1,\n      },\n    ];\n\n    const columns = initColumns;\n    const setCustomColumn = (array, index, columnLabel, cellHandler) => {\n      const columnData = data.columns[columnLabel];\n      array.push({\n        index: index,\n        Header: () => (\n          <ColumnHeader\n            charLabel={columnLabel}\n            data={columnData}\n            onColumnFilter={(valueKey) =>\n              columnFilterHandler(columnLabel, valueKey)\n            }\n            rangeLabel={\n              columnData.from && columnData.to\n                ? `${format(columnData.from)} - ${format(columnData.to)}`\n                : ''\n            }\n          />\n        ),\n        id: columnLabel,\n        sortType: 'basic',\n        Cell: ({ row }) => cellHandler(row),\n      });\n    };\n    if (data.columns) {\n      Object.keys(data.columns).forEach((key) => {\n        const { valueKey, index: columnIndex } = data.columns[key];\n        setCustomColumn(columns, columnIndex + 1, key, (row) => {\n          const value = row.original[key][valueKey];\n          const result =\n            value instanceof Error ? (\n              <span style={{ color: 'red' }}>{value.message}</span>\n            ) : (\n              format(value)\n            );\n          return result;\n        });\n      });\n    }\n    const resultColumns = columns ? columns : initColumns;\n    return resultColumns.sort(\n      (object1, object2) => object1.index - object2.index,\n    );\n  }, [columnFilterHandler, data.columns, format]);\n\n  return data.values && data.values.length > 0 ? (\n    <Fragment>\n      <ReactTable data={data.values} columns={tableColumns} />\n      <div\n        style={{\n          width: '100%',\n          padding: '10px',\n        }}\n        // eslint-disable-next-line react/no-danger\n        dangerouslySetInnerHTML={{ __html: codeEvaluation }}\n      />\n    </Fragment>\n  ) : (\n    <NoTableData />\n  );\n}\n\nexport default memo(MultipleSpectraAnalysisTable);\n","import {\n  SvgNmrOverlay,\n  SvgNmrAddFilter,\n  SvgNmrExportAsMatrix,\n} from 'cheminfo-font';\nimport { useCallback, useState, useRef, memo, useMemo } from 'react';\nimport ReactCardFlip from 'react-card-flip';\nimport { FaFileExport } from 'react-icons/fa';\nimport { IoPulseOutline } from 'react-icons/io5';\n\nimport { getDataAsString } from '../../../data/data1d/MulitpleAnalysis';\nimport { useDispatch } from '../../context/DispatchContext';\nimport Button from '../../elements/ButtonToolTip';\nimport ToggleButton from '../../elements/ToggleButton';\nimport { positions, useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport MultiAnalysisWrapper from '../../hoc/MultiAnalysisWrapper';\nimport AlignSpectraModal from '../../modal/AlignSpectraModal';\nimport ExportAsMatrixModal from '../../modal/ExportAsMatrixModal';\nimport MultipleSpectraFiltersModal from '../../modal/MultipleSpectraFiltersModal';\nimport { RESET_SELECTED_TOOL } from '../../reducer/types/Types';\nimport Events from '../../utility/Events';\nimport { copyTextToClipboard } from '../../utility/Export';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport MultipleSpectraAnalysisPreferences from './MultipleSpectraAnalysisPreferences';\nimport MultipleSpectraAnalysisTable from './MultipleSpectraAnalysisTable';\n\nconst styles = {\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n  },\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n  },\n};\n\nfunction MultipleSpectraAnalysisPanel({ spectraAnalysis, activeTab }) {\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef();\n  const alert = useAlert();\n  const modal = useModal();\n  const dispatch = useDispatch();\n\n  const data = useMemo(() => {\n    const {\n      values,\n      options: { columns, code },\n    } = spectraAnalysis[activeTab] || {\n      values: {},\n      options: { columns: {}, code: null },\n    };\n    return { values: Object.values(values), columns, code };\n  }, [activeTab, spectraAnalysis]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n  }, []);\n\n  const afterSaveHandler = useCallback(() => {\n    setFlipStatus(false);\n  }, []);\n\n  const showTrackerHandler = useCallback((flag) => {\n    Events.emit('showYSpectraTrackers', flag);\n  }, []);\n  const openAlignSpectra = useCallback(() => {\n    dispatch({ type: RESET_SELECTED_TOOL });\n    modal.show(<AlignSpectraModal nucleus={activeTab} />, {\n      isBackgroundBlur: false,\n      position: positions.TOP_CENTER,\n      // enableResizing: false,\n      width: 500,\n      // height: 600,\n    });\n  }, [activeTab, modal, dispatch]);\n  const openFiltersModal = useCallback(() => {\n    dispatch({ type: RESET_SELECTED_TOOL });\n    modal.show(<MultipleSpectraFiltersModal />, {\n      isBackgroundBlur: false,\n      position: positions.TOP_CENTER,\n      // enableResizing: false,\n      width: 500,\n      // height: 600,\n    });\n  }, [modal, dispatch]);\n\n  const copyToClipboardHandler = useCallback(() => {\n    const data = getDataAsString(spectraAnalysis, activeTab);\n    const success = copyTextToClipboard(data);\n    if (success) {\n      alert.success('Data copied to clipboard');\n    } else {\n      alert.error('copy to clipboard failed');\n    }\n  }, [activeTab, alert, spectraAnalysis]);\n\n  const openExportAsMatrixModal = useCallback(() => {\n    dispatch({ type: RESET_SELECTED_TOOL });\n    modal.show(<ExportAsMatrixModal />, {\n      isBackgroundBlur: false,\n      position: positions.TOP_CENTER,\n      width: 500,\n    });\n  }, [modal, dispatch]);\n\n  return (\n    <div style={styles.container}>\n      {!isFlipped && (\n        <DefaultPanelHeader\n          deleteToolTip=\"Delete All Peaks\"\n          showSettingButton=\"true\"\n          canDelete={false}\n          onSettingClick={settingsPanelHandler}\n        >\n          <Button\n            popupTitle=\"Copy To Clipboard\"\n            style={styles.button}\n            onClick={copyToClipboardHandler}\n          >\n            <FaFileExport />\n          </Button>\n          <Button\n            popupTitle=\"Spectra calibration\"\n            style={styles.button}\n            onClick={openAlignSpectra}\n          >\n            <SvgNmrOverlay style={{ fontSize: '18px' }} />\n          </Button>\n          <ToggleButton\n            popupTitle=\"Y Spectra Tracker\"\n            popupPlacement=\"right\"\n            onClick={showTrackerHandler}\n          >\n            <IoPulseOutline />\n          </ToggleButton>\n\n          <Button\n            popupTitle=\"Add Filter\"\n            style={styles.button}\n            onClick={openFiltersModal}\n          >\n            <SvgNmrAddFilter style={{ fontSize: '18px' }} />\n          </Button>\n          <Button\n            popupTitle=\"Export spectra as a Matrix\"\n            onClick={openExportAsMatrixModal}\n          >\n            <SvgNmrExportAsMatrix />\n          </Button>\n        </DefaultPanelHeader>\n      )}\n      {isFlipped && (\n        <PreferencesHeader\n          onSave={saveSettingHandler}\n          onClose={settingsPanelHandler}\n        />\n      )}\n      <div style={{ height: '100%', overflow: 'auto' }}>\n        <ReactCardFlip\n          isFlipped={isFlipped}\n          infinite\n          containerStyle={{ overflow: 'hidden' }}\n        >\n          <MultipleSpectraAnalysisTable data={data} activeTab={activeTab} />\n          <MultipleSpectraAnalysisPreferences\n            data={data}\n            onAfterSave={afterSaveHandler}\n            ref={settingRef}\n          />\n        </ReactCardFlip>\n      </div>\n    </div>\n  );\n}\n\nexport default MultiAnalysisWrapper(memo(MultipleSpectraAnalysisPanel));\n","import { forwardRef, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\n\nfunction PeaksWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      data: spectra,\n      activeSpectrum,\n      xDomain,\n      activeTab,\n      tabActiveSpectrum,\n    } = useChartData();\n    const preferences = usePreferences();\n\n    const { peaks = {}, info = {}, data = {} } = useMemo(() => {\n      if (spectra && activeSpectrum && activeSpectrum.id) {\n        const datum = spectra.find(\n          (datum) => datum.id === activeSpectrum.id,\n        ) || {\n          peaks: {},\n          info: {},\n          data: {},\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, spectra]);\n\n    const nucleus = useMemo(() => {\n      if (tabActiveSpectrum && Object.keys(tabActiveSpectrum).length > 0) {\n        return Object.keys(tabActiveSpectrum);\n      }\n      return null;\n    }, [tabActiveSpectrum]);\n\n    const { forwardedRef, ...rest } = props;\n\n    return (\n      <WrappedComponent\n        {...rest}\n        peaks={peaks}\n        info={info}\n        x={data.x}\n        y={data.y}\n        xDomain={xDomain}\n        preferences={preferences}\n        activeTab={activeTab}\n        nucleus={nucleus}\n        ref={forwardedRef}\n      />\n    );\n  };\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default PeaksWrapper;\n","import lodashGet from 'lodash/get';\nimport lodashSet from 'lodash/set';\nimport {\n  useEffect,\n  useState,\n  useCallback,\n  forwardRef,\n  useImperativeHandle,\n  useRef,\n} from 'react';\n\nimport IsotopesViewer from '../../elements/IsotopesViewer';\nimport { useAlert } from '../../elements/popup/Alert';\nimport PeaksWrapper from '../../hoc/PeaksWrapper';\nimport { SET_PANELS_PREFERENCES } from '../../reducer/preferencesReducer';\nimport {\n  useStateWithLocalStorage,\n  getValue as getValueByKeyPath,\n} from '../../utility/LocalStorage';\nimport ColumnFormatField from '../extra/preferences/ColumnFormatField';\nimport { peaksDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles = {\n  container: { padding: 10, backgroundColor: '#f1f1f1', height: '100%' },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '30%',\n    textAlign: 'center',\n  },\n};\n\nconst formatFields = [\n  {\n    id: 1,\n    label: 'Peak Number :',\n    checkController: 'showPeakNumber',\n    formatController: 'peakNumberFormat',\n    defaultFormat: '',\n  },\n  {\n    id: 2,\n    label: 'Peak Index : ',\n    checkController: 'showPeakIndex',\n    formatController: 'peakIndexFormat',\n    defaultFormat: '',\n  },\n  {\n    id: 3,\n    label: 'δ (ppm) :',\n    checkController: 'showDeltaPPM',\n    formatController: 'deltaPPMFormat',\n    defaultFormat: '00.00',\n  },\n  {\n    id: 4,\n    label: 'δ (Hz) :',\n    checkController: 'showDeltaHz',\n    formatController: 'deltaHzFormat',\n    defaultFormat: '00.00',\n  },\n  {\n    id: 5,\n    label: 'Peak Width',\n    checkController: 'showPeakWidth',\n    formatController: 'peakWidthFormat',\n    defaultFormat: '00.0000',\n  },\n  {\n    id: 6,\n    label: 'Intensity :',\n    checkController: 'showIntensity',\n    formatController: 'intensityFormat',\n    defaultFormat: '00.00',\n  },\n];\n\nfunction PeaksPreferences({ nucleus, preferences }, ref) {\n  const alert = useAlert();\n  const [, setSettingsData] = useStateWithLocalStorage('nmr-general-settings');\n  const [settings, setSetting] = useState(null);\n  const formRef = useRef();\n\n  useEffect(() => {\n    const peaksPreferences = getValueByKeyPath(\n      preferences,\n      `formatting.panels.peaks`,\n    );\n    if (peaksPreferences) {\n      setSetting(peaksPreferences);\n    }\n  }, [preferences]);\n\n  const saveHandler = useCallback(\n    (values, showMessage = false) => {\n      preferences.dispatch({\n        type: SET_PANELS_PREFERENCES,\n        payload: { key: 'peaks', value: values },\n      });\n      if (showMessage) alert.success('Peaks preferences saved successfully');\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(ref, () => ({\n    saveSetting() {\n      if (typeof formRef.current.requestSubmit === 'function') {\n        formRef.current.requestSubmit();\n      } else {\n        formRef.current.dispatchEvent(\n          new Event('submit', { cancelable: true }),\n        );\n      }\n    },\n  }));\n\n  const handleSubmit = useCallback(\n    (event) => {\n      event.preventDefault();\n      const form = event.target;\n      const formData = new FormData(form);\n      let values = {};\n      for (let field of formData.entries()) {\n        const keys = field[0].split('-').join('.');\n        const val = ['true', 'false'].includes(field[1])\n          ? field[1] === 'true'\n          : field[1];\n        values = lodashSet(values, keys, val);\n      }\n      saveHandler(values, true);\n      setSettingsData(values, 'formatting.panels.peaks');\n    },\n    [saveHandler, setSettingsData],\n  );\n\n  const getValue = useCallback(\n    (...params) => {\n      const keys = params.join('.');\n      if (settings) {\n        const value = lodashGet(settings, keys);\n        return value ? value : null;\n      } else {\n        const keyIndex = params.length - 1;\n        return peaksDefaultValues[params[keyIndex]];\n      }\n    },\n    [settings],\n  );\n\n  return (\n    <div style={styles.container}>\n      <form onSubmit={handleSubmit} ref={formRef}>\n        {nucleus &&\n          nucleus.map((nucleusLabel) => (\n            <div key={nucleusLabel} style={styles.groupContainer}>\n              <IsotopesViewer style={styles.header} value={nucleusLabel} />\n              {formatFields.map((field) => (\n                <ColumnFormatField\n                  key={field.id}\n                  label={field.label}\n                  checked={getValue(nucleusLabel, field.checkController)}\n                  format={getValue(nucleusLabel, field.formatController)}\n                  checkControllerName={field.checkController}\n                  formatControllerName={field.formatController}\n                  groupID={nucleusLabel}\n                />\n              ))}\n            </div>\n          ))}\n      </form>\n    </div>\n  );\n}\n\nexport default PeaksWrapper(forwardRef(PeaksPreferences));\n","import { useCallback, useMemo, memo, useEffect, useRef } from 'react';\nimport { FaRegTrashAlt } from 'react-icons/fa';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport EditableColumn from '../../elements/EditableColumn';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport PeaksWrapper from '../../hoc/PeaksWrapper';\nimport {\n  DELETE_PEAK_NOTATION,\n  SHIFT_SPECTRUM,\n} from '../../reducer/types/Types';\nimport formatNumber, {\n  useFormatNumberByNucleus,\n} from '../../utility/FormatNumber';\nimport { getValue } from '../../utility/LocalStorage';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport { peaksDefaultValues } from '../extra/preferences/defaultValues';\n\nfunction PeaksTable({\n  peaks,\n  info,\n  xDomain,\n  activeTab,\n  enableFilter,\n  onFilter,\n  preferences,\n}) {\n  const dispatch = useDispatch();\n  const deltaPPMRefs = useRef([]);\n  const format = useFormatNumberByNucleus(info.nucleus);\n  const deletePeakHandler = useCallback(\n    (e, row) => {\n      e.preventDefault();\n      e.stopPropagation();\n      const params = row.original;\n      dispatch({\n        type: DELETE_PEAK_NOTATION,\n        data: { id: params.id, xIndex: params.xIndex },\n      });\n    },\n    [dispatch],\n  );\n\n  const initialColumns = useMemo(\n    () => [\n      {\n        index: 20,\n        Header: '',\n        width: '1%',\n        maxWidth: '24px',\n        minWidth: '24px',\n        id: 'delete-button',\n        Cell: ({ row }) => (\n          <button\n            type=\"button\"\n            className=\"delete-button\"\n            onClick={(e) => deletePeakHandler(e, row)}\n          >\n            <FaRegTrashAlt />\n          </button>\n        ),\n      },\n    ],\n    [deletePeakHandler],\n  );\n\n  const editStartHander = useCallback((index) => {\n    deltaPPMRefs.current.forEach((ref, i) => {\n      if (index !== i && ref) {\n        ref.closeEdit();\n      }\n    });\n  }, []);\n\n  const saveDeltaPPMRefsHandler = useCallback(\n    (event, row) => {\n      const shiftValue = parseFloat(event.target.value) - parseFloat(row.value);\n      dispatch({ type: SHIFT_SPECTRUM, shiftValue });\n    },\n    [dispatch],\n  );\n\n  const tableColumns = useMemo(() => {\n    const setCustomColumn = (\n      array,\n      index,\n      columnLabel,\n      cellHandler,\n      extraParams,\n    ) => {\n      array.push({\n        ...extraParams,\n        index: index,\n        Header: columnLabel,\n        sortType: 'basic',\n        Cell: ({ row }) => cellHandler(row),\n      });\n    };\n\n    const peaksPreferences = getValue(\n      preferences,\n      `formatting.panels.peaks.[${activeTab}]`,\n      peaksDefaultValues,\n    );\n\n    let cols = [...initialColumns];\n    if (peaksPreferences.showPeakNumber) {\n      setCustomColumn(\n        cols,\n        1,\n        '#',\n        (row) => formatNumber(row.index + 1, peaksPreferences.peakNumberFormat),\n        { width: '1%', maxWidth: '40px', minWidth: '40px' },\n      );\n    }\n    if (peaksPreferences.showPeakIndex) {\n      setCustomColumn(cols, 2, 'index', (row) =>\n        formatNumber(row.original.xIndex, peaksPreferences.peakIndexFormat),\n      );\n    }\n    if (peaksPreferences.showDeltaPPM) {\n      setCustomColumn(cols, 3, 'δ (ppm)', (row) => (\n        <EditableColumn\n          onEditStart={() => editStartHander(row.index)}\n          ref={(ref) => (deltaPPMRefs.current[row.index] = ref)}\n          value={formatNumber(\n            row.original.value,\n            peaksPreferences.deltaPPMFormat,\n          )}\n          onSave={(event) => saveDeltaPPMRefsHandler(event, row.original)}\n          type=\"number\"\n        />\n      ));\n    }\n    if (peaksPreferences.showDeltaHz) {\n      setCustomColumn(cols, 4, 'δ (Hz)', (row) =>\n        formatNumber(row.original.valueHz, peaksPreferences.deltaHzFormat),\n      );\n    }\n    if (peaksPreferences.showIntensity) {\n      setCustomColumn(cols, 5, 'Intensity', (row) =>\n        formatNumber(row.original.intensity, peaksPreferences.intensityFormat),\n      );\n    }\n    if (peaksPreferences.showPeakWidth) {\n      setCustomColumn(cols, 5, 'Peak Width', (row) =>\n        formatNumber(row.original.peakWidth, peaksPreferences.peakWidthFormat),\n      );\n    }\n    return cols.sort((object1, object2) => object1.index - object2.index);\n  }, [\n    activeTab,\n    editStartHander,\n    initialColumns,\n    preferences,\n    saveDeltaPPMRefsHandler,\n  ]);\n\n  const _data = useMemo(() => {\n    function isInRange(value) {\n      const factor = 100000;\n      return (\n        value * factor >= xDomain[0] * factor &&\n        value * factor <= xDomain[1] * factor\n      );\n    }\n    if (peaks && peaks.values) {\n      const _peaks = enableFilter\n        ? peaks.values.filter((peak) => isInRange(peak.delta))\n        : peaks.values;\n\n      return _peaks.map((peak) => {\n        const value = format(peak.delta);\n        return {\n          value: value,\n          valueHz:\n            info && info.originFrequency ? value * info.originFrequency : '',\n          id: peak.id,\n          intensity: peak.intensity,\n          peakWidth: peak.width ? peak.width : '',\n          isConstantlyHighlighted: isInRange(value),\n        };\n      });\n    }\n\n    return [];\n  }, [enableFilter, format, info, peaks, xDomain]);\n\n  useEffect(() => {\n    onFilter(_data.length);\n  }, [_data, onFilter]);\n\n  return _data && _data.length > 0 ? (\n    <ReactTable data={_data} columns={tableColumns} />\n  ) : (\n    <NoTableData />\n  );\n}\n\nexport default PeaksWrapper(memo(PeaksTable));\n","import { useCallback, useState, useRef, memo } from 'react';\nimport ReactCardFlip from 'react-card-flip';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useModal } from '../../elements/popup/Modal';\nimport { DELETE_PEAK_NOTATION } from '../../reducer/types/Types';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport PeaksPreferences from './PeaksPreferences';\nimport PeaksTable from './PeaksTable';\n\nconst styles = {\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n  },\n};\n\nfunction PeaksPanel() {\n  const [filterIsActive, setFilterIsActive] = useState(false);\n  const [peaksCounter, setPeaksCounter] = useState(0);\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef();\n  const yesHandler = useCallback(() => {\n    dispatch({ type: DELETE_PEAK_NOTATION, data: null });\n  }, [dispatch]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All records will be deleted, Are You sure?',\n      buttons: [{ text: 'Yes', handler: yesHandler }, { text: 'No' }],\n    });\n  }, [modal, yesHandler]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n  const changedHandler = useCallback((val) => {\n    setPeaksCounter(val);\n  }, []);\n\n  return (\n    <div style={styles.container}>\n      {!isFlipped && (\n        <DefaultPanelHeader\n          counter={peaksCounter}\n          onDelete={handleDeleteAll}\n          deleteToolTip=\"Delete All Peaks\"\n          onFilter={handleOnFilter}\n          filterToolTip={\n            filterIsActive ? 'Show all peaks' : 'Hide peaks out of view'\n          }\n          filterIsActive={filterIsActive}\n          counterFiltered={peaksCounter}\n          showSettingButton=\"true\"\n          onSettingClick={settingsPanelHandler}\n        />\n      )}\n      {isFlipped && (\n        <PreferencesHeader\n          onSave={saveSettingHandler}\n          onClose={settingsPanelHandler}\n        />\n      )}\n      <div style={{ height: '100%', overflow: 'hidden' }}>\n        <ReactCardFlip\n          isFlipped={isFlipped}\n          infinite\n          containerStyle={{ overflow: 'hidden', height: '100%' }}\n        >\n          <div style={{ overflow: 'auto', height: '100%', display: 'block' }}>\n            <PeaksTable\n              enableFilter={filterIsActive}\n              onFilter={changedHandler}\n            />\n          </div>\n\n          <PeaksPreferences ref={settingRef} />\n        </ReactCardFlip>\n      </div>\n    </div>\n  );\n}\n\nexport default memo(PeaksPanel);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FaCopy } from 'react-icons/fa';\n\nimport CloseButton from '../elements/CloseButton';\n\nconst styles = css`\n  overflow: auto;\n  width: 400px;\n  .innerContainer {\n    padding: 5px;\n    width: 100%;\n    height: 180px;\n    border: none;\n  }\n\n  .mainButtonsContainer {\n    padding: 5px 0px;\n    border-bottom: 0.55px solid #ebebeb;\n    display: flex;\n    justify-content: space-between;\n  }\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 0 5px;\n  }\n\n  button:disabled {\n    opacity: 0.6;\n  }\n`;\n\nfunction CopyClipboardModal({ text, onClose, onCopyClick }) {\n  return (\n    <div css={styles}>\n      <div className=\"mainButtonsContainer handle\">\n        <button type=\"button\" onClick={() => onCopyClick(text)}>\n          <FaCopy />\n        </button>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div\n        className=\"innerContainer\"\n        // eslint-disable-next-line react/no-danger\n        dangerouslySetInnerHTML={{ __html: text }}\n      />\n    </div>\n  );\n}\n\nexport default CopyClipboardModal;\n","import { SvgNmrSum } from 'cheminfo-font';\nimport lodashGet from 'lodash/get';\nimport { rangesToACS } from 'nmr-processing';\nimport { useCallback, useState } from 'react';\nimport { FaFileExport, FaUnlink, FaSitemap } from 'react-icons/fa';\n\nimport { useAssignmentData } from '../../assignment';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { usePreferences } from '../../context/PreferencesContext';\nimport ToggleButton from '../../elements/ToggleButton';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport CopyClipboardModal from '../../modal/CopyClipboardModal';\nimport ChangeSumModal from '../../modal/changeSum/ChangeSumModal';\nimport { CHANGE_RANGE_SUM, DELETE_RANGE } from '../../reducer/types/Types';\nimport Events from '../../utility/Events';\nimport { copyHTMLToClipboard } from '../../utility/Export';\nimport { getNumberOfDecimals } from '../../utility/FormatNumber';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\n\nconst styles = {\n  toolbar: {\n    display: 'flex',\n    flexDirection: 'row',\n    borderBottom: '0.55px solid rgb(240, 240, 240)',\n  },\n  center: {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: '5px',\n  },\n  removeAssignmentsButton: {\n    border: 'none',\n    height: '16px',\n    // width: '18px',\n    fontSize: '12px',\n    backgroundColor: 'transparent',\n  },\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n  },\n};\n\nfunction RangesHeader({\n  ranges,\n  info,\n  activeTab,\n  molecules,\n  onUnlink,\n  onFilterActivated,\n  onSettingClick,\n  isFilterActive,\n  filterCounter,\n}) {\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const alert = useAlert();\n  const preferences = usePreferences();\n  const assignmentData = useAssignmentData();\n  const [isMultiplicityTreesVisible, showMultiplicityTrees] = useState(false);\n\n  const currentSum = lodashGet(ranges, 'options.sum', null);\n\n  const changeRangesSumHandler = useCallback(\n    (value) => {\n      if (value !== undefined) {\n        dispatch({ type: CHANGE_RANGE_SUM, value });\n      }\n\n      modal.close();\n    },\n    [dispatch, modal],\n  );\n\n  const showChangeRangesSumModal = useCallback(() => {\n    modal.show(\n      <ChangeSumModal\n        onClose={() => modal.close()}\n        onSave={changeRangesSumHandler}\n        header={\n          currentSum\n            ? `Set new Ranges Sum (Current: ${Number(currentSum).toFixed(2)})`\n            : 'Set new Ranges Sum'\n        }\n        molecules={molecules}\n        element={activeTab ? activeTab.replace(/[0-9]/g, '') : null}\n      />,\n    );\n  }, [activeTab, changeRangesSumHandler, currentSum, modal, molecules]);\n\n  const removeAssignments = useCallback(() => {\n    onUnlink();\n  }, [onUnlink]);\n\n  const handleOnRemoveAssignments = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All assignments will be removed. Are you sure?',\n      buttons: [{ text: 'Yes', handler: removeAssignments }, { text: 'No' }],\n    });\n  }, [removeAssignments, modal]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All ranges will be deleted. Are You sure?',\n      buttons: [\n        {\n          text: 'Yes',\n          handler: () => {\n            dispatch({ type: DELETE_RANGE, payload: { assignmentData } });\n          },\n        },\n        { text: 'No' },\n      ],\n    });\n  }, [assignmentData, dispatch, modal]);\n\n  const handleSetShowMultiplicityTrees = useCallback((flag) => {\n    Events.emit('showMultiplicityTrees', flag);\n    showMultiplicityTrees(flag);\n  }, []);\n\n  const saveToClipboardHandler = useCallback(\n    (value) => {\n      const success = copyHTMLToClipboard(value);\n      if (success) {\n        alert.success('Data copied to clipboard');\n      } else {\n        alert.error('copy to clipboard failed');\n      }\n    },\n    [alert],\n  );\n\n  const saveAsHTMLHandler = useCallback(() => {\n    const { originFrequency: observedFrequency, nucleus } = info;\n    const format = lodashGet(\n      preferences,\n      `formatting.nucleusByKey[${nucleus.toLowerCase()}]`,\n    );\n    const nbDecimalDelta = getNumberOfDecimals(format.ppm);\n    const nbDecimalJ = getNumberOfDecimals(format.hz);\n\n    const result = rangesToACS(ranges.values, {\n      nucleus, // '19f'\n      nbDecimalDelta, // 2\n      nbDecimalJ, // 1\n      observedFrequency, //400\n    });\n    modal.show(\n      <CopyClipboardModal\n        text={result}\n        onCopyClick={saveToClipboardHandler}\n        onClose={() => modal.close()}\n      />,\n      {},\n    );\n  }, [info, modal, preferences, ranges.values, saveToClipboardHandler]);\n\n  return (\n    <DefaultPanelHeader\n      counter={ranges && ranges.values && ranges.values.length}\n      onDelete={handleDeleteAll}\n      deleteToolTip=\"Delete All Ranges\"\n      onFilter={onFilterActivated}\n      filterToolTip={\n        isFilterActive ? 'Show all ranges' : 'Hide ranges out of view'\n      }\n      filterIsActive={isFilterActive}\n      counterFiltered={filterCounter}\n      showSettingButton=\"true\"\n      onSettingClick={onSettingClick}\n    >\n      <ToolTip title=\"Preview publication string\" popupPlacement=\"right\">\n        <button style={styles.button} type=\"button\" onClick={saveAsHTMLHandler}>\n          <FaFileExport />\n        </button>\n      </ToolTip>\n      <ToolTip\n        title={\n          currentSum\n            ? `Change Ranges Sum (${Number(currentSum).toFixed(2)})`\n            : 'Change Ranges Sum'\n        }\n        popupPlacement=\"right\"\n      >\n        <button\n          css={styles.button}\n          type=\"button\"\n          onClick={showChangeRangesSumModal}\n        >\n          <SvgNmrSum />\n        </button>\n      </ToolTip>\n      <ToolTip title={`Remove all Assignments`} popupPlacement=\"right\">\n        <button\n          style={{ ...styles.center, ...styles.removeAssignmentsButton }}\n          type=\"button\"\n          onClick={handleOnRemoveAssignments}\n          disabled={!ranges || !ranges.values || ranges.values.length === 0}\n        >\n          <FaUnlink />\n        </button>\n      </ToolTip>\n\n      <ToggleButton\n        popupTitle={\n          isMultiplicityTreesVisible\n            ? 'Hide Multiplicity Trees in Spectrum'\n            : 'Show Multiplicity Trees in Spectrum'\n        }\n        popupPlacement=\"right\"\n        onClick={handleSetShowMultiplicityTrees}\n        disabled={!ranges || !ranges.values || ranges.values.length === 0}\n      >\n        <FaSitemap style={{ pointerEvents: 'none', fontSize: '12px' }} />\n      </ToggleButton>\n    </DefaultPanelHeader>\n  );\n}\n\nexport default RangesHeader;\n","import lodashGet from 'lodash/get';\nimport lodashSet from 'lodash/set';\nimport {\n  useEffect,\n  useState,\n  useCallback,\n  forwardRef,\n  useImperativeHandle,\n  useRef,\n  memo,\n} from 'react';\n\nimport IsotopesViewer from '../../elements/IsotopesViewer';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { SET_PANELS_PREFERENCES } from '../../reducer/preferencesReducer';\nimport {\n  useStateWithLocalStorage,\n  getValue as getValueByKeyPath,\n} from '../../utility/LocalStorage';\nimport ColumnFormatField from '../extra/preferences/ColumnFormatField';\nimport { rangeDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles = {\n  container: {\n    padding: 10,\n    backgroundColor: '#f1f1f1',\n    height: '100%',\n    flex: 1,\n  },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '30%',\n    textAlign: 'center',\n  },\n};\n\nfunction RangesPreferences({ nucleus, preferences }, ref) {\n  const alert = useAlert();\n  const [, setSettingsData] = useStateWithLocalStorage('nmr-general-settings');\n  const [settings, setSetting] = useState(null);\n  const formRef = useRef();\n\n  useEffect(() => {\n    const integralsPreferences = getValueByKeyPath(\n      preferences,\n      'formatting.panels.ranges',\n    );\n    if (integralsPreferences) {\n      setSetting(integralsPreferences);\n    }\n  }, [preferences]);\n\n  const saveToLocalStorgate = (values) => {\n    setSettingsData(values, 'formatting.panels.ranges');\n  };\n\n  const saveHandler = useCallback(\n    (values, showMessage = false) => {\n      preferences.dispatch({\n        type: SET_PANELS_PREFERENCES,\n        payload: { key: 'ranges', value: values },\n      });\n      if (showMessage) {\n        alert.success('ranges preferences saved successfully');\n      }\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(ref, () => ({\n    saveSetting() {\n      if (typeof formRef.current.requestSubmit === 'function') {\n        formRef.current.requestSubmit();\n      } else {\n        formRef.current.dispatchEvent(\n          new Event('submit', { cancelable: true }),\n        );\n      }\n    },\n  }));\n\n  const formatFields = [\n    {\n      id: 1,\n      label: 'From :',\n      checkController: 'showFrom',\n      formatController: 'fromFormat',\n      defaultFormat: '0.00',\n    },\n    {\n      id: 2,\n      label: 'To :',\n      checkController: 'showTo',\n      formatController: 'toFormat',\n      defaultFormat: '0.00',\n    },\n    {\n      id: 3,\n      label: 'Absolute :',\n      checkController: 'showAbsolute',\n      formatController: 'absoluteFormat',\n      defaultFormat: '0.00',\n    },\n    {\n      id: 4,\n      label: 'Relative :',\n      checkController: 'showRelative',\n      formatController: 'relativeFormat',\n      defaultFormat: '00.00',\n    },\n  ];\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    const form = event.target;\n    const formData = new FormData(form);\n    let values = {};\n    for (const field of formData.entries()) {\n      const keys = field[0].split('-').join('.');\n      const val = ['true', 'false'].includes(field[1])\n        ? field[1] === 'true'\n        : field[1];\n      values = lodashSet(values, keys, val);\n    }\n\n    saveHandler(values, true);\n    saveToLocalStorgate(values);\n  };\n\n  const getValue = useCallback(\n    (...params) => {\n      const keys = params.join('.');\n      if (settings) {\n        const value = lodashGet(settings, keys);\n        return value ? value : null;\n      } else {\n        const keyIndex = params.length - 1;\n        return rangeDefaultValues[params[keyIndex]];\n      }\n    },\n    [settings],\n  );\n\n  return (\n    <div style={styles.container}>\n      <form onSubmit={handleSubmit} ref={formRef}>\n        {nucleus &&\n          nucleus.map((nucleusLabel) => (\n            <div key={nucleusLabel} style={styles.groupContainer}>\n              <IsotopesViewer style={styles.header} value={nucleusLabel} />\n              {formatFields.map((field) => (\n                <ColumnFormatField\n                  key={field.id}\n                  label={field.label}\n                  checked={getValue(nucleusLabel, field.checkController)}\n                  format={getValue(nucleusLabel, field.formatController)}\n                  checkControllerName={field.checkController}\n                  formatControllerName={field.formatController}\n                  groupID={nucleusLabel}\n                />\n              ))}\n            </div>\n          ))}\n      </form>\n    </div>\n  );\n}\n\nexport default memo(forwardRef(RangesPreferences));\n","import { useCallback, useEffect, useState } from 'react';\n\n/**\n *\n * @param {string} key\n * @param {Array} data\n */\n\nlet oldId = null;\n\nfunction useToggleStatus(key, data) {\n  const [status, setStatus] = useState({});\n\n  useEffect(() => {\n    let statusflags = {};\n    if (data && Array.isArray(data)) {\n      for (let i = 0; i < data.length; i++) {\n        statusflags[data[i][key]] = false;\n      }\n      setStatus(statusflags);\n    }\n  }, [data, key]);\n\n  const toggle = useCallback(\n    (id) => {\n      const newStatus = { ...status };\n      if (oldId) {\n        newStatus[oldId] = false;\n      }\n      if (id != null) {\n        oldId = id;\n        newStatus[id] = true;\n      }\n      setStatus(newStatus);\n    },\n    [status],\n  );\n\n  return [status, toggle];\n}\n\nexport default useToggleStatus;\n","import lodash from 'lodash';\n\nimport FormatNumber from '../../../utility/FormatNumber';\n\nexport default class ColumnsHelper {\n  constructor(preferences, defaultPreference) {\n    this.preferences = preferences;\n    this.defaultPreference = defaultPreference;\n  }\n\n  checkPreferences(preferencesToCheck, key) {\n    const val =\n      preferencesToCheck === undefined ||\n      Object.keys(preferencesToCheck).length === 0 ||\n      (preferencesToCheck && preferencesToCheck[key] === true)\n        ? true\n        : false;\n    return val;\n  }\n\n  setCustomColumn(array, index, columnLabel, cellHandler) {\n    array.push({\n      orderIndex: index,\n      Header: columnLabel,\n      sortType: 'basic',\n      Cell: ({ row }) => cellHandler(row),\n    });\n  }\n  /**\n   * @callback hasPrefix\n   * @param {...any}\n   * @returns {boolean}\n   */\n\n  /**\n   *\n   * @param {string} columns\n   * @param {string} flagKey\n   * @param {string} formatKey\n   * @param {string} columnKey\n   * @param {string} columnLabel\n   * @param {string} columnIndex\n   * @param {Object=} [option = {}]\n   * @param {string} [option.formatPrefix = '']\n   * @param {string} [option.formatSuffix = '']\n   * @param {hasPrefix}   [option.showPrefixSuffixCallback = ()=>true]\n   */\n  addColumn(\n    columns,\n    flagKey,\n    formatKey,\n    columnKey,\n    columnLabel,\n    columnIndex,\n    options = {},\n  ) {\n    const preferences = this.preferences || this.defaultPreference;\n\n    if (this.checkPreferences(preferences, flagKey)) {\n      this.setCustomColumn(columns, columnIndex, columnLabel, (row) => {\n        const format =\n          preferences &&\n          Object.prototype.hasOwnProperty.call(preferences, formatKey)\n            ? preferences[formatKey]\n            : this.defaultPreference[formatKey];\n\n        const {\n          formatPrefix = '',\n          formatSuffix = '',\n          showPrefixSuffixCallback = () => true,\n        } = options;\n\n        if (showPrefixSuffixCallback(row)) {\n          return FormatNumber(\n            row.original[columnKey],\n            format,\n            formatPrefix,\n            formatSuffix,\n          );\n        } else {\n          return FormatNumber(row.original[columnKey], format, '', '');\n        }\n      });\n    }\n  }\n}\n\nexport function isColumnVisible(preferences, key) {\n  return lodash.get(preferences, key, false);\n}\n","import FormatNumber from '../../../utility/FormatNumber';\n\nfunction AbsoluteColumn({ rowSpanTags, value, onHoverRange, format }) {\n  return (\n    <td {...rowSpanTags} {...onHoverRange}>\n      {FormatNumber(value, format)}\n    </td>\n  );\n}\n\nexport default AbsoluteColumn;\n","/** @jsxImportSource @emotion/react */\nimport { Fragment } from 'react';\n\nfunction Button({ onClick, ...props }) {\n  return (\n    <Fragment>\n      <button type=\"button\" onClick={onClick} {...props} />\n    </Fragment>\n  );\n}\n\nexport default Button;\n","/** @jsxImportSource @emotion/react */\nimport { useField } from 'formik';\n\nfunction ErrorMessage({ style, ...props }) {\n  const meta = useField(props)[1];\n\n  return (\n    <div>\n      {meta.error ? (\n        <p style={{ color: 'red', margin: '0.5px', ...style }}>{meta.error}</p>\n      ) : null}\n    </div>\n  );\n}\n\nexport default ErrorMessage;\n","import { useField } from 'formik';\n\nimport ErrorMessage from './ErrorMessage';\n\nfunction Input({ onFocus, onBlur, enableErrorMessage, ...props }) {\n  const [field] = useField(props);\n  return (\n    <div>\n      <input\n        {...field}\n        {...props}\n        onFocus={() => onFocus(field.name)}\n        onBlur={() => onBlur(field.name)}\n      />\n      {enableErrorMessage && enableErrorMessage === true ? (\n        <ErrorMessage {...props} />\n      ) : null}\n    </div>\n  );\n}\n\nInput.defaultProps = {\n  onFocus: () => null,\n  onBlur: () => null,\n};\n\nexport default Input;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport { memo, useState, useCallback, useEffect } from 'react';\nimport { FaPlus } from 'react-icons/fa';\n\nimport Button from '../../../../elements/Button';\nimport Input from '../../../../elements/formik/Input';\nimport { translateMultiplet } from '../../../../panels/extra/utilities/MultiplicityUtilities';\n\nconst AddSignalFormTabStyle = css`\n  text-align: center;\n  width: 100%;\n  height: 100%;\n\n  .infoText {\n    margin-top: 20px;\n    font-size: 12px;\n  }\n\n  input {\n    background-color: transparent;\n    border: 0.5px solid #dedede;\n    width: 50%;\n    text-align: center;\n  }\n\n  .addSignalButton {\n    margin-top: 15px;\n    margin-top: 20px;\n    background-color: transparent;\n    border: none;\n    padding: 0.3rem;\n    border-radius: 25%;\n  }\n`;\n\nfunction AddSignalFormTab({ onFocus, onBlur }) {\n  const { values, setFieldValue, errors } = useFormikContext();\n\n  const [disableAddButton, setDisableAddButton] = useState(false);\n\n  const onAddSignal = useCallback(() => {\n    const newSignal = {\n      multiplicity: 'm',\n      kind: 'signal',\n      delta: Number(values.newSignalDelta),\n      j: [{ multiplicity: translateMultiplet('m'), coupling: '' }],\n    };\n    const _signals = values.signals.slice().concat(newSignal);\n\n    setFieldValue('signals', _signals);\n    setFieldValue('activeTab', String(_signals.length - 1));\n  }, [setFieldValue, values.newSignalDelta, values.signals]);\n\n  useEffect(() => {\n    if (errors.newSignalDelta) {\n      setDisableAddButton(true);\n    } else {\n      setDisableAddButton(false);\n    }\n  }, [errors.newSignalDelta, values.signals]);\n\n  return (\n    <div css={AddSignalFormTabStyle}>\n      <div>\n        <p className=\"infoText\">\n          Edit or select a delta value of new signal (ppm):\n        </p>\n        <Input\n          name=\"newSignalDelta\"\n          type=\"number\"\n          placeholder={`${'\\u0394'} (ppm)`}\n          onFocus={onFocus}\n          onBlur={onBlur}\n        />\n      </div>\n\n      <div>\n        <Button\n          className=\"addSignalButton\"\n          onClick={onAddSignal}\n          disabled={disableAddButton}\n          css={{\n            color: disableAddButton ? 'grey' : 'blue',\n            width: '100%',\n          }}\n        >\n          <FaPlus title=\"Add new signal\" />\n        </Button>\n      </div>\n    </div>\n  );\n}\n\nexport default memo(AddSignalFormTab);\n","/** @jsxImportSource @emotion/react */\nimport { Field, useField } from 'formik';\nimport PropTypes from 'prop-types';\n\nimport ErrorMessage from './ErrorMessage';\n\nfunction SelectBox({ values, ...props }) {\n  const [field] = useField(props);\n\n  return values && values.length > 0 ? (\n    <div>\n      <Field as=\"select\" {...field} {...props}>\n        {values.map((value, i) => {\n          return (\n            <option\n              // eslint-disable-next-line react/no-array-index-key\n              key={i}\n            >\n              {value}\n            </option>\n          );\n        })}\n      </Field>\n      <ErrorMessage {...props} />\n    </div>\n  ) : null;\n}\n\nSelectBox.protoTypes = {\n  valuePath: PropTypes.instanceOf(Array).isRequired,\n  valueSelectionTemplate: PropTypes.func,\n};\n\nexport default SelectBox;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { memo, useEffect, useCallback } from 'react';\nimport { FaMinus, FaPlus } from 'react-icons/fa';\n\nimport { Multiplets } from '../../../../../data/constants/Multiplets';\nimport Button from '../../../../elements/Button';\nimport Input from '../../../../elements/formik/Input';\nimport SelectBox from '../../../../elements/formik/SelectBox';\nimport {\n  hasCouplingConstant,\n  translateMultiplet,\n} from '../../../../panels/extra/utilities/MultiplicityUtilities';\n\nconst CouplingsTableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  height: 100%;\n  font-size: 12px;\n\n  th,\n  td {\n    text-align: center;\n    margin: 0;\n    padding: 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    button {\n      background-color: transparent;\n      border: none;\n    }\n\n    .add-button {\n      color: blue;\n    }\n\n    .delete-button {\n      border-radius: 25%;\n      padding: 0;\n      padding-left: 0.3rem;\n      padding-right: 0.3rem;\n    }\n    .delete-button:hover {\n      background-color: red;\n      .icon {\n        color: white;\n      }\n    }\n\n    input {\n      background-color: transparent;\n      border: 0.5px solid #dedede;\n      height: 100%;\n      width: 100%;\n      text-align: center;\n    }\n    .selectBox {\n      background-color: transparent;\n      border: 0.5px solid #dedede;\n      height: 100%;\n      width: 100%;\n      text-align: center;\n    }\n  }\n\n  tr {\n    :last-child {\n      border-top: 3px solid #dedede;\n    }\n  }\n`;\n\nconst errorStyle = {\n  border: '1px solid red',\n};\n\nfunction CouplingsTable({ push, remove, onFocus, onBlur }) {\n  const { values, setFieldValue, errors } = useFormikContext();\n\n  useEffect(() => {\n    if (values.signals[values.activeTab]) {\n      values.signals[values.activeTab].j.forEach((_coupling, i) => {\n        if (!hasCouplingConstant(_coupling.multiplicity)) {\n          setFieldValue(`signals.${values.activeTab}.j.${i}.coupling`, '');\n        }\n      });\n    }\n  }, [setFieldValue, values.activeTab, values.signals]);\n\n  const hasMissingCouplingValue = useCallback(\n    (i) =>\n      lodashGet(\n        errors,\n        `signals[${values.activeTab}].missingCouplings`,\n        [],\n      ).some((_error) => _error.index === i),\n    [errors, values.activeTab],\n  );\n\n  return (\n    <table css={CouplingsTableStyle}>\n      <tbody>\n        <tr>\n          <th>#</th>\n          <th>Multiplicity</th>\n          <th>J (Hz)</th>\n          <th>{''}</th>\n        </tr>\n        {lodashGet(values, `signals[${values.activeTab}].j`, []).map(\n          (_coupling, i) => (\n            <tr\n              // eslint-disable-next-line react/no-array-index-key\n              key={`editCouplings${values.activeTab}${i}`}\n            >\n              <td>{i + 1}</td>\n              <td>\n                <SelectBox\n                  className=\"selectBox\"\n                  name={`signals.${values.activeTab}.j.${i}.multiplicity`}\n                  values={Multiplets.map((_multiplet) => _multiplet.label)}\n                />\n              </td>\n              <td>\n                <Input\n                  name={`signals.${values.activeTab}.j.${i}.coupling`}\n                  type=\"number\"\n                  placeholder={'J (Hz)'}\n                  disabled={!hasCouplingConstant(_coupling.multiplicity)}\n                  onFocus={onFocus}\n                  onBlur={onBlur}\n                  style={hasMissingCouplingValue(i) ? errorStyle : null}\n                />\n              </td>\n              <td>\n                <Button\n                  className=\"delete-button\"\n                  onClick={() => {\n                    remove(i);\n                  }}\n                >\n                  <FaMinus className=\"icon\" title=\"Delete coupling\" />\n                </Button>\n              </td>\n            </tr>\n          ),\n        )}\n        <tr />\n        <tr>\n          <td colSpan={4}>\n            <Button\n              className=\"add-button\"\n              onClick={() =>\n                push({\n                  multiplicity: translateMultiplet('m'),\n                  coupling: '',\n                })\n              }\n            >\n              <FaPlus title=\"Add new coupling\" />\n            </Button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  );\n}\n\nexport default memo(CouplingsTable);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext, FieldArray } from 'formik';\nimport { memo } from 'react';\n\nimport CouplingsTable from './CouplingsTable';\n\nconst SignalFormTabStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  font-size: 12px;\n  height: 100%;\n\n  margin: 0;\n  padding: 0.4rem;\n  text-align: center;\n`;\n\nfunction SignalFormTab({ onFocus, onBlur }) {\n  const { values } = useFormikContext();\n\n  return (\n    <div css={SignalFormTabStyle}>\n      <FieldArray\n        name={`signals.${values.activeTab}.j`}\n        render={({ push, remove }) => (\n          <div>\n            <CouplingsTable\n              push={push}\n              remove={remove}\n              onFocus={onFocus}\n              onBlur={onBlur}\n            />\n          </div>\n        )}\n      />\n    </div>\n  );\n}\n\nexport default memo(SignalFormTab);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, useMemo, memo, useEffect, useState } from 'react';\n\nimport { useChartData } from '../../../../context/ChartContext';\nimport { Tabs } from '../../../../elements/Tab';\nimport { translateMultiplet } from '../../../../panels/extra/utilities/MultiplicityUtilities';\nimport Events from '../../../../utility/Events';\n\nimport AddSignalFormTab from './AddSignalFormTab';\nimport SignalFormTab from './SignalFormTab';\n\nconst textStyles = css`\n  text-align: center;\n  width: 100%;\n\n  .errorText {\n    color: red;\n  }\n\n  .infoText {\n    margin-bottom: 20px;\n    font-size: 11px;\n  }\n`;\n\nconst tabStylesAddition = css`\n  color: red;\n`;\n\nfunction SignalsForm() {\n  const { values, setFieldValue, errors } = useFormikContext();\n\n  const { data: spectraData, activeSpectrum } = useChartData();\n  const [activeField, setActiveField] = useState(null);\n  const [frequency, setFrequency] = useState(null);\n\n  useEffect(() => {\n    if (\n      spectraData &&\n      activeSpectrum &&\n      lodashGet(\n        spectraData,\n        `[${activeSpectrum.index}].info.originFrequency`,\n        undefined,\n      )\n    ) {\n      setFrequency(spectraData[activeSpectrum.index].info.originFrequency);\n    } else {\n      setFrequency(null);\n    }\n  }, [activeSpectrum, spectraData]);\n\n  useEffect(() => {\n    Events.on('brushEnd', (event) => {\n      if (activeField && frequency) {\n        setFieldValue(\n          activeField,\n          Math.abs(event.range[0] - event.range[1]) * frequency,\n        );\n      }\n    });\n\n    return () => {\n      Events.off('brushEnd');\n    };\n  }, [activeField, setFieldValue, frequency, values.activeTab]);\n\n  useEffect(() => {\n    Events.on('mouseClick', (event) => {\n      if (values.activeTab === 'addSignalTab' && activeField) {\n        setFieldValue(activeField, event.xPPM);\n      }\n    });\n\n    return () => {\n      Events.off('mouseClick');\n    };\n  }, [values.activeTab, activeField, setFieldValue]);\n\n  const handleOnFocus = useCallback(\n    (name) => {\n      setActiveField(name);\n    },\n    [setActiveField],\n  );\n\n  const tapClickHandler = useCallback(\n    ({ tabid }) => {\n      setFieldValue('activeTab', tabid);\n      setActiveField(null);\n    },\n    [setFieldValue],\n  );\n\n  const handleDeleteSignal = useCallback(\n    ({ tabid }) => {\n      const _signals = values.signals.filter(\n        (_signal, i) => i !== Number(tabid),\n      );\n      setFieldValue('signals', _signals);\n    },\n    [setFieldValue, values.signals],\n  );\n\n  useEffect(() => {\n    setFieldValue(\n      'activeTab',\n      values.signals.length > 0\n        ? (values.signals.length - 1).toString()\n        : 'addSignalTab',\n    );\n  }, [setFieldValue, values.signals.length]);\n\n  const tabContainsErrors = useCallback(\n    (i) => {\n      return (\n        errors.signals &&\n        (lodashGet(errors, 'signals.noCouplings', []).some(\n          (_error) => _error.index === i,\n        ) ||\n          lodashGet(errors, `signals[${i}].missingCouplings`, []).length > 0)\n      );\n    },\n    [errors],\n  );\n\n  const signalFormTabs = useMemo(() => {\n    const signalTabs =\n      values.signals.length > 0\n        ? values.signals.map((signal, i) => (\n            <div\n              // eslint-disable-next-line react/no-array-index-key\n              key={`signalForm${i}`}\n              tabid={`${i}`}\n              tablabel={`${'\\u0394'}: ${signal.delta.toFixed(\n                5,\n              )} (${signal.j\n                .map((_coupling) => translateMultiplet(_coupling.multiplicity))\n                .join('')})`}\n              tabstyles={tabContainsErrors(i) ? tabStylesAddition : null}\n            >\n              <SignalFormTab onFocus={handleOnFocus} />\n            </div>\n          ))\n        : [];\n\n    const addSignalTab = (\n      <div\n        tablabel={'\\u002B'}\n        tabid=\"addSignalTab\"\n        candelete=\"false\"\n        key=\"addSignalTab\"\n      >\n        <AddSignalFormTab onFocus={handleOnFocus} />\n      </div>\n    );\n\n    return signalTabs.concat(addSignalTab);\n  }, [handleOnFocus, tabContainsErrors, values.signals]);\n\n  const editSignalInfoText = (\n    <p className=\"infoText\">\n      Focus on an input field and press Shift + Drag &#38; Drop to draw a\n      coupling constant in spectrum view.\n    </p>\n  );\n\n  const addSignalInfoText = (\n    <p className=\"infoText\">\n      Focus on the input field and press Shift + Left mouse click to select new\n      signal delta value in spectrum view.\n    </p>\n  );\n\n  return (\n    <div>\n      <div css={textStyles}>\n        {errors.signals &&\n        (errors.signals.noSignals || errors.signals.noCouplings) ? (\n          <div>\n            <p className=\"errorText\">\n              {errors.signals.noSignals ||\n                errors.signals.noCouplings[0].message}\n            </p>\n            {errors.signals.noSignals ? addSignalInfoText : null}\n          </div>\n        ) : values.activeTab === 'addSignalTab' ? (\n          addSignalInfoText\n        ) : (\n          editSignalInfoText\n        )}\n      </div>\n      <Tabs\n        defaultTabID={values.activeTab}\n        onClick={tapClickHandler}\n        canDelete\n        onDelete={handleDeleteSignal}\n      >\n        {signalFormTabs}\n      </Tabs>\n    </div>\n  );\n}\n\nexport default memo(SignalsForm);\n","import { hasCouplingConstant } from '../../../../panels/extra/utilities/MultiplicityUtilities';\n\nfunction EditRangeValidation(values, rangeData) {\n  const errors = {};\n\n  if (!values.newSignalDelta) {\n    errors.newSignalDelta = 'required';\n  } else if (\n    values.newSignalDelta < rangeData.from ||\n    values.newSignalDelta > rangeData.to\n  ) {\n    errors.newSignalDelta = ` ${values.newSignalDelta.toFixed(\n      5,\n    )} ppm out of the range`;\n  }\n\n  const createSignalsError = (i) => {\n    if (!errors.signals) {\n      errors.signals = {};\n    }\n    if (i !== undefined && !errors.signals[`${i}`]) {\n      errors.signals[`${i}`] = { missingCouplings: [] };\n    }\n  };\n\n  if (values.signals.length === 0) {\n    createSignalsError();\n    errors.signals.noSignals = 'There must be at least one signal in a range!';\n  } else {\n    values.signals.forEach((_signal, i) => {\n      if (_signal.j.length === 0) {\n        createSignalsError(i);\n        if (!errors.signals.noCouplings) {\n          errors.signals.noCouplings = [];\n        }\n        errors.signals.noCouplings.push({\n          index: i,\n          message: `There must be at least one coupling in signal ${i + 1}!`,\n        });\n      }\n      _signal.j.forEach((_coupling, j) => {\n        if (\n          hasCouplingConstant(_coupling.multiplicity) &&\n          _coupling.coupling === ''\n        ) {\n          createSignalsError(i);\n          errors.signals[`${i}`].missingCouplings.push({\n            index: j,\n            message: `There are coupling values missing in signal ${i + 1}!`,\n          });\n        }\n      });\n    });\n  }\n\n  return errors;\n}\n\nexport default EditRangeValidation;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { Form, Formik } from 'formik';\nimport { useCallback, useEffect, useMemo } from 'react';\nimport { FaSearchPlus } from 'react-icons/fa';\n\nimport generateID from '../../../data/utilities/generateID';\nimport Button from '../../elements/Button';\nimport CloseButton from '../../elements/CloseButton';\nimport SaveButton from '../../elements/SaveButton';\nimport {\n  hasCouplingConstant,\n  translateMultiplet,\n} from '../../panels/extra/utilities/MultiplicityUtilities';\n\nimport SignalsForm from './forms/components/SignalsForm';\nimport EditRangeValidation from './forms/validation/EditRangeValidation';\n\nconst styles = css`\n  overflow: auto;\n  width: 600px;\n  height: 500px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n      border-left: 1px solid #ececec;\n      padding-left: 6px;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      padding: 5px;\n\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    display: flex;\n    margin: 30px 5px;\n    input,\n    button {\n      padding: 5px;\n      border: 1px solid gray;\n      border-radius: 5px;\n      height: 36px;\n      margin: 2px;\n    }\n    input {\n      flex: 10;\n    }\n    button {\n      flex: 2;\n      color: white;\n      background-color: gray;\n    }\n  }\n`;\n\nfunction EditRangeModal({\n  onSaveEditRangeModal,\n  onCloseEditRangeModal,\n  onZoomEditRangeModal,\n  rangeData,\n}) {\n  const handleOnZoom = useCallback(() => {\n    onZoomEditRangeModal(rangeData);\n  }, [onZoomEditRangeModal, rangeData]);\n\n  useEffect(() => {\n    handleOnZoom();\n  }, [handleOnZoom]);\n\n  const handleOnClose = useCallback(() => {\n    onCloseEditRangeModal();\n  }, [onCloseEditRangeModal]);\n\n  const getCouplings = useCallback(\n    (couplings) =>\n      couplings\n        .filter((coupling) => coupling.coupling !== '')\n        .map((coupling) => {\n          return {\n            ...coupling,\n            multiplicity: translateMultiplet(coupling.multiplicity),\n          };\n        }),\n    [],\n  );\n\n  const getSignals = useCallback(\n    (signals) => {\n      return signals.map((_signal) => {\n        return {\n          id: generateID(),\n          ..._signal,\n          multiplicity: _signal.j\n            .map((_coupling) => translateMultiplet(_coupling.multiplicity))\n            .join(''),\n          j: getCouplings(_signal.j),\n        };\n      });\n    },\n    [getCouplings],\n  );\n\n  const handleOnSave = useCallback(\n    async (formValues) => {\n      const _range = { ...rangeData };\n      _range.signal = getSignals(formValues.signals);\n      await onSaveEditRangeModal(_range);\n      handleOnClose();\n    },\n    [getSignals, handleOnClose, onSaveEditRangeModal, rangeData],\n  );\n\n  const initialStateSignals = useMemo(() => {\n    return rangeData.signal.map((_signal) => {\n      // counter within j array to access to right j values\n      let counterJ = 0;\n      const couplings = [];\n      let coupling;\n      _signal.multiplicity.split('').forEach((_multiplicity) => {\n        if (hasCouplingConstant(_multiplicity)) {\n          coupling = { ..._signal.j[counterJ] };\n          counterJ++;\n        } else {\n          coupling = { multiplicity: _multiplicity, coupling: '' };\n        }\n        coupling.multiplicity = translateMultiplet(coupling.multiplicity);\n        couplings.push(coupling);\n      });\n      return { ..._signal, j: couplings };\n    });\n  }, [rangeData.signal]);\n\n  const isSaveButtonDisabled = useCallback((errors) => {\n    const errorKeys = Object.keys(errors);\n    if (errorKeys.length > 0) {\n      if (\n        // ignore non-relevant newSignalDelta field\n        errorKeys.length === 1 &&\n        errorKeys[0] === 'newSignalDelta'\n      ) {\n        return false;\n      }\n      return true;\n    }\n    return false;\n  }, []);\n\n  return (\n    <div css={styles}>\n      {rangeData && (\n        <Formik\n          initialValues={{\n            signals: initialStateSignals,\n            newSignalDelta: (rangeData.from + rangeData.to) / 2,\n            activeTab: '0',\n          }}\n          validate={(values) => EditRangeValidation(values, rangeData)}\n          onSubmit={(values, { setSubmitting }) => {\n            handleOnSave(values);\n            setSubmitting(false);\n          }}\n        >\n          {({ values, errors }) => {\n            return (\n              <Form>\n                <div className=\"header handle\">\n                  <Button onClick={handleOnZoom} className=\"zoom-button\">\n                    <FaSearchPlus title=\"Set to default view on range in spectrum\" />\n                  </Button>\n                  <span>Range Information and Editing</span>\n                  <SaveButton\n                    onClick={() => handleOnSave(values)}\n                    disabled={isSaveButtonDisabled(errors)}\n                    popupTitle=\"Save and exit\"\n                  />\n\n                  <CloseButton onClick={handleOnClose} />\n                </div>\n                <SignalsForm />\n              </Form>\n            );\n          }}\n        </Formik>\n      )}\n    </div>\n  );\n}\n\nEditRangeModal.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n  onClose: () => {\n    return null;\n  },\n  onZoom: () => {\n    return null;\n  },\n};\n\nexport default EditRangeModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { Fragment, useCallback } from 'react';\nimport { FaRegTrashAlt, FaSearchPlus, FaEdit } from 'react-icons/fa';\n\nimport { SignalKinds } from '../../../../data/constants/SignalsKinds';\nimport { useAssignmentData } from '../../../assignment';\nimport { useDispatch } from '../../../context/DispatchContext';\nimport Select from '../../../elements/Select';\nimport {\n  useModal,\n  positions,\n  transitions,\n} from '../../../elements/popup/Modal';\nimport EditRangeModal from '../../../modal/editRange/EditRangeModal';\nimport {\n  SET_X_DOMAIN,\n  RESET_SELECTED_TOOL,\n  SET_SELECTED_TOOL,\n  CHANGE_RANGE_SIGNAL_KIND,\n  SAVE_EDITED_RANGE,\n  DELETE_RANGE,\n} from '../../../reducer/types/Types';\n\nconst styles = css`\n  width: 66px;\n  padding: 0 !important;\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n\n  button:disabled {\n    opacity: 0.6;\n  }\n`;\nconst selectBoxStyle = {\n  marginLeft: 2,\n  marginRight: 2,\n  border: 'none',\n  height: '20px',\n};\n\nfunction ActionsColumn({ rowData, onHoverSignal, rowSpanTags }) {\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const assignmentData = useAssignmentData();\n\n  const zoomRangeHandler = useCallback(() => {\n    const margin = Math.abs(rowData.from - rowData.to);\n    dispatch({\n      type: SET_X_DOMAIN,\n      xDomain: [rowData.from - margin, rowData.to + margin],\n    });\n  }, [dispatch, rowData.from, rowData.to]);\n\n  const deleteRangeHandler = useCallback(() => {\n    dispatch({\n      type: DELETE_RANGE,\n      payload: {\n        id: rowData.id,\n        assignmentData,\n      },\n    });\n  }, [assignmentData, dispatch, rowData]);\n\n  const changeRangeSignalKindHandler = useCallback(\n    (value) => {\n      dispatch({\n        type: CHANGE_RANGE_SIGNAL_KIND,\n        payload: {\n          rowData,\n          value,\n        },\n      });\n    },\n    [dispatch, rowData],\n  );\n\n  const saveEditRangeHandler = useCallback(\n    (editedRowData) => {\n      dispatch({\n        type: SAVE_EDITED_RANGE,\n        payload: {\n          editedRowData,\n          assignmentData,\n        },\n      });\n    },\n    [assignmentData, dispatch],\n  );\n\n  const closeEditRangeHandler = useCallback(() => {\n    dispatch({ type: RESET_SELECTED_TOOL });\n    modal.close();\n  }, [dispatch, modal]);\n\n  const openEditRangeHandler = useCallback(() => {\n    dispatch({ type: SET_SELECTED_TOOL, selectedTool: 'editRange' });\n    modal.show(\n      <EditRangeModal\n        onCloseEditRangeModal={closeEditRangeHandler}\n        onSaveEditRangeModal={saveEditRangeHandler}\n        onZoomEditRangeModal={zoomRangeHandler}\n        rangeData={rowData}\n      />,\n      {\n        position: positions.CENTER_RIGHT,\n        transition: transitions.SCALE,\n        isBackgroundBlur: false,\n      },\n    );\n  }, [\n    closeEditRangeHandler,\n    dispatch,\n    modal,\n    rowData,\n    saveEditRangeHandler,\n    zoomRangeHandler,\n  ]);\n\n  return (\n    <Fragment>\n      <td {...onHoverSignal}>\n        <Select\n          onChange={changeRangeSignalKindHandler}\n          data={SignalKinds}\n          defaultValue={rowData.tableMetaInfo.signal.kind}\n          style={selectBoxStyle}\n        />\n      </td>\n      <td {...rowSpanTags} css={styles}>\n        <button\n          type=\"button\"\n          className=\"delete-button\"\n          onClick={deleteRangeHandler}\n        >\n          <FaRegTrashAlt />\n        </button>\n        <button\n          type=\"button\"\n          className=\"zoom-button\"\n          onClick={zoomRangeHandler}\n        >\n          <FaSearchPlus title=\"Zoom to range in spectrum\" />\n        </button>\n        <button\n          type=\"button\"\n          className=\"edit-button\"\n          onClick={openEditRangeHandler}\n        >\n          <FaEdit color=\"blue\" />\n        </button>\n      </td>\n    </Fragment>\n  );\n}\n\nexport default ActionsColumn;\n","import lodashGet from 'lodash/get';\n\nfunction CouplingColumn({ rowData, onHoverSignal }) {\n  const result = lodashGet(rowData, 'tableMetaInfo.signal.j');\n  return (\n    <td {...onHoverSignal}>\n      {result &&\n        result.map((coupling) => coupling.coupling.toFixed(1)).join(',')}\n    </td>\n  );\n}\n\nexport default CouplingColumn;\n","import lodashGet from 'lodash/get';\nimport { useMemo, useCallback, memo } from 'react';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nconst spanStyle = {\n  color: 'red',\n  fontWeight: 'bold',\n};\n\nfunction RangeAssignmentsColumn({\n  rowData,\n  assignment,\n  highlight,\n  onUnlinkVisibilityChange,\n  unlinkVisibility,\n  onLink,\n  onUnlink,\n  rowSpanTags,\n  onHover,\n  highlightData,\n}) {\n  const diaIDs = useMemo(() => {\n    return lodashGet(rowData, 'diaID', []);\n  }, [rowData]);\n\n  const visibilityChangeHandler = useCallback(\n    (flag) => {\n      onUnlinkVisibilityChange(flag);\n    },\n    [onUnlinkVisibilityChange],\n  );\n\n  const spanCss = useMemo(() => {\n    const flag =\n      assignment.isActive ||\n      assignment.isOnHover ||\n      (highlight.isActive &&\n        !highlightData.highlight.highlighted.find((_highlighted) => {\n          return _highlighted === assignment.id;\n        }));\n\n    return flag\n      ? {\n          color: 'red',\n          fontWeight: 'bold',\n        }\n      : { color: 'black', fontWeight: 'normal' };\n  }, [\n    assignment.id,\n    assignment.isActive,\n    assignment.isOnHover,\n    highlight.isActive,\n    highlightData.highlight.highlighted,\n  ]);\n\n  return (\n    <td\n      {...rowSpanTags}\n      {...onHover}\n      {...{ onClick: (e) => onLink(e, assignment) }}\n    >\n      {rowData.pubIntegral !== undefined && rowData.pubIntegral > 0 ? (\n        rowData.diaID && rowData.diaID.length > 0 ? (\n          <div\n            onMouseEnter={() => visibilityChangeHandler(true)}\n            onMouseLeave={() => visibilityChangeHandler(false)}\n          >\n            {rowData.pubIntegral} {' ( '}\n            <span style={spanCss}>{diaIDs.length}</span>\n            {' ) '}\n            <sup>\n              <button\n                type=\"button\"\n                style={{\n                  visibility: unlinkVisibility ? 'visible' : 'hidden',\n                  padding: 0,\n                  margin: 0,\n                }}\n                onClick={(e) => onUnlink(e, true)}\n              >\n                <FaMinusCircle color=\"red\" />\n              </button>\n            </sup>\n          </div>\n        ) : assignment.isActive ? (\n          <div>\n            {`${rowData.pubIntegral} (`}\n            <span style={spanStyle}>0</span>\n            {')'}\n          </div>\n        ) : (\n          rowData.pubIntegral\n        )\n      ) : assignment.isActive ? (\n        <div>\n          {'0 ('}\n          <span style={spanStyle}>0</span>\n          {')'}\n        </div>\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nRangeAssignmentsColumn.defaultProps = {\n  onHover: () => null,\n  onUnlinkVisibilityChange: () => null,\n  onLink: () => null,\n  onUnlink: () => null,\n};\n\nexport default memo(RangeAssignmentsColumn);\n","import { memo } from 'react';\n\nimport FormatNumber from '../../../utility/FormatNumber';\n\nfunction RangeColumn({ value, rowSpanTags, onHoverRange, format }) {\n  return (\n    <td {...rowSpanTags} {...onHoverRange}>\n      {FormatNumber(value, format)}\n    </td>\n  );\n}\n\nexport default memo(RangeColumn);\n","import { forwardRef, useCallback, useMemo } from 'react';\n\nimport { checkRangeKind } from '../../../../data/utilities/RangeUtilities';\nimport { useDispatch } from '../../../context/DispatchContext';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport { CHANGE_RANGE_RELATIVE } from '../../../reducer/types/Types';\nimport FormatNumber from '../../../utility/FormatNumber';\n\nfunction RelativeColumn(\n  { rowData, rowSpanTags, onHoverRange, format, onEditStart, editStatus },\n  ref,\n) {\n  const dispatch = useDispatch();\n  const integralVal = useMemo(() => {\n    const flag = checkRangeKind(rowData);\n    const formattedValue = FormatNumber(rowData.integral, format);\n    return flag ? formattedValue : `[ ${formattedValue} ]`;\n  }, [format, rowData]);\n\n  const saveHandler = useCallback(\n    (event) => {\n      dispatch({\n        type: CHANGE_RANGE_RELATIVE,\n        value: event.target.value,\n        id: rowData.id,\n      });\n    },\n    [dispatch, rowData.id],\n  );\n\n  return (\n    <td {...rowSpanTags} {...onHoverRange}>\n      <EditableColumn\n        ref={ref}\n        onEditStart={onEditStart}\n        value={integralVal}\n        onSave={saveHandler}\n        type=\"number\"\n        style={{ padding: '0.1rem 0.4rem' }}\n        editStatus={editStatus}\n      />\n    </td>\n  );\n}\n\nexport default forwardRef(RelativeColumn);\n","import lodashGet from 'lodash/get';\nimport { useMemo, useCallback, memo } from 'react';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nfunction SignalAssignmentsColumn({\n  rowData,\n  onHover,\n  assignment,\n  highlight,\n  onUnlinkVisibilityChange,\n  unlinkVisibility,\n  onLink,\n  onUnlink,\n}) {\n  const diaIDs = useMemo(() => {\n    return lodashGet(rowData, 'tableMetaInfo.signal.diaID', []);\n  }, [rowData]);\n\n  const tdCss = useMemo(() => {\n    return assignment.isActive || highlight.isActive\n      ? {\n          color: 'red',\n          fontWeight: 'bold',\n        }\n      : null;\n  }, [assignment.isActive, highlight.isActive]);\n\n  const visibilityChangeHandler = useCallback(\n    (flag) => {\n      onUnlinkVisibilityChange(flag);\n    },\n    [onUnlinkVisibilityChange],\n  );\n  const assignHandler = useCallback(\n    (e) => {\n      onLink(e, assignment);\n    },\n    [assignment, onLink],\n  );\n\n  return (\n    <td {...onHover} onClick={assignHandler} style={tdCss}>\n      {diaIDs && diaIDs.length > 0 ? (\n        <div\n          onMouseEnter={() => visibilityChangeHandler(true)}\n          onMouseLeave={() => visibilityChangeHandler(false)}\n        >\n          {diaIDs.length}{' '}\n          <sup>\n            <button\n              type=\"button\"\n              style={{\n                visibility: unlinkVisibility ? 'visible' : 'hidden',\n                padding: 0,\n                margin: 0,\n              }}\n              onClick={(e) => onUnlink(e, false)}\n            >\n              <FaMinusCircle color=\"red\" />\n            </button>\n          </sup>\n        </div>\n      ) : assignment.isActive ? (\n        '0'\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nSignalAssignmentsColumn.defaultProps = {\n  onHover: () => null,\n  onUnlinkVisibilityChange: () => null,\n  onLink: () => null,\n  onUnlink: () => null,\n};\n\nexport default memo(SignalAssignmentsColumn);\n","import lodashGet from 'lodash/get';\n\nimport FormatNumber from '../../../utility/FormatNumber';\n\nexport default function useFormat(preferences) {\n  return (value, keysPath, prefix = '', suffix = '') => {\n    const format = lodashGet(preferences, keysPath, '0.000');\n    return FormatNumber(value, format, prefix, suffix);\n  };\n}\n","import { useCallback } from 'react';\n\nimport { useDispatch } from '../../../context/DispatchContext';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport { CHANGE_RANGE_SIGNAL_VALUE } from '../../../reducer/types/Types';\nimport { checkMultiplicity } from '../../extra/utilities/MultiplicityUtilities';\n\nimport useFormat from './format';\n\nfunction SignalDeltaColumn({\n  rowData,\n  onHoverSignal,\n  preferences,\n  onEditStart,\n  editStatus,\n}) {\n  const dispatch = useDispatch();\n  const signal = rowData.tableMetaInfo.signal;\n  const format = useFormat(preferences);\n\n  const saveHandler = useCallback(\n    (event) => {\n      dispatch({\n        type: CHANGE_RANGE_SIGNAL_VALUE,\n        payload: {\n          value: event.target.value,\n          rangeID: rowData.id,\n          signalID: signal.id,\n        },\n      });\n    },\n    [dispatch, rowData, signal.id],\n  );\n  const editStartHandler = useCallback(() => {\n    onEditStart(signal.id);\n  }, [onEditStart, signal.id]);\n\n  if (!signal) return <td>{''}</td>;\n\n  return (\n    <td {...onHoverSignal}>\n      {!checkMultiplicity(signal.multiplicity, ['m']) ? (\n        `${format(rowData.from, 'fromFormat')} - ${format(\n          rowData.to,\n          'toFormat',\n        )}`\n      ) : (\n        <EditableColumn\n          onEditStart={editStartHandler}\n          value={signal.delta.toFixed(3)}\n          onSave={saveHandler}\n          type=\"number\"\n          style={{ padding: '0.1rem 0.4rem' }}\n          editStatus={editStatus}\n        />\n      )}\n    </td>\n  );\n}\n\nexport default SignalDeltaColumn;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport lodashGet from 'lodash/get';\nimport { useMemo, useCallback, useState } from 'react';\n\nimport { useAssignment } from '../../assignment';\nimport { useHighlight, useHighlightData } from '../../highlight';\nimport { isColumnVisible } from '../extra/preferences/ColumnsHelper';\n\nimport AbsoluteColumn from './TableColumns/AbsoluteColumn';\nimport ActionsColumn from './TableColumns/ActionsColumn';\nimport CouplingColumn from './TableColumns/CouplingColumn';\nimport RangeAssignmentsColumn from './TableColumns/RangeAssignmentsColumn';\nimport RangeColumn from './TableColumns/RangeColumn';\nimport RelativeColumn from './TableColumns/RelativeColumn';\nimport SignalAssignmentsColumn from './TableColumns/SignalAssignmentsColumn';\nimport SignalDeltaColumn from './TableColumns/SignalDeltaColumn';\nimport useFormat from './TableColumns/format';\n\nconst HighlightedRowStyle = css`\n  background-color: #ff6f0057;\n`;\n\nconst ConstantlyHighlightedRowStyle = css`\n  background-color: #f5f5dc;\n`;\n\nfunction RangesTableRow({\n  rowData,\n  onUnlink,\n  onContextMenu,\n  onColumnEditStart,\n  preferences,\n  editFlags: { relativeFlags, signalFlags },\n}) {\n  const assignmentRange = useAssignment(rowData.id);\n  const highlightRange = useHighlight(\n    [assignmentRange.id].concat(assignmentRange.assigned.x || []),\n  );\n  const assignmentSignal = useAssignment(rowData.tableMetaInfo.id);\n  const highlightSignal = useHighlight(\n    [assignmentSignal.id].concat(assignmentSignal.assigned.x || []),\n  );\n  const highlightData = useHighlightData();\n\n  const [unlinkRangeButtonVisibility, showUnlinkRangeButton] = useState(false);\n  const [unlinkSignalButtonVisibility, showUnlinkSignalButton] = useState(\n    false,\n  );\n\n  const getFormat = useFormat(preferences);\n\n  const rowSpanTags = useMemo(() => {\n    return {\n      rowSpan: rowData.tableMetaInfo.rowSpan,\n      style: lodashGet(rowData.tableMetaInfo, 'hide', false)\n        ? { display: 'none' }\n        : null,\n    };\n  }, [rowData.tableMetaInfo]);\n\n  const unlinkHandler = useCallback(\n    (e, isOnRangeLevel) => {\n      // stop propagation here to prevent enabling/disabling the assignment mode at the same time\n      if (e) {\n        e.stopPropagation();\n      }\n\n      if (isOnRangeLevel !== undefined) {\n        if (isOnRangeLevel) {\n          onUnlink(rowData);\n          showUnlinkRangeButton(false);\n          assignmentRange.removeAll('x');\n        } else {\n          onUnlink(\n            rowData,\n            lodashGet(rowData, 'tableMetaInfo.signalIndex', undefined),\n          );\n          showUnlinkSignalButton(false);\n          assignmentSignal.removeAll('x');\n        }\n      } else {\n        showUnlinkRangeButton(false);\n        showUnlinkSignalButton(false);\n      }\n    },\n    [assignmentRange, assignmentSignal, onUnlink, rowData],\n  );\n\n  const linkHandler = useCallback((e, assignment) => {\n    e.stopPropagation();\n    assignment.onClick('x');\n  }, []);\n\n  const onHoverRange = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentRange.onMouseEnter('x');\n        highlightRange.show();\n      },\n      onMouseLeave: () => {\n        assignmentRange.onMouseLeave('x');\n        highlightRange.hide();\n      },\n    };\n  }, [assignmentRange, highlightRange]);\n\n  const onHoverSignal = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentSignal.onMouseEnter('x');\n        highlightSignal.show();\n      },\n      onMouseLeave: () => {\n        assignmentSignal.onMouseLeave('x');\n        highlightSignal.hide();\n      },\n    };\n  }, [assignmentSignal, highlightSignal]);\n\n  const trCss = useMemo(() => {\n    return highlightRange.isActive || assignmentRange.isActive\n      ? HighlightedRowStyle\n      : lodashGet(rowData, 'tableMetaInfo.isConstantlyHighlighted', false)\n      ? ConstantlyHighlightedRowStyle\n      : null;\n  }, [assignmentRange.isActive, highlightRange.isActive, rowData]);\n\n  return (\n    <tr\n      onContextMenu={(e) => onContextMenu(e, rowData)}\n      css={trCss}\n      {...highlightRange.onHover}\n    >\n      <td {...rowSpanTags} {...onHoverRange}>\n        {rowData.tableMetaInfo.rowIndex + 1}\n      </td>\n\n      {isColumnVisible(preferences, 'showFrom') && (\n        <RangeColumn\n          value={rowData.from}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('showFrom')}\n        />\n      )}\n      {isColumnVisible(preferences, 'showTo') && (\n        <RangeColumn\n          value={rowData.to}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('toFormat')}\n        />\n      )}\n\n      <SignalDeltaColumn\n        rowData={rowData}\n        onHoverSignal={onHoverSignal}\n        preferences={preferences}\n        onEditStart={(signalId) => onColumnEditStart('signal', `${signalId}`)}\n        editStatus={signalFlags[rowData.tableMetaInfo.signal.id]}\n      />\n\n      {isColumnVisible(preferences, 'showRelative') && (\n        <RelativeColumn\n          rowData={rowData}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('relativeFormat')}\n          onEditStart={() => onColumnEditStart('relative', rowData.id)}\n          editStatus={relativeFlags[rowData.id]}\n        />\n      )}\n\n      {isColumnVisible(preferences, 'showAbsolute') && (\n        <AbsoluteColumn\n          value={rowData.absolute}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('absoluteFormat')}\n        />\n      )}\n\n      <td {...onHoverSignal}>\n        {lodashGet(rowData, 'tableMetaInfo.signal.multiplicity', '')}\n      </td>\n\n      <CouplingColumn rowData={rowData} onHoverSignal={onHoverSignal} />\n\n      <SignalAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentSignal}\n        highlight={highlightSignal}\n        onHover={onHoverSignal}\n        unlinkVisibility={unlinkSignalButtonVisibility}\n        onUnlinkVisibilityChange={(flag) => showUnlinkSignalButton(flag)}\n        onLink={linkHandler}\n        onUnlink={unlinkHandler}\n      />\n\n      <RangeAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentRange}\n        highlight={highlightRange}\n        onHover={onHoverRange}\n        unlinkVisibility={unlinkRangeButtonVisibility}\n        onUnlinkVisibilityChange={(flag) => showUnlinkRangeButton(flag)}\n        onLink={linkHandler}\n        onUnlink={unlinkHandler}\n        rowSpanTags={rowSpanTags}\n        highlightData={highlightData}\n      />\n\n      <ActionsColumn\n        rowData={rowData}\n        onHoverSignal={onHoverSignal}\n        onHoverRange={onHoverRange}\n        rowSpanTags={rowSpanTags}\n      />\n    </tr>\n  );\n}\n\nexport default RangesTableRow;\n","import { useMemo } from 'react';\n\nfunction useMapRanges(data) {\n  return useMemo(() => {\n    const _rangesData = [];\n    data.forEach((range, i) => {\n      if (range.signal.length === 1) {\n        _rangesData.push({\n          ...range,\n          tableMetaInfo: {\n            ...range.tableMetaInfo,\n            signal: range.signal[0],\n            rowIndex: i,\n            signalIndex: 0,\n            id: range.signal[0].id,\n          },\n        });\n      } else if (range.signal.length > 1) {\n        range.signal.forEach((signal, j) => {\n          let hide = false;\n          let rowSpan = null;\n          if (j < range.signal.length - 1) {\n            if (j === 0) {\n              rowSpan = range.signal.length;\n            } else {\n              hide = true;\n            }\n          } else {\n            hide = true;\n          }\n\n          _rangesData.push({\n            ...range,\n            tableMetaInfo: {\n              ...range.tableMetaInfo,\n              signal,\n              rowSpan,\n              hide,\n              rowIndex: i,\n              signalIndex: j,\n              id: signal.id,\n            },\n          });\n        });\n      }\n    });\n\n    return _rangesData;\n  }, [data]);\n}\n\nexport default useMapRanges;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport lodashGet from 'lodash/get';\nimport { Fragment, useCallback, useEffect, useRef } from 'react';\nimport { FaLink } from 'react-icons/fa';\n\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport { useGlobal } from '../../context/GlobalContext';\nimport ContextMenu from '../../elements/ContextMenu';\nimport useToggleStatus from '../extra/utilities/UseToggleStatus';\n\nimport RangesTableRow from './RangesTableRow';\nimport useMapRanges from './useMapRanges';\n\nconst tableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  font-size: 12px;\n  // height: 100%;\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  th {\n    position: sticky;\n    top: 0;\n    background-color: white;\n    z-index: 1;\n  }\n  th,\n  td {\n    white-space: nowrap;\n    text-align: center;\n    margin: 0;\n    padding: 0.1rem 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n    }\n  }\n`;\n\nfunction RangesTable({\n  tableData,\n  onChangeKind,\n  onDelete,\n  onUnlink,\n  onZoom,\n  onEdit,\n  context,\n  activeTab,\n  preferences,\n}) {\n  const element = activeTab && activeTab.replace(/[0-9]/g, '');\n  const contextRef = useRef();\n  const data = useMapRanges(tableData);\n  const [relativeFlags, toggleRelativeColumn] = useToggleStatus('id', data);\n  const [signalFlags, toggleSignalColumn] = useToggleStatus('id', data);\n  const { rootRef } = useGlobal();\n\n  const isVisible = (key) => {\n    return lodashGet(preferences, key, false);\n  };\n\n  const contextMenuHandler = useCallback(\n    (e, rowData) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, rowData);\n      }\n    },\n    [contextRef],\n  );\n\n  const columnEditStartHandler = useCallback(\n    (columnKey, id) => {\n      if (columnKey === 'relative') {\n        toggleRelativeColumn(id);\n      } else if (columnKey === 'signal') {\n        toggleSignalColumn(id);\n      }\n    },\n    [toggleRelativeColumn, toggleSignalColumn],\n  );\n\n  useEffect(() => {\n    const handleEditStart = () => {\n      columnEditStartHandler('realtive', null);\n      columnEditStartHandler('signal', null);\n    };\n    if (rootRef) {\n      rootRef.addEventListener('mousedown', handleEditStart);\n    }\n    return () => {\n      if (rootRef) {\n        rootRef.removeEventListener('mousedown', handleEditStart);\n      }\n    };\n  }, [columnEditStartHandler, rootRef]);\n\n  return (\n    <Fragment>\n      <table css={tableStyle}>\n        <thead>\n          <tr>\n            <th>#</th>\n            {isVisible('showFrom') ? <th>From</th> : null}\n            {isVisible('showTo') ? <th>To</th> : null}\n            <th>δ (ppm)</th>\n            {isVisible('showRelative') ? <th>Rel. {element}</th> : null}\n            {isVisible('showAbsolute') ? <th>Absolute</th> : null}\n            <th>Mult.</th>\n            <th>J (Hz)</th>\n            <th>\n              <FaLink style={{ fontSize: 10 }} />\n            </th>\n            <th>Σ</th>\n            <th>Kind</th>\n            <th>{''}</th>\n          </tr>\n        </thead>\n        <tbody>\n          {data &&\n            data.map((range, i) => {\n              return (\n                <RangesTableRow\n                  // eslint-disable-next-line react/no-array-index-key\n                  key={`rangesTableRow${i}`}\n                  rowData={data[i]}\n                  onChangeKind={onChangeKind}\n                  onDelete={onDelete}\n                  onUnlink={onUnlink}\n                  onZoom={onZoom}\n                  onEdit={onEdit}\n                  onContextMenu={(e, rowData) => contextMenuHandler(e, rowData)}\n                  preferences={preferences}\n                  onColumnEditStart={columnEditStartHandler}\n                  editFlags={{ relativeFlags, signalFlags }}\n                />\n              );\n            })}\n        </tbody>\n      </table>\n      <ContextMenu ref={contextRef} context={context} />\n    </Fragment>\n  );\n}\n\nexport default RangesTable;\n","import lodashGet from 'lodash/get';\nimport { xGetFromToIndex } from 'ml-spectra-processing';\nimport { useCallback, useMemo, memo, useState, useRef } from 'react';\nimport ReactCardFlip from 'react-card-flip';\n\nimport { useAssignmentData } from '../../assignment';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useAlert } from '../../elements/popup/Alert';\nimport RangesWrapper from '../../hoc/RangesWrapper';\nimport { UNLINK_RANGE } from '../../reducer/types/Types';\nimport { copyTextToClipboard } from '../../utility/Export';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport { rangeDefaultValues } from '../extra/preferences/defaultValues';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport RangesHeader from './RangesHeader';\nimport RangesPreferences from './RangesPreferences';\nimport RangesTable from './RangesTable';\n\nconst styles = {\n  toolbar: {\n    display: 'flex',\n    flexDirection: 'row',\n    borderBottom: '0.55px solid rgb(240, 240, 240)',\n  },\n  container: {\n    flexDirection: 'column',\n    height: '100%',\n    display: 'flex',\n  },\n  sumButton: {\n    borderRadius: '5px',\n    marginTop: '3px',\n    color: 'white',\n    backgroundColor: '#6d6d6d',\n    border: 'none',\n    height: '16px',\n    width: '18px',\n    fontSize: '12px',\n    padding: 0,\n  },\n  removeAssignmentsButton: {\n    borderRadius: '5px',\n    marginTop: '3px',\n    marginLeft: '2px',\n    border: 'none',\n    height: '16px',\n    width: '18px',\n    fontSize: '12px',\n    padding: 0,\n  },\n  setShowMultiplicityTreesButton: {\n    borderRadius: '5px',\n    marginTop: '3px',\n    marginLeft: '5px',\n    color: 'black',\n    backgroundColor: 'transparent',\n    border: 'none',\n    height: '16px',\n    width: '18px',\n    fontSize: '12px',\n    padding: 0,\n  },\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n  },\n};\n\nfunction RangesTablePanel({\n  ranges,\n  x,\n  y,\n  info,\n  xDomain,\n  preferences,\n  activeTab,\n  molecules,\n  nucleus,\n}) {\n  const [isFilterActive, setFilterIsActive] = useState(false);\n  const assignmentData = useAssignmentData();\n\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef();\n\n  const rangesData = useMemo(() => {\n    const isInView = (from, to) => {\n      const factor = 10000;\n      to = to * factor;\n      from = from * factor;\n      return (\n        (to >= xDomain[0] * factor && from <= xDomain[1] * factor) ||\n        (from <= xDomain[0] * factor && to >= xDomain[1] * factor)\n      );\n    };\n\n    const getFilteredRanges = (ranges) => {\n      return ranges.filter((range) => isInView(range.from, range.to));\n    };\n\n    if (ranges.values) {\n      const _ranges = isFilterActive\n        ? getFilteredRanges(ranges.values)\n        : ranges.values;\n\n      return _ranges.map((range) => {\n        return {\n          ...range,\n          tableMetaInfo: {\n            isConstantlyHighlighted: isInView(range.from, range.to),\n          },\n        };\n      });\n    }\n    return [];\n  }, [isFilterActive, ranges.values, xDomain]);\n\n  const unlinkRangeHandler = useCallback(\n    (rangeData, signalIndex = -1) => {\n      dispatch({\n        type: UNLINK_RANGE,\n        payload: {\n          rangeData,\n          assignmentData,\n          signalIndex,\n        },\n      });\n    },\n    [assignmentData, dispatch],\n  );\n\n  const saveJSONToClipboardHandler = useCallback(\n    (value) => {\n      if (x && y) {\n        const { from, to } = value;\n        const { fromIndex, toIndex } = xGetFromToIndex(x, {\n          from,\n          to,\n        });\n\n        const dataToClipboard = {\n          x: x.slice(fromIndex, toIndex),\n          y: y.slice(fromIndex, toIndex),\n          ...value,\n        };\n\n        const success = copyTextToClipboard(\n          JSON.stringify(dataToClipboard, undefined, 2),\n        );\n\n        if (success) {\n          alert.show('Data copied to clipboard');\n        } else {\n          alert.error('copy to clipboard failed');\n        }\n      }\n    },\n    [x, y, alert],\n  );\n\n  const rangesPreferences = useMemo(() => {\n    const _preferences =\n      lodashGet(preferences, `formatting.panels.ranges.[${activeTab}]`) ||\n      rangeDefaultValues;\n\n    return _preferences;\n  }, [activeTab, preferences]);\n\n  const contextMenu = useMemo(\n    () => [\n      {\n        label: 'Copy to clipboard',\n        onClick: saveJSONToClipboardHandler,\n      },\n    ],\n    [saveJSONToClipboardHandler],\n  );\n\n  const filterHandler = useCallback(() => {\n    setFilterIsActive(!isFilterActive);\n  }, [isFilterActive]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  return (\n    <>\n      <div style={styles.container}>\n        {!isFlipped && (\n          <RangesHeader\n            ranges={ranges}\n            info={info}\n            activeTab={activeTab}\n            molecules={molecules}\n            onUnlink={unlinkRangeHandler}\n            onFilterActivated={filterHandler}\n            onSettingClick={settingsPanelHandler}\n            isFilterActive={isFilterActive}\n            filterCounter={rangesData.length}\n          />\n        )}\n        {isFlipped && (\n          <PreferencesHeader\n            onSave={saveSettingHandler}\n            onClose={settingsPanelHandler}\n          />\n        )}\n        <div style={{ height: '100%', overflow: 'hidden' }}>\n          <ReactCardFlip\n            isFlipped={isFlipped}\n            infinite\n            containerStyle={{ overflow: 'hidden', height: '100%' }}\n          >\n            <div style={{ overflow: 'auto', height: '100%', display: 'block' }}>\n              {rangesData && rangesData.length > 0 ? (\n                <RangesTable\n                  activeTab={activeTab}\n                  tableData={rangesData}\n                  onUnlink={unlinkRangeHandler}\n                  context={contextMenu}\n                  preferences={rangesPreferences}\n                />\n              ) : (\n                <NoTableData />\n              )}\n            </div>\n            <RangesPreferences\n              ranges={ranges}\n              ref={settingRef}\n              nucleus={nucleus}\n              preferences={preferences}\n            />\n          </ReactCardFlip>\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default RangesWrapper(memo(RangesTablePanel));\n","import { forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction SpectraWraper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const { data, activeSpectrum, activeTab, displayerMode } = useChartData();\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        data={data}\n        activeSpectrum={activeSpectrum}\n        activeTab={activeTab}\n        displayerMode={displayerMode}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default SpectraWraper;\n","import { SvgNmrSameTop, SvgNmrResetScale } from 'cheminfo-font';\nimport { memo, useCallback } from 'react';\nimport {\n  FaCreativeCommonsSamplingPlus,\n  FaEye,\n  FaEyeSlash,\n} from 'react-icons/fa';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport Button from '../../elements/ButtonToolTip';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport SpectraWraper from '../../hoc/SpectraWraper';\nimport { DISPLAYER_MODE } from '../../reducer/core/Constants';\nimport {\n  ADD_MISSING_PROJECTION,\n  CHANGE_VISIBILITY,\n  DELETE_SPECTRA,\n  RESET_SPECTRA_SCALE,\n  SET_SPECTRA_SAME_TOP,\n} from '../../reducer/types/Types';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\n\nfunction SpectraPanelHeader({\n  data,\n  activeSpectrum,\n  activeTab,\n  displayerMode,\n  spectrums,\n}) {\n  const modal = useModal();\n  const alert = useAlert();\n  const dispatch = useDispatch();\n\n  const handleDelete = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All records will be deleted, Are You sure?',\n      buttons: [\n        {\n          text: 'Yes',\n          handler: () => {\n            dispatch({ type: DELETE_SPECTRA });\n          },\n        },\n        { text: 'No' },\n      ],\n    });\n  }, [dispatch, modal]);\n\n  const showAllSpectrumsHandler = useCallback(() => {\n    const spectrumsPerTab = spectrums.map((datum) => {\n      return datum.id;\n    });\n    dispatch({ type: CHANGE_VISIBILITY, id: spectrumsPerTab });\n  }, [dispatch, spectrums]);\n\n  const hideAllSpectrumsHandler = useCallback(() => {\n    dispatch({ type: CHANGE_VISIBILITY, id: [] });\n  }, [dispatch]);\n\n  const addMissingProjectionHandler = useCallback(() => {\n    function getMissingProjection(SpectrumsData) {\n      let nucleus = activeTab.split(',');\n      nucleus = nucleus[0] === nucleus[1] ? [nucleus[0]] : nucleus;\n      const missingNucleus = [];\n      for (const n of nucleus) {\n        const hasSpectrums = SpectrumsData.some((d) => d.info.nucleus === n);\n        if (!hasSpectrums) {\n          missingNucleus.push(n);\n        }\n      }\n      return missingNucleus;\n    }\n    const missingNucleus = getMissingProjection(data);\n    if (missingNucleus.length > 0) {\n      dispatch({ type: ADD_MISSING_PROJECTION, nucleus: missingNucleus });\n    } else {\n      alert.error('Nothing to calculate');\n    }\n  }, [activeTab, alert, data, dispatch]);\n\n  const setSameTopHandler = useCallback(() => {\n    dispatch({ type: SET_SPECTRA_SAME_TOP });\n  }, [dispatch]);\n  const resetScaleHandler = useCallback(() => {\n    dispatch({ type: RESET_SPECTRA_SCALE });\n  }, [dispatch]);\n\n  return (\n    <DefaultPanelHeader\n      onDelete={handleDelete}\n      counter={spectrums && spectrums.length}\n      deleteToolTip=\"Delete all spectra\"\n    >\n      <Button popupTitle=\"Hide all spectra\" onClick={hideAllSpectrumsHandler}>\n        <FaEyeSlash />\n      </Button>\n      <Button popupTitle=\"Show all spectra\" onClick={showAllSpectrumsHandler}>\n        <FaEye />\n      </Button>\n      {activeSpectrum && activeTab && activeTab.split(',').length > 1 && (\n        <Button\n          popupTitle=\"Add missing projection\"\n          onClick={addMissingProjectionHandler}\n        >\n          <FaCreativeCommonsSamplingPlus />\n        </Button>\n      )}\n      {displayerMode === DISPLAYER_MODE.DM_1D && (\n        <>\n          <Button popupTitle=\"Reset Scale\" onClick={resetScaleHandler}>\n            <SvgNmrResetScale />\n          </Button>\n          <Button popupTitle=\"Same Top\" onClick={setSameTopHandler}>\n            <SvgNmrSameTop />\n          </Button>\n        </>\n      )}\n    </DefaultPanelHeader>\n  );\n}\n\nexport default SpectraWraper(memo(SpectraPanelHeader));\n","function getNucleusSum(input) {\n  const nucleus = input.split(',');\n  return nucleus.reduce((acc, i) => {\n    const additions = nucleus.length === 2 ? 100 : 0;\n    acc += Number(i.replace(/\\D/g, '')) + additions;\n    return acc;\n  }, 0);\n}\nconst GroupByInfoKey = (key) => (array, orderByNucleus = false) => {\n  const unorderedGroup = array.reduce((objectsByKeyValue, obj) => {\n    const value = obj.info[key];\n    objectsByKeyValue[value] = (objectsByKeyValue[value] || []).concat(obj);\n    return objectsByKeyValue;\n  }, {});\n\n  if (!orderByNucleus) {\n    return unorderedGroup;\n  } else {\n    return Object.keys(unorderedGroup)\n      .sort((a, b) => getNucleusSum(a) - getNucleusSum(b))\n      .reduce((acc, key) => {\n        acc[key] = unorderedGroup[key];\n        return acc;\n      }, {});\n  }\n};\n\nexport default GroupByInfoKey;\n","import { memo } from 'react';\n\nfunction ColorIndicator1D({ color, activated }) {\n  return (\n    <div\n      style={{\n        backgroundColor: color,\n        height: '12px',\n        width: '12px',\n        opacity: activated ? 1 : 0.1,\n        display: 'inline-block',\n      }}\n    />\n  );\n}\nfunction ColorIndicator2D({ positiveColor, negativeColor, activated }) {\n  return (\n    <svg\n      width=\"12\"\n      height=\"12\"\n      viewBox=\"0 0 12 12\"\n      opacity={activated ? 1 : 0.1}\n    >\n      <g>\n        <path d=\"M0,0H12L0,12Z\" fill={positiveColor} strokeWidth=\"0\" />\n        <path d=\"M12,12H0L12,0Z\" fill={negativeColor} strokeWidth=\"0\" />\n      </g>\n    </svg>\n  );\n}\n\nfunction ColorIndicator({ dimension, color, activated, onClick, style }) {\n  return (\n    <button style={style} type=\"button\" onClick={onClick}>\n      {dimension === 2 ? (\n        <ColorIndicator2D {...color} activated={activated} />\n      ) : (\n        <ColorIndicator1D activated={activated} {...color} />\n      )}\n    </button>\n  );\n}\n\nexport default memo(ColorIndicator);\n","import { SvgNmrPeaks } from 'cheminfo-font';\nimport React from 'react';\n\nfunction ShowHideMarkersButton({\n  data,\n  onChangeMarkersVisibility,\n  markersVisible,\n  style,\n}) {\n  const isMarkerVisible = (id) => {\n    return markersVisible.findIndex((v) => v.id === id) !== -1 ? true : false;\n  };\n\n  return (\n    <button\n      style={{\n        ...style,\n        opacity:\n          isMarkerVisible(data.id) && data.peaks && data.peaks.values.length > 0\n            ? 1\n            : 0.1,\n      }}\n      type=\"button\"\n      onClick={() => onChangeMarkersVisibility(data)}\n      disabled={data.peaks && data.peaks.values.length === 0}\n    >\n      <SvgNmrPeaks />\n    </button>\n  );\n}\n\nexport default ShowHideMarkersButton;\n","import React from 'react';\nimport { FaEye } from 'react-icons/fa';\n\nfunction ShowHideSpectrumButton({ data, onChangeVisibility, style }) {\n  const isVisible = (id, key) => {\n    return data ? data.display[key] : true;\n  };\n  return (\n    <>\n      {data.info.dimension === 1 && (\n        <button\n          style={style}\n          type=\"button\"\n          onClick={() => onChangeVisibility(data, 'isVisible')}\n        >\n          <FaEye\n            style={{\n              fill: data.display.color,\n\n              ...(isVisible(data.id, 'isVisible')\n                ? {\n                    opacity: 1,\n                    strokeWidth: '1px',\n                    fill: data.display.color,\n                  }\n                : {\n                    opacity: 0.1,\n                    fill: data.display.color,\n                  }),\n            }}\n          />\n        </button>\n      )}\n      {data.info.dimension === 2 && (\n        <div style={{ minWidth: '40px' }}>\n          <button\n            style={{ ...style, width: '20px', minWidth: '20px' }}\n            type=\"button\"\n            onClick={() => onChangeVisibility(data, 'isPositiveVisible')}\n          >\n            <FaEye\n              style={{\n                fill: data.display.positiveColor,\n                ...(isVisible(data.id, 'isPositiveVisible')\n                  ? {\n                      opacity: 1,\n                      strokeWidth: '1px',\n                      fill: data.display.positiveColor,\n                    }\n                  : {\n                      opacity: 0.1,\n                      fill: data.display.positiveColor,\n                    }),\n              }}\n            />\n          </button>\n          <button\n            style={{ ...style, width: '20px', minWidth: '20px' }}\n            type=\"button\"\n            onClick={() => onChangeVisibility(data, 'isNegativeVisible')}\n          >\n            <FaEye\n              style={{\n                fill: data.display.negativeColor,\n                ...(isVisible(data.id, 'isNegativeVisible')\n                  ? {\n                      opacity: 1,\n                      strokeWidth: '1px',\n                      fill: data.display.negativeColor,\n                    }\n                  : {\n                      opacity: 0.1,\n                      fill: data.display.negativeColor,\n                    }),\n              }}\n            />\n          </button>\n        </div>\n      )}\n    </>\n  );\n}\n\nexport default ShowHideSpectrumButton;\n","import { SvgNmrFid, SvgNmrFt, SvgNmr2D } from 'cheminfo-font';\nimport { memo } from 'react';\n\nimport ColorIndicator from './base/ColorIndicator';\nimport ShowHideMarkersButton from './base/ShowHideMarkersButton';\nimport ShowHideSpectrumButton from './base/ShowHideSpectrumButton';\n\nconst styles = {\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n    width: '26px',\n    minWidth: '26px',\n  },\n  row: {\n    display: 'flex',\n    alignContent: 'center',\n    height: '25px',\n    borderBottom: '0.55px solid #f1f1f1',\n  },\n  name: {\n    flex: 1,\n    height: '100%',\n    display: 'flex',\n  },\n  info: {\n    flex: '1 1 1px',\n    height: '100%',\n    display: 'block',\n    alignItems: 'center',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    lineHeight: '24px',\n  },\n  icon: {\n    display: 'flex',\n    margin: 'auto',\n    justifyContent: 'center',\n  },\n};\n\nfunction SpectrumListItem({\n  activeSpectrum,\n  markersVisible,\n  data,\n  onChangeVisibility,\n  onChangeMarkersVisibility,\n  onChangeActiveSpectrum,\n  onOpenSettingModal,\n  onContextMenu,\n}) {\n  const formatValueAsHTML = (value) => {\n    if (value) {\n      // eslint-disable-next-line prefer-named-capture-group\n      value = value.replace(/([0-9]+)/g, '<sub>$1</sub>');\n    }\n    return value;\n  };\n  const activated = activeSpectrum && activeSpectrum.id === data.id;\n  const { color, name, positiveColor, negativeColor } = data.display;\n  return (\n    <div\n      style={{\n        ...styles.row,\n        ...(activated\n          ? { backgroundColor: '#fafafa' }\n          : { opacity: activeSpectrum ? 0.2 : 1 }),\n      }}\n      onContextMenu={onContextMenu}\n    >\n      <ShowHideSpectrumButton\n        data={data}\n        onChangeVisibility={onChangeVisibility}\n        style={styles.button}\n      />\n\n      <div style={styles.name} onClick={() => onChangeActiveSpectrum(data)}>\n        <div style={{ ...styles.icon, width: '16px' }}>\n          {data.info.isFid ? (\n            <SvgNmrFid />\n          ) : data.info.dimension === 2 ? (\n            <SvgNmr2D />\n          ) : (\n            <SvgNmrFt />\n          )}\n        </div>\n        <span style={styles.info}>{name}</span>\n        <div\n          style={styles.info}\n          // eslint-disable-next-line react/no-danger\n          dangerouslySetInnerHTML={{\n            __html: data.info && formatValueAsHTML(data.info.solvent),\n          }}\n        />\n        <span style={styles.info}>\n          <span\n            style={{\n              borderLeft: '0.55px solid #e5e5e5',\n              paddingRight: '5px',\n            }}\n          />\n          {data.info && data.info.experiment}\n        </span>\n\n        {/* {data.info && data.info.solvent} */}\n        {/* </div> */}\n        <span style={styles.info}>{data.info && data.info.pulse}</span>\n      </div>\n\n      <ShowHideMarkersButton\n        data={data}\n        style={{\n          ...styles.icon,\n          ...styles.button,\n        }}\n        onChangeMarkersVisibility={onChangeMarkersVisibility}\n        markersVisible={markersVisible}\n      />\n      <ColorIndicator\n        style={styles.button}\n        dimension={data.info.dimension}\n        color={{ positiveColor, color, negativeColor }}\n        activated={activated}\n        onClick={(event) => onOpenSettingModal(data, event)}\n      />\n    </div>\n  );\n}\n\nSpectrumListItem.defaultProps = {\n  onContextMenu: () => null,\n};\n\nexport default memo(SpectrumListItem);\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, memo } from 'react';\nimport { SketchPicker } from 'react-color';\n\nimport { COLORS } from '../../../data/utilities/getColor';\n\nfunction FormikColorPicker({ onColorChange, name, ...props }) {\n  const { values, setFieldValue } = useFormikContext();\n\n  const colorchangeHandler = useCallback(\n    (color) => {\n      onColorChange(color);\n      setFieldValue(\n        name,\n        `${color.hex}${Math.round(color.rgb.a * 255).toString(16)}`,\n      );\n    },\n    [name, onColorChange, setFieldValue],\n  );\n\n  return (\n    <SketchPicker\n      color={{ hex: lodashGet(values, name, '#000') }}\n      presetColors={COLORS}\n      onChangeComplete={(e) => colorchangeHandler(e)}\n      {...props}\n    />\n  );\n}\n\nFormikColorPicker.defaultProps = {\n  onColorChange: () => null,\n};\n\nexport default memo(FormikColorPicker);\n","import { xHistogram, xAbsolute, xMinMaxValues } from 'ml-spectra-processing';\nimport { memo, useMemo } from 'react';\nimport { Axis, BarSeries, Heading, Plot } from 'react-plot';\n\nconst Spectrum2DHistogram = memo(({ color = 'red', data }) => {\n  const histogramData = useMemo(() => {\n    const array = prepareData(data.re);\n    const result = xHistogram(array, {\n      logBaseX: 10,\n      logBaseY: 2,\n      nbSlots: 100,\n    });\n    return result.x.reduce((acc, value, index) => {\n      acc.push({ x: value, y: result.y[index] });\n      return acc;\n    }, []);\n  }, [data.re]);\n\n  return (\n    <div\n      style={{\n        borderTop: '1px solid #ededed',\n        marginTop: '10px',\n        paddingTop: '10px',\n      }}\n    >\n      <Plot\n        width={220}\n        height={200}\n        margin={{ bottom: 50, left: 10, top: 30, right: 10 }}\n        // seriesViewportStyle={{ stroke: 'gray' }}\n      >\n        <Heading title=\"Histogram\" />\n        <BarSeries\n          data={histogramData}\n          xAxis=\"x\"\n          yAxis=\"y\"\n          lineStyle={{\n            stroke: color,\n          }}\n          markerStyle={{\n            fill: color,\n            stroke: color,\n          }}\n        />\n        <Axis\n          id=\"x\"\n          position=\"bottom\"\n          displayGridLines\n          tickStyle={{ fontSize: '0.7rem' }}\n        />\n        <Axis id=\"y\" position=\"left\" displayGridLines hidden />\n      </Plot>\n    </div>\n  );\n});\n\nexport default Spectrum2DHistogram;\n\nfunction prepareData(array) {\n  array = xAbsolute(array);\n  // we will shift of the minValue that is not 0\n  let { min, max } = xMinMaxValues(array);\n  if (min < 1) {\n    if (max > 1e6) min = 1;\n  }\n  for (let i = 0; i < array.length; i++) {\n    array[i] += min;\n  }\n  return array;\n}\n","import { useCallback, useRef } from 'react';\n\nimport FormikColorPicker from '../../../../elements/formik/FormikColorPicker';\nimport FormikForm from '../../../../elements/formik/FormikForm';\n\nimport Spectrum1DHistogram from './Spectrum1DHistogram';\n\nfunction Spectrum1DSetting({ data: SpectrumData, onSubmit }) {\n  const refForm = useRef();\n\n  const triggerSubmitHandler = useCallback(() => {\n    if (refForm.current) {\n      refForm.current.submitForm();\n    }\n  }, []);\n\n  return (\n    <FormikForm\n      ref={refForm}\n      initialValues={SpectrumData.display}\n      onSubmit={onSubmit}\n    >\n      <div>\n        <FormikColorPicker name=\"color\" onColorChange={triggerSubmitHandler} />\n        <Spectrum1DHistogram color=\"red\" data={SpectrumData.data} />\n      </div>\n    </FormikForm>\n  );\n}\n\nexport default Spectrum1DSetting;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, memo } from 'react';\nimport ReactSlider from 'react-slider';\n\nfunction FormikSlider({ onAfterChange, name, ...props }) {\n  const { values, setFieldValue } = useFormikContext();\n\n  const changeHandler = useCallback(\n    (value) => {\n      onAfterChange(value);\n      setFieldValue(name, value);\n    },\n    [name, onAfterChange, setFieldValue],\n  );\n\n  return (\n    <ReactSlider\n      className=\"horizontal-slider\"\n      thumbClassName=\"thumb\"\n      trackClassName=\"track\"\n      defaultValue={lodashGet(values, name, [0, 100])}\n      onAfterChange={changeHandler}\n      // ariaLabel={['Lower thumb', 'Upper thumb']}\n      // ariaValuetext={(state) => ` ${state.valueNow}`}\n      renderThumb={(props, state) => (\n        <div {...props}>\n          <span>{state.valueNow}</span>\n        </div>\n      )}\n      pearling\n      minDistance={10}\n      {...props}\n    />\n  );\n}\n\nFormikSlider.defaultProps = {\n  onColorChange: () => null,\n};\n\nexport default memo(FormikSlider);\n","import {\n  matrixHistogram,\n  xAbsolute,\n  matrixMinMaxZ,\n} from 'ml-spectra-processing';\nimport { memo, useMemo } from 'react';\nimport { Axis, BarSeries, Heading, Plot } from 'react-plot';\n\nconst Spectrum1DHistogram = memo(({ color = 'red', data }) => {\n  const histogramData = useMemo(() => {\n    let matrix = prepareData(data.z);\n\n    const result = matrixHistogram(matrix, {\n      logBaseX: 10,\n      logBaseY: 2,\n      nbSlots: 256,\n    });\n    return result.x.reduce((acc, value, index) => {\n      acc.push({ x: value, y: result.y[index] });\n      return acc;\n    }, []);\n  }, [data.z]);\n\n  return (\n    <div\n      style={{\n        borderTop: '1px solid #ededed',\n        marginTop: '10px',\n        paddingTop: '10px',\n      }}\n    >\n      <Plot\n        width={450}\n        height={200}\n        margin={{ bottom: 50, left: 10, top: 30, right: 10 }}\n        // seriesViewportStyle={{ stroke: 'gray' }}\n      >\n        <Heading title=\"Histogram\" />\n        <BarSeries\n          data={histogramData}\n          xAxis=\"x\"\n          yAxis=\"y\"\n          lineStyle={{\n            stroke: color,\n          }}\n          markerStyle={{\n            fill: color,\n            stroke: color,\n          }}\n        />\n        <Axis\n          id=\"x\"\n          position=\"bottom\"\n          displayGridLines\n          tickStyle={{ fontSize: '0.7rem' }}\n        />\n        <Axis id=\"y\" position=\"left\" displayGridLines hidden />\n      </Plot>\n    </div>\n  );\n});\n\nexport default Spectrum1DHistogram;\n\nfunction prepareData(existingMatrix) {\n  const matrix = [];\n  for (let row of existingMatrix) {\n    matrix.push(xAbsolute(row));\n  }\n  // we will shift the minValue that is not 0\n  let { min, max } = matrixMinMaxZ(matrix);\n  if (min < 1) {\n    if (max > 1e6) min = 1;\n  }\n\n  for (let row of matrix) {\n    for (let i = 0; i < row.length; i++) {\n      row[i] += min;\n    }\n  }\n\n  return matrix;\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useRef } from 'react';\n\nimport FormikColorPicker from '../../../../elements/formik/FormikColorPicker';\nimport FormikForm from '../../../../elements/formik/FormikForm';\nimport FormikInput from '../../../../elements/formik/FormikInput';\nimport FormikSlider from '../../../../elements/formik/FormikSlider';\n\nimport Spectrum2DHistogram from './Spectrum2DHistogram';\n\nfunction Spectrum2DSetting({ data: SpectrumData, onSubmit }) {\n  const refForm = useRef();\n\n  const style = css`\n    .positive {\n      display: inline-block;\n      .track-1 {\n        background-color: ${SpectrumData.display.positiveColor} !important;\n      }\n    }\n    .negative {\n      display: inline-block;\n\n      .track-1 {\n        background-color: ${SpectrumData.display.negativeColor} !important;\n      }\n    }\n  `;\n\n  const triggerSubmitHandler = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  return (\n    <FormikForm\n      ref={refForm}\n      initialValues={SpectrumData.display}\n      onSubmit={onSubmit}\n    >\n      <div css={style}>\n        <div className=\"positive\">\n          <span style={{ padding: '0 10px' }}>Positive</span>\n          <FormikColorPicker\n            name=\"positiveColor\"\n            onColorChange={triggerSubmitHandler}\n          />\n          <div style={{ padding: '5px' }}>\n            <span className=\"label\">contour Levels [ min - max ]</span>\n            <FormikSlider\n              name=\"contourOptions.positive.contourLevels\"\n              onAfterChange={triggerSubmitHandler}\n            />\n            <span className=\"label\">number of Layers </span>\n            <FormikInput\n              name=\"contourOptions.positive.numberOfLayers\"\n              onChange={triggerSubmitHandler}\n              type=\"number\"\n            />\n          </div>\n        </div>\n        <div className=\"negative\">\n          <span style={{ padding: '0 10px' }}>Negative</span>\n          <FormikColorPicker\n            name=\"negativeColor\"\n            onColorChange={triggerSubmitHandler}\n          />\n          <div style={{ padding: '5px' }}>\n            <span className=\"label\">contour Levels [ min - max ]</span>\n            <FormikSlider\n              name=\"contourOptions.negative.contourLevels\"\n              onAfterChange={triggerSubmitHandler}\n            />\n            <span className=\"label\">number of Layers </span>\n            <FormikInput\n              name=\"contourOptions.negative.numberOfLayers\"\n              onChange={triggerSubmitHandler}\n              type=\"number\"\n            />\n          </div>\n        </div>\n        <Spectrum2DHistogram data={SpectrumData.data} />\n      </div>\n    </FormikForm>\n  );\n}\n\nexport default Spectrum2DSetting;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo, useCallback } from 'react';\n\nimport { useDispatch } from '../../../../context/DispatchContext';\nimport { CHANGE_SPECTRUM_SETTING } from '../../../../reducer/types/Types';\n\nimport Spectrum1DSetting from './Spectrum1DSetting';\nimport Spectrum2DSetting from './Spectrum2DSetting';\n\nconst style = css`\n  position: fixed;\n  z-index: 999999999;\n  width:100%;\n  height:100%;\n  left:0;\n  top:0;\n  .ineer-conatiner{\n    position:absolute;\n    display: flex;\n    flex-direction: row-reverse;\n    border-radius: 4px;\n    background-color: white;\n    box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 0px 1px,\n      rgba(0, 0, 0, 0.15) 0px 8px 16px;\n      overflow: auto;\n      height: 350px;\n  }\n\n\n  .sketch-picker {\n    border-radius: none !important;\n    box-shadow: none !important;\n  }\n\n\n  .horizontal-slider {\n    width: 80%;\n    height: 15px;\n  }\n\n  .thumb {\n    height: 15px;\n    line-height: 15px;\n    width: 20px;\n    text-align: center;\n    color: black;\n    border-radius: 5px;\n    cursor: grab;\n    font-size: 10px;\n    background-image: -webkit-linear-gradient(top, #f4f1ee, #fff);\n    background-image: linear-gradient(top, #f4f1ee, #fff);\n  }\n\n  .track {\n    top: 0;\n    bottom: 0;\n    background: #eaeaea;\n    border-radius: 999px;\n    border-radius: 5px;\n  }\n\n  .track-1 {\n    background: red;\n  }\n   \n  .label{\n    font-size: 12px;\n    margin: 8px 0;\n    display: block;\n  }\n \n  }\n`;\nfunction SpectrumSetting({ position, data, onClose }) {\n  const dispatch = useDispatch();\n  const { id, info } = data;\n  const submitHandler = useCallback(\n    (values) => {\n      dispatch({ type: CHANGE_SPECTRUM_SETTING, id, display: values });\n    },\n    [dispatch, id],\n  );\n\n  const clickHandler = useCallback(\n    (e) => {\n      if (e.target === e.currentTarget) {\n        onClose();\n      }\n    },\n    [onClose],\n  );\n\n  const { x, y } = position;\n  return (\n    <div css={style} onClick={clickHandler}>\n      <div\n        className=\"ineer-conatiner\"\n        style={{\n          left: info.dimension === 2 ? x - 450 : x - 220,\n          padding: info.dimension === 2 ? '10px 0' : '',\n          top: y,\n        }}\n      >\n        {info.dimension === 2 ? (\n          <Spectrum2DSetting onSubmit={submitHandler} data={data} />\n        ) : (\n          <Spectrum1DSetting onSubmit={submitHandler} data={data} />\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction arePropsEqual() {\n  return true;\n}\n\nexport default memo(SpectrumSetting, arePropsEqual);\n","import {\n  useCallback,\n  useState,\n  useMemo,\n  useRef,\n  Fragment,\n  useEffect,\n} from 'react';\n\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport { useDispatch } from '../../context/DispatchContext';\nimport ContextMenu from '../../elements/ContextMenu';\nimport { Tabs } from '../../elements/Tab';\nimport { useAlert } from '../../elements/popup/Alert';\nimport SpectraWraper from '../../hoc/SpectraWraper';\nimport {\n  CHANGE_PEAKS_MARKERS_VISIBILITY,\n  SET_ACTIVE_TAB,\n  CHANGE_VISIBILITY,\n  CHANGE_ACTIVE_SPECTRUM,\n  DELETE_SPECTRA,\n} from '../../reducer/types/Types';\nimport { copyTextToClipboard } from '../../utility/Export';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\n\nimport SpectrumListItem from './SpectrumListItem';\nimport SpectrumSetting from './base/setting/SpectrumSetting';\n\nfunction SpectrumsTabs({ data, activeSpectrum, activeTab, onTabChange }) {\n  const contextRef = useRef();\n  const [markersVisible, setMarkersVisible] = useState([]);\n  const [selectedSpectrumData, setSelectedSpectrum] = useState(null);\n  const [settingModalPosition, setSettingModalPosition] = useState(null);\n  const [isSettingModalDisplayed, setIsSettingModalDisplayed] = useState(false);\n\n  const alert = useAlert();\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (data) {\n      const visibleMarkers = data\n        ? data.filter((d) => d.display.isPeaksMarkersVisible === true)\n        : [];\n\n      setMarkersVisible(visibleMarkers);\n    }\n  }, [data, dispatch]);\n\n  const spectrumsGroupByNucleus = useMemo(() => {\n    if (!data) return [];\n    const groupByNucleus = GroupByInfoKey('nucleus');\n    return groupByNucleus(data, true);\n  }, [data]);\n\n  useEffect(() => {\n    onTabChange({\n      tab: activeTab,\n      data: spectrumsGroupByNucleus[activeTab],\n    });\n  }, [activeTab, onTabChange, spectrumsGroupByNucleus]);\n\n  const handleChangeMarkersVisibility = useCallback(\n    (d) => {\n      const currentIndex = markersVisible.findIndex((v) => v.id === d.id);\n      const newChecked = [...markersVisible];\n      if (currentIndex === -1) {\n        newChecked.push({ id: d.id });\n      } else {\n        newChecked.splice(currentIndex, 1);\n      }\n      dispatch({ type: CHANGE_PEAKS_MARKERS_VISIBILITY, data: newChecked });\n      setMarkersVisible(newChecked);\n    },\n    [dispatch, markersVisible],\n  );\n\n  const onTabChangeHandler = useCallback(\n    (tab) => {\n      onTabChange({\n        tab: tab.tabid,\n        data: spectrumsGroupByNucleus[tab.tabid],\n      });\n\n      dispatch({ type: SET_ACTIVE_TAB, tab: tab.tabid });\n    },\n    [dispatch, onTabChange, spectrumsGroupByNucleus],\n  );\n\n  const contextMenu = useMemo(\n    () => [\n      {\n        label: 'Copy to Clipboard',\n        onClick: (spectrumData) => {\n          const { x, y, info } = spectrumData;\n          const success = copyTextToClipboard(\n            JSON.stringify({ x, y, info }, undefined, 2),\n          );\n\n          if (success) {\n            alert.success('Data copied to clipboard');\n          } else {\n            alert.error('Copy to clipboard failed');\n          }\n        },\n      },\n      {\n        label: 'Delete',\n        onClick: (spectrumData) => {\n          setTimeout(() => {\n            dispatch({ type: DELETE_SPECTRA, id: spectrumData.id });\n          }, 0);\n        },\n      },\n    ],\n    [alert, dispatch],\n  );\n\n  const contextMenuHandler = useCallback(\n    (e, rowData) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, rowData);\n      }\n    },\n    [contextRef],\n  );\n\n  const openSettingHandler = useCallback((selectedSpectrum, event) => {\n    setSettingModalPosition({\n      x: event.nativeEvent.clientX,\n      y: event.nativeEvent.clientY,\n    });\n    setSelectedSpectrum(selectedSpectrum);\n    setIsSettingModalDisplayed(true);\n  }, []);\n\n  const handleChangeVisibility = useCallback(\n    (d, key) => {\n      dispatch({\n        type: CHANGE_VISIBILITY,\n        id: d.id,\n        key,\n        value: !d.display[key],\n      });\n    },\n    [dispatch],\n  );\n\n  const handleChangeActiveSpectrum = useCallback(\n    (d) => {\n      setTimeout(() => {\n        if (activeSpectrum && activeSpectrum.id === d.id) {\n          dispatch({ type: CHANGE_ACTIVE_SPECTRUM, data: null });\n        } else {\n          dispatch({ type: CHANGE_ACTIVE_SPECTRUM, data: { id: d.id } });\n        }\n      }, 0);\n    },\n    [activeSpectrum, dispatch],\n  );\n\n  const mouseLeaveHandler = useCallback(() => {\n    setIsSettingModalDisplayed(false);\n  }, []);\n\n  return (\n    <Fragment>\n      <Tabs defaultTabID={activeTab} onClick={onTabChangeHandler}>\n        {spectrumsGroupByNucleus &&\n          Object.keys(spectrumsGroupByNucleus).map((group) => (\n            <div\n              tablabel={group}\n              tabid={group}\n              key={group}\n              style={{ overflow: 'auto', height: '100%' }}\n            >\n              {spectrumsGroupByNucleus[group] &&\n                spectrumsGroupByNucleus[group].map((d) => (\n                  <SpectrumListItem\n                    key={d.id}\n                    activeSpectrum={activeSpectrum}\n                    // activated={\n                    //   activeSpectrum && activeSpectrum.id === d.id\n                    //     ? true\n                    //     : false\n                    // }\n                    markersVisible={markersVisible}\n                    data={d}\n                    onChangeVisibility={handleChangeVisibility}\n                    onChangeMarkersVisibility={handleChangeMarkersVisibility}\n                    onChangeActiveSpectrum={handleChangeActiveSpectrum}\n                    onOpenSettingModal={openSettingHandler}\n                    onContextMenu={(e) => contextMenuHandler(e, d)}\n                  />\n                ))}\n            </div>\n          ))}\n      </Tabs>\n      <ContextMenu ref={contextRef} context={contextMenu} />\n\n      {isSettingModalDisplayed ? (\n        <SpectrumSetting\n          onClose={mouseLeaveHandler}\n          data={selectedSpectrumData}\n          position={settingModalPosition}\n        />\n      ) : null}\n    </Fragment>\n  );\n}\n\nexport default SpectraWraper(SpectrumsTabs);\n","import React, { useCallback, memo, useState } from 'react';\n\nimport SpectraPanelHeader from './SpectraPanelHeader';\nimport SpectrumsTabs from './SpectrumsTabs';\n\nconst styles = {\n  overflow: 'hidden',\n  height: '100%',\n  display: 'flex',\n  flexDirection: 'column',\n};\n\nfunction SpectrumListPanel({\n  data,\n  activeSpectrum,\n  activeTab: activeTabState,\n}) {\n  const [spectrums, setSpectrums] = useState([]);\n\n  const tabChangeHandler = useCallback((e) => {\n    setSpectrums(e.data ? e.data : []);\n  }, []);\n\n  return (\n    <div style={styles}>\n      <SpectraPanelHeader spectrums={spectrums} />\n      <SpectrumsTabs\n        onTabChange={tabChangeHandler}\n        data={data}\n        activeSpectrum={activeSpectrum}\n        activeTab={activeTabState}\n      />\n    </div>\n  );\n}\n\nexport default memo(SpectrumListPanel);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport { useCallback } from 'react';\n\nconst arrowDownIcon = `url('data:image/svg+xml;utf8,<svg  xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"960px\" height=\"560px\" viewBox=\"0 0 960 560\" enable-background=\"new 0 0 960 560\" xml:space=\"preserve\"><g id=\"Rounded_Rectangle_33_copy_4_1_\"><path d=\"M480,344.181L268.869,131.889c-15.756-15.859-41.3-15.859-57.054,0c-15.754,15.857-15.754,41.57,0,57.431l237.632,238.937c8.395,8.451,19.562,12.254,30.553,11.698c10.993,0.556,22.159-3.247,30.555-11.698l237.631-238.937c15.756-15.86,15.756-41.571,0-57.431s-41.299-15.859-57.051,0L480,344.181z\"/></g></svg>')`;\n\nfunction SelectUncontrolled({ data, style, onChange, value }) {\n  const handleOnChanged = useCallback(\n    (e) => {\n      onChange(e.target.value);\n    },\n    [onChange],\n  );\n\n  const styles = css`\n    position: relative;\n    padding: 0px 5px;\n    border: 0.55px solid #cacaca;\n    font-size: 14px;\n    width: ${style.width ? style.width - 5 : 95}px;\n    margin: 0;\n    height: 100%;\n    background: ${arrowDownIcon} no-repeat right white;\n    -webkit-appearance: none;\n    background-position-x: ${style.width ? style.width - 18 : 95 - 18}px;\n    background-size: 15px 15px;\n    border-radius: 5px;\n    margin: 0px 5px;\n    :focus,\n    input:focus {\n      outline: none;\n    }\n  `;\n\n  return (\n    <select css={[styles, style]} onChange={handleOnChanged} value={value}>\n      {data.map((d) => (\n        <option\n          key={`${d.key}`}\n          value={d.value}\n          // selected={d.value === defaultValue ? 'selected' : ''}\n        >\n          {d.label}\n        </option>\n      ))}\n    </select>\n  );\n}\n\nSelectUncontrolled.propTypes = {\n  onChange: PropTypes.func,\n  data: PropTypes.array.isRequired,\n  style: PropTypes.any,\n  value: PropTypes.any,\n};\n\nSelectUncontrolled.defaultProps = {\n  onChange: function () {\n    return null;\n  },\n};\n\nexport default SelectUncontrolled;\n","// error colors in priority order\nconst ErrorColors = [\n  { key: 'outOfLimit', color: 'red' },\n  { key: 'ambiguousAttachment', color: 'orange' },\n  { key: 'notAttached', color: 'blue' },\n  { key: 'incomplete', color: 'red' },\n];\n\nconst Errors = ErrorColors.map((errorColor) => errorColor.key);\n\nconst Hybridizations = [\n  {\n    key: '-',\n    label: '',\n    value: '',\n  },\n  {\n    key: 'sp',\n    label: 'sp',\n    value: 'SP',\n  },\n  {\n    key: 'sp2',\n    label: 'sp2',\n    value: 'SP2',\n  },\n  {\n    key: 'sp3',\n    label: 'sp3',\n    value: 'SP3',\n  },\n];\n\nconst DefaultTolerance = {\n  C: 0.25,\n  H: 0.02,\n  N: 0.25,\n  F: 0.25,\n  Si: 0.25,\n  P: 0.25,\n};\n\nexport { DefaultTolerance, Errors, ErrorColors, Hybridizations };\n","import lodashGet from 'lodash/get';\n\nimport { ErrorColors, Errors } from './CorrelationTable/Constants';\n\nfunction getAtomType(nucleus) {\n  return nucleus.split(/\\d+/)[1];\n}\n\nfunction getLabelColor(correlationData, correlation) {\n  const error = lodashGet(\n    correlationData,\n    `state.${correlation.atomType}.error`,\n    null,\n  );\n  if (error) {\n    for (let errorIndex in Errors) {\n      if (\n        ErrorColors[errorIndex].key !== 'incomplete' && // do not consider this for a single atom type\n        (ErrorColors[errorIndex].key === 'notAttached' ||\n          ErrorColors[errorIndex].key === 'ambiguousAttachment') &&\n        lodashGet(error, `${ErrorColors[errorIndex].key}`, []).some(\n          (index) => correlationData.values[index].id === correlation.id,\n        )\n      ) {\n        return ErrorColors[errorIndex].color;\n      }\n    }\n  }\n\n  return null;\n}\n\nfunction findSpectrum(spectraData, value) {\n  return spectraData.filter(\n    (_spectrum) =>\n      _spectrum.id === value.experimentID &&\n      _spectrum.display.isVisible === true,\n  )[0];\n}\n\nfunction findSignal(spectrum, value) {\n  for (let i = 0; i < spectrum.zones.values.length; i++) {\n    const signalIndex = spectrum.zones.values[i].signal.findIndex(\n      (_signal) => _signal.id === value.signal.id,\n    );\n    if (signalIndex >= 0) {\n      return spectrum.zones.values[i].signal[signalIndex];\n    }\n  }\n}\n\nfunction findRange(spectrum, value) {\n  for (let i = 0; i < spectrum.ranges.values.length; i++) {\n    const signalIndex = spectrum.ranges.values[i].signal.findIndex(\n      (_signal) => _signal.id === value.signal.id,\n    );\n    if (signalIndex >= 0) {\n      return spectrum.ranges.values[i];\n    }\n  }\n}\n\nfunction findZone(spectrum, value) {\n  for (let i = 0; i < spectrum.zones.values.length; i++) {\n    const signalIndex = spectrum.zones.values[i].signal.findIndex(\n      (_signal) => _signal.id === value.signal.id,\n    );\n    if (signalIndex >= 0) {\n      return spectrum.zones.values[i];\n    }\n  }\n}\n\nconst findRangeOrZoneID = (spectraData, value) => {\n  const spectrum = findSpectrum(spectraData, value);\n  if (spectrum) {\n    if (spectrum.info.dimension === 1) {\n      const range = findRange(spectrum, value);\n      if (range) return range.id;\n    } else if (spectrum.info.dimension === 2) {\n      const zone = findZone(spectrum, value);\n      if (zone) return zone.id;\n    }\n  }\n};\n\nfunction findSignalMatch1D(spectrum, link, factor, xDomain0, xDomain1) {\n  if (spectrum && spectrum.info.dimension === 2) {\n    const signal = findSignal(spectrum, link);\n    if (signal) {\n      const otherAxis = link.axis === 'x' ? 'y' : 'x';\n      return (\n        signal[otherAxis].delta * factor >= xDomain0 &&\n        signal[otherAxis].delta * factor <= xDomain1\n      );\n    }\n  }\n  return false;\n}\nfunction findSignalMatch2D(\n  spectrum,\n  value,\n  factor,\n  xDomain0,\n  xDomain1,\n  yDomain0,\n  yDomain1,\n) {\n  if (spectrum && spectrum.info.dimension === 2) {\n    const signal = findSignal(spectrum, value);\n    if (signal) {\n      return (\n        signal.x.delta * factor >= xDomain0 &&\n        signal.x.delta * factor <= xDomain1 &&\n        signal.y.delta * factor >= yDomain0 &&\n        signal.y.delta * factor <= yDomain1\n      );\n    }\n  }\n  return false;\n}\n\nexport {\n  findRange,\n  findRangeOrZoneID,\n  findSignalMatch1D,\n  findSignalMatch2D,\n  findSpectrum,\n  findZone,\n  getAtomType,\n  getLabelColor,\n};\n","/** @jsxImportSource @emotion/react */\nimport { useCallback, useMemo } from 'react';\n\nimport { buildID } from '../../../../data/utilities/Concatenation';\nimport { useHighlight } from '../../../highlight';\nimport { findRangeOrZoneID, getLabelColor } from '../Utilities';\n\nfunction AdditionalColumnHeader({\n  spectraData,\n  correlationsData,\n  correlation,\n}) {\n  const highlightIDsAdditionalColumn = useMemo(() => {\n    if (correlation.pseudo === true) {\n      return [];\n    }\n    const ids = [\n      correlation.signal.id,\n      buildID(correlation.signal.id, 'Crosshair_X'),\n    ];\n    const id = findRangeOrZoneID(spectraData, correlation);\n    if (id) {\n      ids.push(id);\n    }\n    correlation.link.forEach((link) => {\n      if (link.pseudo === false) {\n        ids.push(link.signal.id);\n        ids.push(buildID(link.signal.id, 'Crosshair_X'));\n        const _id = findRangeOrZoneID(spectraData, link);\n        if (_id) {\n          ids.push(_id);\n        }\n      }\n    });\n\n    return ids;\n  }, [correlation, spectraData]);\n  const highlightAdditionalColumn = useHighlight(highlightIDsAdditionalColumn);\n\n  const mouseEnterHandler = useCallback(\n    (event) => {\n      event.currentTarget.focus();\n      highlightAdditionalColumn.show();\n    },\n    [highlightAdditionalColumn],\n  );\n  const mouseLeaveHandler = useCallback(\n    (event) => {\n      event.currentTarget.blur();\n      highlightAdditionalColumn.hide();\n    },\n    [highlightAdditionalColumn],\n  );\n\n  const tableHeaderProps = useMemo(() => {\n    return {\n      style: {\n        ...{ color: getLabelColor(correlationsData, correlation) },\n        backgroundColor: highlightAdditionalColumn.isActive\n          ? '#ff6f0057'\n          : 'inherit',\n      },\n      title:\n        correlation.pseudo === false &&\n        [correlation.experimentType.toUpperCase()]\n          .concat(\n            correlation.link.reduce((arr, link) => {\n              if (\n                link.pseudo === false &&\n                link.experimentType !== correlation.experimentType &&\n                !arr.includes(link.experimentType.toUpperCase())\n              ) {\n                arr.push(link.experimentType.toUpperCase());\n              }\n              return arr;\n            }, []),\n          )\n          .sort()\n          .join('/'),\n      onMouseEnter: mouseEnterHandler,\n      onMouseLeave: mouseLeaveHandler,\n    };\n  }, [\n    correlation,\n    correlationsData,\n    highlightAdditionalColumn.isActive,\n    mouseEnterHandler,\n    mouseLeaveHandler,\n  ]);\n\n  const equivalenceTextStyle = useMemo(() => {\n    return correlation.edited.equivalence\n      ? { backgroundColor: '#F7F2E0' }\n      : {\n          color: Number.isInteger(correlation.equivalence)\n            ? correlation.equivalence === 1\n              ? '#bebebe'\n              : 'black'\n            : 'red',\n        };\n  }, [correlation]);\n\n  return (\n    <th {...tableHeaderProps}>\n      <div style={{ display: 'block' }}>\n        <p>{correlation.label.origin}</p>\n        <p>\n          {correlation && correlation.signal && correlation.signal.delta\n            ? correlation.signal.delta.toFixed(2)\n            : ''}\n        </p>\n        <p style={equivalenceTextStyle}>\n          {Number.isInteger(correlation.equivalence)\n            ? correlation.equivalence\n            : correlation.equivalence.toFixed(2)}\n        </p>\n      </div>\n    </th>\n  );\n}\n\nexport default AdditionalColumnHeader;\n","import lodashCloneDeep from 'lodash/cloneDeep';\nimport {\n  CorrelationUtilities,\n  GeneralUtilities,\n  LinkUtilities,\n} from 'nmr-correlation';\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\n\nimport { buildID } from '../../../../data/utilities/Concatenation';\nimport generateID from '../../../../data/utilities/generateID';\nimport ContextMenu from '../../../elements/ContextMenu';\nimport { useHighlight } from '../../../highlight';\nimport { findRangeOrZoneID } from '../Utilities';\n\nfunction AdditionalColumnField({\n  rowCorrelation,\n  columnCorrelation,\n  commonLinks,\n  correlations,\n  spectraData,\n  onEdit,\n}) {\n  const contextRef = useRef();\n  const [isEdited, setIsEdited] = useState(false);\n\n  const highlightIDsCommonLinks = useMemo(() => {\n    const ids = [];\n    commonLinks.forEach((link) => {\n      if (link.pseudo === false) {\n        ids.push(link.signal.id);\n        ids.push(buildID(link.signal.id, 'Crosshair'));\n        const _id = findRangeOrZoneID(spectraData, link);\n        if (_id) {\n          ids.push(_id);\n        }\n      }\n    });\n\n    return ids;\n  }, [commonLinks, spectraData]);\n  const highlightCommonLinks = useHighlight(highlightIDsCommonLinks);\n\n  const mouseEnterHandler = useCallback(\n    (event) => {\n      event.currentTarget.focus();\n      highlightCommonLinks.show();\n    },\n    [highlightCommonLinks],\n  );\n  const mouseLeaveHandler = useCallback(\n    (event) => {\n      event.currentTarget.blur();\n      highlightCommonLinks.hide();\n    },\n    [highlightCommonLinks],\n  );\n\n  useEffect(() => {\n    if (commonLinks.some((commonLink) => commonLink.pseudo === true)) {\n      setIsEdited(true);\n    } else {\n      setIsEdited(false);\n    }\n  }, [commonLinks]);\n\n  const contextMenuHandler = useCallback(\n    (e, rowData) => {\n      e.preventDefault();\n      contextRef.current.handleContextMenu(e, rowData);\n    },\n    [contextRef],\n  );\n\n  const onEditHandler = useCallback(\n    (experimentType, action, commonLink) => {\n      const _rowCorrelation = lodashCloneDeep(rowCorrelation);\n      const _columnCorrelation = lodashCloneDeep(columnCorrelation);\n      const pseudoLinkCountHSQC = _rowCorrelation.link.filter(\n        (link) =>\n          link.experimentType === 'hsqc' || link.experimentType === 'hmqc',\n      ).length;\n\n      if (action === 'add') {\n        const pseudoLinkID = generateID();\n        const pseudoExperimentID = generateID();\n        const pseudoCommonLink = LinkUtilities.buildLink({\n          experimentType,\n          experimentID: pseudoExperimentID,\n          atomType: [_columnCorrelation.atomType, _rowCorrelation.atomType],\n          id: pseudoLinkID,\n          pseudo: true,\n          signal: { id: generateID(), sign: 0 }, // pseudo signal\n        });\n\n        CorrelationUtilities.addLink(\n          _columnCorrelation,\n          LinkUtilities.buildLink({\n            ...pseudoCommonLink,\n            axis: 'x',\n            match: [\n              GeneralUtilities.getCorrelationIndex(\n                correlations,\n                _rowCorrelation,\n              ),\n            ],\n          }),\n        );\n        CorrelationUtilities.addLink(\n          _rowCorrelation,\n          LinkUtilities.buildLink({\n            ...pseudoCommonLink,\n            axis: 'y',\n            match: [\n              GeneralUtilities.getCorrelationIndex(\n                correlations,\n                _columnCorrelation,\n              ),\n            ],\n          }),\n        );\n        if (!_rowCorrelation.edited.protonsCount) {\n          _rowCorrelation.protonsCount = [pseudoLinkCountHSQC + 1];\n        }\n      } else if (action === 'remove') {\n        CorrelationUtilities.removeLink(_rowCorrelation, commonLink.id);\n        CorrelationUtilities.removeLink(_columnCorrelation, commonLink.id);\n        if (!_rowCorrelation.edited.protonsCount) {\n          _rowCorrelation.protonsCount =\n            pseudoLinkCountHSQC - 1 > 0 ? [pseudoLinkCountHSQC - 1] : [];\n        }\n      }\n\n      onEdit(_rowCorrelation, _columnCorrelation);\n    },\n    [rowCorrelation, onEdit, columnCorrelation, correlations],\n  );\n\n  const contextMenu = useMemo(() => {\n    // allow the edition of pseudo correlations and pseudo HSQC only (for now)\n    // assumption here that only one pseudo HSQC can be added to a pseudo correlation\n    const commonLinkHSQC = commonLinks.find(\n      (commonLink) =>\n        commonLink.experimentType === 'hsqc' && commonLink.pseudo === true,\n    );\n\n    return rowCorrelation.pseudo === true\n      ? commonLinkHSQC\n        ? [\n            {\n              label: 'remove HSQC',\n              onClick: () => {\n                onEditHandler('hsqc', 'remove', commonLinkHSQC);\n              },\n            },\n          ]\n        : [\n            {\n              label: 'add HSQC',\n              onClick: () => {\n                onEditHandler('hsqc', 'add');\n              },\n            },\n          ]\n      : [];\n  }, [commonLinks, onEditHandler, rowCorrelation]);\n\n  const content = useMemo(() => {\n    const linkSet = new Set();\n    commonLinks.forEach((commonLink) => {\n      if (\n        commonLink.experimentType === 'hsqc' ||\n        commonLink.experimentType === 'hmqc'\n      ) {\n        linkSet.add(\n          !commonLink.signal || commonLink.signal.sign === 0\n            ? 'S'\n            : `S${commonLink.signal.sign === 1 ? '+' : '-'}`,\n        );\n      } else if (\n        commonLink.experimentType === 'hmbc' ||\n        commonLink.experimentType === 'cosy' ||\n        commonLink.experimentType === 'tocsy'\n      ) {\n        linkSet.add('M');\n      } else if (\n        commonLink.experimentType === 'noesy' ||\n        commonLink.experimentType === 'roesy'\n      ) {\n        linkSet.add('NOE');\n      }\n    });\n\n    return [...linkSet];\n  }, [commonLinks]);\n\n  const title = useMemo(\n    () =>\n      commonLinks\n        .reduce((arr, link) => {\n          if (!arr.includes(link.experimentType.toUpperCase())) {\n            arr.push(link.experimentType.toUpperCase());\n          }\n          return arr;\n        }, [])\n        .sort()\n        .join('/'),\n    [commonLinks],\n  );\n\n  return (\n    <td\n      onContextMenu={(e) => {\n        if (contextMenu.length > 0) {\n          contextMenuHandler(e, rowCorrelation);\n        }\n      }}\n      style={{\n        backgroundColor: highlightCommonLinks.isActive\n          ? '#ff6f0057'\n          : isEdited\n          ? '#F7F2E0'\n          : 'inherit',\n      }}\n      title={title}\n      onMouseEnter={mouseEnterHandler}\n      onMouseLeave={mouseLeaveHandler}\n    >\n      {content.join('/')}\n      <ContextMenu ref={contextRef} context={contextMenu} />\n    </td>\n  );\n}\n\nexport default AdditionalColumnField;\n","import lodashGet from 'lodash/get';\nimport { LinkUtilities, GeneralUtilities } from 'nmr-correlation';\nimport { useCallback, useMemo } from 'react';\n\nimport { buildID } from '../../../../data/utilities/Concatenation';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport SelectUncontrolled from '../../../elements/SelectUncontrolled';\nimport { useHighlight } from '../../../highlight';\nimport { findRangeOrZoneID } from '../Utilities';\n\nimport AdditionalColumnField from './AdditionalColumnField';\nimport { Hybridizations } from './Constants';\n\nconst selectBoxStyle = {\n  marginLeft: 2,\n  marginRight: 2,\n  border: 'none',\n  height: '20px',\n};\n\nfunction CorrelationTableRow({\n  additionalColumnData,\n  correlations,\n  correlation,\n  styleRow,\n  styleLabel,\n  onSaveEditEquivalences,\n  onChangeHybridization,\n  onSaveEditProtonsCount,\n  onEditAdditionalColumnField,\n  spectraData,\n}) {\n  const highlightIDsRow = useMemo(() => {\n    if (correlation.pseudo === true) {\n      return [];\n    }\n    const ids = [\n      correlation.signal.id,\n      buildID(correlation.signal.id, 'Crosshair_Y'),\n    ];\n    const id = findRangeOrZoneID(spectraData, correlation);\n    if (id) {\n      ids.push(id);\n    }\n    correlation.link.forEach((link) => {\n      if (link.pseudo === false) {\n        ids.push(link.signal.id);\n        ids.push(buildID(link.signal.id, 'Crosshair_Y'));\n        const _id = findRangeOrZoneID(spectraData, link);\n        if (_id) {\n          ids.push(_id);\n        }\n      }\n    });\n\n    return ids;\n  }, [correlation, spectraData]);\n  const highlightRow = useHighlight(highlightIDsRow);\n\n  const onSaveEquivalencesHandler = useCallback(\n    (e) => {\n      onSaveEditEquivalences(correlation, e.target.value);\n    },\n    [correlation, onSaveEditEquivalences],\n  );\n\n  const onSaveProtonsCountHandler = useCallback(\n    (e) => {\n      onSaveEditProtonsCount(correlation, e.target.value);\n    },\n    [correlation, onSaveEditProtonsCount],\n  );\n\n  const additionalColumnFields = useMemo(() => {\n    return additionalColumnData.map((_correlation) => {\n      const commonLinks = [];\n      correlation.link.forEach((link) => {\n        _correlation.link.forEach((_link) => {\n          if (\n            link.axis !== _link.axis &&\n            link.experimentID === _link.experimentID &&\n            link.signal.id === _link.signal.id\n          ) {\n            let experimentLabel = link.experimentType;\n            if (link.signal && link.signal.sign !== 0) {\n              experimentLabel += ' (edited)';\n            }\n            commonLinks.push(\n              LinkUtilities.buildLink({\n                ...link,\n                experimentLabel,\n                axis: undefined,\n              }),\n            );\n          }\n        });\n      });\n\n      return (\n        <AdditionalColumnField\n          key={`addColData_${correlation.id}_${_correlation.id}`}\n          rowCorrelation={correlation}\n          columnCorrelation={_correlation}\n          commonLinks={commonLinks}\n          correlations={correlations}\n          spectraData={spectraData}\n          onEdit={onEditAdditionalColumnField}\n        />\n      );\n    });\n  }, [\n    additionalColumnData,\n    correlation,\n    correlations,\n    onEditAdditionalColumnField,\n    spectraData,\n  ]);\n\n  const onChangeHybridizationHandler = useCallback(\n    (value) => {\n      onChangeHybridization(correlation, value);\n    },\n    [correlation, onChangeHybridization],\n  );\n\n  const equivalenceCellStyle = useMemo(() => {\n    return correlation.edited.equivalence\n      ? { backgroundColor: '#F7F2E0' }\n      : {\n          color: correlation.equivalence === 1 ? '#bebebe' : 'black',\n        };\n  }, [correlation]);\n\n  const mouseEnterHandler = useCallback(\n    (event) => {\n      event.currentTarget.focus();\n      highlightRow.show();\n    },\n    [highlightRow],\n  );\n  const mouseLeaveHandler = useCallback(\n    (event) => {\n      event.currentTarget.blur();\n      highlightRow.hide();\n    },\n    [highlightRow],\n  );\n\n  const tableDataProps = useMemo(() => {\n    return {\n      style: {\n        ...styleRow,\n        backgroundColor: highlightRow.isActive ? '#ff6f0057' : 'inherit',\n      },\n      title:\n        correlation.pseudo === false &&\n        [correlation.experimentType.toUpperCase()]\n          .concat(\n            correlation.link.reduce((arr, link) => {\n              if (\n                link.pseudo === false &&\n                link.experimentType !== correlation.experimentType &&\n                !arr.includes(link.experimentType.toUpperCase())\n              ) {\n                arr.push(link.experimentType.toUpperCase());\n              }\n              return arr;\n            }, []),\n          )\n          .sort()\n          .join('/'),\n      onMouseEnter: mouseEnterHandler,\n      onMouseLeave: mouseLeaveHandler,\n    };\n  }, [\n    correlation.experimentType,\n    correlation.link,\n    correlation.pseudo,\n    highlightRow.isActive,\n    mouseEnterHandler,\n    mouseLeaveHandler,\n    styleRow,\n  ]);\n\n  return (\n    <tr style={styleRow}>\n      <td\n        {...{\n          ...tableDataProps,\n          style: { ...tableDataProps.style, styleLabel },\n        }}\n      >\n        {GeneralUtilities.getLabel(correlations, correlation)}\n      </td>\n      <td {...tableDataProps}>\n        {lodashGet(correlation.signal, 'delta', false)\n          ? correlation.signal.delta.toFixed(2)\n          : ''}\n      </td>\n      <td {...tableDataProps}>\n        {correlation.pseudo === false ? (\n          correlation.atomType !== 'H' ? (\n            <EditableColumn\n              type=\"number\"\n              value={correlation.equivalence}\n              style={equivalenceCellStyle}\n              onSave={onSaveEquivalencesHandler}\n            />\n          ) : (\n            <text style={equivalenceCellStyle}>{correlation.equivalence}</text>\n          )\n        ) : (\n          ''\n        )}\n      </td>\n      <td {...tableDataProps}>\n        {correlation.atomType !== 'H' ? (\n          <EditableColumn\n            type=\"text\"\n            value={correlation.protonsCount.join(',')}\n            style={\n              correlation.edited.protonsCount\n                ? { backgroundColor: '#F7F2E0' }\n                : {}\n            }\n            onSave={onSaveProtonsCountHandler}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n      <td\n        {...{\n          ...tableDataProps,\n          style: { ...tableDataProps.style, borderRight: '1px solid' },\n        }}\n      >\n        {correlation.atomType !== 'H' ? (\n          <SelectUncontrolled\n            onChange={onChangeHybridizationHandler}\n            data={Hybridizations}\n            value={correlation.hybridization}\n            style={{\n              ...selectBoxStyle,\n              backgroundColor: correlation.edited.hybridization\n                ? '#F7F2E0'\n                : styleRow.backgroundColor,\n              width: '50px',\n            }}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n      {additionalColumnFields}\n    </tr>\n  );\n}\n\nexport default CorrelationTableRow;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useMemo } from 'react';\n\nimport { getLabelColor } from '../Utilities';\n\nimport AdditionalColumnHeader from './AdditionalColumnHeader';\nimport CorrelationTableRow from './CorrelationTableRow';\n\nconst tableStyle = css`\n  overflow: auto;\n  height: 100%;\n  display: block;\n  table {\n    border-spacing: 0;\n    border: 1px solid #dedede;\n    width: 100%;\n    font-size: 12px;\n    height: 100%;\n  }\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  thead tr {\n    background-color: white !important;\n  }\n  th {\n    position: sticky;\n    background-color: white;\n    z-index: 2;\n    top: 0;\n  }\n\n  th,\n  td {\n    white-space: nowrap;\n    text-align: center;\n    margin: 0;\n    padding: 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n    }\n  }\n`;\n\nfunction CorrelationTable({\n  correlationsData,\n  filteredCorrelationsData,\n  additionalColumnData,\n  editEquivalencesSaveHandler,\n  changeHybridizationSaveHandler,\n  editProtonsCountSaveHandler,\n  editAdditionalColumnFieldSaveHandler,\n  showProtonsAsRows,\n  spectraData,\n}) {\n  const rows = useMemo(() => {\n    if (!filteredCorrelationsData) {\n      return [];\n    }\n\n    return filteredCorrelationsData.values\n      .filter((correlation) =>\n        showProtonsAsRows\n          ? correlation.atomType === 'H'\n          : correlation.atomType !== 'H',\n      )\n      .map((correlation) => (\n        <CorrelationTableRow\n          additionalColumnData={additionalColumnData}\n          correlations={correlationsData.values}\n          correlation={correlation}\n          key={`correlation${correlation.atomType}${correlation.id}`}\n          styleRow={{ backgroundColor: 'mintcream' }}\n          styleLabel={\n            correlation.atomType === 'H'\n              ? {\n                  color: getLabelColor(correlationsData, correlation),\n                }\n              : {}\n          }\n          onSaveEditEquivalences={editEquivalencesSaveHandler}\n          onChangeHybridization={changeHybridizationSaveHandler}\n          onSaveEditProtonsCount={editProtonsCountSaveHandler}\n          onEditAdditionalColumnField={editAdditionalColumnFieldSaveHandler}\n          spectraData={spectraData}\n        />\n      ));\n  }, [\n    filteredCorrelationsData,\n    showProtonsAsRows,\n    additionalColumnData,\n    correlationsData,\n    editEquivalencesSaveHandler,\n    changeHybridizationSaveHandler,\n    editProtonsCountSaveHandler,\n    editAdditionalColumnFieldSaveHandler,\n    spectraData,\n  ]);\n\n  const additionalColumnHeader = useMemo(\n    () =>\n      additionalColumnData.map((correlation) => (\n        <AdditionalColumnHeader\n          key={`additionalCorrelationHeader_${correlation.id}`}\n          spectraData={spectraData}\n          correlationsData={correlationsData}\n          correlation={correlation}\n        />\n      )),\n    [additionalColumnData, correlationsData, spectraData],\n  );\n\n  return (\n    <div css={tableStyle}>\n      <table>\n        <thead>\n          <tr>\n            <th>Atom</th>\n            <th>δ (ppm)</th>\n            <th>Equiv</th>\n            <th>#H</th>\n            <th style={{ borderRight: '1px solid' }}>Hybrid</th>\n            {additionalColumnHeader}\n          </tr>\n        </thead>\n        <tbody>{rows}</tbody>\n      </table>\n    </div>\n  );\n}\n\nexport default CorrelationTable;\n","import { GeneralUtilities } from 'nmr-correlation';\nimport { memo } from 'react';\n\nimport { ErrorColors, Errors } from './CorrelationTable/Constants';\n\nfunction Overview({ correlationsData }) {\n  if (!correlationsData) {\n    return null;\n  }\n  const atoms = GeneralUtilities.getAtomCounts(correlationsData.options.mf);\n\n  return Object.keys(atoms).length > 0 ? (\n    Object.keys(atoms).map((atomType, i) => {\n      const stateAtomType = correlationsData.state[atomType];\n      const error = stateAtomType ? stateAtomType.error : undefined;\n      const errorColorIndex = error\n        ? Errors.findIndex((_error) => error[_error] !== undefined)\n        : 'black';\n\n      return (\n        <span\n          // eslint-disable-next-line react/no-array-index-key\n          key={`molFormulaView_${i}`}\n          style={{\n            color: stateAtomType\n              ? stateAtomType.complete === true &&\n                (!error || Object.keys(error).length === 0)\n                ? 'green'\n                : errorColorIndex >= 0\n                ? ErrorColors[errorColorIndex].color\n                : 'black'\n              : 'black',\n          }}\n        >\n          {`${atomType}: ${stateAtomType ? stateAtomType.current : '-'}/${\n            atoms[atomType]\n          }   `}\n        </span>\n      );\n    })\n  ) : (\n    <p style={{ fontStyle: 'italic', color: 'orange' }}>\n      Molecular formula is not set\n    </p>\n  );\n}\n\nexport default memo(Overview);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { MF } from 'mf-parser';\nimport { useCallback, useState } from 'react';\n\nconst inputStyle = css`\n  text-align: center;\n\n  input {\n    height: 100%;\n    width: 200px;\n    border-radius: 5px;\n    border: 0.55px solid #c7c7c7;\n    margin: 0px 5px 0px 5px;\n    text-align: center;\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 36px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n`;\n\nfunction MolecularFormulaInput({ onSave, previousMF }) {\n  const [mf, setMF] = useState('');\n  const [isValidMF, setIsValidMF] = useState(true);\n  const [hasChanged, setHasChanged] = useState(false);\n\n  const checkMF = useCallback((mf) => {\n    try {\n      new MF(mf);\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }, []);\n\n  const onChangeHandler = useCallback(\n    (e) => {\n      setHasChanged(true);\n      if (checkMF(e.target.value)) {\n        setIsValidMF(true);\n        setMF(e.target.value);\n      } else {\n        setIsValidMF(false);\n        setMF('');\n      }\n    },\n    [checkMF],\n  );\n\n  const onSaveHandler = useCallback(() => {\n    onSave(hasChanged ? mf.trim() : previousMF);\n  }, [hasChanged, mf, onSave, previousMF]);\n\n  return (\n    <div css={inputStyle}>\n      <input type=\"text\" onChange={onChangeHandler} defaultValue={previousMF} />\n      <button type=\"button\" onClick={onSaveHandler} disabled={!isValidMF}>\n        Set\n      </button>\n    </div>\n  );\n}\n\nMolecularFormulaInput.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n};\n\nexport default MolecularFormulaInput;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useState } from 'react';\n\nimport CloseButton from '../../elements/CloseButton';\nimport MolecularFormulaInput from '../../elements/MolecularFormulaInput';\nimport MoleculeSelection from '../../elements/MoleculeSelection';\n\nconst modalContainer = css`\n  overflow: auto;\n  width: 400px;\n  height: 550px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n\n    button {\n      height: 36px;\n      margin: 2px;\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .info {\n    margin-top: 0;\n    margin-bottom: 10px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n\n  .optional {\n    margin-top: 20px;\n    margin-bottom: 5px;\n    padding: 0px 10px;\n\n    text-align: center;\n    font-size: 18px;\n    font-weight: bold;\n  }\n  .optional2 {\n    margin-top: 5px;\n    margin-bottom: 25px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n`;\n\nfunction SetMolecularFormulaModal({ onClose, onSave, molecules, previousMF }) {\n  const [currentIndex, setCurrentIndex] = useState();\n\n  useEffect(() => {\n    if (molecules && molecules.length > 0) {\n      setCurrentIndex(0);\n    }\n  }, [molecules]);\n\n  const onSaveHandlerMolecularFormulaInput = useCallback(\n    (mf) => {\n      onSave(mf);\n      onClose();\n    },\n    [onClose, onSave],\n  );\n\n  const onSaveHandlerMoleculeSelection = useCallback(() => {\n    onSave(molecules[currentIndex].mf);\n    onClose();\n  }, [currentIndex, molecules, onClose, onSave]);\n\n  const onChangeHandlerMoleculeSelection = useCallback((index) => {\n    setCurrentIndex(index);\n  }, []);\n\n  return (\n    <div css={modalContainer}>\n      <div className=\"header\">\n        <CloseButton onClick={onClose} />\n      </div>\n      <div>\n        <p className=\"info\">Please type in a molecular formula!</p>\n      </div>\n      <MolecularFormulaInput\n        onSave={onSaveHandlerMolecularFormulaInput}\n        previousMF={previousMF}\n      />\n      <div>\n        <p className=\"optional\">OR</p>\n        <p className=\"optional2\">Select a molecule as reference!</p>\n      </div>\n      <MoleculeSelection\n        molecules={molecules}\n        onChange={onChangeHandlerMoleculeSelection}\n      />\n      <button type=\"button\" onClick={onSaveHandlerMoleculeSelection}>\n        Set\n      </button>\n    </div>\n  );\n}\n\nSetMolecularFormulaModal.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n  onClose: () => {\n    return null;\n  },\n};\n\nexport default SetMolecularFormulaModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\n\nimport CloseButton from '../../elements/CloseButton';\n\nconst modalContainer = css`\n  overflow: auto;\n  width: 300px;\n  height: 300px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  text-align: center;\n\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n\n    button {\n      height: 36px;\n      margin: 2px;\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .info {\n    margin-top: 0;\n    margin-bottom: 10px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n\n  input {\n    border-radius: 5px;\n    border: 0.55px solid #c7c7c7;\n    margin: 0px 5px 0px 5px;\n    text-align: center;\n  }\n`;\n\nfunction SetShiftToleranceModal({ onClose, onSave, previousTolerance }) {\n  const [tolerance, setTolerance] = useState();\n\n  useEffect(() => {\n    if (previousTolerance) {\n      setTolerance(previousTolerance);\n    } else {\n      setTolerance(undefined);\n    }\n  }, [previousTolerance]);\n\n  const onSaveHandler = useCallback(() => {\n    onSave(tolerance);\n    onClose();\n  }, [onClose, onSave, tolerance]);\n\n  const onChangeHandler = useCallback(\n    (e, atomType) =>\n      setTolerance({ ...tolerance, [atomType]: Number(e.target.value) }),\n    [tolerance],\n  );\n\n  const inputFields = useMemo(() => {\n    return tolerance\n      ? Object.keys(tolerance).map((atomType) => {\n          return (\n            <div\n              key={`toleranceInputField_${atomType}`}\n              className=\"input-field\"\n            >\n              <span>{atomType}: </span>\n              <input\n                type=\"number\"\n                onChange={(e) => onChangeHandler(e, atomType)}\n                defaultValue={tolerance[atomType]}\n              />\n            </div>\n          );\n        })\n      : undefined;\n  }, [onChangeHandler, tolerance]);\n\n  return (\n    <div css={modalContainer}>\n      <div className=\"header\">\n        <CloseButton onClick={onClose} />\n      </div>\n      <div>\n        <p className=\"info\">Shift tolerances: </p>\n      </div>\n      {inputFields}\n      <button type=\"button\" onClick={onSaveHandler}>\n        Set\n      </button>\n    </div>\n  );\n}\n\nSetShiftToleranceModal.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n  onClose: () => {\n    return null;\n  },\n};\n\nexport default SetShiftToleranceModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo, useCallback, useEffect, useMemo, useState } from 'react';\nimport { FaFlask, FaSlidersH } from 'react-icons/fa';\n\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport SelectUncontrolled from '../../elements/SelectUncontrolled';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useModal } from '../../elements/popup/Modal';\nimport { DISPLAYER_MODE } from '../../reducer/core/Constants';\nimport {\n  SET_CORRELATION,\n  SET_CORRELATIONS,\n  SET_CORRELATIONS_MF,\n  SET_CORRELATIONS_TOLERANCE,\n} from '../../reducer/types/Types';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\n\nimport CorrelationTable from './CorrelationTable/CorrelationTable';\nimport Overview from './Overview';\nimport SetMolecularFormulaModal from './SetMolecularFormulaModal';\nimport SetShiftToleranceModal from './SetShiftTolerancesModal';\nimport {\n  findSignalMatch1D,\n  findSignalMatch2D,\n  findSpectrum,\n  getAtomType,\n} from './Utilities';\n\nconst panelStyle = css`\n  display: flex;\n  flex-direction: column;\n  text-align: center;\n  height: 100%;\n  width: 100%;\n  justify-content: center,\n  align-items: 'center',\n\n  button {\n    border-radius: 5px;\n    margin-top: 3px;\n    margin-left: 2px;\n    border: none;\n    height: 16px;\n    width: 18px;\n    font-size: 12px;\n    padding: 0;\n    background-color: transparent;\n  }\n\n  .overview-container {\n    width: 100%;\n    margin-left: 15px;\n    white-space: nowrap;\n    span {\n      margin-left: 8px;\n    }\n  }\n\n  .homoHeteroKinds-container {\n    width: 100%;\n    margin-left: 15px;\n    span {\n      margin-left: 7px;\n    }\n  }\n\n\n`;\n\nfunction SummaryPanel() {\n  const {\n    molecules,\n    correlations: correlationsData,\n    data: spectraData,\n    xDomain,\n    yDomain,\n    displayerMode,\n    activeTab,\n  } = useChartData();\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n\n  const [additionalColumnData, setAdditionalColumnData] = useState([]);\n  const [\n    selectedAdditionalColumnsAtomType,\n    setSelectedAdditionalColumnsAtomType,\n  ] = useState('-');\n  const [showProtonsAsRows, setShowProtonsAsRows] = useState(false);\n  const [filterIsActive, setFilterIsActive] = useState(false);\n\n  const filteredCorrelationsData = useMemo(() => {\n    const isInView = (value) => {\n      if (value.pseudo === true) {\n        return false;\n      }\n      const atomTypesInView = activeTab\n        .split(',')\n        .map((tab) => getAtomType(tab));\n\n      const factor = 10000;\n      const xDomain0 = xDomain[0] * factor;\n      const xDomain1 = xDomain[1] * factor;\n      const yDomain0 = yDomain[0] * factor;\n      const yDomain1 = yDomain[1] * factor;\n\n      if (displayerMode === DISPLAYER_MODE.DM_1D) {\n        const delta = value.signal.delta * factor;\n        const spectrum = findSpectrum(spectraData, value);\n        if (\n          spectrum &&\n          atomTypesInView[0] === value.atomType &&\n          delta >= xDomain0 &&\n          delta <= xDomain1\n        ) {\n          return true;\n        }\n        // try to find a link which contains the belonging 2D signal in the spectra in view\n        if (\n          value.link.some((link) => {\n            const spectrum = findSpectrum(spectraData, link);\n            return findSignalMatch1D(\n              spectrum,\n              link,\n              factor,\n              xDomain0,\n              xDomain1,\n            );\n          })\n        ) {\n          return true;\n        }\n      } else if (displayerMode === DISPLAYER_MODE.DM_2D) {\n        if (!atomTypesInView.includes(value.atomType)) {\n          return false;\n        }\n        const spectrum = findSpectrum(spectraData, value);\n        // correlation is represented by a 2D signal\n        if (\n          findSignalMatch2D(\n            spectrum,\n            value,\n            factor,\n            xDomain0,\n            xDomain1,\n            yDomain0,\n            yDomain1,\n          )\n        ) {\n          return true;\n        } else {\n          // try to find a link which contains the belonging 2D signal in the spectra in view\n          if (\n            value.link.some((link) => {\n              const spectrum = findSpectrum(spectraData, link);\n              return findSignalMatch2D(\n                spectrum,\n                link,\n                factor,\n                xDomain0,\n                xDomain1,\n                yDomain0,\n                yDomain1,\n              );\n            })\n          ) {\n            return true;\n          }\n        }\n      }\n      // do not show correlation\n      return false;\n    };\n\n    if (correlationsData) {\n      const _values = filterIsActive\n        ? correlationsData.values.filter((value) => isInView(value))\n        : correlationsData.values;\n\n      return { ...correlationsData, values: _values };\n    }\n  }, [\n    activeTab,\n    correlationsData,\n    displayerMode,\n    filterIsActive,\n    spectraData,\n    xDomain,\n    yDomain,\n  ]);\n\n  const handleOnSetMolecularFormula = useCallback(\n    (mf) => {\n      dispatch({\n        type: SET_CORRELATIONS_MF,\n        payload: {\n          mf,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const handleOnSetShiftTolerance = useCallback(\n    (tolerance) => {\n      dispatch({\n        type: SET_CORRELATIONS_TOLERANCE,\n        payload: {\n          tolerance,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const showSetMolecularFormulaModal = useCallback(() => {\n    modal.show(\n      <SetMolecularFormulaModal\n        onClose={() => modal.close()}\n        onSave={handleOnSetMolecularFormula}\n        molecules={molecules}\n        previousMF={correlationsData.options.mf}\n      />,\n    );\n  }, [correlationsData, handleOnSetMolecularFormula, modal, molecules]);\n\n  const showSetShiftToleranceModal = useCallback(() => {\n    modal.show(\n      <SetShiftToleranceModal\n        onClose={() => modal.close()}\n        onSave={handleOnSetShiftTolerance}\n        previousTolerance={correlationsData.options.tolerance}\n      />,\n    );\n  }, [correlationsData, handleOnSetShiftTolerance, modal]);\n\n  const additionalColumnTypes = useMemo(() => {\n    const columnTypes = ['-'].concat(\n      correlationsData\n        ? correlationsData.values\n            .map((correlation) => correlation.atomType)\n            .filter((atomType, i, array) => array.indexOf(atomType) === i)\n        : [],\n    );\n\n    if (columnTypes.includes('H')) {\n      columnTypes.push('H-H');\n    }\n\n    if (columnTypes.includes('H')) {\n      setSelectedAdditionalColumnsAtomType('H');\n    } else {\n      setSelectedAdditionalColumnsAtomType('-');\n    }\n\n    return columnTypes.map((columnType) => {\n      return {\n        key: columnType,\n        label: columnType,\n        value: columnType,\n      };\n    });\n  }, [correlationsData]);\n\n  useEffect(() => {\n    const _selectedAdditionalColumnsAtomType = selectedAdditionalColumnsAtomType.split(\n      '-',\n    )[0];\n\n    setAdditionalColumnData(\n      filteredCorrelationsData\n        ? filteredCorrelationsData.values\n            .filter(\n              (correlation) =>\n                correlation.atomType === _selectedAdditionalColumnsAtomType,\n            )\n            .reverse()\n        : [],\n    );\n  }, [filteredCorrelationsData, selectedAdditionalColumnsAtomType]);\n\n  const editEquivalencesSaveHandler = useCallback(\n    (correlation, value) => {\n      dispatch({\n        type: SET_CORRELATION,\n        payload: {\n          id: correlation.id,\n          correlation: {\n            ...correlation,\n            equivalence: value,\n            edited: { ...correlation.edited, equivalence: true },\n          },\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const editProtonsCountSaveHandler = useCallback(\n    (correlation, valuesString) => {\n      let values;\n      // eslint-disable-next-line prefer-named-capture-group\n      if (valuesString.match(/^([0-9],{0,1})+$/g)) {\n        // allow digits followed by optional comma only\n        values = valuesString\n          .split(',')\n          .filter((char) => char.length > 0)\n          .map((char) => Number(char));\n      } else if (valuesString.trim().length === 0) {\n        // set values to default\n        values = [];\n      }\n\n      if (values) {\n        // ignore not supported text input\n        dispatch({\n          type: SET_CORRELATION,\n          payload: {\n            id: correlation.id,\n            correlation: {\n              ...correlation,\n              protonsCount: values,\n              edited: { ...correlation.edited, protonsCount: true },\n            },\n          },\n        });\n      }\n    },\n    [dispatch],\n  );\n\n  const changeHybridizationSaveHandler = useCallback(\n    (correlation, value) => {\n      dispatch({\n        type: SET_CORRELATION,\n        payload: {\n          id: correlation.id,\n          correlation: {\n            ...correlation,\n            hybridization: value,\n            edited: { ...correlation.edited, hybridization: true },\n          },\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const editAdditionalColumnFieldSaveHandler = useCallback(\n    (rowCorrelation, columnCorrelation) => {\n      dispatch({\n        type: SET_CORRELATIONS,\n        payload: {\n          ids: [rowCorrelation.id, columnCorrelation.id],\n          correlations: [\n            {\n              ...rowCorrelation,\n              edited: {\n                ...rowCorrelation.edited,\n                additionalColumnField: true,\n              },\n            },\n            {\n              ...columnCorrelation,\n              edited: {\n                ...columnCorrelation.edited,\n                additionalColumnField: true,\n              },\n            },\n          ],\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n\n  return (\n    <div css={panelStyle}>\n      <DefaultPanelHeader\n        canDelete={false}\n        counter={correlationsData ? correlationsData.values.length : 0}\n        onFilter={handleOnFilter}\n        filterToolTip={\n          filterIsActive\n            ? 'Show all correlations'\n            : 'Hide correlations out of view'\n        }\n        filterIsActive={filterIsActive}\n        counterFiltered={\n          filteredCorrelationsData && filteredCorrelationsData.values.length\n        }\n      >\n        <ToolTip\n          title={`Set molecular formula (${correlationsData.options.mf})`}\n          popupPlacement=\"right\"\n        >\n          <button type=\"button\" onClick={showSetMolecularFormulaModal}>\n            <FaFlask />\n          </button>\n        </ToolTip>\n        <ToolTip title={`Set shift tolerance`} popupPlacement=\"right\">\n          <button type=\"button\" onClick={showSetShiftToleranceModal}>\n            <FaSlidersH />\n          </button>\n        </ToolTip>\n        <div className=\"overview-container\">\n          <Overview correlationsData={correlationsData} />\n        </div>\n        <div className=\"homoHeteroKinds-container\">\n          <SelectUncontrolled\n            onChange={(selection) => {\n              setSelectedAdditionalColumnsAtomType(selection);\n              if (selection === 'H-H') {\n                setShowProtonsAsRows(true);\n              } else {\n                setShowProtonsAsRows(false);\n              }\n            }}\n            data={additionalColumnTypes}\n            value={selectedAdditionalColumnsAtomType}\n            style={{\n              width: '65px',\n              height: '20px',\n              border: '1px solid grey',\n            }}\n          />\n        </div>\n      </DefaultPanelHeader>\n      <CorrelationTable\n        correlationsData={correlationsData}\n        filteredCorrelationsData={filteredCorrelationsData}\n        additionalColumnData={additionalColumnData}\n        editEquivalencesSaveHandler={editEquivalencesSaveHandler}\n        changeHybridizationSaveHandler={changeHybridizationSaveHandler}\n        editProtonsCountSaveHandler={editProtonsCountSaveHandler}\n        editAdditionalColumnFieldSaveHandler={\n          editAdditionalColumnFieldSaveHandler\n        }\n        showProtonsAsRows={showProtonsAsRows}\n        spectraData={spectraData}\n      />\n    </div>\n  );\n}\n\nexport default memo(SummaryPanel);\n","import lodashGet from 'lodash/get';\nimport lodashSet from 'lodash/set';\nimport {\n  useEffect,\n  useState,\n  useCallback,\n  forwardRef,\n  useImperativeHandle,\n  useRef,\n  memo,\n} from 'react';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport IsotopesViewer from '../../elements/IsotopesViewer';\nimport { useAlert } from '../../elements/popup/Alert';\nimport ZonesWrapper from '../../hoc/ZonesWrapper';\nimport { SET_PANELS_PREFERENCES } from '../../reducer/preferencesReducer';\nimport {\n  useStateWithLocalStorage,\n  getValue as getValueByKeyPath,\n} from '../../utility/LocalStorage';\nimport ColumnFormatField from '../extra/preferences/ColumnFormatField';\nimport { rangeDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles = {\n  container: {\n    padding: 10,\n    backgroundColor: '#f1f1f1',\n    height: '100%',\n    flex: 1,\n  },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '30%',\n    textAlign: 'center',\n  },\n};\n\nconst formatFields = [\n  {\n    id: 1,\n    label: 'From :',\n    checkController: 'showFrom',\n    formatController: 'fromFormat',\n    defaultFormat: '0.00',\n  },\n  {\n    id: 2,\n    label: 'To :',\n    checkController: 'showTo',\n    formatController: 'toFormat',\n    defaultFormat: '0.00',\n  },\n  {\n    id: 3,\n    label: 'Absolute :',\n    checkController: 'showAbsolute',\n    formatController: 'absoluteFormat',\n    defaultFormat: '0.00',\n  },\n  {\n    id: 4,\n    label: 'Relative :',\n    checkController: 'showRelative',\n    formatController: 'relativeFormat',\n    defaultFormat: '00.00',\n  },\n];\n\nfunction ZonesPreferences({ nucleus }, ref) {\n  const alert = useAlert();\n  const [, setSettingsData] = useStateWithLocalStorage('nmr-general-settings');\n  const preferences = usePreferences();\n\n  const [settings, setSetting] = useState(null);\n  const formRef = useRef();\n  useEffect(() => {\n    const zonesPreferences = getValueByKeyPath(\n      preferences,\n      'formatting.panels.zones',\n    );\n    if (zonesPreferences) {\n      setSetting(zonesPreferences);\n    }\n  }, [preferences]);\n\n  const saveToLocalStorgate = (values) => {\n    setSettingsData(values, 'formatting.panels.ranges');\n  };\n\n  const saveHandler = useCallback(\n    (values, showMessage = false) => {\n      preferences.dispatch({\n        type: SET_PANELS_PREFERENCES,\n        payload: { key: 'zones', value: values },\n      });\n      if (showMessage) {\n        alert.success('zones preferences saved successfully');\n      }\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(ref, () => ({\n    saveSetting() {\n      if (typeof formRef.current.requestSubmit === 'function') {\n        formRef.current.requestSubmit();\n      } else {\n        formRef.current.dispatchEvent(\n          new Event('submit', { cancelable: true }),\n        );\n      }\n    },\n  }));\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    const form = event.target;\n    const formData = new FormData(form);\n    let values = {};\n    for (const field of formData.entries()) {\n      const keys = field[0].split('-').join('.');\n      const val = ['true', 'false'].includes(field[1])\n        ? field[1] === 'true'\n        : field[1];\n      values = lodashSet(values, keys, val);\n    }\n\n    saveHandler(values, true);\n    saveToLocalStorgate(values);\n  };\n\n  const getValue = useCallback(\n    (...params) => {\n      const keys = params.join('.');\n      if (settings) {\n        const value = lodashGet(settings, keys);\n        return value ? value : null;\n      } else {\n        const keyIndex = params.length - 1;\n        return rangeDefaultValues[params[keyIndex]];\n      }\n    },\n    [settings],\n  );\n\n  return (\n    <div style={styles.container}>\n      <form onSubmit={handleSubmit} ref={formRef}>\n        {nucleus &&\n          nucleus.map((nucleusLabel) => (\n            <div key={nucleusLabel} style={styles.groupContainer}>\n              <IsotopesViewer style={styles.header} value={nucleusLabel} />\n              {formatFields.map((field) => (\n                <ColumnFormatField\n                  key={field.id}\n                  label={field.label}\n                  checked={getValue(nucleusLabel, field.checkController)}\n                  format={getValue(nucleusLabel, field.formatController)}\n                  checkControllerName={field.checkController}\n                  formatControllerName={field.formatController}\n                  groupID={nucleusLabel}\n                />\n              ))}\n            </div>\n          ))}\n      </form>\n    </div>\n  );\n}\n\nexport default ZonesWrapper(memo(forwardRef(ZonesPreferences)));\n","import { Fragment, useCallback } from 'react';\nimport { FaRegTrashAlt, FaSearchPlus } from 'react-icons/fa';\n\nimport { SignalKinds } from '../../../../data/constants/SignalsKinds';\nimport { useAssignmentData } from '../../../assignment';\nimport { useDispatch } from '../../../context/DispatchContext';\nimport Select from '../../../elements/Select';\nimport {\n  CHANGE_ZONE_SIGNAL_KIND,\n  DELETE_2D_ZONE,\n  SET_X_DOMAIN,\n  SET_Y_DOMAIN,\n} from '../../../reducer/types/Types';\n\nconst selectBoxStyle = {\n  marginLeft: 2,\n  marginRight: 2,\n  border: 'none',\n  height: '20px',\n};\n\nfunction ActionsColumn({ rowData, rowSpanTags }) {\n  const dispatch = useDispatch();\n  const assignmentData = useAssignmentData();\n\n  const changeSignalKindHandler = useCallback(\n    (value) => {\n      dispatch({\n        type: CHANGE_ZONE_SIGNAL_KIND,\n        payload: {\n          rowData,\n          value,\n        },\n      });\n    },\n    [dispatch, rowData],\n  );\n\n  const deleteZoneHandler = useCallback(() => {\n    dispatch({\n      type: DELETE_2D_ZONE,\n      payload: {\n        id: rowData.id,\n        assignmentData,\n      },\n    });\n  }, [assignmentData, dispatch, rowData]);\n\n  const zoomZoneHandler = useCallback(() => {\n    const xMargin = Math.abs(rowData.x.from - rowData.x.to) * 10;\n    dispatch({\n      type: SET_X_DOMAIN,\n      xDomain:\n        rowData.x.from <= rowData.x.to\n          ? [rowData.x.from - xMargin, rowData.x.to + xMargin]\n          : [rowData.x.to - xMargin, rowData.x.from + xMargin],\n    });\n    const yMargin = Math.abs(rowData.y.from - rowData.y.to) * 10;\n    dispatch({\n      type: SET_Y_DOMAIN,\n      yDomain:\n        rowData.y.from <= rowData.y.to\n          ? [rowData.y.from - yMargin, rowData.y.to + yMargin]\n          : [rowData.y.to - yMargin, rowData.y.from + yMargin],\n    });\n  }, [dispatch, rowData.x.from, rowData.x.to, rowData.y.from, rowData.y.to]);\n\n  return (\n    <Fragment>\n      <td>\n        <Select\n          onChange={(value) => {\n            changeSignalKindHandler(value);\n          }}\n          data={SignalKinds}\n          defaultValue={rowData.tableMetaInfo.signal.kind}\n          style={selectBoxStyle}\n        />\n      </td>\n      <td {...rowSpanTags}>\n        <button\n          type=\"button\"\n          className=\"delete-button\"\n          onClick={deleteZoneHandler}\n        >\n          <FaRegTrashAlt />\n        </button>\n        <button type=\"button\" className=\"zoom-button\" onClick={zoomZoneHandler}>\n          <FaSearchPlus title=\"Zoom to zone in spectrum\" />\n        </button>\n      </td>\n    </Fragment>\n  );\n}\n\nexport default ActionsColumn;\n","import lodashGet from 'lodash/get';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nfunction SignalAssignmentsColumn({\n  rowData,\n  assignment,\n  highlight,\n  onHover,\n  onClick,\n  onUnlink,\n  axis,\n  showUnlinkButton,\n  setShowUnlinkButton,\n}) {\n  return (\n    <td\n      {...onHover}\n      {...{ onClick: (e) => onClick(e, assignment, axis) }}\n      style={\n        highlight.isActive ||\n        (assignment.isActive && assignment.activeAxis === axis)\n          ? {\n              color: 'red',\n              fontWeight: 'bold',\n            }\n          : null\n      }\n    >\n      {lodashGet(rowData, `tableMetaInfo.signal.${axis}.diaID`, []).length >\n      0 ? (\n        <div\n          onMouseEnter={() => setShowUnlinkButton(true)}\n          onMouseLeave={() => setShowUnlinkButton(false)}\n        >\n          {rowData.tableMetaInfo.signal[axis].diaID.length}{' '}\n          <sup>\n            <button\n              type=\"button\"\n              style={{\n                visibility: showUnlinkButton ? 'visible' : 'hidden',\n                padding: 0,\n                margin: 0,\n              }}\n              onClick={(e) => onUnlink(e, false, axis)}\n            >\n              <FaMinusCircle color=\"red\" />\n            </button>\n          </sup>\n        </div>\n      ) : assignment.isActive && assignment.activeAxis === axis ? (\n        '0'\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nexport default SignalAssignmentsColumn;\n","import { Fragment } from 'react';\n\nimport SignalAssignmentsColumn from './SignalAssignmentsColumn';\n\nfunction SignalAssignmentsColumns({\n  rowData,\n  assignmentSignal,\n  onHoverSignalX,\n  onHoverSignalY,\n  showUnlinkButtonSignalX,\n  showUnlinkButtonSignalY,\n  setShowUnlinkButtonSignalX,\n  setShowUnlinkButtonSignalY,\n  onClick,\n  onUnlink,\n  highlightSignalX,\n  highlightSignalY,\n}) {\n  return (\n    <Fragment>\n      <SignalAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentSignal}\n        highlight={highlightSignalX}\n        onHover={onHoverSignalX}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis={'x'}\n        showUnlinkButton={showUnlinkButtonSignalX}\n        setShowUnlinkButton={setShowUnlinkButtonSignalX}\n      />\n      <SignalAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentSignal}\n        highlight={highlightSignalY}\n        onHover={onHoverSignalY}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis={'y'}\n        showUnlinkButton={showUnlinkButtonSignalY}\n        setShowUnlinkButton={setShowUnlinkButtonSignalY}\n      />\n    </Fragment>\n  );\n}\n\nexport default SignalAssignmentsColumns;\n","import lodashGet from 'lodash/get';\nimport { Fragment, useCallback } from 'react';\n\nimport { useDispatch } from '../../../context/DispatchContext';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport { CHANGE_ZONE_SIGNAL_VALUE } from '../../../reducer/types/Types';\n\nfunction SignalDeltaColumn({ rowData, onHoverSignalX, onHoverSignalY }) {\n  const dispatch = useDispatch();\n\n  const signalDeltaX = lodashGet(rowData, 'tableMetaInfo.signal.x.delta', null);\n  const signalDeltaY = lodashGet(rowData, 'tableMetaInfo.signal.y.delta', null);\n  const id = lodashGet(rowData, 'tableMetaInfo.signal.id', undefined);\n\n  const saveXHandler = useCallback(\n    (event) => {\n      const value = event.target.value;\n      dispatch({\n        type: CHANGE_ZONE_SIGNAL_VALUE,\n        payload: {\n          zoneID: rowData.id,\n          signal: { id, x: value },\n        },\n      });\n    },\n    [dispatch, id, rowData.id],\n  );\n  const saveYHandler = useCallback(\n    (event) => {\n      const value = event.target.value;\n      dispatch({\n        type: CHANGE_ZONE_SIGNAL_VALUE,\n        payload: {\n          zoneID: rowData.id,\n          signal: { id, y: value },\n        },\n      });\n    },\n    [dispatch, id, rowData.id],\n  );\n\n  return (\n    <Fragment>\n      <td {...onHoverSignalX}>\n        {signalDeltaX !== null ? (\n          <EditableColumn\n            value={signalDeltaX.toFixed(2)}\n            onSave={saveXHandler}\n            type=\"number\"\n            style={{ padding: '0.1rem 0.4rem' }}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n      <td {...onHoverSignalY}>\n        {signalDeltaY !== null ? (\n          <EditableColumn\n            value={signalDeltaY.toFixed(2)}\n            onSave={saveYHandler}\n            type=\"number\"\n            style={{ padding: '0.1rem 0.4rem' }}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n    </Fragment>\n  );\n}\n\nexport default SignalDeltaColumn;\n","import lodashGet from 'lodash/get';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nfunction ZoneAssignmentColumn({\n  rowData,\n  assignment,\n  highlight,\n  onHover,\n  onClick,\n  onUnlink,\n  axis,\n  showUnlinkButton,\n  setShowUnlinkButton,\n  rowSpanTags,\n}) {\n  return (\n    <td\n      {...rowSpanTags}\n      {...onHover}\n      {...{ onClick: (e) => onClick(e, assignment, axis) }}\n    >\n      {lodashGet(rowData, `${axis}.pubIntegral`, 0) > 0 ? (\n        lodashGet(rowData, `${axis}.diaID`, []).length > 0 ? (\n          <div\n            onMouseEnter={() => setShowUnlinkButton(true)}\n            onMouseLeave={() => setShowUnlinkButton(false)}\n          >\n            {rowData[axis].pubIntegral} {`(`}\n            <span\n              style={\n                assignment.isActive & (assignment.activeAxis === axis) ||\n                assignment.isOnHover & (assignment.onHoverAxis === axis) ||\n                highlight.isActive\n                  ? {\n                      color: 'red',\n                      fontWeight: 'bold',\n                    }\n                  : { color: 'black', fontWeight: 'normal' }\n              }\n            >\n              {lodashGet(rowData, `${axis}.diaID`, []).length}\n            </span>\n            {`)`}{' '}\n            <sup>\n              <button\n                type=\"button\"\n                style={{\n                  visibility: showUnlinkButton ? 'visible' : 'hidden',\n                  padding: 0,\n                  margin: 0,\n                }}\n                onClick={(e) => onUnlink(e, true, axis)}\n              >\n                <FaMinusCircle color=\"red\" />\n              </button>\n            </sup>\n          </div>\n        ) : assignment.isActive && assignment.activeAxis === axis ? (\n          <div>\n            {`${lodashGet(rowData, `${axis}.pubIntegral`, '')} (`}\n            <span\n              style={{\n                color: 'red',\n                fontWeight: 'bold',\n              }}\n            >\n              0\n            </span>\n            {')'}\n          </div>\n        ) : (\n          rowData[axis].pubIntegral\n        )\n      ) : assignment.isActive && assignment.activeAxis === axis ? (\n        <div>\n          {'0 ('}\n          <span style={{ color: 'red', fontWeight: 'bold' }}>0</span>\n          {')'}\n        </div>\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nexport default ZoneAssignmentColumn;\n","import { Fragment } from 'react';\n\nimport ZoneAssignmentColumn from './ZoneAssignmentsColumn';\n\nfunction ZoneAssignmentsColumns({\n  rowData,\n  assignmentZone,\n  onHoverZoneX,\n  onHoverZoneY,\n  showUnlinkButtonZoneX,\n  showUnlinkButtonZoneY,\n  setShowUnlinkButtonZoneX,\n  setShowUnlinkButtonZoneY,\n  rowSpanTags,\n  onClick,\n  onUnlink,\n  highlightZoneX,\n  highlightZoneY,\n}) {\n  return (\n    <Fragment>\n      <ZoneAssignmentColumn\n        rowData={rowData}\n        assignment={assignmentZone}\n        highlight={highlightZoneX}\n        onHover={onHoverZoneX}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis={'x'}\n        showUnlinkButton={showUnlinkButtonZoneX}\n        setShowUnlinkButton={setShowUnlinkButtonZoneX}\n        rowSpanTags={rowSpanTags}\n      />\n      <ZoneAssignmentColumn\n        rowData={rowData}\n        assignment={assignmentZone}\n        highlight={highlightZoneY}\n        onHover={onHoverZoneY}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis={'y'}\n        showUnlinkButton={showUnlinkButtonZoneY}\n        setShowUnlinkButton={setShowUnlinkButtonZoneY}\n        rowSpanTags={rowSpanTags}\n      />\n    </Fragment>\n  );\n}\n\nexport default ZoneAssignmentsColumns;\n","/** @jsxImportSource @emotion/react */\n\nimport lodashGet from 'lodash/get';\nimport { useMemo, useCallback, useState } from 'react';\n\nimport { buildID } from '../../../data/utilities/Concatenation';\nimport { useAssignment } from '../../assignment';\nimport { useHighlight } from '../../highlight';\n\nimport ActionsColumn from './TableColumns/ActionsColumn';\nimport SignalAssignmentsColumns from './TableColumns/SignalAssignmentsColumns';\nimport SignalDeltaColumn from './TableColumns/SignalDeltaColumn';\nimport ZoneAssignmentsColumns from './TableColumns/ZoneAssignmentsColumns';\n\nconst HighlightedRowStyle = { backgroundColor: '#ff6f0057' };\n\nconst ConstantlyHighlightedRowStyle = { backgroundColor: '#f5f5dc' };\n\nfunction ZonesTableRow({ rowData, onUnlink, onContextMenu }) {\n  const assignmentZone = useAssignment(rowData.id);\n  const highlightZone = useHighlight([assignmentZone.id]);\n  const highlightZoneX = useHighlight(\n    [buildID(assignmentZone.id, 'X')].concat(assignmentZone.assigned.x || []),\n  );\n  const highlightZoneY = useHighlight(\n    [buildID(assignmentZone.id, 'Y')].concat(assignmentZone.assigned.y || []),\n  );\n\n  const assignmentSignal = useAssignment(rowData.tableMetaInfo.id);\n  const highlightSignalX = useHighlight(\n    [buildID(assignmentSignal.id, 'X')].concat(\n      assignmentSignal.assigned.x || [],\n      buildID(assignmentSignal.id, 'Crosshair'),\n    ),\n  );\n  const highlightSignalY = useHighlight(\n    [buildID(assignmentSignal.id, 'Y')].concat(\n      assignmentSignal.assigned.y || [],\n      buildID(assignmentSignal.id, 'Crosshair'),\n    ),\n  );\n\n  const [showUnlinkButtonZoneX, setShowUnlinkButtonZoneX] = useState(false);\n  const [showUnlinkButtonZoneY, setShowUnlinkButtonZoneY] = useState(false);\n  const [showUnlinkButtonSignalX, setShowUnlinkButtonSignalX] = useState(false);\n  const [showUnlinkButtonSignalY, setShowUnlinkButtonSignalY] = useState(false);\n\n  const rowSpanTags = useMemo(() => {\n    return {\n      rowSpan: rowData.tableMetaInfo.rowSpan,\n      style:\n        lodashGet(rowData, 'tableMetaInfo.hide', false) === true\n          ? { display: 'none' }\n          : null,\n    };\n  }, [rowData]);\n\n  const unlinkHandler = useCallback(\n    (e, isOnZoneLevel, axis) => {\n      // event handling here in case of unlink button clicked\n      if (e) {\n        e.stopPropagation();\n      }\n      onUnlink(rowData, isOnZoneLevel, rowData.tableMetaInfo.signalIndex, axis);\n      if (axis === 'x') {\n        if (isOnZoneLevel !== undefined) {\n          if (isOnZoneLevel) {\n            setShowUnlinkButtonZoneX(false);\n            assignmentZone.removeAll('x');\n          } else {\n            setShowUnlinkButtonSignalX(false);\n            assignmentSignal.removeAll('x');\n          }\n        } else {\n          setShowUnlinkButtonZoneX(false);\n          setShowUnlinkButtonSignalX(false);\n        }\n      } else if (axis === 'y') {\n        if (isOnZoneLevel !== undefined) {\n          if (isOnZoneLevel) {\n            setShowUnlinkButtonZoneY(false);\n            assignmentZone.removeAll('y');\n          } else {\n            setShowUnlinkButtonSignalY(false);\n            assignmentSignal.removeAll('y');\n          }\n        } else {\n          setShowUnlinkButtonZoneY(false);\n          setShowUnlinkButtonSignalY(false);\n        }\n      } else {\n        setShowUnlinkButtonZoneX(false);\n        assignmentZone.removeAll('x');\n        setShowUnlinkButtonSignalX(false);\n        assignmentSignal.removeAll('x');\n        setShowUnlinkButtonZoneY(false);\n        assignmentZone.removeAll('y');\n        setShowUnlinkButtonSignalY(false);\n        assignmentSignal.removeAll('y');\n      }\n    },\n    [assignmentSignal, assignmentZone, onUnlink, rowData],\n  );\n\n  const clickHandler = useCallback((e, assignment, axis) => {\n    e.stopPropagation();\n    assignment.onClick(axis);\n  }, []);\n\n  const onHoverZoneX = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentZone.onMouseEnter('x');\n        highlightZoneX.show();\n      },\n      onMouseLeave: () => {\n        assignmentZone.onMouseLeave('x');\n        highlightZoneX.hide();\n      },\n    };\n  }, [assignmentZone, highlightZoneX]);\n\n  const onHoverZoneY = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentZone.onMouseEnter('y');\n        highlightZoneY.show();\n      },\n      onMouseLeave: () => {\n        assignmentZone.onMouseLeave('y');\n        highlightZoneY.hide();\n      },\n    };\n  }, [assignmentZone, highlightZoneY]);\n\n  const onHoverSignalX = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentSignal.onMouseEnter('x');\n        highlightSignalX.show();\n      },\n      onMouseLeave: () => {\n        assignmentSignal.onMouseLeave('x');\n        highlightSignalX.hide();\n      },\n    };\n  }, [assignmentSignal, highlightSignalX]);\n\n  const onHoverSignalY = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentSignal.onMouseEnter('y');\n        highlightSignalY.show();\n      },\n      onMouseLeave: () => {\n        assignmentSignal.onMouseLeave('y');\n        highlightSignalY.hide();\n      },\n    };\n  }, [assignmentSignal, highlightSignalY]);\n\n  return (\n    <tr\n      onContextMenu={(e) => onContextMenu(e, rowData)}\n      style={\n        highlightZone.isActive || assignmentZone.isActive\n          ? HighlightedRowStyle\n          : lodashGet(\n              rowData,\n              'tableMetaInfo.isConstantlyHighlighted',\n              false,\n            ) === true\n          ? ConstantlyHighlightedRowStyle\n          : null\n      }\n      {...highlightZone.onHover}\n    >\n      <td {...rowSpanTags}>{rowData.tableMetaInfo.rowIndex + 1}</td>\n      <SignalDeltaColumn\n        rowData={rowData}\n        onHoverSignalX={onHoverSignalX}\n        onHoverSignalY={onHoverSignalY}\n      />\n      <SignalAssignmentsColumns\n        rowData={rowData}\n        assignmentSignal={assignmentSignal}\n        onHoverSignalX={onHoverSignalX}\n        onHoverSignalY={onHoverSignalY}\n        showUnlinkButtonSignalX={showUnlinkButtonSignalX}\n        showUnlinkButtonSignalY={showUnlinkButtonSignalY}\n        setShowUnlinkButtonSignalX={(show) => setShowUnlinkButtonSignalX(show)}\n        setShowUnlinkButtonSignalY={(show) => setShowUnlinkButtonSignalY(show)}\n        onClick={clickHandler}\n        onUnlink={unlinkHandler}\n        highlightSignalX={highlightSignalX}\n        highlightSignalY={highlightSignalY}\n      />\n      <ZoneAssignmentsColumns\n        rowData={rowData}\n        assignmentZone={assignmentZone}\n        onHoverZoneX={onHoverZoneX}\n        onHoverZoneY={onHoverZoneY}\n        showUnlinkButtonZoneX={showUnlinkButtonZoneX}\n        showUnlinkButtonZoneY={showUnlinkButtonZoneY}\n        setShowUnlinkButtonZoneX={(show) => setShowUnlinkButtonZoneX(show)}\n        setShowUnlinkButtonZoneY={(show) => setShowUnlinkButtonZoneY(show)}\n        rowSpanTags={rowSpanTags}\n        onClick={clickHandler}\n        onUnlink={unlinkHandler}\n        highlightZoneX={highlightZoneX}\n        highlightZoneY={highlightZoneY}\n      />\n      <ActionsColumn rowData={rowData} rowSpanTags={rowSpanTags} />\n    </tr>\n  );\n}\n\nexport default ZonesTableRow;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useMemo, useCallback, useRef } from 'react';\nimport { FaLink } from 'react-icons/fa';\n\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport ContextMenu from '../../elements/ContextMenu';\n\nimport ZonesTableRow from './ZonesTableRow';\n\nconst tableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  font-size: 12px;\n  // height: 100%;\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  thead tr:nth-of-type(1) th {\n    top: 0;\n  }\n  thead tr:nth-of-type(2) th {\n    top: 21px;\n  }\n  th {\n    position: sticky;\n    background-color: white;\n    z-index: 2;\n  }\n  th,\n  td {\n    white-space: nowrap;\n    text-align: center;\n    margin: 0;\n    padding: 0.1rem 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n      padding: 0 5px;\n    }\n  }\n`;\n\nfunction ZonesTable({ tableData, onUnlink, context, nuclei, preferences }) {\n  const contextRef = useRef();\n\n  const contextMenuHandler = useCallback(\n    (e, rowData) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, rowData);\n      }\n    },\n    [contextRef],\n  );\n\n  const data = useMemo(() => {\n    const _data = [];\n    tableData.forEach((zone, i) => {\n      if (zone.signal.length === 1) {\n        _data.push({\n          ...zone,\n          tableMetaInfo: {\n            ...zone.tableMetaInfo,\n            signal: zone.signal[0],\n            rowIndex: i,\n            signalIndex: 0,\n            id: zone.signal[0].id,\n          },\n        });\n      } else if (zone.signal.length > 1) {\n        zone.signal.forEach((signal, j) => {\n          let hide = false;\n          let rowSpan = null;\n          if (j < zone.signal.length - 1) {\n            if (j === 0) {\n              rowSpan = zone.signal.length;\n            } else {\n              hide = true;\n            }\n          } else {\n            hide = true;\n          }\n          _data.push({\n            ...zone,\n            tableMetaInfo: {\n              ...zone.tableMetaInfo,\n              signal,\n              rowSpan,\n              hide,\n              rowIndex: i,\n              signalIndex: j,\n              id: signal.id,\n            },\n          });\n        });\n      }\n    });\n\n    return _data;\n  }, [tableData]);\n\n  const rows = useMemo(\n    () =>\n      data.map((rowData) => (\n        <ZonesTableRow\n          key={`zonesTableRow_${rowData.tableMetaInfo.id}`}\n          rowData={rowData}\n          onUnlink={onUnlink}\n          onContextMenu={(e, rowData) => contextMenuHandler(e, rowData)}\n          preferences={preferences}\n        />\n      )),\n    [contextMenuHandler, data, onUnlink, preferences],\n  );\n\n  return (\n    <div>\n      <table css={tableStyle}>\n        <thead>\n          <tr>\n            <th rowSpan={2}>#</th>\n            <th colSpan={2}>δ (ppm)</th>\n            <th colSpan={2}>\n              <FaLink />\n            </th>\n            <th colSpan={2}>Σ</th>\n            <th rowSpan={2}>Kind</th>\n            <th rowSpan={2}>{''}</th>\n          </tr>\n          <tr>\n            <th>{nuclei[0]}</th>\n            <th>{nuclei[1]}</th>\n            <th>{nuclei[0]}</th>\n            <th>{nuclei[1]}</th>\n            <th>{nuclei[0]}</th>\n            <th>{nuclei[1]}</th>\n          </tr>\n        </thead>\n        <tbody>{rows}</tbody>\n      </table>\n      <ContextMenu ref={contextRef} context={context} />\n    </div>\n  );\n}\n\nexport default ZonesTable;\n","import lodashGet from 'lodash/get';\nimport { useState, useMemo, useCallback, useRef, memo } from 'react';\nimport ReactCardFlip from 'react-card-flip';\nimport { FaUnlink } from 'react-icons/fa';\n\nimport { useAssignmentData } from '../../assignment';\nimport { useDispatch } from '../../context/DispatchContext';\nimport ToggleButton from '../../elements/ToggleButton';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useModal } from '../../elements/popup/Modal';\nimport ZonesWrapper from '../../hoc/ZonesWrapper';\nimport { DELETE_2D_ZONE, UNLINK_ZONE } from '../../reducer/types/Types';\nimport Events from '../../utility/Events';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport ZonesPreferences from './ZonesPreferences';\nimport ZonesTable from './ZonesTable';\n\nconst styles = {\n  container: {\n    flexDirection: 'column',\n    height: '100%',\n    display: 'flex',\n  },\n  removeAssignmentsButton: {\n    borderRadius: '5px',\n    marginTop: '3px',\n    marginLeft: '2px',\n    border: 'none',\n    height: '16px',\n    width: '18px',\n    fontSize: '12px',\n    padding: 0,\n    backgroundColor: 'transparent',\n  },\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n  },\n  toggle: {\n    width: '22px',\n    height: '22px',\n    marginLeft: '2px',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n};\n\nfunction ZonesPanel({ zones, activeTab, preferences, xDomain, yDomain }) {\n  const [filterIsActive, setFilterIsActive] = useState(false);\n\n  const assignmentData = useAssignmentData();\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef();\n\n  const tableData = useMemo(() => {\n    const isInView = (xFrom, xTo, yFrom, yTo) => {\n      const factor = 10000;\n      xFrom = xFrom * factor;\n      xTo = xTo * factor;\n      yFrom = yFrom * factor;\n      yTo = yTo * factor;\n      return (\n        ((xTo >= xDomain[0] * factor && xFrom <= xDomain[1] * factor) ||\n          (xFrom <= xDomain[0] * factor && xTo >= xDomain[1] * factor)) &&\n        ((yTo >= yDomain[0] * factor && yFrom <= yDomain[1] * factor) ||\n          (yFrom <= yDomain[0] * factor && yTo >= yDomain[1] * factor))\n      );\n    };\n\n    const getFilteredZones = (zones) => {\n      return zones.filter((zone) => {\n        return isInView(zone.x.from, zone.x.to, zone.y.from, zone.y.to);\n      });\n    };\n    if (zones.values) {\n      const _zones = filterIsActive\n        ? getFilteredZones(zones.values)\n        : zones.values;\n\n      return _zones.map((zone) => {\n        return {\n          ...zone,\n          tableMetaInfo: {\n            isConstantlyHighlighted: isInView(\n              zone.x.from,\n              zone.x.to,\n              zone.y.from,\n              zone.y.to,\n            ),\n          },\n        };\n      });\n    }\n  }, [zones, filterIsActive, xDomain, yDomain]);\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n\n  const unlinkZoneHandler = useCallback(\n    (zoneData, isOnZoneLevel, signalIndex, axis) => {\n      dispatch({\n        type: UNLINK_ZONE,\n        payload: {\n          zoneData,\n          assignmentData,\n          isOnZoneLevel,\n          signalIndex,\n          axis,\n        },\n      });\n    },\n    [assignmentData, dispatch],\n  );\n\n  const removeAssignments = useCallback(() => {\n    zones.values.forEach((zone) => unlinkZoneHandler(zone));\n  }, [zones.values, unlinkZoneHandler]);\n\n  const handleOnRemoveAssignments = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All assignments will be removed. Are you sure?',\n      buttons: [{ text: 'Yes', handler: removeAssignments }, { text: 'No' }],\n    });\n  }, [removeAssignments, modal]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All zones will be deleted. Are You sure?',\n      buttons: [\n        {\n          text: 'Yes',\n          handler: () => {\n            dispatch({ type: DELETE_2D_ZONE, payload: { assignmentData } });\n          },\n        },\n        { text: 'No' },\n      ],\n    });\n  }, [assignmentData, dispatch, modal]);\n\n  const zonesPreferences = useMemo(() => {\n    const _preferences = lodashGet(preferences, `panels.zones.[${activeTab}]`);\n\n    return _preferences;\n  }, [activeTab, preferences]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  const visibilityHandler = useCallback((key) => {\n    Events.emit('onZonesVisibilityChange', { key });\n  }, []);\n\n  return (\n    <>\n      <div style={styles.container}>\n        {!isFlipped && (\n          <DefaultPanelHeader\n            counter={zones.values ? zones.values.length : 0}\n            onDelete={handleDeleteAll}\n            deleteToolTip=\"Delete All Zones\"\n            onFilter={handleOnFilter}\n            filterToolTip={\n              filterIsActive ? 'Show all zones' : 'Hide zones out of view'\n            }\n            filterIsActive={filterIsActive}\n            counterFiltered={tableData && tableData.length}\n            showSettingButton=\"true\"\n            onSettingClick={settingsPanelHandler}\n          >\n            <ToolTip title={`Remove all Assignments`} popupPlacement=\"right\">\n              <button\n                style={styles.removeAssignmentsButton}\n                type=\"button\"\n                onClick={handleOnRemoveAssignments}\n                disabled={!zones.values || zones.values.length === 0}\n              >\n                <FaUnlink />\n              </button>\n            </ToolTip>\n            <ToggleButton\n              popupTitle=\"show/hide zones\"\n              popupPlacement=\"right\"\n              style={styles.toggle}\n              defaultValue\n              onClick={() => visibilityHandler('zones')}\n            >\n              <span style={{ fontSize: '12px', pointerEvents: 'none' }}>z</span>\n            </ToggleButton>\n            <ToggleButton\n              popupTitle=\"show/hide signals\"\n              popupPlacement=\"right\"\n              style={styles.toggle}\n              defaultValue\n              onClick={() => visibilityHandler('signals')}\n            >\n              <span style={{ fontSize: '12px', pointerEvents: 'none' }}>s</span>\n            </ToggleButton>\n            <ToggleButton\n              popupTitle=\"show/hide peaks\"\n              popupPlacement=\"right\"\n              style={styles.toggle}\n              defaultValue\n              onClick={() => visibilityHandler('peaks')}\n            >\n              <span style={{ fontSize: '12px', pointerEvents: 'none' }}>p</span>\n            </ToggleButton>\n          </DefaultPanelHeader>\n        )}\n        {isFlipped && (\n          <PreferencesHeader\n            onSave={saveSettingHandler}\n            onClose={settingsPanelHandler}\n          />\n        )}\n        <div style={{ height: '100%', overflow: 'hidden' }}>\n          <ReactCardFlip\n            isFlipped={isFlipped}\n            infinite\n            containerStyle={{ overflow: 'hidden', height: '100%' }}\n          >\n            <div style={{ overflow: 'auto', height: '100%', display: 'block' }}>\n              {tableData && tableData.length > 0 ? (\n                <ZonesTable\n                  tableData={tableData}\n                  onUnlink={unlinkZoneHandler}\n                  preferences={zonesPreferences}\n                  nuclei={\n                    activeTab && activeTab.split(',').length === 2\n                      ? activeTab.split(',')\n                      : ['?', '?']\n                  }\n                />\n              ) : (\n                <NoTableData />\n              )}\n            </div>\n            <ZonesPreferences ref={settingRef} />\n          </ReactCardFlip>\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default ZonesWrapper(memo(ZonesPanel));\n","import { memo } from 'react';\n\nconst styles = {\n  width: '100%',\n  height: '100%',\n  padding: '0px',\n  display: 'flex',\n  flexDirection: 'column',\n};\nfunction Table({ children, className, style }) {\n  return (\n    <div className={className} style={{ ...styles, ...style }}>\n      {children}\n    </div>\n  );\n}\n\nexport default memo(Table);\n","import { useMemo, memo, Children, cloneElement } from 'react';\n\nconst styles = {\n  width: '100%',\n  overflowY: 'auto',\n  display: 'flex',\n  flexDirection: 'column',\n  padding: '5px 0px',\n  color: 'gray',\n};\nfunction TableBody({ children, className, style }) {\n  const mappedChildren = useMemo(() => {\n    return Children.map(children, (child) =>\n      cloneElement(child, {\n        style: { borderBottom: '0.55px solid #d8d8d8', ...child.props.style },\n      }),\n    );\n  }, [children]);\n\n  return (\n    <div className={className} style={{ ...styles, style }}>\n      {mappedChildren}\n    </div>\n  );\n}\n\nexport default memo(TableBody);\n","import { memo } from 'react';\n\nconst styles = {\n  width: '100%',\n  display: 'flex',\n  alignItems: 'flex-start',\n};\n\nfunction getVAlign(align) {\n  if (align.toLowerCase() === 'top') {\n    return 'flex-start';\n  } else if (align.toLowerCase() === 'bottom') {\n    return 'flex-end';\n  }\n  return 'center';\n}\nfunction TableHeader({\n  children,\n  className,\n  style,\n  align = 'center',\n  vAlign = 'center',\n  size = 1,\n  onClick,\n}) {\n  return (\n    <div\n      className={className}\n      style={{\n        ...styles,\n        alignItems: getVAlign(vAlign),\n        textAlign: align,\n        flex: size,\n        ...style,\n      }}\n      onClick={onClick}\n    >\n      {children}\n    </div>\n  );\n}\n\nTableHeader.defaultProps = {\n  onClick: () => null,\n};\n\nexport default memo(TableHeader);\n","import { memo } from 'react';\n\nconst styles = {\n  width: '100%',\n  display: 'flex',\n  padding: '0px 5px',\n  color: '#424242',\n  backgroundColor: '#d8d8d8',\n  borderBottom: '0.55px solid #d8d8d8',\n  fontSize: 11,\n  fontWeight: 'bold',\n};\nfunction TableHead({ children, className, style }) {\n  return (\n    <div className={className} style={{ ...styles, ...style }}>\n      {children}\n    </div>\n  );\n}\n\nexport default memo(TableHead);\n","import { memo } from 'react';\n\nconst styles = {\n  width: '100%',\n  display: 'flex',\n  padding: '5px 0px',\n};\nfunction TableHeader({ children, className, style, onClick }) {\n  return (\n    <div\n      className={className}\n      style={{ ...styles, ...style }}\n      onClick={onClick}\n    >\n      {children}\n    </div>\n  );\n}\n\nTableHeader.defaultProps = {\n  onClick: () => null,\n};\n\nexport default memo(TableHeader);\n","import { forwardRef, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction FiltersWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const { data, activeSpectrum } = useChartData();\n\n    const { filters = [] } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const datum = data.find((datum) => datum.id === activeSpectrum.id) || {\n          filters: [],\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, data]);\n    const { forwardedRef, ...rest } = props;\n    return <WrappedComponent {...rest} filters={filters} ref={forwardedRef} />;\n  };\n\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default FiltersWrapper;\n","import { useMemo, useCallback, memo, useState } from 'react';\nimport { FaRegTrashAlt } from 'react-icons/fa';\nimport { ObjectInspector } from 'react-inspector';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport CheckBox from '../../elements/CheckBox';\nimport { TableCell, TableRow } from '../../elements/Table';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport {\n  ENABLE_FILTER,\n  DELETE_FILTER,\n  SET_FILTER_SNAPSHOT,\n  DELETE_SPECTRA_FILTER,\n} from '../../reducer/types/Types';\n\nconst styles = {\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n    height: 25,\n    width: 25,\n    padding: '5px',\n  },\n  active: {\n    backgroundColor: '#fbfbfb',\n    borderTop: '1px solid #817066',\n    borderBottom: '1px solid #817066',\n  },\n};\nfunction FiltersTableRow({ filters }) {\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const alert = useAlert();\n  const [selectedFilterID, setSelectedFilter] = useState();\n\n  const handelFilterCheck = useCallback(\n    (id, checked) => {\n      dispatch({ type: ENABLE_FILTER, id, checked });\n    },\n    [dispatch],\n  );\n  const handelDeleteFilter = useCallback(\n    ({ id, name }) => {\n      modal.showConfirmDialog({\n        message: 'Filter/s will be deleted, Are You sure?',\n        buttons: [\n          {\n            text: 'Yes,All spectra',\n            handler: async () => {\n              const hideLoading = await alert.showLoading(\n                'Delete all spectra filter processs in progress',\n              );\n              dispatch({\n                type: DELETE_SPECTRA_FILTER,\n                payload: { filterType: name },\n              });\n              hideLoading();\n            },\n          },\n          {\n            text: 'Yes ',\n            handler: async () => {\n              const hideLoading = await alert.showLoading(\n                'Delete filter processs in progress',\n              );\n              dispatch({ type: DELETE_FILTER, payload: { id } });\n              hideLoading();\n            },\n          },\n          { text: 'No' },\n        ],\n      });\n    },\n    [alert, dispatch, modal],\n  );\n  const filterSnapShotHandler = useCallback(\n    (newID) => {\n      setSelectedFilter((prevId) => {\n        const id = prevId === newID ? null : newID;\n        dispatch({ type: SET_FILTER_SNAPSHOT, id });\n        return id;\n      });\n    },\n    [dispatch],\n  );\n  const filtersTableRow = useMemo(() => {\n    return (\n      filters &&\n      filters.map((d) => (\n        <TableRow\n          key={d.id}\n          style={d.id === selectedFilterID ? { ...styles.active } : {}}\n        >\n          <TableCell\n            align=\"center\"\n            size=\"2\"\n            onClick={() => filterSnapShotHandler(d.id)}\n          >\n            {d.label}\n          </TableCell>\n          <TableCell align=\"left\" size=\"3\">\n            <div onClick={(e) => e.stopPropagation()}>\n              <ObjectInspector data={d.error ? d.error : d.value} />\n            </div>\n          </TableCell>\n          <TableCell align=\"center\" vAlign=\"center\" size=\"1\">\n            <CheckBox\n              checked={d.flag}\n              onChange={(event) =>\n                handelFilterCheck(d.id, event.target.checked)\n              }\n            />\n            {d.isDeleteAllow && (\n              <button\n                style={styles.button}\n                type=\"button\"\n                onClick={() => handelDeleteFilter(d)}\n              >\n                <FaRegTrashAlt />\n              </button>\n            )}\n          </TableCell>\n        </TableRow>\n      ))\n    );\n  }, [\n    filterSnapShotHandler,\n    filters,\n    handelDeleteFilter,\n    handelFilterCheck,\n    selectedFilterID,\n  ]);\n  return filtersTableRow;\n}\n\nexport default memo(FiltersTableRow);\n","import { useMemo, memo } from 'react';\n\nimport {\n  Table,\n  TableHead,\n  TableCell,\n  TableBody,\n  TableRow,\n} from '../../elements/Table';\nimport FiltersWrapper from '../../hoc/FiltersWrapper';\nimport NoTableData from '../extra/placeholder/NoTableData';\n\nimport FiltersTableRow from './FiltersTableRow';\n\nfunction FilterPanel({ filters }) {\n  const filtersTable = useMemo(() => {\n    return filters ? (\n      <Table>\n        <TableHead>\n          <TableRow>\n            <TableCell align=\"center\" size=\"1\">\n              Label\n            </TableCell>\n            <TableCell align=\"center\" size=\"2\">\n              Properties\n            </TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          <FiltersTableRow filters={filters} />\n        </TableBody>\n      </Table>\n    ) : (\n      <NoTableData />\n    );\n  }, [filters]);\n\n  return filtersTable;\n}\n\nexport default FiltersWrapper(memo(FilterPanel));\n","import lodashGet from 'lodash/get';\nimport { useCallback, useState, useEffect, memo } from 'react';\n\nimport { usePreferences } from '../context/PreferencesContext';\nimport { Accordion, AccordionItem } from '../elements/accordion';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\nimport { options } from '../toolbar/ToolTypes';\n\nimport InformationPanel from './InformationPanel';\nimport IntegralPanel from './IntegralsPanel/IntegralPanel';\nimport MoleculePanel from './MoleculesPanel/MoleculePanel';\nimport MultipleSpectraAnalysisPanel from './MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisPanel';\nimport PeaksPanel from './PeaksPanel/PeaksPanel';\nimport RangesPanel from './RangesPanel/RangesPanel';\nimport SpectrumListPanel from './SpectrumsPanel/SpectrumListPanel';\nimport SummaryPanel from './SummaryPanel/SummaryPanel';\nimport ZonesPanel from './ZonesPanel/ZonesPanel';\nimport FilterPanel from './filtersPanel/FilterPanel';\n\nconst accordionItems = [\n  {\n    title: 'Spectra',\n    component: <SpectrumListPanel />,\n    openWhen: null,\n    style: '',\n    hidePreferenceKey: 'hideSpectraPanel',\n    mode: null,\n  },\n  {\n    title: 'Information',\n    component: <InformationPanel />,\n    openWhen: null,\n    style: { overflow: 'hidden' },\n    hidePreferenceKey: 'hideInformationPanel',\n    mode: null,\n  },\n  {\n    title: 'Peaks',\n    component: <PeaksPanel />,\n    openWhen: [options.peakPicking.id],\n    style: '',\n    hidePreferenceKey: 'hidePeaksPanel',\n    mode: null,\n  },\n  {\n    title: 'Filters',\n    component: <FilterPanel />,\n    openWhen: null,\n    style: '',\n    hidePreferenceKey: 'hideFiltersPanel',\n    mode: null,\n  },\n  {\n    title: 'Integrals',\n    component: <IntegralPanel />,\n    openWhen: [options.integral.id],\n    style: '',\n    hidePreferenceKey: 'hideIntegralsPanel',\n    mode: null,\n  },\n  {\n    title: 'Ranges',\n    component: <RangesPanel />,\n    openWhen: [options.rangesPicking.id],\n    style: '',\n    hidePreferenceKey: 'hideRangesPanel',\n    mode: DISPLAYER_MODE.DM_1D,\n  },\n  {\n    title: 'Multiple Spectra Analysis',\n    component: <MultipleSpectraAnalysisPanel />,\n    openWhen: [options.multipleSpectraAnalysis.id],\n    style: '',\n    hidePreferenceKey: 'hideMultipleSpectraAnalysisPanel',\n    mode: null,\n  },\n  {\n    title: 'Zones',\n    component: <ZonesPanel />,\n    openWhen: [options.zone2D.id],\n    style: '',\n    hidePreferenceKey: 'hideZonesPanel',\n    mode: DISPLAYER_MODE.DM_2D,\n  },\n  {\n    title: 'Summary',\n    component: <SummaryPanel />,\n    openWhen: [],\n    style: '',\n    hidePreferenceKey: 'hideSummaryPanel',\n    mode: null,\n  },\n  {\n    title: 'Structures',\n    component: <MoleculePanel />,\n    openWhen: [options.rangesPicking.id],\n    style: '',\n    hidePreferenceKey: 'hideStructuresPanel',\n    mode: null,\n  },\n];\n\nfunction Panels({ selectedTool, displayerMode }) {\n  const [panelIndex, setSelectedPanelIndex] = useState(0);\n  const preferences = usePreferences();\n\n  useEffect(() => {\n    function getDefaultIndex() {\n      const index = accordionItems.findIndex(\n        (item) => item.openWhen && item.openWhen.includes(selectedTool),\n      );\n      return index !== -1 ? index : null;\n    }\n    const index = getDefaultIndex();\n    if (selectedTool) {\n      setSelectedPanelIndex(index);\n    }\n  }, [selectedTool]);\n\n  const check = useCallback(\n    (item) => {\n      return (\n        !lodashGet(preferences, `display.panels.${item.hidePreferenceKey}`) &&\n        (item.mode == null || item.mode === displayerMode)\n      );\n    },\n    [displayerMode, preferences],\n  );\n\n  return (\n    <Accordion defaultOpenIndex={panelIndex}>\n      {accordionItems.map((item) => {\n        return (\n          check(item) && (\n            <AccordionItem\n              key={item.title}\n              title={item.title}\n              style={item.style}\n            >\n              {item.component}\n            </AccordionItem>\n          )\n        );\n      })}\n    </Accordion>\n  );\n}\n\nexport default memo(Panels);\n","import * as types from './types/Types';\n\nconst ignoreActions = [\n  types.APPLY_KEY_PREFERENCES,\n  types.BRUSH_END,\n  types.RESET_DOMAIN,\n  types.RESET_SELECTED_TOOL,\n  types.SET_KEY_PREFERENCES,\n  types.SET_LOADING_FLAG,\n  types.SET_ORIGINAL_DOMAIN,\n  types.SET_SELECTED_FILTER,\n  types.SET_SELECTED_OPTIONS_PANEL,\n  types.SET_SELECTED_TOOL,\n  types.SET_SPECTRUMS_VERTICAL_ALIGN,\n  types.SET_VERTICAL_INDICATOR_X_POSITION,\n  types.SET_WIDTH,\n  types.SET_DIMENSIONS,\n  types.SET_X_DOMAIN,\n  types.SET_Y_DOMAIN,\n  types.SET_ZOOM_FACTOR,\n  types.TOGGLE_REAL_IMAGINARY_VISIBILITY,\n  types.CALCULATE_MANUAL_PHASE_CORRECTION_FILTER,\n  types.CHANGE_SPECTRUM_DISPLAY_VIEW_MODE,\n  types.FULL_ZOOM_OUT,\n  types.SAVE_AS_SVG,\n  types.SAVE_DATA_AS_JSON,\n  types.SET_ACTIVE_TAB,\n  types.CHANGE_VISIBILITY,\n  types.CHANGE_PEAKS_MARKERS_VISIBILITY,\n  types.CHANGE_ACTIVE_SPECTRUM,\n  types.CHANGE_INTEGRAL_ZOOM,\n  types.CHANGE_SPECTRUM_COLOR,\n];\n\nfunction checkActionType(type: string): boolean {\n  if (!ignoreActions.includes(type)) return true;\n  return false;\n}\n\nexport default checkActionType;\n","import { NmrRecord, parseSDF } from 'nmredata';\n\nimport { addBruker, addJcamp } from '../../data/SpectraManager';\nimport { detectRanges, mapRanges } from '../../data/data1d/Datum1D';\nimport { detectZones } from '../../data/data2d/Datum2D';\n\nconst computeDistance = (s1, s2) =>\n  ['x', 'y'].reduce(\n    (dist, axis) => Math.pow(s2[axis].delta - s1[axis].delta, 2) + dist,\n    0,\n  );\n\nexport async function nmredataToNmrium(zipFilesValues) {\n  let files = {};\n  for (const file of zipFilesValues) files[file.name] = file;\n  const sdfFiles = await getSDF(files);\n  const jsonData = await NmrRecord.toJSON({\n    sdf: sdfFiles[0],\n    zipFiles: files,\n  });\n\n  let { spectra, molecules = [] } = jsonData;\n\n  let nmrium = {\n    spectra: [],\n    molecules,\n  };\n\n  for (const data of spectra) {\n    const { zip, jcamp } = data.source;\n\n    let spectrum = zip\n      ? await addBruker({ xy: true, noContours: true }, zip)\n      : (spectrum = addJcamp({}, jcamp));\n\n    const { info } = spectrum[0];\n    if (info.dimension > 1) {\n      detectZones(spectrum[0], {});\n      assignZones(spectrum[0], data.signals);\n    } else {\n      detectRanges(spectrum[0], {});\n      assignRanges(spectrum[0], data.signals);\n    }\n    nmrium.spectra.push(...spectrum);\n  }\n\n  return nmrium;\n}\n\nasync function getSDF(zipFiles) {\n  let result = [];\n  for (const file in zipFiles) {\n    const pathFile = file.split('/');\n    if (pathFile[pathFile.length - 1].match(/^[^.].+sdf$/)) {\n      const filename = pathFile[pathFile.length - 1].replace(/\\.sdf/, '');\n      const root = pathFile.slice(0, pathFile.length - 1).join('/');\n      const sdf = await zipFiles[file].async('string');\n      let parserResult = parseSDF(`${sdf}`, { mixedEOL: true });\n      parserResult.filename = filename;\n      parserResult.root = root !== '' ? `${root}/` : '';\n      result.push(parserResult);\n    }\n  }\n  return result;\n}\n\nfunction assignZones(datum, eSignals) {\n  let zones = datum.zones.values;\n  let signals = eSignals.slice();\n  for (let zone of zones) {\n    let signalsInside = [];\n    for (let i = 0; i < signals.length; i++) {\n      let isInside = 0;\n      let signal = signals[i];\n      for (let axis of ['x', 'y']) {\n        let { from, to } = zone[axis];\n        let deltaIn = signal[axis].delta;\n        if (deltaIn >= from && deltaIn <= to) isInside++;\n      }\n      if (isInside > 1) {\n        signalsInside.push(signal);\n        signals.splice(i, 1);\n        i--;\n      }\n    }\n    if (signalsInside.length > 0) {\n      for (let signal of signalsInside) {\n        for (let axis of ['x', 'y']) {\n          if (!signal[axis].diaID) continue;\n          let index = closeSignalIndex(signal, zone);\n          zone.signal[index][axis].diaID = signal[axis].diaID;\n        }\n      }\n    }\n  }\n}\n\nfunction closeSignalIndex(signal, zone) {\n  const signals = zone.signal;\n  if (signals.length === 1) return 0;\n\n  let index = 0;\n  let distance = computeDistance(signals[0], signal);\n  for (let i = 0; i < signals.length; i++) {\n    let currentDistance = computeDistance(signals[i], signal);\n    if (currentDistance < distance) {\n      index = i;\n      distance = currentDistance;\n    }\n  }\n  return index;\n}\n\nfunction assignRanges(datum, signals) {\n  let ranges = datum.ranges.values.slice();\n  ranges.sort((a, b) => a.from - b.from);\n  signals.sort((a, b) => a.delta - b.delta);\n  for (let range of ranges) {\n    let { from, to } = range;\n    let signalsInside = [];\n    for (let signal of signals) {\n      if (signal.delta >= from && signal.delta <= to) {\n        let { jCoupling: j, delta, diaID = [], multiplicity } = signal;\n        signalsInside.push({ j, delta, diaID, multiplicity });\n      }\n      if (signal.delta > to) break;\n    }\n    if (signalsInside.length > 0) range.signal = signalsInside;\n  }\n  datum.ranges.values = [];\n  datum.ranges.values = mapRanges(ranges, datum);\n}\n","import { original, Draft } from 'immer';\nimport lodashCloneDeep from 'lodash/cloneDeep';\nimport { Build, CorrelationUtilities, Types } from 'nmr-correlation';\n\nimport { State } from '../Reducer';\n\nfunction handleUpdateCorrelations(draft: Draft<State>) {\n  const { data: spectra, correlations } = draft;\n  draft.correlations = Build.build(\n    spectra as Types.Spectra,\n    correlations.options,\n    lodashCloneDeep(correlations.values),\n  );\n}\n\nfunction handleSetMF(draft: Draft<State>, payload: { mf: string }) {\n  const state = original(draft) as State;\n  const { data: spectra, correlations } = state;\n  const { mf } = payload;\n  // update of correlation data is needed only if the following is true\n  if (correlations.options.mf === '' || correlations.options.mf !== mf) {\n    draft.correlations = Build.build(\n      spectra as Types.Spectra,\n      { ...correlations.options, mf },\n      lodashCloneDeep(correlations.values),\n    );\n  }\n}\n\nfunction handleSetTolerance(\n  draft: Draft<State>,\n  payload: { tolerance: Types.Tolerance },\n) {\n  const state = original(draft) as State;\n  const { data: spectra, correlations } = state;\n  const { tolerance } = payload;\n  draft.correlations = Build.build(\n    spectra as Types.Spectra,\n    { ...correlations.options, tolerance },\n    lodashCloneDeep(correlations.values),\n  );\n}\n\nfunction handleSetCorrelation(\n  draft: Draft<State>,\n  payload: { id: string; correlation: Types.Correlation },\n) {\n  const state = original(draft) as State;\n  const { correlations } = state;\n  const { id, correlation } = payload;\n  draft.correlations = CorrelationUtilities.setCorrelation(\n    correlations,\n    id,\n    correlation,\n  );\n  handleUpdateCorrelations(draft);\n}\n\nfunction handleSetCorrelations(\n  draft: Draft<State>,\n  payload: { ids: Array<string>; correlations: Types.Values },\n) {\n  const { ids, correlations } = payload;\n  ids.forEach((id, i) => {\n    const { correlations: correlationsData } = draft;\n    draft.correlations = CorrelationUtilities.setCorrelation(\n      correlationsData,\n      id,\n      correlations[i],\n    );\n  });\n  handleUpdateCorrelations(draft);\n}\n\nexport {\n  handleUpdateCorrelations,\n  handleSetCorrelation,\n  handleSetCorrelations,\n  handleSetMF,\n  handleSetTolerance,\n};\n","import { extent } from 'd3';\nimport { Draft } from 'immer';\nimport { xyIntegral } from 'ml-spectra-processing';\n\nimport { Datum1D } from '../../../data/data1d/Datum1D';\nimport { Datum2D } from '../../../data/data2d/Datum2D';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\nimport { State } from '../Reducer';\nimport { DISPLAYER_MODE } from '../core/Constants';\n\nfunction getActiveData(draft: Draft<State>) {\n  if (draft.activeTab) {\n    const groupByNucleus = GroupByInfoKey('nucleus');\n    let data = groupByNucleus(draft.data)[draft.activeTab];\n    if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n      return data;\n    } else {\n      if (draft.activeSpectrum && data) {\n        const activeSpectrumIndex = data.findIndex(\n          (datum) => datum.id === draft.activeSpectrum.id,\n        );\n        if (activeSpectrumIndex !== -1) {\n          const isFid = data[activeSpectrumIndex].info.isFid || false;\n          data = data.filter((datum) => datum.info.isFid === isFid);\n        }\n      } else {\n        data = data ? data.filter((datum) => datum.info.isFid === false) : [];\n      }\n\n      for (let datum of draft.data) {\n        if (data.some((activeData: any) => activeData.id === datum.id)) {\n          // AnalysisObj.getDatum(datum.id).isVisibleInDomain = true;\n          (datum as Datum2D | Datum1D).display.isVisibleInDomain = true;\n        } else {\n          // AnalysisObj.getDatum(datum.id).isVisibleInDomain = false;\n          (datum as Datum2D | Datum1D).display.isVisibleInDomain = false;\n        }\n      }\n      return draft.data;\n    }\n  } else {\n    return draft.data;\n  }\n}\n\nfunction getDomain(data) {\n  let xArray = [];\n  let yArray = [];\n  let yDomains = {};\n  let xDomains = {};\n  let integralYDomain = {};\n  try {\n    xArray = data.reduce((acc, d: Datum1D) => {\n      const { display, data } = d;\n      if (display.isVisibleInDomain) {\n        const domain = [data.x[0], data.x[data.x.length - 1]];\n        xDomains[d.id] = domain;\n        if (display.isVisible) {\n          acc = acc.concat(domain);\n        }\n        return acc;\n      } else {\n        return acc.concat([]);\n      }\n    }, []);\n\n    yArray = data.reduce((acc, d: Datum1D) => {\n      const { display, data, integrals } = d;\n      if (display.isVisibleInDomain) {\n        const _extent = extent(data.y);\n        yDomains[d.id] = _extent;\n        if (integrals.values && integrals.values.length > 0) {\n          const values = integrals.values;\n          const { from = 0, to = 0 } = values[0];\n          const { x, y } = data;\n          const integralResult = xyIntegral(\n            { x: x, y: y },\n            {\n              from: from,\n              to: to,\n              reverse: true,\n            },\n          );\n          integralYDomain[d.id] = extent(integralResult.y);\n        }\n        if (display.isVisible) {\n          acc = acc.concat(_extent);\n        }\n        return acc;\n      } else {\n        return acc.concat([]);\n      }\n    }, []);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n\n  return {\n    xDomain: extent(xArray),\n    yDomain: extent(yArray),\n    yDomains,\n    xDomains,\n    integralYDomain,\n  };\n}\nfunction get2DDomain(state) {\n  let xArray = [];\n  let yArray = [];\n  let yDomains = {};\n  let xDomains = {};\n\n  const { activeTab, tabActiveSpectrum, data } = state;\n\n  const nucleus = activeTab.split(',');\n\n  try {\n    xArray = data.reduce((acc, datum: Datum1D | Datum2D) => {\n      if (datum.info.dimension === 2) {\n        acc = acc.concat([\n          (datum as Datum2D).data.minX,\n          (datum as Datum2D).data.maxX,\n        ]);\n      }\n      return acc;\n    }, []);\n\n    yArray = data.reduce((acc, datum: Datum1D | Datum2D) => {\n      if (\n        datum.info.dimension === 2 &&\n        datum.info.nucleus?.join(',') === activeTab\n      ) {\n        acc = acc.concat([\n          (datum as Datum2D).data.minY,\n          (datum as Datum2D).data.maxY,\n        ]);\n      }\n      return acc;\n    }, []);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n\n  const spectrumsIDs = nucleus.map((n) => tabActiveSpectrum[n]?.id);\n\n  const filteredData = data.reduce((acc, datum: Datum1D | Datum2D) => {\n    return spectrumsIDs.includes(datum.id) && datum.info.dimension === 1\n      ? acc.concat(datum)\n      : acc.concat([]);\n  }, []);\n  try {\n    xDomains = filteredData.reduce((acc, d: Datum1D) => {\n      const { x } = d.data;\n      const domain = [x[0], x[x.length - 1]];\n      acc[d.id] = domain;\n      return acc;\n    }, {});\n\n    yDomains = filteredData.reduce((acc, d: Datum1D) => {\n      const _extent = extent(d.data.y);\n      acc[d.id] = _extent;\n      return acc;\n    }, {});\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n\n  return {\n    xDomain: extent(xArray),\n    yDomain: extent(yArray),\n    yDomains,\n    xDomains,\n  };\n}\n\nfunction setDomain(draft: Draft<State>, isYDomainChanged = true) {\n  let domain;\n  const data = getActiveData(draft);\n\n  if (\n    draft.activeTab &&\n    [DISPLAYER_MODE.DM_1D, DISPLAYER_MODE.DM_2D].includes(draft.displayerMode)\n  ) {\n    domain =\n      draft.displayerMode === DISPLAYER_MODE.DM_1D\n        ? getDomain(data)\n        : get2DDomain(draft);\n    draft.xDomain = domain.xDomain;\n    draft.xDomains = domain.xDomains;\n    if (isYDomainChanged) {\n      draft.yDomain = domain.yDomain;\n\n      if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n        draft.yDomains = Object.keys(domain.yDomains).reduce((acc, key) => {\n          acc[key] = domain.yDomain;\n          return acc;\n        }, {});\n        draft.originDomain = {\n          ...domain,\n          yDomains: draft.yDomains,\n          originYDomains: domain.yDomains,\n        };\n      } else {\n        draft.yDomains = domain.yDomains;\n        draft.originDomain = domain;\n      }\n\n      draft.integralsYDomains =\n        domain.integralYDomain && domain.integralYDomain;\n      draft.originIntegralYDomain =\n        domain.integralYDomain && domain.integralYDomain;\n    } else {\n      draft.originDomain = {\n        ...draft.originDomain,\n        xDomain: domain.xDomain,\n        xDomains: domain.xDomains,\n      };\n    }\n  }\n}\n\nfunction setOriginalDomain(draft: Draft<State>, originDomain) {\n  draft.originDomain = originDomain;\n}\n\nfunction setXDomain(draft: Draft<State>, xDomain) {\n  draft.xDomain = xDomain;\n}\n\nfunction setYDomain(draft: Draft<State>, yDomain) {\n  draft.yDomain = yDomain;\n}\n\nfunction handelResetDomain(draft: Draft<State>) {\n  const { xDomain, yDomain, xDomains, yDomains } = draft.originDomain;\n  draft.xDomain = xDomain;\n  draft.yDomain = yDomain;\n  draft.xDomains = xDomains;\n  draft.yDomains = yDomains;\n}\n\nfunction setMode(draft) {\n  const data = getActiveData(draft).filter(\n    (datum) => datum.display.isVisibleInDomain === true,\n  );\n  draft.mode = (data[0] as Datum1D)?.info.isFid ? 'LTR' : 'RTL';\n}\n\nfunction handleChangeIntegralYDomain(draft, newYDomain) {\n  const activeSpectrum = draft.activeSpectrum;\n  if (activeSpectrum) {\n    draft.integralsYDomains[activeSpectrum.id] = newYDomain;\n  }\n}\n\nexport {\n  getDomain,\n  setOriginalDomain,\n  setXDomain,\n  setYDomain,\n  handelResetDomain,\n  setDomain,\n  setMode,\n  handleChangeIntegralYDomain,\n};\n","export default function nucluesToString(nuclues) {\n  return typeof nuclues === 'string' ? nuclues : nuclues.join(',');\n}\n","function getClosestNumber(array = [], goal = 0) {\n  const closest = array.reduce((prev, curr) => {\n    return Math.abs(curr - goal) < Math.abs(prev - goal) ? curr : prev;\n  });\n  return closest;\n}\n\nexport default getClosestNumber;\n","export default class ZoomHistory {\n  constructor() {\n    this.stack = [];\n  }\n\n  static getInstance(ZoomHistoryInstances, nucleus) {\n    if (\n      ZoomHistoryInstances[nucleus] &&\n      ZoomHistoryInstances[nucleus] instanceof ZoomHistory\n    ) {\n      return ZoomHistoryInstances[nucleus];\n    }\n    ZoomHistoryInstances[nucleus] = new ZoomHistory();\n    return ZoomHistoryInstances[nucleus];\n  }\n\n  push(val) {\n    this.stack.push(val);\n  }\n\n  pop() {\n    const val = this.stack.pop();\n    return val ? this.stack[this.stack.length - 1] : null;\n  }\n\n  getLast() {\n    if (this.stack.length === 0) return null;\n    return this.stack[this.stack.length - 1];\n  }\n}\n","import { Draft, original } from 'immer';\nimport cloneDeep from 'lodash/cloneDeep';\nimport lodashGet from 'lodash/get';\n\nimport { Datum1D } from '../../../data/data1d/Datum1D';\nimport { Datum2D } from '../../../data/data2d/Datum2D';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\nimport nucluesToString from '../../utility/nucluesToString';\nimport { State } from '../Reducer';\nimport { DEFAULT_YAXIS_SHIFT_VALUE, DISPLAYER_MODE } from '../core/Constants';\n\nimport { setDomain } from './DomainActions';\nimport { setZoom } from './Zoom';\n\nfunction handelSetPreferences(draft: Draft<State>, action) {\n  const { type, values } = action;\n  const panelsPreferences = lodashGet(draft.preferences, 'panels', {});\n  draft.preferences.panels = { ...panelsPreferences, [type]: values };\n}\n\nfunction changeSpectrumVerticalAlignment(\n  draft: Draft<State>,\n  center,\n  checkData = false,\n) {\n  if (draft.data && draft.data.length > 0) {\n    if (\n      center ||\n      (checkData &&\n        (draft.data[0] as Datum1D).info.isFid &&\n        !(draft.data as Datum1D[]).some((d) => d.info.isFid === false))\n    ) {\n      const YAxisShift = draft.height / 2;\n      draft.verticalAlign.flag = true;\n      draft.verticalAlign.value = YAxisShift;\n      draft.verticalAlign.stacked = false;\n    } else {\n      draft.verticalAlign.flag = false;\n      draft.verticalAlign.value = DEFAULT_YAXIS_SHIFT_VALUE;\n      draft.verticalAlign.stacked = false;\n    }\n  }\n}\n\nfunction setKeyPreferencesHandler(draft: Draft<State>, keyCode) {\n  const state = original(draft) as State;\n  const {\n    activeTab,\n    data,\n    activeSpectrum,\n    zoomFactor,\n    xDomain,\n    xDomains,\n    yDomain,\n    yDomains,\n    originDomain,\n    margin,\n    displayerMode,\n    tabActiveSpectrum,\n  } = state;\n  if (activeTab) {\n    const groupByNucleus = GroupByInfoKey('nucleus');\n\n    const spectrumsGroupsList = groupByNucleus(data);\n\n    const level =\n      displayerMode === DISPLAYER_MODE.DM_2D\n        ? spectrumsGroupsList[activeTab].reduce((acc, datum) => {\n            acc[datum.id] = datum.processingController.getLevel();\n            return acc;\n          }, {})\n        : null;\n\n    draft.keysPreferences[keyCode] = {\n      activeTab,\n      activeSpectrum,\n      displayerMode,\n      tabActiveSpectrum,\n      zoomFactor,\n      xDomain,\n      xDomains,\n      yDomain,\n      yDomains,\n      originDomain,\n      level,\n      margin,\n      data: spectrumsGroupsList[activeTab].reduce((acc, datum) => {\n        acc[datum.id] = {\n          display: {\n            color: datum.display.color,\n            isVisible: datum.display.isVisible,\n            isPeaksMarkersVisible: datum.display.isPeaksMarkersVisible,\n          },\n        };\n        return acc;\n      }, {}),\n    };\n  }\n}\n\nfunction applyKeyPreferencesHandler(draft: Draft<State>, keyCode) {\n  const state = original(draft) as State;\n\n  const preferences = state.keysPreferences[keyCode];\n  if (preferences) {\n    draft.activeTab = preferences.activeTab;\n    (state.data as Datum1D[] | Datum2D[]).forEach((datum, index) => {\n      if (nucluesToString(datum.info.nucleus) === preferences.activeTab) {\n        draft.data[index].display = Object.assign(\n          cloneDeep(datum.display),\n          preferences.data[datum.id].display,\n        );\n      }\n    });\n    draft.displayerMode = preferences.displayerMode;\n    draft.tabActiveSpectrum = preferences.tabActiveSpectrum;\n    draft.activeSpectrum = preferences.activeSpectrum;\n\n    draft.margin = preferences.margin;\n\n    setDomain(draft);\n\n    draft.xDomain = preferences.xDomain;\n    draft.xDomains = preferences.xDomains;\n    draft.yDomain = preferences.yDomain;\n    draft.originDomain = preferences.originDomain;\n    draft.yDomains = preferences.yDomains;\n\n    if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n      // draft.yDomains = preferences.yDomains;\n\n      for (const datumID of Object.keys(preferences.level)) {\n        const { levelPositive, levelNegative } = preferences.level[datumID];\n        const index = state.data.findIndex((datum) => datum.id === datumID);\n        const processController = (draft.data[index] as Datum2D)\n          .processingController;\n        processController.setLevel(levelPositive, levelNegative);\n        draft.contours[datumID] = processController.drawContours();\n      }\n    } else {\n      setZoom(\n        // {\n        //   ...state,\n        //   activeSpectrum: draft.activeSpectrum,\n        //   activeTab: draft.activeTab,\n        // },\n        draft,\n        preferences.zoomFactor.scale,\n      );\n    }\n  }\n}\n\nexport {\n  changeSpectrumVerticalAlignment,\n  handelSetPreferences,\n  setKeyPreferencesHandler,\n  applyKeyPreferencesHandler,\n};\n","import { max } from 'd3';\nimport { original, Draft } from 'immer';\n\nimport { Filters } from '../../../data/Filters';\nimport { Data1D, Datum1D } from '../../../data/data1d/Datum1D';\n// import { Datum2D } from '../../../data/data2d/Datum2D';\nimport { Datum2D } from '../../../data/data2d/Datum2D';\nimport generateID from '../../../data/utilities/generateID';\nimport { getYScale, getXScale } from '../../1d/utilities/scale';\nimport { LAYOUT } from '../../2d/utilities/DimensionLayout';\nimport { get2DYScale } from '../../2d/utilities/scale';\nimport { options } from '../../toolbar/ToolTypes';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\nimport { State } from '../Reducer';\nimport {\n  DEFAULT_YAXIS_SHIFT_VALUE,\n  DISPLAYER_MODE,\n  MARGIN,\n} from '../core/Constants';\nimport ZoomHistory from '../helper/ZoomHistory';\n\nimport { setDomain, setMode } from './DomainActions';\nimport { changeSpectrumVerticalAlignment } from './PreferencesActions';\nimport { setZoom1D, setZoom, ZoomType, wheel } from './Zoom';\n\nfunction getStrongestPeak(draft: Draft<State>) {\n  const { activeSpectrum, data } = draft;\n  const activeData = data[activeSpectrum.index].data as Data1D;\n  const strongestPeakValue = max(activeData.y);\n  const index = activeData.y.findIndex((val) => val === strongestPeakValue);\n  return {\n    xValue: activeData.x[index],\n    yValue: strongestPeakValue,\n    index: index,\n  };\n}\n\nfunction setFilterChanges(draft: Draft<State>, selectedFilter) {\n  const activeSpectrumId = draft.activeSpectrum.id;\n\n  //save reduced snapshot\n  //select the equalizer tool when you enable manual phase correction filter\n  if (selectedFilter === Filters.phaseCorrection.id) {\n    draft.tempData = draft.data;\n\n    const { xValue } = getStrongestPeak(draft);\n    draft.pivot = xValue;\n  } else {\n    if (draft.selectedTool === options.phaseCorrection.id) {\n      const spectrumIndex = draft.data.findIndex(\n        (spectrum) => spectrum.id === activeSpectrumId,\n      );\n\n      draft.data[spectrumIndex].data = draft.tempData[spectrumIndex].data;\n    }\n  }\n}\n\nfunction resetTool(draft: Draft<State>, setDefaultTool = true) {\n  draft.selectedOptionPanel = null;\n  if (setDefaultTool) {\n    draft.selectedTool = options.zoom.id;\n  }\n  draft.baseLineZones = [];\n  if (draft.tempData) {\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\n\nfunction resetSelectedTool(draft: Draft<State>, filterOnly = false) {\n  if (\n    (draft.selectedTool && options[draft.selectedTool].isFilter) ||\n    !filterOnly\n  ) {\n    resetTool(draft);\n  }\n}\n\nfunction setSelectedTool(draft: Draft<State>, selectedTool) {\n  if (draft?.data.length > 0) {\n    if (selectedTool) {\n      if (selectedTool !== draft.selectedTool) {\n        resetTool(draft, false);\n      }\n      draft.selectedTool = selectedTool;\n      if (options[selectedTool].hasOptionPanel) {\n        draft.selectedOptionPanel = selectedTool;\n      }\n\n      if (options[selectedTool].isFilter) {\n        setFilterChanges(draft, selectedTool);\n      }\n    } else {\n      resetTool(draft, false);\n    }\n    setMargin(draft);\n  }\n}\n\nfunction setSelectedOptionPanel(draft: Draft<State>, selectedOptionPanel) {\n  draft.selectedOptionPanel = selectedOptionPanel;\n}\n\nfunction setSpectrumsVerticalAlign(draft: Draft<State>) {\n  changeSpectrumVerticalAlignment(draft, !draft.verticalAlign.flag);\n}\n\nfunction handleChangeSpectrumDisplayMode(draft: Draft<State>) {\n  const state = original(draft) as State;\n  const { activeSpectrum, height, activeTab } = draft;\n  let YAxisShift = DEFAULT_YAXIS_SHIFT_VALUE;\n  if (activeSpectrum) {\n    const { index } = activeSpectrum;\n    if ((state.data[index] as Datum1D).info.isFid) {\n      YAxisShift = height / 2;\n    }\n  }\n  draft.verticalAlign.flag = !draft.verticalAlign.stacked;\n  draft.verticalAlign.stacked = !draft.verticalAlign.stacked;\n\n  if (draft.verticalAlign.stacked) {\n    const count = (state.data as Datum1D[]).filter(\n      (datum) => datum.info.nucleus === activeTab,\n    ).length;\n    draft.verticalAlign.value = Math.floor(height / (count + 2));\n  } else {\n    draft.verticalAlign.value = YAxisShift;\n  }\n}\n\nfunction handleAddBaseLineZone(draft: Draft<State>, { from, to }) {\n  const scaleX = getXScale(draft);\n\n  let start = scaleX.invert(from);\n  const end = scaleX.invert(to);\n\n  let zone: any = [];\n  if (start > end) {\n    zone = [end, start];\n  } else {\n    zone = [start, end];\n  }\n\n  const zones = draft.baseLineZones.slice();\n  zones.push({\n    id: generateID(),\n    from: zone[0],\n    to: zone[1],\n  });\n  draft.baseLineZones = zones;\n}\n\nfunction handleDeleteBaseLineZone(draft: Draft<State>, id) {\n  const state = original(draft) as State;\n  draft.baseLineZones = state.baseLineZones.filter((zone) => zone.id !== id);\n}\n\nfunction handleToggleRealImaginaryVisibility(draft) {\n  if (draft.activeSpectrum != null) {\n    const { index } = draft.activeSpectrum;\n\n    draft.data[index].display.isRealSpectrumVisible = !draft.data[index].display\n      .isRealSpectrumVisible;\n    if (draft.data[index].display.isRealSpectrumVisible) {\n      const re = draft.data[index].data.re;\n      if (re !== null && re !== undefined) {\n        draft.data[index].data.y = re;\n      }\n    } else {\n      const im = draft.data[index].data.im;\n\n      if (im !== null && im !== undefined) {\n        draft.data[index].data.y = im;\n      }\n    }\n\n    setDomain(draft);\n  }\n}\n\nfunction handleBrushEnd(draft: Draft<State>, action) {\n  const is2D = draft.displayerMode === DISPLAYER_MODE.DM_2D;\n  const xScale = getXScale(draft);\n\n  const yScale = is2D ? get2DYScale(draft) : getYScale(draft);\n\n  const startX = xScale.invert(action.startX);\n  const endX = xScale.invert(action.endX);\n  const startY = yScale.invert(action.startY);\n  const endY = yScale.invert(action.endY);\n  const domainX = startX > endX ? [endX, startX] : [startX, endX];\n  const domainY = startY > endY ? [endY, startY] : [startY, endY];\n  const brushHistory = ZoomHistory.getInstance(\n    draft.ZoomHistory,\n    draft.activeTab,\n  );\n\n  if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n    switch (action.trackID) {\n      case LAYOUT.CENTER_2D:\n        draft.xDomain = domainX;\n        draft.yDomain = domainY;\n        break;\n      case LAYOUT.TOP_1D:\n        draft.xDomain = domainX;\n        break;\n      case LAYOUT.LEFT_1D:\n        draft.yDomain = domainY;\n        break;\n      default:\n        break;\n    }\n    if (brushHistory) {\n      brushHistory.push({ xDomain: domainX, yDomain: domainY });\n    }\n  } else {\n    draft.xDomain = domainX;\n    if (brushHistory) {\n      brushHistory.push({ xDomain: domainX, yDomain: domainY });\n    }\n  }\n}\nfunction setVerticalIndicatorXPosition(draft: Draft<State>, position) {\n  const scaleX = getXScale(draft);\n  draft.pivot = scaleX.invert(position);\n}\n\nfunction getSpectrumID(draft: Draft<State>, index) {\n  return draft.tabActiveSpectrum[draft.activeTab.split(',')[index]].id;\n}\n\nfunction handleZoom(draft: Draft<State>, action) {\n  const { deltaY, deltaMode, trackID } = action;\n  if (trackID) {\n    switch (trackID) {\n      case LAYOUT.TOP_1D: {\n        const id = getSpectrumID(draft, 0);\n        wheel(deltaY, deltaMode, draft, id);\n        setZoom1D(draft, draft.margin.top, 10, 0);\n        break;\n      }\n      case LAYOUT.LEFT_1D: {\n        const id = getSpectrumID(draft, 1);\n        wheel(deltaY, deltaMode, draft, id);\n        setZoom1D(draft, draft.margin.left, 10, 1);\n        break;\n      }\n      default:\n        break;\n    }\n  } else {\n    wheel(deltaY, deltaMode, draft);\n    setZoom(draft);\n  }\n}\n\nfunction zoomOut(draft: Draft<State>, action) {\n  if (draft?.data.length > 0) {\n    const { zoomType, trackID } = action;\n    const zoomHistory = ZoomHistory.getInstance(\n      draft.ZoomHistory,\n      draft.activeTab,\n    );\n\n    if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n      switch (zoomType) {\n        case ZoomType.HORIZONTAL: {\n          draft.xDomain = draft.originDomain.xDomain;\n          break;\n        }\n        case ZoomType.VERTICAL:\n          setZoom(draft, 0.8);\n          break;\n        case ZoomType.STEP_HROZENTAL: {\n          const zoomValue = zoomHistory.pop();\n          draft.xDomain = zoomValue\n            ? zoomValue.xDomain\n            : draft.originDomain.xDomain;\n          setZoom(draft, 0.8);\n          break;\n        }\n        default: {\n          draft.xDomain = draft.originDomain.xDomain;\n          setZoom(draft, 0.8);\n          break;\n        }\n      }\n    } else {\n      const { xDomain, yDomain, yDomains } = draft.originDomain;\n      switch (trackID) {\n        case LAYOUT.TOP_1D: {\n          const { id } = draft.tabActiveSpectrum[draft.activeTab.split(',')[0]];\n          draft.xDomain = xDomain;\n          draft.yDomains[id] = yDomains[id];\n          break;\n        }\n        case LAYOUT.LEFT_1D: {\n          const { id } = draft.tabActiveSpectrum[draft.activeTab.split(',')[1]];\n          draft.yDomain = yDomain;\n          draft.yDomains[id] = yDomains[id];\n\n          break;\n        }\n        case LAYOUT.CENTER_2D: {\n          const zoomValue = zoomHistory.pop();\n          draft.xDomain = zoomValue ? zoomValue.xDomain : xDomain;\n          draft.yDomain = zoomValue ? zoomValue.yDomain : yDomain;\n          break;\n        }\n        default:\n          draft.xDomain = xDomain;\n          draft.yDomain = yDomain;\n          draft.yDomains = yDomains;\n          break;\n      }\n    }\n  }\n}\n\nfunction hasAcceptedSpectrum(draft: Draft<State>, index) {\n  const nucleuses = draft.activeTab.split(',');\n  return (\n    draft.tabActiveSpectrum[nucleuses[index]] &&\n    !(draft.data[draft.tabActiveSpectrum[nucleuses[index]].index] as Datum1D)\n      .info.isFid\n  );\n}\n\nfunction setMargin(draft: Draft<State>) {\n  if (\n    draft.displayerMode === DISPLAYER_MODE.DM_2D &&\n    draft.selectedTool !== options.slicingTool.id\n  ) {\n    const top = hasAcceptedSpectrum(draft, 0)\n      ? MARGIN['2D'].top\n      : MARGIN['1D'].top;\n    const left = hasAcceptedSpectrum(draft, 1)\n      ? MARGIN['2D'].left\n      : MARGIN['1D'].left;\n    draft.margin = { ...MARGIN['2D'], top, left };\n  } else if (draft.selectedTool === options.slicingTool.id) {\n    draft.margin = MARGIN['2D'];\n  } else if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n    draft.margin = MARGIN['1D'];\n  }\n}\n\nfunction Processing2DData(draft: Draft<State>, data) {\n  if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n    let _data = {};\n    for (const datum of data[draft.activeTab]) {\n      _data[datum.id] = datum.processingController.drawContours();\n    }\n    draft.contours = _data;\n  }\n}\n\nfunction setDisplayerMode(draft: Draft<State>, data) {\n  draft.displayerMode =\n    data && (data as Datum1D[] | Datum2D[]).some((d) => d.info.dimension === 2)\n      ? DISPLAYER_MODE.DM_2D\n      : DISPLAYER_MODE.DM_1D;\n}\n\nfunction setTabActiveSpectrum(draft: Draft<State>, dataGroupByTab) {\n  let tabs2D: any[] = [];\n  const tabActiveSpectrum = {};\n\n  const tabkeys = Object.keys(dataGroupByTab).sort((a, b) =>\n    a.split(',').length > b.split(',').length ? -1 : 1,\n  );\n  for (let tabKey of tabkeys) {\n    const data = dataGroupByTab[tabKey];\n    const nucleusLength = tabKey.split(',').length;\n    if (nucleusLength === 2) {\n      tabs2D.push(tabKey);\n    }\n\n    if (data.length === 1) {\n      const index = draft.data.findIndex((datum) => datum.id === data[0].id);\n      tabActiveSpectrum[tabKey] = { id: data[0].id, index };\n    } else {\n      const tabSpectra = dataGroupByTab[tabKey];\n      const tabSpectraLength = tabSpectra.length;\n      if (tabSpectraLength >= 2) {\n        const FTSpectrums = tabSpectra.filter((d) => !d.info.isFid);\n        if (\n          FTSpectrums.length > 0 &&\n          (nucleusLength === 2 ||\n            (nucleusLength === 1 && tabSpectraLength !== FTSpectrums.length))\n        ) {\n          const index = draft.data.findIndex(\n            (datum) => datum.id === FTSpectrums[0].id,\n          );\n          tabActiveSpectrum[tabKey] = { id: FTSpectrums[0].id, index };\n        } else {\n          tabActiveSpectrum[tabKey] = null;\n        }\n      } else {\n        tabActiveSpectrum[tabKey] = null;\n      }\n    }\n  }\n  draft.tabActiveSpectrum = tabActiveSpectrum;\n  return tabs2D;\n}\n\nfunction setTab(draft: Draft<State>, dataGroupByTab, tab, refresh = false) {\n  const groupByTab = Object.keys(dataGroupByTab).sort((a, b) =>\n    a.split(',').length > b.split(',').length ? -1 : 1,\n  );\n\n  if (\n    JSON.stringify(groupByTab) !==\n      JSON.stringify(Object.keys(draft.tabActiveSpectrum)) ||\n    refresh\n  ) {\n    const tabs2D = setTabActiveSpectrum(draft, dataGroupByTab);\n\n    if (tabs2D.length > 0 && tab == null) {\n      draft.activeSpectrum = draft.tabActiveSpectrum[tabs2D[0]];\n      draft.activeTab = tabs2D[0];\n    } else {\n      draft.activeSpectrum = tab ? draft.tabActiveSpectrum[tab] : tab;\n      draft.activeTab = tab;\n    }\n  } else {\n    draft.activeTab = tab;\n    draft.activeSpectrum = draft.tabActiveSpectrum[tab];\n  }\n\n  setDisplayerMode(draft, dataGroupByTab[draft.activeTab]);\n  setMargin(draft);\n}\n\nfunction setActiveTab(\n  draft: Draft<State>,\n  tab = null,\n  refreshTabActiveSpectrums = false,\n) {\n  const groupByNucleus = GroupByInfoKey('nucleus');\n  const dataGroupByNucleus = groupByNucleus(draft.data);\n  const tabs = Object.keys(dataGroupByNucleus);\n  const currentTab = !tab || !tabs.includes(tab ?? '') ? tabs[0] : tab;\n  setTab(draft, dataGroupByNucleus, currentTab, refreshTabActiveSpectrums);\n  resetTool(draft);\n  // resetFilterTool(draft);\n\n  Processing2DData(draft, dataGroupByNucleus);\n  setDomain(draft);\n\n  const zoomHistory = ZoomHistory.getInstance(\n    draft.ZoomHistory,\n    draft.activeTab,\n  );\n  const zoomValue = zoomHistory.getLast();\n  if (zoomValue) {\n    draft.xDomain = zoomValue.xDomain;\n    draft.yDomain = zoomValue.yDomain;\n  }\n  setMode(draft);\n}\n\nfunction handelSetActiveTab(draft: Draft<State>, tab) {\n  if (tab) {\n    setActiveTab(draft, tab);\n  }\n}\n\nfunction levelChangeHandler(draft: Draft<State>, { deltaY, shiftKey }) {\n  try {\n    if (draft.activeSpectrum?.id) {\n      const { index, id } = draft.activeSpectrum;\n      // const datum2dObject = AnalysisObj.getDatum(id);\n      // if (datum2dObject instanceof Datum2D) {\n      const processingController = (draft.data[index] as Datum2D)\n        .processingController;\n      // const processing2dController = processingController.drawContours;\n      if (shiftKey) {\n        processingController.shiftWheel(deltaY);\n      } else {\n        processingController.wheel(deltaY);\n      }\n      const contours = Object.freeze(processingController.drawContours());\n      draft.contours[id] = contours;\n      // }\n    }\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n}\n\nfunction setSpectraSameTopHandler(draft: Draft<State>) {\n  if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n    draft.originDomain.yDomains = draft.originDomain.originYDomains;\n    setZoom(draft, 0.8);\n  }\n}\nfunction resetSpectraScale(draft: Draft<State>) {\n  if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n    draft.yDomains = Object.keys(draft.yDomains).reduce((acc, key) => {\n      acc[key] = draft.originDomain.yDomain;\n      return acc;\n    }, {});\n    draft.originDomain.yDomains = draft.yDomains;\n    draft.yDomain = draft.originDomain.yDomain;\n  }\n}\n\nfunction handleAddExclusionZone(draft: Draft<State>, action) {\n  const { from, to } = action.payload;\n  const scaleX = getXScale(draft);\n\n  const start = scaleX.invert(from);\n  const end = scaleX.invert(to);\n\n  let zone: any = [];\n  if (start > end) {\n    zone = [end, start];\n  } else {\n    zone = [start, end];\n  }\n  const newExclusionZone = {\n    id: generateID(),\n    from: zone[0],\n    to: zone[1],\n  };\n  if (draft.exclusionZones[draft.activeTab]) {\n    draft.exclusionZones[draft.activeTab].push(newExclusionZone);\n  } else {\n    draft.exclusionZones[draft.activeTab] = [newExclusionZone];\n  }\n}\n\nfunction handleDeleteExclusionZone(draft: Draft<State>, action) {\n  const id = action.payload.id;\n  const index = draft.exclusionZones[draft.activeTab].findIndex(\n    (zone) => zone.id === id,\n  );\n  draft.exclusionZones[draft.activeTab].splice(index, 1);\n}\n\nexport {\n  resetSelectedTool,\n  setSelectedTool,\n  setSelectedOptionPanel,\n  setSpectrumsVerticalAlign,\n  handleChangeSpectrumDisplayMode,\n  handleAddBaseLineZone,\n  handleDeleteBaseLineZone,\n  handleToggleRealImaginaryVisibility,\n  handleBrushEnd,\n  setVerticalIndicatorXPosition,\n  handleZoom,\n  zoomOut,\n  handelSetActiveTab,\n  levelChangeHandler,\n  setActiveTab,\n  setTab,\n  setSpectraSameTopHandler,\n  resetSpectraScale,\n  handleAddExclusionZone,\n  handleDeleteExclusionZone,\n};\n","import { Draft } from 'immer';\n\nimport { Filters } from '../../../data/Filters';\nimport * as FiltersManager from '../../../data/FiltersManager';\nimport { Datum1D, updateXShift } from '../../../data/data1d/Datum1D';\nimport { apply as autoPhaseCorrection } from '../../../data/data1d/filter1d/autoPhaseCorrection';\nimport { apply as phaseCorrection } from '../../../data/data1d/filter1d/phaseCorrection';\nimport {\n  Datum2D,\n  updateShift as update2dShift,\n} from '../../../data/data2d/Datum2D';\nimport nucluesToString from '../../utility/nucluesToString';\nimport { State } from '../Reducer';\nimport getClosestNumber from '../helper/GetClosestNumber';\nimport ZoomHistory from '../helper/ZoomHistory';\n\nimport { setDomain, setMode } from './DomainActions';\nimport { changeSpectrumVerticalAlignment } from './PreferencesActions';\nimport { resetSelectedTool } from './ToolsActions';\n\nfunction setDataBy1DFilter(datum: Datum1D) {\n  datum.data.y = datum.data.re;\n}\n\nfunction shiftSpectrumAlongXAxis(draft: Draft<State>, shiftValue) {\n  //apply filter into the spectrum\n  if (draft.activeSpectrum?.id) {\n    const index = draft.activeSpectrum.index;\n\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.shiftX.id, options: shiftValue },\n    ]);\n    updateXShift(draft.data[index] as Datum1D);\n    resetSelectedTool(draft);\n    setDataBy1DFilter(draft.data[index] as Datum1D);\n    setDomain(draft);\n  }\n}\n\nfunction applyZeroFillingFilter(draft: Draft<State>, filterOptions) {\n  if (draft.activeSpectrum?.id) {\n    const index = draft.activeSpectrum.index;\n    // const activeObject = AnalysisObj.getDatum(activeSpectrumId);\n    const filters = [\n      { name: Filters.zeroFilling.id, options: filterOptions.zeroFillingSize },\n      {\n        name: Filters.lineBroadening.id,\n        options: filterOptions.lineBroadeningValue,\n      },\n    ];\n    FiltersManager.applyFilter(draft.data[index], filters);\n    resetSelectedTool(draft);\n    setDataBy1DFilter(draft.data[index] as Datum1D);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\nfunction applyFFTFilter(draft: Draft<State>) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    // const activeObject = AnalysisObj.getDatum(activeSpectrumId);\n\n    //apply filter into the spectrum\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.fft.id, options: {} },\n    ]);\n    resetSelectedTool(draft);\n    setDataBy1DFilter(draft.data[index] as Datum1D);\n    changeSpectrumVerticalAlignment(draft, false, true);\n\n    setDomain(draft);\n    setMode(draft);\n  }\n}\nfunction applyManualPhaseCorrectionFilter(draft: Draft<State>, filterOptions) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    let { ph0, ph1 } = filterOptions;\n    const datum = draft.data[index] as Datum1D;\n    const closest = getClosestNumber(datum.data.x, draft.pivot);\n    const pivotIndex = datum.data.x.indexOf(closest);\n\n    ph0 = ph0 - (ph1 * pivotIndex) / datum.data.y.length;\n\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.phaseCorrection.id, options: { ph0, ph1 } },\n    ]);\n\n    resetSelectedTool(draft);\n    setDataBy1DFilter(draft.data[index] as Datum1D);\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\nfunction applyAbsoluteFilter(draft: Draft<State>) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.absolute.id, options: {} },\n    ]);\n    resetSelectedTool(draft);\n    setDataBy1DFilter(draft.data[index] as Datum1D);\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\n\nfunction applyAutoPhaseCorrectionFilter(draft: Draft<State>) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    const {\n      data: { x, y, im },\n      info,\n    } = draft.tempData[index];\n\n    let _data = { data: { x, re: y, im }, info };\n    const { data, ph0, ph1 } = autoPhaseCorrection(_data);\n\n    const { im: newIm, re: newRe } = data;\n    draft.tempData[index].data.im = newIm;\n    draft.tempData[index].data.y = newRe;\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.phaseCorrection.id, options: { ph0, ph1 } },\n    ]);\n    resetSelectedTool(draft);\n    setDataBy1DFilter(draft.data[index] as Datum1D);\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\n\nfunction calculateManualPhaseCorrection(draft: Draft<State>, filterOptions) {\n  const { tempData } = draft;\n  const { index } = draft.activeSpectrum;\n  const {\n    data: { x, y, im },\n    info,\n  } = tempData[index];\n\n  let { ph0, ph1 } = filterOptions;\n  const closest = getClosestNumber(tempData[index].data.x, draft.pivot);\n  const pivotIndex = tempData[index].data.x.indexOf(closest);\n\n  ph0 = ph0 - (ph1 * pivotIndex) / y.length;\n\n  let _data = { data: { x, re: y, im }, info };\n  phaseCorrection(_data, { ph0, ph1 });\n  const { im: newIm, re: newRe } = _data.data;\n  draft.tempData[index].data.im = newIm;\n  draft.tempData[index].data.y = newRe;\n}\n\nfunction enableFilter(draft: Draft<State>, filterID, checked) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    //apply filter into the spectrum\n    FiltersManager.enableFilter(draft.data[index], filterID, checked);\n\n    if (draft.data[index].info?.dimension === 1) {\n      updateXShift(draft.data[index] as Datum1D);\n      setDataBy1DFilter(draft.data[index] as Datum1D);\n    } else if (draft.data[index].info?.dimension === 2) {\n      update2dShift(draft.data[index] as Datum2D);\n    }\n\n    resetSelectedTool(draft);\n    setDomain(draft);\n    setMode(draft);\n\n    const zoomHistory = ZoomHistory.getInstance(\n      draft.ZoomHistory,\n      draft.activeTab,\n    );\n    const zoomValue = zoomHistory.getLast();\n    if (zoomValue) {\n      draft.xDomain = zoomValue.xDomain;\n      draft.yDomain = zoomValue.yDomain;\n    }\n  }\n}\n\nfunction deleteFilter(draft: Draft<State>, actions) {\n  const filterID = actions.payload.id;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    //apply filter into the spectrum\n    FiltersManager.deleteFilter(draft.data[index], filterID);\n\n    if (draft.data[index].info?.dimension === 1) {\n      updateXShift(draft.data[index] as Datum1D);\n      setDataBy1DFilter(draft.data[index] as Datum1D);\n    } else if (draft.data[index].info?.dimension === 2) {\n      update2dShift(draft.data[index] as Datum2D);\n    }\n\n    resetSelectedTool(draft);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\nfunction deleteSpectraFilter(draft: Draft<State>, actions) {\n  const filterType = actions.payload.filterType;\n\n  if (draft.activeTab) {\n    for (const datum of draft.data) {\n      if (nucluesToString(datum?.info?.nucleus) === draft.activeTab) {\n        const filtersResult =\n          datum.filters?.filter((filter) => filter.name === filterType) || [];\n\n        filtersResult.forEach((filter) => {\n          FiltersManager.deleteFilter(datum, filter.id);\n\n          if (datum.info?.dimension === 1) {\n            updateXShift(datum as Datum1D);\n            setDataBy1DFilter(datum as Datum1D);\n          } else if (datum.info?.dimension === 2) {\n            update2dShift(datum as Datum2D);\n          }\n        });\n      }\n    }\n\n    resetSelectedTool(draft);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\n\nfunction handleBaseLineCorrectionFilter(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    FiltersManager.applyFilter(draft.data[index], [\n      {\n        name: Filters.baselineCorrection.id,\n        options: { zones: draft.baseLineZones, ...action.options },\n      },\n    ]);\n\n    draft.baseLineZones = [];\n    const xDomainSnapshot = draft.xDomain.slice();\n\n    resetSelectedTool(draft);\n    setDataBy1DFilter(draft.data[index] as Datum1D);\n    setDomain(draft);\n    draft.xDomain = xDomainSnapshot;\n  }\n}\n\nfunction filterSnapshotHandler(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const index = draft.activeSpectrum.index;\n\n    if (action.id) {\n      const filterIndex = (draft.data[index] as Datum1D).filters.findIndex(\n        (f) => f.id === action.id,\n      );\n      const filters = (draft.data[index] as Datum1D).filters.slice(\n        0,\n        filterIndex + 1,\n      );\n      FiltersManager.reapplyFilters(draft.data[index], filters);\n    } else {\n      //close filter snapshot mode and replay all enabled filters\n      FiltersManager.reapplyFilters(draft.data[index]);\n    }\n    // const activeObject = AnalysisObj.getDatum(id);\n\n    resetSelectedTool(draft);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\n\nfunction handleMultipleSpectraFilter(draft: Draft<State>, action) {\n  if (draft.data && draft.data.length > 0) {\n    for (let datum of draft.data) {\n      if (\n        datum.info?.dimension === 1 &&\n        datum.info.nucleus === draft.activeTab &&\n        Array.isArray(action.payload)\n      ) {\n        const filters = action.payload.map((filter) => {\n          if (filter.name === Filters.equallySpaced.id) {\n            const exclusions = draft.exclusionZones[draft.activeTab] || [];\n            return {\n              ...filter,\n              options: { ...filter.options, exclusions },\n            };\n          }\n          return filter;\n        });\n\n        FiltersManager.applyFilter(datum, filters);\n        (datum as Datum1D).data.y = (datum as Datum1D).data.re;\n      }\n    }\n  }\n  setDomain(draft);\n}\n\nexport {\n  shiftSpectrumAlongXAxis,\n  applyZeroFillingFilter,\n  applyFFTFilter,\n  applyManualPhaseCorrectionFilter,\n  applyAutoPhaseCorrectionFilter,\n  applyAbsoluteFilter,\n  calculateManualPhaseCorrection,\n  handleMultipleSpectraFilter,\n  enableFilter,\n  deleteFilter,\n  deleteSpectraFilter,\n  handleBaseLineCorrectionFilter,\n  filterSnapshotHandler,\n};\n","import { getXScale } from '../../1d/utilities/scale';\n\nexport default function getRange(draft, options) {\n  const { startX, endX } = options;\n  const scaleX = getXScale(draft);\n\n  const start = scaleX.invert(startX);\n  const end = scaleX.invert(endX);\n  const range: number[] = [];\n  if (start > end) {\n    range[0] = end;\n    range[1] = start;\n  } else {\n    range[0] = start;\n    range[1] = end;\n  }\n  return range;\n}\n","import { extent } from 'd3';\nimport { Draft, original } from 'immer';\nimport { xyIntegral, xyIntegration } from 'ml-spectra-processing';\n\nimport {\n  updateIntegralIntegrals,\n  changeIntegralsRealtive,\n  Datum1D,\n  getShiftX,\n} from '../../../data/data1d/Datum1D';\nimport generateID from '../../../data/utilities/generateID';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\nimport { setIntegralZoom, integralZoomHanlder } from './Zoom';\n\nfunction handleChangeIntegralSum(draft: Draft<State>, value) {\n  if (draft.activeSpectrum?.id) {\n    const { index, id } = draft.activeSpectrum;\n    (draft.data[index] as Datum1D).integrals.options.sum = value;\n    updateIntegralIntegrals((draft.data[index] as Datum1D).integrals);\n\n    if (!draft.integralsYDomains) {\n      draft.integralsYDomains[id] = draft.yDomains[id];\n    }\n  }\n}\n\nfunction handleChangeIntegralZoom(draft: Draft<State>, action) {\n  const { deltaY, deltaMode } = action;\n  integralZoomHanlder.wheel(deltaY, deltaMode);\n  setIntegralZoom(integralZoomHanlder.getScale(), draft);\n}\n\nfunction addIntegral(draft: Draft<State>, action) {\n  const state = original(draft);\n  const { startX, endX } = action;\n  const [from, to] = getRange(draft, { startX, endX });\n\n  if (draft.activeSpectrum?.id && state) {\n    const { id, index } = draft.activeSpectrum;\n    const datum = draft.data[index] as Datum1D;\n\n    const { x, re } = datum.data;\n\n    const shiftX = getShiftX(datum);\n\n    const integral = {\n      id: generateID(),\n      originFrom: from - shiftX,\n      originTo: to - shiftX,\n      from,\n      to,\n      absolute: xyIntegration({ x, y: re }, { from, to, reverse: true }), // the real value\n      kind: 'signal',\n    };\n    datum.integrals.values.push(integral);\n    updateIntegralIntegrals(datum.integrals);\n    if (datum.integrals.values.length === 1) {\n      const { from = 0, to = 0 } = datum.integrals.values[0];\n      const { x, y } = datum.data;\n      const integralResult = xyIntegral(\n        { x: x, y: y },\n        {\n          from: from,\n          to: to,\n          reverse: true,\n        },\n      );\n      const integralYDomain = extent(integralResult.y);\n      draft.integralsYDomains[id] = integralYDomain;\n      draft.originIntegralYDomain[id] = integralYDomain;\n      setIntegralZoom(draft.integralZoomFactor.scale, draft);\n    }\n  }\n}\n\nfunction deleteIntegral(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  const { index } = draft.activeSpectrum;\n  const { integralID } = action;\n\n  const datum = draft.data[index] as Datum1D;\n\n  if (integralID == null) {\n    datum.integrals.values = [];\n  } else {\n    const peakIndex = (state.data[index] as Datum1D).integrals.values.findIndex(\n      (p) => p.id === integralID,\n    );\n    datum.integrals.values.splice(peakIndex, 1);\n    updateIntegralIntegrals(datum.integrals);\n  }\n}\n\nfunction changeIntegral(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  const integral = action.data;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    const orignalDatum = state.data[index] as Datum1D;\n    const datum = draft.data[index] as Datum1D;\n\n    const { x, re } = orignalDatum.data;\n    const integralIndex = orignalDatum.integrals.values.findIndex(\n      (i) => i.id === integral.id,\n    );\n    if (integralIndex !== -1) {\n      datum.integrals.values[integralIndex] = {\n        // ...draft.data[index].integrals.values[integralIndex],\n        originFrom: integral.from,\n        originTo: integral.to,\n        ...integral,\n        absolute: xyIntegration(\n          { x, y: re },\n          { from: integral.from, to: integral.to, reverse: true },\n        ),\n      };\n      updateIntegralIntegrals(datum.integrals);\n    }\n  }\n}\n\nfunction handleChangeIntegralsRaltiveValue(draft: Draft<State>, action) {\n  const { id, value } = action;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    changeIntegralsRealtive(\n      (draft.data[index] as Datum1D).integrals,\n      id,\n      value,\n    );\n  }\n}\n\nexport {\n  handleChangeIntegralSum,\n  handleChangeIntegralZoom,\n  addIntegral,\n  deleteIntegral,\n  changeIntegral,\n  handleChangeIntegralsRaltiveValue,\n};\n","import { MF } from 'mf-parser';\nimport { Molecule as OCLMolecule } from 'openchemlib/full';\n\nimport generateID from '../utilities/generateID';\n\n/**\n * @param {object} [options={}]\n * @param {object} [options.molfile='']\n * @param {object} [options.key=Math.random()] Optional unique identifier\n */\nexport function initMolecule(options = {}) {\n  const molecule = {};\n  molecule.key = options.key || generateID();\n  molecule.molfile = options.molfile || '';\n  const mol = new OCLMolecule.fromMolfile(molecule.molfile);\n  const mfInfo = mol.getMolecularFormula();\n  molecule.mf = mfInfo.formula;\n  molecule.em = mfInfo.absoluteWeight;\n  molecule.mw = mfInfo.relativeWeight;\n  molecule.svg = mol.toSVG(50, 50);\n\n  const mf = new MF(molecule.mf);\n  molecule.atoms = mf.getInfo().atoms;\n  return molecule;\n}\n\nexport function toJSON(molecule) {\n  return {\n    molfile: molecule.molfile,\n  };\n}\n","import { Molecule, Molecule as OCLMolecule } from 'openchemlib/full';\n\nimport { initMolecule } from './Molecule';\n\nexport function fromJSON(mols = []) {\n  const molecules = [];\n  for (let i = 0; i < mols.length; i++) {\n    const molecule = OCLMolecule.fromMolfile(mols[i].molfile);\n    const fragments = molecule.getFragments();\n    for (let fragment of fragments) {\n      molecules.push(\n        initMolecule({\n          molfile: fragment.toMolfileV3(),\n        }),\n      );\n    }\n  }\n\n  return molecules;\n}\n\nexport function addMolfile(molecules, molfile) {\n  // try to parse molfile\n  // this will throw if the molecule can not be parsed !\n  const molecule = Molecule.fromMolfile(molfile);\n  let fragments = molecule.getFragments();\n  for (let fragment of fragments) {\n    const {\n      formula,\n      absoluteWeight,\n      relativeWeight,\n    } = fragment.getMolecularFormula();\n    molecules.push(\n      initMolecule({\n        molfile: fragment.toMolfileV3(),\n        svg: fragment.toSVG(150, 150),\n        mf: formula,\n        em: absoluteWeight,\n        mw: relativeWeight,\n      }),\n    );\n  }\n  // we will split if we have many fragments\n}\n\nexport function setMolfile(molecules, molfile, key) {\n  // try to parse molfile\n  // this will throw if the molecule can not be parsed !\n  let molecule = Molecule.fromMolfile(molfile);\n  let fragments = molecule.getFragments();\n\n  if (fragments.length > 1) {\n    molecules = this.molecules.filter((m) => m.key !== key);\n\n    for (let fragment of fragments) {\n      const {\n        formula,\n        absoluteWeight,\n        relativeWeight,\n      } = fragment.getMolecularFormula();\n\n      molecules.push(\n        new initMolecule({\n          molfile: fragment.toMolfileV3(),\n          svg: fragment.toSVG(150, 150),\n          mf: formula,\n          em: absoluteWeight,\n          mw: relativeWeight,\n        }),\n      );\n    }\n  } else if (fragments.length === 1) {\n    const fragment = fragments[0];\n    const {\n      formula,\n      absoluteWeight,\n      relativeWeight,\n    } = fragment.getMolecularFormula();\n    const _mol = initMolecule({\n      molfile: fragment.toMolfileV3(),\n      svg: fragment.toSVG(150, 150),\n      mf: formula,\n      em: absoluteWeight,\n      mw: relativeWeight,\n      key: key,\n    });\n    let molIndex = molecules.findIndex((m) => m.key === key);\n    molecules.splice(molIndex, 1, _mol);\n  }\n\n  // we will split if we have many fragments\n}\n","import { Draft } from 'immer';\nimport lodashGet from 'lodash/get';\nimport { Build, Types } from 'nmr-correlation';\n\nimport { addJcamps, addJDFs } from '../../../data/SpectraManager';\nimport * as MoleculeManager from '../../../data/molecules/MoleculeManager';\nimport generateID from '../../../data/utilities/generateID';\nimport { Molecules, NMRiumPreferences, Spectra } from '../../NMRium';\nimport { DefaultTolerance } from '../../panels/SummaryPanel/CorrelationTable/Constants';\nimport { State } from '../Reducer';\n\nimport { changeSpectrumVerticalAlignment } from './PreferencesActions';\nimport { setActiveTab } from './ToolsActions';\nimport { initZoom1DHandler } from './Zoom';\n\nfunction setIsLoading(draft: Draft<State>, isLoading: boolean) {\n  draft.isLoading = isLoading;\n}\n\nfunction setData(\n  draft: Draft<State>,\n  data: {\n    spectra: Spectra;\n    molecules: Molecules;\n    preferences: NMRiumPreferences;\n    correlations: Types.CorrelationData;\n    exclusionZones: any;\n  },\n) {\n  const {\n    spectra,\n    molecules,\n    preferences,\n    correlations,\n    exclusionZones = {},\n  } = data || {\n    spectra: [],\n    molecules: [],\n    preferences: {},\n    correlations: {},\n    multipleAnalysis: {},\n    exclusionZones: {},\n  };\n  draft.data = spectra;\n  draft.molecules = MoleculeManager.fromJSON(molecules);\n  draft.preferences = preferences;\n  draft.exclusionZones = exclusionZones;\n\n  if (!correlations || Object.keys(correlations).length === 0) {\n    draft.correlations = Build.init({\n      values: [],\n      options: { tolerance: DefaultTolerance, mf: '' },\n      state: {},\n    });\n  } else {\n    draft.correlations = Build.init(correlations);\n  }\n\n  // const spectraAnalysis = AnalysisObj.getMultipleAnalysis();\n}\n\nfunction initiate(draft: Draft<State>, action) {\n  draft.displayerKey = generateID();\n  setData(draft, action.payload);\n  initZoom1DHandler(draft.data);\n  const alignCenter = lodashGet(draft.preferences, 'display.center', null);\n  changeSpectrumVerticalAlignment(draft, alignCenter, true);\n  setActiveTab(draft);\n  draft.isLoading = false;\n}\n\nfunction loadJDFFile(draft: Draft<State>, files) {\n  const spectra = addJDFs(files);\n  for (const spectrum of spectra) {\n    draft.data.push(spectrum);\n  }\n\n  setActiveTab(draft);\n  initZoom1DHandler(draft.data);\n\n  draft.isLoading = false;\n}\n\nfunction loadJcampFile(draft: Draft<State>, files) {\n  const spectra = addJcamps(files);\n  for (const spectrum of spectra) {\n    draft.data.push(spectrum);\n  }\n  changeSpectrumVerticalAlignment(draft, false, true);\n  setActiveTab(draft);\n  initZoom1DHandler(draft.data);\n\n  draft.isLoading = false;\n}\n\nfunction handleLoadJsonFile(draft: Draft<State>, actions) {\n  const data = actions.payload;\n  setData(draft, data);\n\n  const alignCenter = lodashGet(draft.preferences, 'display.center', null);\n\n  changeSpectrumVerticalAlignment(draft, alignCenter, true);\n\n  setActiveTab(draft);\n  initZoom1DHandler(draft.data);\n\n  draft.isLoading = false;\n}\n\nfunction handleLoadMOLFile(draft: Draft<State>, files) {\n  for (let file of files) {\n    MoleculeManager.addMolfile(draft.molecules, file.binary.toString());\n  }\n  draft.isLoading = false;\n}\n\nfunction handleLoadZIPFile(draft: Draft<State>, action) {\n  draft.data = action.payload;\n  setActiveTab(draft);\n  initZoom1DHandler(draft.data);\n  draft.isLoading = false;\n}\n\nfunction handleLoadNmredata(draft: Draft<State>, action) {\n  setData(draft, action.payload);\n  const alignCenter = lodashGet(draft.preferences, 'display.center', null);\n  changeSpectrumVerticalAlignment(draft, alignCenter, true);\n  setActiveTab(draft);\n  initZoom1DHandler(draft.data);\n  draft.isLoading = false;\n}\n\nexport {\n  setIsLoading,\n  initiate,\n  loadJcampFile,\n  loadJDFFile,\n  handleLoadJsonFile,\n  handleLoadNmredata,\n  handleLoadMOLFile,\n  handleLoadZIPFile,\n};\n","import { Draft, original } from 'immer';\nimport cloneDeep from 'lodash/cloneDeep';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\n\nimport { Filters } from '../../../data/Filters';\nimport * as FiltersManager from '../../../data/FiltersManager';\nimport {\n  DatumKind,\n  SignalKindsToInclude,\n} from '../../../data/constants/SignalsKinds';\nimport {\n  addRange,\n  changeRangeSignal,\n  detectRanges,\n  updateIntegralRanges,\n  changeRange,\n  changeRangesRealtive,\n  Datum1D,\n  Range,\n  Signal,\n  updateXShift,\n} from '../../../data/data1d/Datum1D';\nimport {\n  getPubIntegral,\n  unlink,\n  unlinkInAssignmentData,\n} from '../../../data/utilities/RangeUtilities';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\nimport { handleUpdateCorrelations } from './CorrelationsActions';\nimport { setDomain } from './DomainActions';\n\nfunction handleAutoRangesDetection(draft: Draft<State>, detectionOptions) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const datum = draft.data[index] as Datum1D;\n\n    const [from, to] = draft.xDomain;\n    const windowFromIndex = xFindClosestIndex(datum.data.x, from);\n    const windowToIndex = xFindClosestIndex(datum.data.x, to);\n\n    detectRanges(datum, {\n      ...detectionOptions,\n      windowFromIndex,\n      windowToIndex,\n    });\n    handleOnChangeRangesData(draft);\n  }\n}\n\nfunction getRangeIndex(drfat: Draft<State>, spectrumIndex, rangeID) {\n  return (drfat.data[spectrumIndex] as Datum1D).ranges.values.findIndex(\n    (range) => range.id === rangeID,\n  );\n}\n\nfunction handleDeleteRange(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { id, assignmentData } = action.payload;\n    const datum = draft.data[index] as Datum1D;\n    if (id) {\n      const range = datum.ranges.values.find((range) => range.id === id);\n      unlinkInAssignmentData(assignmentData, [range]);\n      const rangeIndex = getRangeIndex(state, index, id);\n      datum.ranges.values.splice(rangeIndex, 1);\n    } else {\n      unlinkInAssignmentData(assignmentData, datum.ranges.values);\n      datum.ranges.values = [];\n    }\n    updateIntegralRanges(draft.data[index]);\n    handleOnChangeRangesData(draft);\n  }\n}\n\nfunction handleChangeRangeSignalKind(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { rowData, value } = action.payload;\n    const rangeIndex = getRangeIndex(state, index, rowData.id);\n    const _range = (draft.data[index] as Datum1D).ranges.values[\n      rangeIndex\n    ] as Range;\n    if (_range?.signal) {\n      (_range.signal[rowData.tableMetaInfo.signalIndex] as Signal).kind = value;\n      _range.kind = SignalKindsToInclude.includes(value)\n        ? DatumKind.signal\n        : DatumKind.mixed;\n      updateIntegralRanges(draft.data[index]);\n      handleOnChangeRangesData(draft);\n    }\n  }\n}\n\nfunction handleSaveEditedRange(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { editedRowData, assignmentData } = action.payload;\n    // remove assignments in global state\n    const _editedRowData = unlink(editedRowData);\n    delete _editedRowData.tableMetaInfo;\n    // remove assignments in assignment hook data\n    // for now: clear all assignments for this range because signals or levels to store might have changed\n    unlinkInAssignmentData(assignmentData, _editedRowData);\n\n    const rangeIndex = getRangeIndex(state, index, _editedRowData.id);\n    (draft.data[index] as Datum1D).ranges.values[rangeIndex] = _editedRowData;\n    updateIntegralRanges(draft.data[index]);\n    handleOnChangeRangesData(draft);\n  }\n}\n\nfunction handleUnlinkRange(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const {\n      assignmentData,\n      rangeData = null,\n      signalIndex = -1,\n    } = action.payload;\n\n    // remove assignments in global state\n    if (rangeData) {\n      const rangeIndex = getRangeIndex(draft, index, rangeData.id);\n      const range = cloneDeep(\n        (draft.data[index] as Datum1D).ranges.values[rangeIndex],\n      );\n\n      let newRange: any = {};\n      let id = rangeData.id;\n      if (rangeData && signalIndex === -1) {\n        newRange = unlink(range, 'range');\n      } else {\n        newRange = unlink(range, 'signal', { signalIndex });\n        id = rangeData.signal[signalIndex].id;\n      }\n      // remove assignments in assignment hook data\n      unlinkInAssignmentData(assignmentData, [\n        {\n          id,\n        },\n      ]);\n      (draft.data[index] as Datum1D).ranges.values[rangeIndex] = newRange;\n    } else {\n      const ranges = (draft.data[index] as Datum1D).ranges.values.map(\n        (range) => {\n          return unlink(range);\n        },\n      );\n      (draft.data[index] as Datum1D).ranges.values = ranges;\n\n      unlinkInAssignmentData(assignmentData, ranges);\n    }\n  }\n}\n\nfunction handleSetDiaIDRange(draft, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const { rangeData, diaID, signalIndex } = action.payload;\n\n    const rangeIndex = getRangeIndex(draft, index, rangeData.id);\n    const _range = draft.data[index].ranges.values[rangeIndex];\n    if (signalIndex === undefined) {\n      _range.diaID = diaID;\n    } else {\n      _range.signal[signalIndex].diaID = diaID;\n    }\n    _range.pubIntegral = getPubIntegral(_range);\n  }\n}\n\nfunction handleResizeRange(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    changeRange(draft.data[index], action.data);\n  }\n}\n\nfunction handleChangeRangeSum(draft: Draft<State>, value) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    (draft.data[index] as Datum1D).ranges.options.sum = value;\n    updateIntegralRanges(draft.data[index]);\n  }\n}\nfunction handleAddRange(draft: Draft<State>, action) {\n  const { startX, endX } = action;\n  const range = getRange(draft, { startX, endX });\n\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const [from, to] = range;\n    addRange(draft.data[index], { from, to });\n    handleOnChangeRangesData(draft);\n  }\n}\n\nfunction handleChangeRangeRaltiveValue(draft, action) {\n  const { id: rangeID, value } = action;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    changeRangesRealtive(draft.data[index], rangeID, value);\n  }\n}\n\nfunction handleChangeRangeSignalValue(draft, action) {\n  const { rangeID, signalID, value } = action.payload;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    const shift = changeRangeSignal(\n      draft.data[index],\n      rangeID,\n      signalID,\n      value,\n    );\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.shiftX.id, options: shift },\n    ]);\n\n    updateXShift(draft.data[index] as Datum1D);\n\n    handleOnChangeRangesData(draft);\n    setDomain(draft);\n  }\n}\n\nfunction handleOnChangeRangesData(draft) {\n  handleUpdateCorrelations(draft);\n}\n\nexport {\n  handleAutoRangesDetection,\n  handleDeleteRange,\n  handleChangeRangeSum,\n  handleAddRange,\n  handleResizeRange,\n  handleChangeRangeRaltiveValue,\n  handleChangeRangeSignalValue,\n  handleChangeRangeSignalKind,\n  handleSaveEditedRange,\n  handleUnlinkRange,\n  handleSetDiaIDRange,\n};\n","import { Draft, original } from 'immer';\nimport cloneDeep from 'lodash/cloneDeep';\n\nimport { Filters } from '../../../data/Filters';\nimport * as FiltersManager from '../../../data/FiltersManager';\nimport {\n  DatumKind,\n  SignalKindsToInclude,\n} from '../../../data/constants/SignalsKinds';\nimport {\n  changeZoneSignal,\n  Datum2D,\n  detectZones,\n  detectZonesManual,\n  updateShift,\n  Zone,\n} from '../../../data/data2d/Datum2D';\nimport {\n  getPubIntegral,\n  unlink,\n  unlinkInAssignmentData,\n} from '../../../data/utilities/ZoneUtilities';\nimport Events from '../../utility/Events';\nimport { State } from '../Reducer';\nimport get2DRange from '../helper/get2DRange';\n\n// eslint-disable-next-line import/order\nimport { handleUpdateCorrelations } from './CorrelationsActions';\n// import { AnalysisObj } from '../core/Analysis';\n\nimport { setDomain } from './DomainActions';\n\nlet noiseFactor = 1;\n\nEvents.on('noiseFactorChanged', (val) => {\n  noiseFactor = val;\n});\n\nfunction add2dZoneHandler(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const drawnZone = get2DRange(draft, action);\n    detectZonesManual(draft.data[index], {\n      selectedZone: drawnZone,\n      thresholdFactor: noiseFactor,\n      convolutionByFFT: false,\n    });\n    handleOnChangeZonesData(draft);\n  }\n}\nfunction handleAutoZonesDetection(draft: Draft<State>, detectionOptions) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    const [fromX, toX] = draft.xDomain;\n    const [fromY, toY] = draft.yDomain;\n    detectionOptions.selectedZone = { fromX, toX, fromY, toY };\n\n    detectZones(draft.data[index], detectionOptions);\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction changeZoneSignalDelta(draft: Draft<State>, action) {\n  const { zoneID, signal } = action.payload;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const { xShift, yShift } = changeZoneSignal(\n      draft.data[index],\n      zoneID,\n      signal,\n    );\n    let filters: any = [];\n    if (xShift !== 0) {\n      filters.push({ name: Filters.shift2DX.id, options: xShift });\n    }\n    if (yShift !== 0) {\n      filters.push({ name: Filters.shift2DY.id, options: yShift });\n    }\n\n    FiltersManager.applyFilter(draft.data[index], filters);\n\n    updateShift(draft.data[index] as Datum2D);\n\n    setDomain(draft);\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction getZoneIndex(state, spectrumIndex, zoneID) {\n  return state.data[spectrumIndex].zones.values.findIndex(\n    (zone) => zone.id === zoneID,\n  );\n}\n\nfunction handleChangeZoneSignalKind(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { rowData, value } = action.payload;\n    const zoneIndex = getZoneIndex(state, index, rowData.id);\n    const _zone = (draft.data[index] as Datum2D).zones.values[\n      zoneIndex\n    ] as Zone;\n    _zone.signal[rowData.tableMetaInfo.signalIndex].kind = value;\n    _zone.kind = SignalKindsToInclude.includes(value)\n      ? DatumKind.signal\n      : DatumKind.mixed;\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction handleDeleteZone(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { id, assignmentData } = action.payload;\n    if (id) {\n      const zone = (draft.data[index] as Datum2D).zones.values.find(\n        (zone) => zone.id === id,\n      );\n      unlinkInAssignmentData(assignmentData, [zone]);\n      const zoneIndex = getZoneIndex(state, index, id);\n      (draft.data[index] as Datum2D).zones.values.splice(zoneIndex, 1);\n    } else {\n      unlinkInAssignmentData(\n        assignmentData,\n        (draft.data[index] as Datum2D).zones.values,\n      );\n      (draft.data[index] as Datum2D).zones.values = [];\n    }\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction handleUnlinkZone(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const {\n      zoneData,\n      assignmentData,\n      isOnZoneLevel,\n      signalIndex,\n      axis,\n    } = action.payload;\n\n    for (let zone of zoneData\n      ? [zoneData]\n      : (state.data[index] as Datum2D).zones.values) {\n      // remove assignments in global state\n      const _zoneData = unlink(\n        cloneDeep(zone),\n        isOnZoneLevel,\n        signalIndex,\n        axis,\n      );\n      // remove assignments in assignment hook data\n      if (isOnZoneLevel) {\n        unlinkInAssignmentData(assignmentData, [{ id: _zoneData.id }], axis);\n      } else {\n        unlinkInAssignmentData(\n          assignmentData,\n          [{ id: _zoneData.signal[signalIndex].id }],\n          axis,\n        );\n      }\n\n      const zoneIndex = getZoneIndex(state, index, _zoneData.id);\n      (draft.data[index] as Datum2D).zones.values[zoneIndex] = _zoneData;\n    }\n  }\n}\n\nfunction handleSetDiaIDZone(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { zoneData, diaID, axis, signalIndex } = action.payload;\n\n    const zoneIndex = getZoneIndex(state, index, zoneData.id);\n    const _zone = (draft.data[index] as Datum2D).zones.values[\n      zoneIndex\n    ] as Zone;\n    if (signalIndex === undefined) {\n      _zone[axis].diaID = diaID;\n    } else {\n      _zone.signal[signalIndex][axis].diaID = diaID;\n    }\n    _zone[axis].pubIntegral = getPubIntegral(_zone, axis);\n  }\n}\n\nfunction handleOnChangeZonesData(draft) {\n  handleUpdateCorrelations(draft);\n}\n\nexport {\n  add2dZoneHandler,\n  handleAutoZonesDetection,\n  handleDeleteZone,\n  changeZoneSignalDelta,\n  handleChangeZoneSignalKind,\n  handleUnlinkZone,\n  handleSetDiaIDZone,\n};\n","import { get2DXScale, get2DYScale } from '../../2d/utilities/scale';\n\nexport default function get2DRange(draft, options) {\n  const { startX, startY, endX, endY } = options;\n  const scaleX = get2DXScale(draft);\n  const scaleY = get2DYScale(draft);\n  const x1 = startX * 1000000 > endX * 1000000 ? endX : startX;\n  const x2 = startX * 1000000 > endX * 1000000 ? startX : endX;\n  const y1 = startY * 1000000 > endY * 1000000 ? endY : startY;\n  const y2 = startY * 1000000 > endY * 1000000 ? startY : endY;\n\n  const fromY = scaleY.invert(y1);\n  const fromX = scaleX.invert(x1);\n  const toY = scaleY.invert(y2);\n  const toX = scaleX.invert(x2);\n  return { fromX, fromY, toX, toY };\n}\n","import { Draft } from 'immer';\nimport { signalsToXY } from 'nmr-processing';\n\nimport {\n  initiateDatum1D,\n  mapRanges,\n  updateIntegralRanges,\n} from '../../../data/data1d/Datum1D';\nimport * as MoleculeManager from '../../../data/molecules/MoleculeManager';\nimport { State } from '../Reducer';\nimport { DISPLAYER_MODE } from '../core/Constants';\n\nimport { handleUnlinkRange } from './RangesActions';\nimport { setActiveTab } from './ToolsActions';\nimport { handleUnlinkZone } from './ZonesActions';\nimport { initZoom1DHandler, setZoom } from './Zoom';\n\nfunction addMoleculeHandler(draft: Draft<State>, molfile) {\n  MoleculeManager.addMolfile(draft.molecules, molfile);\n}\n\nfunction setMoleculeHandler(draft: Draft<State>, molfile, key) {\n  MoleculeManager.setMolfile(draft.molecules, molfile, key);\n}\n\nfunction deleteMoleculeHandler(draft: Draft<State>, action) {\n  const { key, assignmentData } = action.payload;\n  if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n    handleUnlinkRange(draft, { payload: { assignmentData, rangeData: null } });\n  }\n  if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n    handleUnlinkZone(draft, { payload: { assignmentData, zoneData: null } });\n  }\n  const moleculeIndex = draft.molecules.findIndex(\n    (molecule) => molecule.key === key,\n  );\n\n  draft.molecules.splice(moleculeIndex, 1);\n}\n\nfunction predictSpectraFromMolculeHandler(draft: Draft<State>, action) {\n  const { fromMolfile, options } = action.payload;\n  const { x, y } = signalsToXY(fromMolfile.signals, {});\n  let id: any = null;\n  if (options.spectra['1h']) {\n    const datum = initiateDatum1D({\n      data: { x, im: null, re: y },\n      info: { nucleus: '1H' },\n    });\n    id = datum.id;\n    datum.ranges.values = mapRanges(fromMolfile.ranges, datum);\n    updateIntegralRanges(datum);\n    draft.data.push(datum);\n    const activeSpectrum = { id, index: draft.data.length - 1 };\n    draft.tabActiveSpectrum['1H'] = activeSpectrum;\n    draft.activeSpectrum = activeSpectrum;\n  }\n  setActiveTab(draft);\n  initZoom1DHandler(draft.data);\n  setZoom(draft, 0.9, id);\n\n  draft.isLoading = false;\n}\n\nexport {\n  addMoleculeHandler,\n  setMoleculeHandler,\n  deleteMoleculeHandler,\n  predictSpectraFromMolculeHandler,\n};\n","import { Draft, original } from 'immer';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\n\nimport { lookupPeak, Datum1D, getShiftX } from '../../../data/data1d/Datum1D';\nimport autoPeakPicking from '../../../data/data1d/autoPeakPicking';\nimport generateID from '../../../data/utilities/generateID';\nimport { options } from '../../toolbar/ToolTypes';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\n// import { AnalysisObj } from '../core/Analysis';\n\nfunction addPeak(draft: Draft<State>, mouseCoordinates) {\n  const state = original(draft) as State;\n  if (draft.activeSpectrum?.id && state) {\n    const { index } = draft.activeSpectrum;\n    const xShift = 10;\n    const startX = mouseCoordinates.x - xShift;\n    const endX = mouseCoordinates.x + xShift;\n    const [from, to] = getRange(draft, { startX, endX });\n    const candidatePeak = lookupPeak(state.data[index].data, { from, to });\n\n    const shiftX = getShiftX(draft.data[index] as Datum1D);\n\n    if (candidatePeak) {\n      const peak = {\n        id: generateID(),\n        originDelta: candidatePeak.x - shiftX,\n        delta: candidatePeak.x,\n        intensity: candidatePeak.y,\n      };\n      (draft.data[index] as Datum1D).peaks.values.push(peak);\n    }\n  }\n}\n\nfunction addPeaks(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n\n  if (draft.activeSpectrum) {\n    const { index } = draft.activeSpectrum;\n    const datumOriginal = state.data[index] as Datum1D;\n\n    const { startX, endX } = action;\n    const [from, to] = getRange(draft, { startX, endX });\n\n    if (from !== to) {\n      const peak = lookupPeak(datumOriginal.data, { from, to });\n\n      const shiftX = getShiftX(draft.data[index] as Datum1D);\n\n      if (peak && !datumOriginal.peaks.values.some((p) => p.delta === peak.x)) {\n        const newPeak = {\n          id: generateID(),\n          originDelta: peak.x - shiftX,\n          delta: peak.x,\n          intensity: peak.y,\n        };\n        (draft.data[index] as Datum1D).peaks.values.push(newPeak);\n      }\n    }\n  }\n}\n\nfunction deletePeak(draft: Draft<State>, peakData) {\n  const { index } = draft.activeSpectrum;\n  const state = original(draft) as State;\n\n  if (peakData == null) {\n    (draft.data[index] as Datum1D).peaks.values = [];\n  } else {\n    const peakIndex = (state.data[index] as Datum1D).peaks.values.findIndex(\n      (p) => p.id === peakData.id,\n    );\n    (draft.data[index] as Datum1D).peaks.values.splice(peakIndex, 1);\n  }\n}\n\nfunction handleAutoPeakPicking(draft: Draft<State>, autOptions) {\n  if (draft.activeSpectrum?.id) {\n    draft.selectedTool = options.zoom.id;\n    draft.selectedOptionPanel = null;\n    const { index } = draft.activeSpectrum;\n    const datum = draft.data[index] as Datum1D;\n\n    const [from, to] = draft.xDomain;\n    const windowFromIndex = xFindClosestIndex(datum.data.x, from);\n    const windowToIndex = xFindClosestIndex(datum.data.x, to);\n\n    const peaks = autoPeakPicking(draft.data[index], {\n      ...autOptions,\n      windowFromIndex,\n      windowToIndex,\n    });\n\n    datum.peaks.values = datum.peaks.values.concat(peaks);\n  }\n}\n\nexport { addPeak, addPeaks, deletePeak, handleAutoPeakPicking };\n","import median from 'ml-array-median';\nimport { xyAutoPeaksPicking } from 'nmr-processing';\n\nimport { getShiftX } from '../data1d/Datum1D';\nimport generateID from '../utilities/generateID';\n\nexport default function autoPeakPicking(datum1D, options) {\n  const {\n    minMaxRatio,\n    maxNumberOfPeaks,\n    noiseFactor,\n    lookNegative,\n    windowFromIndex,\n    windowToIndex,\n  } = options;\n  // we calculate the noise but this could be improved\n  const noise = median(datum1D.data.re.map((y) => Math.abs(y)));\n\n  let { re, x } = datum1D.data;\n\n  if (windowFromIndex !== undefined && windowToIndex !== undefined) {\n    x = x.slice(windowFromIndex, windowToIndex);\n    re = re.slice(windowFromIndex, windowToIndex);\n  }\n\n  let peaks = xyAutoPeaksPicking(\n    { x, y: re },\n    {\n      lookNegative,\n      noiseLevel: noise * noiseFactor,\n      minMaxRatio: minMaxRatio, // Threshold to determine if a given peak should be considered as a noise\n      realTopDetection: true,\n      maxCriteria: true,\n      smoothY: false,\n      sgOptions: { windowSize: 15, polynomial: 3 },\n    },\n  );\n  peaks.sort((a, b) => b.y - a.y);\n  if (maxNumberOfPeaks < peaks.length) peaks = peaks.slice(0, maxNumberOfPeaks);\n\n  const shiftX = getShiftX(datum1D);\n\n  const error = (x[x.length - 1] - x[0]) / 10000;\n\n  return peaks.reduce((acc, newPeak) => {\n    // check if the peak is already exists\n    for (const { delta } of datum1D.peaks.values) {\n      if (Math.abs(newPeak.x - delta) < error) {\n        return acc;\n      }\n    }\n\n    acc.push({\n      id: generateID(),\n      originDelta: newPeak.x - shiftX,\n      delta: newPeak.x,\n      intensity: newPeak.y,\n      width: newPeak.width,\n    });\n\n    return acc;\n  }, []);\n}\n","import { Draft } from 'immer';\n\nimport * as MulitpleAnalysis from '../../../data/data1d/MulitpleAnalysis';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\nfunction analyzeSpectra(draft: Draft<State>, action) {\n  const [from, to] = getRange(draft, action);\n  MulitpleAnalysis.analyzeSpectra(draft.data, draft.spectraAnalysis, {\n    from,\n    to,\n    nucleus: draft.activeTab,\n  });\n}\n\nfunction handleDeleteSpectraRanges(draft: Draft<State>, action) {\n  const { colKey } = action;\n  MulitpleAnalysis.deleteSpectraAnalysis(\n    draft.spectraAnalysis,\n    colKey,\n    draft.activeTab,\n  );\n}\nfunction handleResizeSpectraRange(draft: Draft<State>, action) {\n  const { columnKey, from, to } = action.payload;\n  MulitpleAnalysis.analyzeSpectra(draft.data, draft.spectraAnalysis, {\n    from,\n    to,\n    nucleus: draft.activeTab,\n    columnKey,\n  });\n}\nfunction handleSetcolumns(draft: Draft<State>, action) {\n  const data = action.payload;\n  MulitpleAnalysis.setColumn(draft.spectraAnalysis, draft.activeTab, data);\n}\nfunction handleFiltercolumn(draft: Draft<State>, action) {\n  const { columnKey, valueKey } = action.payload;\n  MulitpleAnalysis.changeColumnValueKey(\n    draft.spectraAnalysis,\n    draft.activeTab,\n    columnKey,\n    valueKey,\n  );\n}\n\nexport {\n  analyzeSpectra,\n  handleDeleteSpectraRanges,\n  handleResizeSpectraRange,\n  handleSetcolumns,\n  handleFiltercolumn,\n};\n","import { xyCalibrate } from 'ml-spectra-processing';\n\nimport { getRange } from '../constants/References';\n/**\n *\n * @param {*} datum1D\n * @param {object} [options={}]\n * @param {number} [options.from]\n * @param {number} [options.to] Define the from zone where the reference is expected to be found\n * @param {number} [options.from]\n * @param {number} [options.nbPeaks]\n * @param {number} [options.targetX]\n * @param {string} [options.reference]\n */\n\nexport default function getReferenceShift(datum1D, options) {\n  let { from, to, nbPeaks, targetX, reference } = options;\n  if (reference) {\n    let data = getRange({ reference: reference, nucleus: datum1D.nucleus });\n    from = data.from;\n    to = data.to;\n    nbPeaks = data.nbPeaks;\n    targetX = data.delta;\n  }\n\n  const { re, x } = datum1D.data;\n  return xyCalibrate({ x, y: re }, { from, to }, { nbPeaks, targetX });\n}\n","import { Draft, original } from 'immer';\n\nimport { Filters } from '../../../data/Filters';\nimport { applyFilter } from '../../../data/FiltersManager';\nimport { Datum1D } from '../../../data/data1d/Datum1D';\nimport getReferenceShift from '../../../data/data1d/getReferenceShift';\nimport { getMissingProjection, Datum2D } from '../../../data/data2d/Datum2D';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\nimport { State } from '../Reducer';\n\nimport { setDomain, setMode } from './DomainActions';\nimport { setTab, setActiveTab } from './ToolsActions';\n\nfunction checkIsVisible2D(datum: Datum2D): boolean {\n  if (\n    datum.display.isPositiveVisible === false &&\n    datum.display.isNegativeVisible === false\n  ) {\n    return false;\n  }\n  return true;\n}\n\nfunction setVisible(datum, flag) {\n  if (datum.info.dimension === 2) {\n    (datum as Datum2D).display.isPositiveVisible = flag;\n    (datum as Datum2D).display.isNegativeVisible = flag;\n    (datum as Datum2D).display.isVisible = checkIsVisible2D(datum as Datum2D);\n  } else {\n    (datum as Datum1D).display.isVisible = flag;\n  }\n}\n\nfunction handleSpectrumVisibility(draft: Draft<State>, action) {\n  if (Array.isArray(action.id)) {\n    const IDs = action.id;\n    if (IDs.length === 0) {\n      for (const datum of draft.data) {\n        setVisible(datum, false);\n      }\n    } else {\n      for (const datum of draft.data) {\n        if (IDs.includes(datum.id)) {\n          setVisible(datum, true);\n        } else {\n          setVisible(datum, false);\n        }\n      }\n    }\n  } else {\n    const index = draft.data.findIndex((d) => d.id === action.id);\n    (draft.data[index] as Datum1D | Datum2D).display[action.key] = action.value;\n\n    if ((draft.data[index] as Datum1D | Datum2D).info.dimension === 2) {\n      (draft.data[index] as Datum2D).display.isVisible = checkIsVisible2D(\n        draft.data[index] as Datum2D,\n      );\n    }\n  }\n}\n\nfunction handleChangePeaksMarkersVisibility(draft: Draft<State>, data) {\n  for (let datum of draft.data) {\n    if (\n      datum.info?.dimension === 1 &&\n      data.some((activeData) => activeData.id === datum.id)\n    ) {\n      (datum as Datum1D).display.isPeaksMarkersVisible = true;\n    } else {\n      (datum as Datum1D).display.isPeaksMarkersVisible = false;\n    }\n  }\n}\n\nfunction handleChangeActiveSpectrum(draft: Draft<State>, activeSpectrum) {\n  // const state = original(draft);\n\n  let refreshDomain = false;\n  if (activeSpectrum) {\n    // AnalysisObj.getDatum(activeSpectrum.id).setDisplay({ isVisible: true });\n    const newIndex = draft.data.findIndex((d) => d.id === activeSpectrum.id);\n    const oldIndex = draft.data.findIndex(\n      (d) => d.id === draft.activeSpectrum?.id,\n    );\n    if (newIndex !== -1) {\n      const newActiveSpectrum = draft.data[newIndex] as Datum1D | Datum2D;\n\n      newActiveSpectrum.display.isVisible = true;\n\n      if (oldIndex !== -1) {\n        refreshDomain =\n          (draft.data[oldIndex] as Datum1D | Datum2D).info.isFid ===\n          newActiveSpectrum.info.isFid\n            ? false\n            : true;\n      } else {\n        refreshDomain = newActiveSpectrum.info.isFid || false;\n      }\n    }\n    activeSpectrum = { ...activeSpectrum, index: newIndex };\n    draft.activeSpectrum = activeSpectrum;\n    draft.tabActiveSpectrum[draft.activeTab] = activeSpectrum;\n  } else {\n    draft.activeSpectrum = null;\n    draft.tabActiveSpectrum[draft.activeTab] = null;\n    refreshDomain = false;\n  }\n\n  /**\n   * if the active spectrum not is FID then dont refresh the domain and the mode when the first time you activate soectrum\n   * if the new active spectrum different than the previous active spectrum fid then refresh the domain andf the mode.\n   */\n  if (refreshDomain) {\n    setDomain(draft);\n    // const tab = draft.activeTab;\n    // delete draft.tabActiveSpectrum[tab];\n    setMode(draft);\n  }\n}\n\nfunction changeSpectrumSetting(draft: Draft<State>, { id, display }) {\n  const state = original(draft) as State;\n  const index = state.data.findIndex((d) => d.id === id);\n  if (index !== -1) {\n    draft.data[index].display = display;\n  }\n}\nfunction handleChangeSpectrumColor(draft: Draft<State>, { id, color, key }) {\n  const state = original(draft) as State;\n  const index = state.data.findIndex((d) => d.id === id);\n  if (index !== -1) {\n    (draft.data[index] as Datum1D | Datum2D).display[key] = color;\n  }\n}\n\nfunction handleDeleteSpectra(draft: Draft<State>, action) {\n  const { activeTab } = draft;\n  const state = original(draft) as State;\n  if (action.id) {\n    const index = state.data.findIndex((d) => d.id === action.id);\n    draft.data.splice(index, 1);\n  } else {\n    draft.data.forEach((datum, index) => {\n      draft.data.splice(index, 1);\n    });\n  }\n  draft.activeSpectrum = null;\n  setActiveTab(draft, activeTab, true);\n}\nfunction addMissingProjectionHander(draft, action) {\n  const state = original(draft);\n  const nucleus = action.nucleus;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    for (let n of nucleus) {\n      const datum1D = getMissingProjection(state.data[index], n);\n      draft.data.push(datum1D);\n    }\n    const groupByNucleus = GroupByInfoKey('nucleus');\n    const dataGroupByNucleus = groupByNucleus(draft.data);\n    setTab(draft, dataGroupByNucleus, draft.activeTab, true);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\nfunction alignSpectraHandler(draft: Draft<State>, action) {\n  if (draft.data && draft.data.length > 0) {\n    for (let datum of draft.data) {\n      if (\n        datum.info?.dimension === 1 &&\n        datum.info.nucleus === draft.activeTab &&\n        !datum.info?.isFid\n      ) {\n        const shift = getReferenceShift(datum, { ...action.payload });\n        applyFilter(datum, [\n          {\n            name: Filters.shiftX.id,\n            options: shift,\n          },\n        ]);\n      }\n    }\n  }\n\n  setDomain(draft);\n  setMode(draft);\n}\n\nexport {\n  handleSpectrumVisibility,\n  handleChangePeaksMarkersVisibility,\n  handleChangeActiveSpectrum,\n  handleChangeSpectrumColor,\n  changeSpectrumSetting,\n  handleDeleteSpectra,\n  addMissingProjectionHander,\n  alignSpectraHandler,\n};\n","export const UNDO = 'undo';\nexport const REDO = 'redo';\nexport const SET = 'set';\nexport const RESET = 'reset';\n","import { produce } from 'immer';\nimport { Build, Types } from 'nmr-correlation';\nimport { predictionProton } from 'nmr-processing';\nimport OCL from 'openchemlib/full';\n\nimport * as SpectraManager from '../../data/SpectraManager';\nimport { Spectra } from '../NMRium';\nimport { DefaultTolerance } from '../panels/SummaryPanel/CorrelationTable/Constants';\nimport { options } from '../toolbar/ToolTypes';\nimport { nmredataToNmrium } from '../utility/nmredataToNmrium';\n\nimport * as CorrelationsActions from './actions/CorrelationsActions';\nimport { setWidth, handleSetDimensions } from './actions/DimensionsActions';\nimport * as DomainActions from './actions/DomainActions';\nimport * as FiltersActions from './actions/FiltersActions';\nimport * as GlobalActions from './actions/GlobalActions';\nimport {\n  handleHistoryUndo,\n  handleHistoryRedo,\n  handleHistoryReset,\n} from './actions/HistoryActions';\nimport * as IntegralsActions from './actions/IntegralsActions';\nimport * as LoadActions from './actions/LoadActions';\nimport * as MoleculeActions from './actions/MoleculeActions';\nimport * as PeaksActions from './actions/PeaksActions';\nimport {\n  handelSetPreferences,\n  setKeyPreferencesHandler,\n  applyKeyPreferencesHandler,\n} from './actions/PreferencesActions';\nimport * as RangesActions from './actions/RangesActions';\nimport * as SpectraAanalysisActions from './actions/SpectraAanalysisAction';\nimport * as SpectrumsActions from './actions/SpectrumsActions';\nimport * as ToolsActions from './actions/ToolsActions';\nimport * as ZonesActions from './actions/ZonesActions';\nimport { DEFAULT_YAXIS_SHIFT_VALUE, DISPLAYER_MODE } from './core/Constants';\nimport { UNDO, REDO, RESET } from './types/HistoryTypes';\nimport * as types from './types/Types';\n\nexport const initialState = {\n  data: null,\n  contours: null,\n  tempData: null,\n  xDomain: [],\n  yDomain: [],\n  yDomains: {},\n  xDomains: {},\n  originDomain: {},\n  integralsYDomains: {},\n  originIntegralYDomain: {},\n  selectedTool: options.zoom.id,\n  selectedFilter: null,\n  selectedOptionPanel: null,\n  activeTab: null,\n  width: 0,\n  height: 0,\n  margin: {\n    top: 10,\n    right: 20,\n    bottom: 70,\n    left: 0,\n  },\n  activeSpectrum: null,\n  mode: 'RTL',\n  zoomFactor: { scale: 1 },\n  integralZoomFactor: { scale: 0.5 },\n  molecules: [],\n  verticalAlign: {\n    flag: false,\n    stacked: false,\n    value: DEFAULT_YAXIS_SHIFT_VALUE,\n  },\n  history: {\n    past: [],\n    present: null,\n    future: [],\n    hasUndo: false,\n    hasRedo: false,\n  },\n  pivot: 0,\n  isLoading: false,\n  preferences: {},\n  baseLineZones: [],\n  keysPreferences: {},\n  displayerMode: DISPLAYER_MODE.DM_1D,\n  tabActiveSpectrum: {},\n  spectraAnalysis: {},\n  correlations: Build.init({\n    values: [],\n    options: { tolerance: DefaultTolerance, mf: '' },\n    state: {},\n  }),\n  displayerKey: '',\n  ZoomHistory: {},\n  overDisplayer: false,\n  exclusionZones: {},\n};\n\nexport interface State {\n  data: Spectra;\n  contours: any;\n  tempData: any;\n  xDomain: Array<number>;\n  yDomain: Array<number>;\n  yDomains: any;\n  xDomains: any;\n  originDomain: any;\n  integralsYDomains: any;\n  originIntegralYDomain: any;\n  selectedTool: any;\n  selectedFilter: any;\n  selectedOptionPanel: any;\n  activeTab: any;\n  width: any;\n  height: any;\n  margin: Partial<{ top: number; right: number; bottom: number; left: number }>;\n  activeSpectrum: any;\n  mode: string;\n  zoomFactor: Partial<{ scale: number }>;\n  integralZoomFactor: Partial<{ scale: number }>;\n  molecules: Array<any>;\n  verticalAlign: Partial<{\n    flag: boolean;\n    stacked: boolean;\n    value: number;\n  }>;\n  history: Partial<{\n    past: Array<any>;\n    present: any;\n    future: Array<any>;\n    hasUndo: boolean;\n    hasRedo: boolean;\n  }>;\n  pivot: number;\n  isLoading: boolean;\n  preferences: any;\n  baseLineZones: any;\n  keysPreferences: any;\n  displayerMode: any;\n  tabActiveSpectrum: any;\n  spectraAnalysis: any;\n  displayerKey: any;\n  correlations: Types.CorrelationData;\n  ZoomHistory: any;\n  overDisplayer: boolean;\n  exclusionZones: {\n    [key: string]: Array<{ id: string; from: number; to: number }>;\n  };\n}\n\nexport function dispatchMiddleware(dispatch) {\n  return (action) => {\n    switch (action.type) {\n      case types.INITIATE: {\n        if (action.payload) {\n          const { spectra, ...res } = action.payload;\n          void SpectraManager.fromJSON(spectra).then((data) => {\n            action.payload = { spectra: data, ...res };\n            dispatch(action);\n          });\n        } else {\n          dispatch(action);\n        }\n        break;\n      }\n      case types.LOAD_JSON_FILE: {\n        const data = JSON.parse(action.files[0].binary.toString());\n        void SpectraManager.fromJSON(data.spectra).then((spectra) => {\n          action.payload = Object.assign(data, { spectra });\n          dispatch(action);\n        });\n        break;\n      }\n      case types.LOAD_ZIP_FILE: {\n        for (let zipFile of action.files) {\n          void SpectraManager.addBruker(\n            { display: { name: zipFile.name } },\n            zipFile.binary,\n          ).then((data) => {\n            action.payload = data;\n            dispatch(action);\n          });\n        }\n        break;\n      }\n      case types.LOAD_NMREDATA_FILE: {\n        void nmredataToNmrium(action.files).then((data) => {\n          action.payload = data;\n          dispatch(action);\n        });\n        break;\n      }\n      case types.PREDICT_SPECTRA: {\n        const molecule = OCL.Molecule.fromMolfile(action.payload.mol.molfile);\n        void predictionProton(molecule, {}).then((result) => {\n          action.payload.fromMolfile = result;\n          dispatch(action);\n        });\n\n        break;\n      }\n\n      default:\n        dispatch(action);\n\n        break;\n    }\n  };\n}\n\nfunction innerSpectrumReducer(draft, action) {\n  draft.actionType = action.type;\n  switch (action.type) {\n    case types.INITIATE:\n      return LoadActions.initiate(draft, action);\n    case types.SET_LOADING_FLAG:\n      return LoadActions.setIsLoading(draft, action.isLoading);\n    case types.LOAD_JSON_FILE:\n      return LoadActions.handleLoadJsonFile(draft, action);\n    case types.LOAD_JCAMP_FILE:\n      return LoadActions.loadJcampFile(draft, action.files);\n    case types.LOAD_JDF_FILE:\n      return LoadActions.loadJDFFile(draft, action.files);\n    case types.LOAD_MOL_FILE:\n      return LoadActions.handleLoadMOLFile(draft, action.files);\n    case types.LOAD_ZIP_FILE:\n      return LoadActions.handleLoadZIPFile(draft, action);\n    case types.LOAD_NMREDATA_FILE:\n      return LoadActions.handleLoadNmredata(draft, action);\n    case types.ADD_PEAK:\n      return PeaksActions.addPeak(draft, action.mouseCoordinates);\n    case types.ADD_PEAKS:\n      return PeaksActions.addPeaks(draft, action);\n\n    case types.DELETE_PEAK_NOTATION:\n      return PeaksActions.deletePeak(draft, action.data);\n\n    case types.ADD_INTEGRAL:\n      return IntegralsActions.addIntegral(draft, action);\n    case types.DELETE_INTEGRAL:\n      return IntegralsActions.deleteIntegral(draft, action);\n    case types.CHANGE_INTEGRAL_DATA:\n      return IntegralsActions.changeIntegral(draft, action);\n    case types.RESIZE_INTEGRAL:\n      return IntegralsActions.changeIntegral(draft, action);\n    case types.CHANGE_INTEGRAL_ZOOM:\n      return IntegralsActions.handleChangeIntegralZoom(draft, action);\n    case types.CHANGE_INTEGRAL_SUM:\n      return IntegralsActions.handleChangeIntegralSum(draft, action.value);\n    case types.CHANGE_INTEGRAL_RELATIVE:\n      return IntegralsActions.handleChangeIntegralsRaltiveValue(draft, action);\n\n    case types.SET_ORIGINAL_DOMAIN:\n      return DomainActions.setOriginalDomain(draft, action.domain);\n\n    case types.SET_X_DOMAIN:\n      return DomainActions.setXDomain(draft, action.xDomain);\n\n    case types.SET_Y_DOMAIN:\n      return DomainActions.setYDomain(draft, action.yDomain);\n\n    case types.SET_WIDTH:\n      return setWidth(draft, action.width);\n\n    case types.SET_DIMENSIONS:\n      return handleSetDimensions(draft, action.width, action.height);\n\n    case types.SET_SELECTED_TOOL:\n      return ToolsActions.setSelectedTool(draft, action.selectedTool);\n    case types.RESET_SELECTED_TOOL:\n      return ToolsActions.resetSelectedTool(draft);\n    case types.SET_SELECTED_OPTIONS_PANEL:\n      return ToolsActions.setSelectedOptionPanel(\n        draft,\n        action.selectedOptionPanel,\n      );\n    case types.FULL_ZOOM_OUT:\n      return ToolsActions.zoomOut(draft, action);\n    case types.SHIFT_SPECTRUM:\n      return FiltersActions.shiftSpectrumAlongXAxis(draft, action.shiftValue);\n    case types.APPLY_ZERO_FILLING_FILTER:\n      return FiltersActions.applyZeroFillingFilter(draft, action.value);\n    case types.APPLY_FFT_FILTER:\n      return FiltersActions.applyFFTFilter(draft);\n    case types.APPLY_MANUAL_PHASE_CORRECTION_FILTER:\n      return FiltersActions.applyManualPhaseCorrectionFilter(\n        draft,\n        action.value,\n      );\n    case types.APPLY_AUTO_PHASE_CORRECTION_FILTER:\n      return FiltersActions.applyAutoPhaseCorrectionFilter(draft);\n    case types.APPLY_ABSOLUTE_FILTER:\n      return FiltersActions.applyAbsoluteFilter(draft);\n    case types.CALCULATE_MANUAL_PHASE_CORRECTION_FILTER:\n      return FiltersActions.calculateManualPhaseCorrection(draft, action.value);\n    case types.ENABLE_FILTER:\n      return FiltersActions.enableFilter(draft, action.id, action.checked);\n    case types.DELETE_FILTER:\n      return FiltersActions.deleteFilter(draft, action);\n    case types.DELETE_SPECTRA_FILTER:\n      return FiltersActions.deleteSpectraFilter(draft, action);\n    case types.SET_FILTER_SNAPSHOT:\n      return FiltersActions.filterSnapshotHandler(draft, action);\n    case types.APPLY_MULTIPLE_SPECTRA_FILTER:\n      return FiltersActions.handleMultipleSpectraFilter(draft, action);\n\n    case types.CHANGE_VISIBILITY:\n      return SpectrumsActions.handleSpectrumVisibility(draft, action);\n\n    case types.CHANGE_PEAKS_MARKERS_VISIBILITY:\n      return SpectrumsActions.handleChangePeaksMarkersVisibility(\n        draft,\n        action.data,\n      );\n    case types.CHANGE_ACTIVE_SPECTRUM:\n      return SpectrumsActions.handleChangeActiveSpectrum(draft, action.data);\n    case types.CHANGE_SPECTRUM_COLOR:\n      return SpectrumsActions.handleChangeSpectrumColor(draft, action.data);\n    case types.CHANGE_SPECTRUM_SETTING:\n      return SpectrumsActions.changeSpectrumSetting(draft, action);\n    case types.ALIGN_SPECTRA:\n      return SpectrumsActions.alignSpectraHandler(draft, action);\n    case types.TOGGLE_REAL_IMAGINARY_VISIBILITY:\n      return ToolsActions.handleToggleRealImaginaryVisibility(draft);\n    case types.SET_ZOOM_FACTOR:\n      return ToolsActions.handleZoom(draft, action);\n    case types.SET_SPECTRA_SAME_TOP:\n      return ToolsActions.setSpectraSameTopHandler(draft);\n    case types.RESET_SPECTRA_SCALE:\n      return ToolsActions.resetSpectraScale(draft);\n\n    case types.CHANGE_SPECTRUM_DISPLAY_VIEW_MODE:\n      return ToolsActions.handleChangeSpectrumDisplayMode(draft);\n\n    case types.ADD_MOLECULE:\n      return MoleculeActions.addMoleculeHandler(draft, action.molfile);\n\n    case types.SET_MOLECULE:\n      return MoleculeActions.setMoleculeHandler(\n        draft,\n        action.molfile,\n        action.key,\n      );\n\n    case types.DELETE_MOLECULE:\n      return MoleculeActions.deleteMoleculeHandler(draft, action);\n\n    case types.PREDICT_SPECTRA:\n      return MoleculeActions.predictSpectraFromMolculeHandler(draft, action);\n\n    case types.SET_CORRELATIONS_MF:\n      return CorrelationsActions.handleSetMF(draft, action.payload);\n\n    case types.SET_CORRELATIONS_TOLERANCE:\n      return CorrelationsActions.handleSetTolerance(draft, action.payload);\n\n    case types.SET_CORRELATION:\n      return CorrelationsActions.handleSetCorrelation(draft, action.payload);\n\n    case types.SET_CORRELATIONS:\n      return CorrelationsActions.handleSetCorrelations(draft, action.payload);\n\n    case types.DELETE_SPECTRA:\n      return SpectrumsActions.handleDeleteSpectra(draft, action);\n\n    case types.SET_INTEGRAL_Y_DOMAIN:\n      return DomainActions.handleChangeIntegralYDomain(draft, action.yDomain);\n\n    case types.BRUSH_END:\n      return ToolsActions.handleBrushEnd(draft, action);\n\n    case types.SET_VERTICAL_INDICATOR_X_POSITION:\n      return ToolsActions.setVerticalIndicatorXPosition(draft, action.position);\n    case types.SET_SPECTRUMS_VERTICAL_ALIGN:\n      return ToolsActions.setSpectrumsVerticalAlign(draft);\n\n    case types.AUTO_PEAK_PICKING:\n      return PeaksActions.handleAutoPeakPicking(draft, action.options);\n\n    case types.AUTO_ZONES_DETECTION:\n      return ZonesActions.handleAutoZonesDetection(draft, action.options);\n    case types.AUTO_RANGES_DETECTION:\n      return RangesActions.handleAutoRangesDetection(draft, action.options);\n    case types.ADD_RANGE:\n      return RangesActions.handleAddRange(draft, action);\n    case types.DELETE_RANGE:\n      return RangesActions.handleDeleteRange(draft, action);\n    case types.RESIZE_RANGE:\n      return RangesActions.handleResizeRange(draft, action);\n    case types.CHANGE_RANGE_SUM:\n      return RangesActions.handleChangeRangeSum(draft, action.value);\n    case types.CHANGE_RANGE_RELATIVE:\n      return RangesActions.handleChangeRangeRaltiveValue(draft, action);\n    case types.CHANGE_RANGE_SIGNAL_VALUE:\n      return RangesActions.handleChangeRangeSignalValue(draft, action);\n    case types.CHANGE_RANGE_SIGNAL_KIND:\n      return RangesActions.handleChangeRangeSignalKind(draft, action);\n    case types.SAVE_EDITED_RANGE:\n      return RangesActions.handleSaveEditedRange(draft, action);\n    case types.UNLINK_RANGE:\n      return RangesActions.handleUnlinkRange(draft, action);\n    case types.SET_DIAID_RANGE:\n      return RangesActions.handleSetDiaIDRange(draft, action);\n\n    case types.SET_PREFERENCES:\n      return handelSetPreferences(draft, action.data);\n    case types.SET_ACTIVE_TAB:\n      return ToolsActions.handelSetActiveTab(draft, action.tab);\n    case types.ADD_BASE_LINE_ZONE:\n      return ToolsActions.handleAddBaseLineZone(draft, action.zone);\n    case types.DELETE_BASE_LINE_ZONE:\n      return ToolsActions.handleDeleteBaseLineZone(draft, action.id);\n    case types.ADD_EXCLUSION_ZONE:\n      return ToolsActions.handleAddExclusionZone(draft, action);\n    case types.DELETE_EXCLUSION_ZONE:\n      return ToolsActions.handleDeleteExclusionZone(draft, action);\n\n    case types.APPLY_BASE_LINE_CORRECTION_FILTER:\n      return FiltersActions.handleBaseLineCorrectionFilter(draft, action);\n    case types.SET_KEY_PREFERENCES:\n      return setKeyPreferencesHandler(draft, action.keyCode);\n    case types.APPLY_KEY_PREFERENCES:\n      return applyKeyPreferencesHandler(draft, action.keyCode);\n    case types.SET_2D_LEVEL:\n      return ToolsActions.levelChangeHandler(draft, action);\n    case types.ADD_2D_ZONE:\n      return ZonesActions.add2dZoneHandler(draft, action);\n    case types.DELETE_2D_ZONE:\n      return ZonesActions.handleDeleteZone(draft, action);\n    case types.ADD_MISSING_PROJECTION:\n      return SpectrumsActions.addMissingProjectionHander(draft, action);\n    case types.RESET_DOMAIN:\n      return DomainActions.handelResetDomain(draft);\n    case types.CHANGE_ZONE_SIGNAL_VALUE:\n      return ZonesActions.changeZoneSignalDelta(draft, action);\n    case types.CHANGE_ZONE_SIGNAL_KIND:\n      return ZonesActions.handleChangeZoneSignalKind(draft, action);\n    case types.UNLINK_ZONE:\n      return ZonesActions.handleUnlinkZone(draft, action);\n    case types.SET_DIAID_ZONE:\n      return ZonesActions.handleSetDiaIDZone(draft, action);\n\n    case types.ANALYZE_SPECTRA:\n      return SpectraAanalysisActions.analyzeSpectra(draft, action);\n    case types.DELETE_ANALYZE_SPECTRA_RANGE:\n      return SpectraAanalysisActions.handleDeleteSpectraRanges(draft, action);\n    case types.RESIZE_ANALYZE_SPECTRA_RANGE:\n      return SpectraAanalysisActions.handleResizeSpectraRange(draft, action);\n    case types.SET_ANALYZE_SPECTRA_COLUMNS:\n      return SpectraAanalysisActions.handleSetcolumns(draft, action);\n    case types.FILTER_SPECTRA_COLUMN:\n      return SpectraAanalysisActions.handleFiltercolumn(draft, action);\n\n    case UNDO:\n      return handleHistoryUndo(draft);\n\n    case REDO:\n      return handleHistoryRedo(draft);\n\n    case RESET:\n      return handleHistoryReset(draft, action);\n\n    case types.SET_MOUSE_OVER_DISPLAYER:\n      return GlobalActions.setIsOverDisplayer(draft, action);\n\n    default:\n      return;\n  }\n}\n\nexport const spectrumReducer = produce(innerSpectrumReducer);\n","import { Draft } from 'immer';\n\nimport { State } from '../Reducer';\n\nfunction setWidth(draft: Draft<State>, width) {\n  draft.width = width;\n}\n\nfunction handleSetDimensions(draft: Draft<State>, width, height) {\n  draft.width = width;\n  draft.height = height;\n}\n\nexport { setWidth, handleSetDimensions };\n","import { setDomain, getDomain } from './DomainActions';\n\nfunction handleHistoryUndo(draft) {\n  const { past, present, future } = draft.history;\n  const previous = past[past.length - 1];\n  const newPast = past.slice(0, past.length - 1);\n  const newfuture = [present, ...future];\n\n  const hasRedo = newfuture.length !== 0;\n  const hasUndo = past.length !== 0;\n\n  // AnalysisObj.undoFilter(past);\n  // let resultData = AnalysisObj.getSpectraData();\n\n  const domain = getDomain(draft.data);\n  // const domain = getDomain(resultData);\n  const history = {\n    past: newPast,\n    present: previous,\n    future: newfuture,\n    hasRedo,\n    hasUndo,\n  };\n\n  // draft.data = resultData;\n  draft.xDomain = domain.xDomain;\n  draft.yDomain = domain.yDomain;\n  draft.originDomain = domain;\n  draft.history = history;\n}\n\nfunction handleHistoryRedo(draft) {\n  const { history } = draft;\n  // eslint-disable-next-line no-unused-vars\n  const next = history.future[0];\n  const newPresent = history.future.shift();\n  history.past.push(history.present);\n  history.present = newPresent;\n  history.hasUndo = true;\n  history.hasRedo = history.future.length > 0;\n\n  // AnalysisObj.redoFilter(next);\n  // draft.data = AnalysisObj.getSpectraData();\n  setDomain(draft.data);\n}\n\nfunction handleHistoryReset(draft, action) {\n  draft.history = {\n    past: [],\n    present: action,\n    future: [],\n    hasRedo: false,\n    hasUndo: false,\n  };\n}\n\nexport { handleHistoryUndo, handleHistoryRedo, handleHistoryReset };\n","import { Draft } from 'immer';\n\nimport { State } from '../Reducer';\n\nfunction setIsOverDisplayer(draft: Draft<State>, actions) {\n  draft.overDisplayer = actions.payload;\n}\nexport { setIsOverDisplayer };\n","import { useMemo, memo, forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction ToolBarWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      data,\n      activeSpectrum,\n      verticalAlign,\n      displayerMode,\n    } = useChartData();\n\n    const { info = {} } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const result = data.find((datum) => datum.id === activeSpectrum.id);\n        return result !== null && result !== undefined\n          ? { info: result.info, spectrumsCount: result.length }\n          : {};\n      }\n      return {};\n    }, [activeSpectrum, data]);\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        info={info}\n        activeSpectrum={activeSpectrum}\n        verticalAlign={verticalAlign}\n        displayerMode={displayerMode}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return memo(\n    forwardRef((props, ref) => {\n      return <Wrapper {...props} forwardedRef={ref} />;\n    }),\n  );\n}\nexport default ToolBarWrapper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useRef, useCallback } from 'react';\n\nimport CloseButton from '../elements/CloseButton';\nimport { loadFile, extractFileMetaFromPath } from '../utility/FileUtility';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  width: 450px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    display: flex;\n    margin: 30px 5px;\n    input,\n    button {\n      padding: 5px;\n      border: 1px solid gray;\n      border-radius: 5px;\n      height: 36px;\n      margin: 2px;\n    }\n    input {\n      flex: 10;\n    }\n    button {\n      flex: 2;\n      color: white;\n      background-color: gray;\n    }\n  }\n`;\nconst allowedExtensions = ['dx', 'jdx'];\n\nfunction LoadJCAMPModal({ onLoadClick, onClose, startLoading }) {\n  const pathReft = useRef();\n\n  const loadJCAMPHandler = useCallback(() => {\n    // ./data/xtc/XTC-814d_zg30.jdx\n    const path = pathReft.current.value;\n    const { name, extension } = extractFileMetaFromPath(path);\n    if (allowedExtensions.includes(extension)) {\n      startLoading();\n      loadFile(path, { asBuffer: true }).then((data) => {\n        const file = {\n          binary: data,\n          name,\n          extension,\n          jcampURL: path,\n        };\n        onLoadClick(file);\n      });\n    } else {\n      onLoadClick(null);\n    }\n  }, [onLoadClick, startLoading]);\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>Load JCAMP Dialog</span>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div className=\"container\">\n        <input\n          ref={pathReft}\n          type=\"text\"\n          placeholder=\"Enter URL to JCAMP-DX file\"\n        />\n        <button type=\"button\" onClick={loadJCAMPHandler}>\n          Load\n        </button>\n      </div>\n    </div>\n  );\n}\n\nLoadJCAMPModal.defaultProps = {\n  onLoadButtonClick: () => {\n    return null;\n  },\n  onClose: () => {\n    return null;\n  },\n  startLoading: () => {\n    return null;\n  },\n};\nexport default LoadJCAMPModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  SvgNmrRealImag,\n  SvgNmrOverlay3,\n  SvgNmrOverlay3Aligned,\n  SvgNmrAlignBottom,\n  SvgNmrAlignCenter,\n} from 'cheminfo-font';\nimport lodashGet from 'lodash/get';\nimport { Fragment, useCallback, memo } from 'react';\nimport {\n  FaDownload,\n  FaFileDownload,\n  FaFileImage,\n  FaCopy,\n  FaFileExport,\n  FaFile,\n  FaFileImport,\n} from 'react-icons/fa';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport { useLoader } from '../context/LoaderContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport MenuButton from '../elements/MenuButton';\nimport ToolTip from '../elements/ToolTip/ToolTip';\nimport { useAlert } from '../elements/popup/Alert';\nimport { useModal } from '../elements/popup/Modal';\nimport ToolBarWrapper from '../hoc/ToolBarWrapper';\nimport useExport from '../hooks/useExport';\nimport useToolsFunctions from '../hooks/useToolsFunctions';\nimport LoadJCAMPModal from '../modal/LoadJCAMPModal';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\nimport { LOAD_JCAMP_FILE, SET_LOADING_FLAG } from '../reducer/types/Types';\n\nconst styles = css`\n  background-color: transparent;\n  border: none;\n  width: 35px;\n  height: 35px;\n  min-height: 35px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  outline: outline;\n  :focus {\n    outline: none !important;\n  }\n\n  &.fa {\n    svg {\n      font-size: 14px;\n    }\n  }\n  &.cheminfo {\n    svg {\n      font-size: 24px;\n    }\n  }\n`;\n\nconst IMPORT_MENU = [\n  {\n    id: 'importFile',\n    icon: <FaFile />,\n    label: 'Import from file system (Press Ctrl + O)',\n  },\n  {\n    id: 'importJDX',\n    icon: <FaFile />,\n    label: 'Add JCAMP-DX from URL',\n  },\n];\nconst EXPORT_MENU = [\n  {\n    id: 'svg',\n    icon: <FaDownload />,\n    label: 'Export as SVG',\n  },\n  {\n    id: 'png',\n    icon: <FaFileImage />,\n    label: 'Export as PNG',\n  },\n  {\n    id: 'json',\n    icon: <FaFileDownload />,\n    label: 'Save data ( Press Ctrl + S )',\n  },\n  {\n    id: 'advance_save',\n    icon: <FaFileDownload />,\n    label: 'Save data as  ( Press Ctrl + Shift + S )',\n  },\n  {\n    id: 'nmre',\n    icon: <FaFileDownload />,\n    label: 'Save NMRE data',\n  },\n  {\n    id: 'copy',\n    icon: <FaCopy />,\n    label: 'Copy image to Clipboard ( Press Ctrl + C )',\n  },\n];\n\nfunction BasicToolBar({ info, verticalAlign, displayerMode }) {\n  const dispatch = useDispatch();\n  const preferences = usePreferences();\n  const alert = useAlert();\n  const modal = useModal();\n  const loader = useLoader();\n\n  const {\n    isRealSpectrumShown,\n\n    changeSpectrumViewHandler,\n    changeDisplayViewModeHandler,\n    alignSpectrumsVerticallyHandler,\n  } = useToolsFunctions();\n\n  const {\n    saveAsSVGHandler,\n    saveAsPNGHandler,\n    saveAsJSONHandler,\n    saveAsNMREHandler,\n    saveToClipboardHandler,\n    saveAsHandler,\n  } = useExport();\n\n  const selectedSpectrumInfo = { isComplex: false, isFid: false, ...info };\n\n  const LoadJacmpHandler = useCallback(\n    (file) => {\n      if (file) {\n        dispatch({ type: LOAD_JCAMP_FILE, files: [file] });\n        modal.close();\n      } else {\n        alert.error('you file must be one of those extensions [ .jdx, dx ] ');\n      }\n    },\n    [alert, dispatch, modal],\n  );\n\n  const startLoadingHandler = useCallback(() => {\n    modal.close();\n    dispatch({ type: SET_LOADING_FLAG, isLoading: true });\n  }, [dispatch, modal]);\n\n  const importJCAMPFile = useCallback(() => {\n    modal.show(\n      <LoadJCAMPModal\n        onLoadClick={LoadJacmpHandler}\n        onClose={() => modal.close()}\n        startLoading={startLoadingHandler}\n      />,\n      {},\n    );\n  }, [LoadJacmpHandler, modal, startLoadingHandler]);\n\n  const isButtonVisible = useCallback(\n    (key) => {\n      return !lodashGet(preferences, `display.toolBarButtons.${key}`);\n    },\n    [preferences],\n  );\n  const importFromFileSystemHandler = useCallback(() => {\n    loader.open();\n  }, [loader]);\n\n  const ImportHandler = useCallback(\n    ({ id }) => {\n      switch (id) {\n        case 'importFile':\n          importFromFileSystemHandler();\n          break;\n        case 'importJDX':\n          importJCAMPFile();\n          break;\n        default:\n          return;\n      }\n    },\n    [importFromFileSystemHandler, importJCAMPFile],\n  );\n\n  const exportHandler = useCallback(\n    ({ id }) => {\n      switch (id) {\n        case 'svg':\n          saveAsSVGHandler();\n          break;\n        case 'png':\n          saveAsPNGHandler();\n          break;\n        case 'json':\n          saveAsJSONHandler();\n          break;\n        case 'advance_save':\n          saveAsHandler();\n          break;\n        case 'nmre':\n          saveAsNMREHandler();\n          break;\n        case 'copy':\n          saveToClipboardHandler();\n          break;\n\n        default:\n          break;\n      }\n    },\n    [\n      saveAsSVGHandler,\n      saveAsPNGHandler,\n      saveAsJSONHandler,\n      saveAsHandler,\n      saveAsNMREHandler,\n      saveToClipboardHandler,\n    ],\n  );\n\n  return (\n    <Fragment>\n      {isButtonVisible('hideImport') && (\n        <MenuButton\n          style={styles}\n          className=\"fa\"\n          component={<FaFileImport />}\n          toolTip=\"Import\"\n          onClick={ImportHandler}\n          items={IMPORT_MENU}\n        />\n      )}\n      {isButtonVisible('hideExportAs') && (\n        <MenuButton\n          style={styles}\n          className=\"fa\"\n          component={<FaFileExport />}\n          toolTip=\"Export As\"\n          onClick={exportHandler}\n          items={EXPORT_MENU}\n        />\n      )}\n\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('hideSpectraStackAlignments') && (\n          <button\n            type=\"button\"\n            css={styles}\n            className=\"cheminfo\"\n            onClick={changeDisplayViewModeHandler}\n          >\n            <ToolTip\n              title=\"Spectra alignment ( Press s )\"\n              popupPlacement=\"right\"\n            >\n              {verticalAlign.stacked ? (\n                <SvgNmrOverlay3Aligned />\n              ) : (\n                <SvgNmrOverlay3 />\n              )}\n            </ToolTip>\n          </button>\n        )}\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('hideRealImaginary') &&\n        selectedSpectrumInfo &&\n        selectedSpectrumInfo.isComplex && (\n          <button\n            css={styles}\n            className=\"cheminfo\"\n            type=\"button\"\n            onClick={changeSpectrumViewHandler}\n          >\n            <ToolTip\n              title={\n                isRealSpectrumShown ? 'Display Real ' : 'Display Imaginary '\n              }\n              popupPlacement=\"right\"\n            >\n              <SvgNmrRealImag />\n            </ToolTip>\n          </button>\n        )}\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('hideSpectraCenterAlignments') && (\n          <button\n            css={styles}\n            className=\"cheminfo\"\n            type=\"button\"\n            onClick={alignSpectrumsVerticallyHandler}\n          >\n            <ToolTip\n              title={\n                !verticalAlign.flag\n                  ? 'Baseline  Center ( Press c )'\n                  : 'Baseline  Bottom ( Press c )'\n              }\n              popupPlacement=\"right\"\n            >\n              {!verticalAlign.flag ? (\n                <SvgNmrAlignCenter />\n              ) : (\n                <SvgNmrAlignBottom />\n              )}\n            </ToolTip>\n          </button>\n        )}\n    </Fragment>\n  );\n}\n\nexport default ToolBarWrapper(memo(BasicToolBar));\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useState, useEffect, cloneElement } from 'react';\n\nconst styles = css`\n  width: 35px;\n  height: 35px;\n  background-color: white;\n  padding: 5px;\n  margin: 0px;\n  border: none;\n  outline: none;\n\n  :focus {\n    outline: none !important;\n  }\n`;\nconst activeStyles = css`\n  color: black;\n  background-color: #f3f3f3 !important;\n`;\n\nfunction ToggleButton({\n  children,\n  value,\n  disabled,\n  isActive,\n  onChange,\n  className,\n  style,\n  isVisible,\n  onMouseEnter,\n  onMouseLeave,\n  helpID,\n}) {\n  const [active, setActive] = useState(isActive);\n  const toggleButton = useCallback(() => {\n    const _isActive = !active;\n    setActive(_isActive);\n    if (_isActive) {\n      onChange(value);\n    } else {\n      onChange(null);\n    }\n  }, [active, onChange, value]);\n\n  useEffect(() => {\n    setActive(isActive);\n  }, [isActive]);\n\n  if (!isVisible) {\n    return null;\n  }\n  return (\n    <button\n      type=\"button\"\n      onClick={toggleButton}\n      css={[styles, active && activeStyles]}\n      style={style}\n      className={active ? ` ${className}  active` : ` ${className} `}\n      disabled={disabled}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}\n      data-helpid={helpID}\n    >\n      {cloneElement(children, { style: { fontSize: '10px' } })}\n    </button>\n  );\n}\nToggleButton.displayName = 'ToggleButton';\n\nToggleButton.defaultProps = {\n  isActive: false,\n  disabled: false,\n  isVisible: true,\n  value: null,\n  className: '',\n  onChange: function () {\n    return null;\n  },\n  onValueReady: function () {\n    return null;\n  },\n};\n\nexport default ToggleButton;\n","import {\n  useCallback,\n  useState,\n  useMemo,\n  useEffect,\n  Children,\n  cloneElement,\n} from 'react';\n\nconst style = { display: 'flex', flexDirection: 'column' };\n\nfunction ToggleButtonGroup({ children, value, onChange }) {\n  const [toggleButtons, setToggleButtons] = useState([]);\n  const handleOnChange = useCallback(\n    (val) => {\n      const _toggles = [...toggleButtons];\n      const toggles = _toggles.map((toggle) => {\n        return {\n          value: toggle.value,\n          isActive: toggle.value === val ? true : false,\n        };\n      });\n      setToggleButtons(toggles);\n      onChange(val);\n    },\n    [onChange, toggleButtons],\n  );\n\n  const mappedChildren = useMemo(() => {\n    let index = 0;\n    return Children.map(children, (child) => {\n      if (child) {\n        if (child.type.displayName === 'ToggleButton') {\n          const _child = cloneElement(child, {\n            onChange: handleOnChange,\n            isActive:\n              toggleButtons[index] &&\n              toggleButtons[index].isActive &&\n              toggleButtons[index].isActive,\n            index,\n          });\n          index++;\n          return _child;\n        } else {\n          return cloneElement(child);\n        }\n      }\n    });\n  }, [children, handleOnChange, toggleButtons]);\n\n  useEffect(() => {\n    const val = Children.map(children, (child) => {\n      if (child && child.type.displayName === 'ToggleButton') {\n        return {\n          value: child.props.value,\n          isActive: child.props.value === value ? true : false,\n        };\n      }\n    });\n    setToggleButtons(val);\n  }, [children, value]);\n\n  return <div style={style}> {mappedChildren} </div>;\n}\n\nToggleButtonGroup.defaultProps = {\n  onChange: function () {\n    return null;\n  },\n};\nexport default ToggleButtonGroup;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  SvgNmrBaselineCorrection,\n  SvgNmrFourierTransform,\n  SvgNmrIntegrate,\n  SvgNmrMultipleAnalysis,\n  SvgNmrPeakPicking,\n  SvgNmrPhaseCorrection,\n  SvgNmrRangePicking,\n  SvgNmrZeroFilling,\n} from 'cheminfo-font';\nimport lodashGet from 'lodash/get';\nimport { useState, useEffect, useCallback, memo } from 'react';\nimport { FaSearchPlus, FaExpand, FaDiceFour } from 'react-icons/fa';\n\nimport { Filters } from '../../data/Filters';\nimport { useDispatch } from '../context/DispatchContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport ToolTip from '../elements/ToolTip/ToolTip';\nimport { useHelp } from '../elements/popup/Help/Context';\nimport { ToggleButton, ToggleButtonGroup } from '../elements/toggle';\nimport ToolBarWrapper from '../hoc/ToolBarWrapper';\nimport useToolsFunctions from '../hooks/useToolsFunctions';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\nimport { APPLY_FFT_FILTER, SET_SELECTED_FILTER } from '../reducer/types/Types';\n\nimport { options } from './ToolTypes';\n\nconst styles = css`\n  button {\n    background-color: transparent;\n    border: none;\n    width: 35px;\n    height: 35px;\n    min-height: 35px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    outline: outline;\n    :focus {\n      outline: none !important;\n    }\n\n    &.fa {\n      svg {\n        font-size: 14px;\n      }\n    }\n    &.cheminfo {\n      svg {\n        font-size: 18px;\n      }\n    }\n  }\n`;\n\n// let debounceClickEvents = [];\n\nfunction FunctionToolBar({\n  defaultValue,\n  activeSpectrum,\n  info,\n  displayerMode,\n}) {\n  const [option, setOption] = useState();\n  const help = useHelp();\n  const preferences = usePreferences();\n\n  const dispatch = useDispatch();\n\n  const selectedSpectrumInfo = {\n    info: { isComplex: false, isFid: false, ...info },\n  };\n  const { handleChangeOption, handleFullZoomOut } = useToolsFunctions();\n\n  const handleChange = useCallback(\n    (selectedOption) => {\n      setOption(selectedOption);\n      handleChangeOption(selectedOption);\n    },\n    [handleChangeOption],\n  );\n\n  useEffect(() => {\n    setOption(defaultValue);\n  }, [defaultValue]);\n\n  const handleOnFFTFilter = useCallback(() => {\n    dispatch({\n      type: APPLY_FFT_FILTER,\n      value: '',\n    });\n    dispatch({ type: SET_SELECTED_FILTER, selectedFilter: null });\n  }, [dispatch]);\n\n  const isButtonVisible = useCallback(\n    (key) => {\n      return !lodashGet(preferences, `display.toolBarButtons.${key}`);\n    },\n    [preferences],\n  );\n\n  return (\n    <div css={styles}>\n      <ToggleButtonGroup value={option} onChange={handleChange}>\n        {isButtonVisible('hideZoomTool') && (\n          <ToggleButton\n            key={options.zoom.id}\n            value={options.zoom.id}\n            {...help.onHover}\n            helpID=\"zoomIn\"\n            className=\"fa\"\n          >\n            <ToolTip\n              title={`${options.zoom.label} ( Press z )`}\n              popupPlacement=\"right\"\n              offset={{ x: 10, y: 0 }}\n              style={{ display: 'flex' }}\n            >\n              <FaSearchPlus />\n            </ToolTip>\n          </ToggleButton>\n        )}\n\n        {isButtonVisible('hideZoomOutTool') && (\n          <button className=\"fa\" type=\"button\" onClick={handleFullZoomOut}>\n            <ToolTip\n              title=\"Horizontal zoom out ( Press f ), Horizontal and Vertical zoom out, double click ( Press ff )\"\n              popupPlacement=\"right\"\n            >\n              <FaExpand />\n            </ToolTip>\n          </button>\n        )}\n\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hidePeakTool') && (\n            <ToggleButton\n              key={options.peakPicking.id}\n              value={options.peakPicking.id}\n              className=\"cheminfo\"\n              isVisible={\n                activeSpectrum &&\n                selectedSpectrumInfo &&\n                !selectedSpectrumInfo.info.isFid\n              }\n              {...help.onHover}\n              helpID=\"peakPicking\"\n            >\n              <ToolTip\n                title={`${options.peakPicking.label} ( Press p )`}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrPeakPicking />\n              </ToolTip>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hideIntegralTool') && (\n            <ToggleButton\n              key={options.integral.id}\n              value={options.integral.id}\n              className=\"cheminfo\"\n              isVisible={\n                activeSpectrum &&\n                selectedSpectrumInfo &&\n                !selectedSpectrumInfo.info.isFid\n              }\n              {...help.onHover}\n              helpID=\"integralPicking\"\n            >\n              <ToolTip\n                title={`${options.integral.label} ( Press i )`}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrIntegrate />\n              </ToolTip>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_2D &&\n          isButtonVisible('hideIntegralTool') && (\n            <ToggleButton\n              key={options.zone2D.id}\n              value={options.zone2D.id}\n              className=\"fa\"\n              isVisible={activeSpectrum}\n            >\n              <ToolTip\n                title={`${options.zone2D.label} ( Press i  )`}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <FaDiceFour />\n              </ToolTip>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_2D && (\n          <ToggleButton\n            key={options.slicingTool.id}\n            value={options.slicingTool.id}\n            style={styles.icon}\n            isVisible={activeSpectrum}\n          >\n            <ToolTip\n              title={`${options.slicingTool.label}`}\n              popupPlacement=\"right\"\n              offset={{ x: 10, y: 0 }}\n            >\n              Slic\n            </ToolTip>\n          </ToggleButton>\n        )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hideAutoRangesTool') && (\n            <ToggleButton\n              key={options.rangesPicking.id}\n              value={options.rangesPicking.id}\n              className=\"cheminfo\"\n              isVisible={\n                activeSpectrum &&\n                selectedSpectrumInfo &&\n                !selectedSpectrumInfo.info.isFid\n              }\n            >\n              <ToolTip\n                title={options.rangesPicking.label}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrRangePicking />\n              </ToolTip>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hideMultipleSpectraAnalysisTool') && (\n            <ToggleButton\n              key={options.multipleSpectraAnalysis.id}\n              value={options.multipleSpectraAnalysis.id}\n              className=\"cheminfo\"\n            >\n              <ToolTip\n                title={options.multipleSpectraAnalysis.label}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrMultipleAnalysis />\n              </ToolTip>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hideZeroFillingTool') && (\n            <ToggleButton\n              key={options.zeroFilling.id}\n              value={options.zeroFilling.id}\n              className=\"cheminfo\"\n              isVisible={\n                selectedSpectrumInfo &&\n                Filters.zeroFilling.isApplicable(selectedSpectrumInfo)\n              }\n            >\n              <ToolTip\n                title={options.zeroFilling.label}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrZeroFilling />\n              </ToolTip>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hidePhaseCorrectionTool') && (\n            <ToggleButton\n              key={options.phaseCorrection.id}\n              value={options.phaseCorrection.id}\n              className=\"cheminfo\"\n              style={styles.icon}\n              isVisible={\n                activeSpectrum &&\n                selectedSpectrumInfo &&\n                Filters.phaseCorrection.isApplicable(selectedSpectrumInfo)\n              }\n            >\n              <ToolTip\n                title={options.phaseCorrection.label}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrPhaseCorrection />\n              </ToolTip>\n            </ToggleButton>\n          )}\n\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hideBaseLineCorrectionTool') && (\n            <ToggleButton\n              key={options.baseLineCorrection.id}\n              value={options.baseLineCorrection.id}\n              className=\"cheminfo\"\n              isVisible={\n                activeSpectrum &&\n                selectedSpectrumInfo &&\n                Filters.baselineCorrection.isApplicable(selectedSpectrumInfo)\n              }\n            >\n              <ToolTip\n                title={options.baseLineCorrection.label}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrBaselineCorrection />\n              </ToolTip>\n            </ToggleButton>\n          )}\n\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hideExclusionZonesTool') && (\n            <ToggleButton\n              key={options.exclusionZones.id}\n              value={options.exclusionZones.id}\n              className=\"cheminfo\"\n            >\n              <ToolTip\n                title={options.exclusionZones.label}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrMultipleAnalysis />\n              </ToolTip>\n            </ToggleButton>\n          )}\n      </ToggleButtonGroup>\n\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('hideFFTTool') &&\n        selectedSpectrumInfo &&\n        Filters.fft.isApplicable(selectedSpectrumInfo) && (\n          <button\n            className=\"cheminfo\"\n            type=\"button\"\n            onClick={handleOnFFTFilter}\n          >\n            <ToolTip\n              title={`FFT Filter`}\n              popupPlacement=\"right\"\n              offset={{ x: 10, y: 0 }}\n            >\n              <SvgNmrFourierTransform />\n            </ToolTip>\n          </button>\n        )}\n    </div>\n  );\n}\n\nexport default ToolBarWrapper(memo(FunctionToolBar));\n\nFunctionToolBar.defaultProps = {\n  defaultValue: options.zoom.id,\n};\n","import { memo } from 'react';\n\nimport BasicToolBar from './BasicToolBar';\nimport FunctionToolBar from './FunctionToolBar';\n\nconst styles = {\n  display: 'flex',\n  flexDirection: 'column',\n  alignItems: 'start',\n  borderRight: '0.55px solid #f7f7f7',\n  paddingRight: '1px',\n  overflowY: 'auto',\n  height: '100%',\n};\nfunction ToolBar({ selectedTool }) {\n  return (\n    <div style={{ ...styles }}>\n      <FunctionToolBar defaultValue={selectedTool} />\n      {/* <HistoryToolBar /> */}\n      <BasicToolBar />\n    </div>\n  );\n}\n\nexport default memo(ToolBar);\n","/** @jsxImportSource @emotion/react */\n\nimport { css } from '@emotion/react';\nimport lodashGet from 'lodash/get';\nimport PropTypes from 'prop-types';\nimport {\n  useEffect,\n  useCallback,\n  useReducer,\n  useState,\n  useMemo,\n  useRef,\n  memo,\n  Reducer,\n  CSSProperties,\n  ReactElement,\n  ReactNode,\n} from 'react';\nimport SplitPane from 'react-split-pane';\nimport { useToggle, useFullscreen } from 'react-use';\n\nimport { Datum1D } from '../data/data1d/Datum1D';\nimport { Datum2D } from '../data/data2d/Datum2D';\nimport checkModifierKeyActivated from '../data/utilities/checkModifierKeyActivated';\n\nimport Viewer1D from './1d/Viewer1D';\nimport Viewer2D from './2d/Viewer2D';\nimport ErrorBoundary from './ErrorBoundary';\nimport KeysListenerTracker from './EventsTrackers/KeysListenerTracker';\nimport { AssignmentProvider } from './assignment';\nimport helpList, { setBaseUrl } from './constants/help';\nimport { ChartDataProvider } from './context/ChartContext';\nimport { DispatchProvider } from './context/DispatchContext';\nimport { GlobalProvider } from './context/GlobalContext';\nimport { PreferencesProvider } from './context/PreferencesContext';\nimport { AlertProvider } from './elements/popup/Alert';\nimport { HelpProvider } from './elements/popup/Help';\nimport { ModalProvider } from './elements/popup/Modal';\nimport Header from './header/Header';\nimport { HighlightProvider } from './highlight';\nimport DropZone from './loader/DropZone';\nimport { defaultGetSpinner, SpinnerProvider } from './loader/SpinnerContext';\nimport Panels from './panels/Panels';\nimport checkActionType from './reducer/IgnoreActions';\nimport {\n  spectrumReducer,\n  initialState,\n  dispatchMiddleware,\n} from './reducer/Reducer';\nimport { DISPLAYER_MODE } from './reducer/core/Constants';\nimport {\n  preferencesInitialState,\n  preferencesReducer,\n  INIT_PREFERENCES,\n} from './reducer/preferencesReducer';\nimport {\n  INITIATE,\n  SET_WIDTH,\n  SET_LOADING_FLAG,\n  SET_MOUSE_OVER_DISPLAYER,\n} from './reducer/types/Types';\nimport ToolBar from './toolbar/ToolBar';\n\nconst splitPaneStyles: Record<\n  'container' | 'resizer' | 'pane',\n  CSSProperties\n> = {\n  container: {\n    position: 'relative',\n    height: 'none',\n  },\n  resizer: {\n    width: 10,\n    backgroundColor: '#f7f7f7',\n    cursor: 'ew-resize',\n  },\n  pane: { overflow: 'hidden' },\n};\n\nconst containerStyles = css`\n  background-color: white;\n  width: 100%;\n  display: block;\n  height: 100%;\n  font-size: 14px;\n\n  div:focus {\n    outline: none !important;\n  }\n\n  button {\n    cursor: pointer;\n    color: black;\n    &:disabled {\n      cursor: default;\n    }\n  }\n\n  button:active,\n  button:hover,\n  button:focus,\n  [type='button']:focus,\n  button {\n    outline: none !important;\n  }\n  * {\n    -webkit-user-drag: none;\n    -moz-user-drag: none;\n    -o-user-drag: none;\n    user-drag: none;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n  }\n\n  .SplitPane {\n    height: 100%;\n  }\n\n  .Resizer.vertical:after {\n    content: '\\\\22EE';\n    top: 50%;\n    color: black;\n    position: absolute;\n    font-size: 14px;\n  }\n\n  .Resizer.vertical {\n    padding: 2px;\n  }\n\n  .Resizer.vertical:hover {\n    background-color: #dfdfdf !important;\n    border-left: 0.55px #bbbbbb solid;\n    border-right: 0.55px #bbbbbb solid;\n  }\n`;\n\nexport interface NMRiumProps {\n  data?: NMRiumData;\n  docsBaseUrl?: string;\n  onDataChange?: (data: any) => void;\n  preferences?: NMRiumPreferences;\n  emptyText?: ReactNode;\n  /**\n   * Returns a custom spinner that will be rendered while loading data.\n   */\n  getSpinner?: () => ReactElement;\n}\n\nexport type NMRiumPreferences = Partial<{\n  general: Partial<{\n    disableMultipletAnalysis: boolean;\n    hideSetSumFromMolecule: boolean;\n  }>;\n  panels: Partial<{\n    hideSpectraPanel: boolean;\n    hideInformationPanel: boolean;\n    hidePeaksPanel: boolean;\n    hideIntegralsPanel: boolean;\n    hideRangesPanel: boolean;\n    hideStructuresPanel: boolean;\n    hideFiltersPanel: boolean;\n    hideZonesPanel: boolean;\n    hideSummaryPanel: boolean;\n    hideMultipleSpectraAnalysisPanel: boolean;\n  }>;\n  toolBarButtons: Partial<{\n    hideZoomTool: boolean;\n    hideZoomOutTool: boolean;\n    hideImport: boolean;\n    hideExportAs: boolean;\n    hideSpectraStackAlignments: boolean;\n    hideSpectraCenterAlignments: boolean;\n    hideRealImaginary: boolean;\n    hidePeakTool: boolean;\n    hideIntegralTool: boolean;\n    hideAutoRangesTool: boolean;\n    hideZeroFillingTool: boolean;\n    hidePhaseCorrectionTool: boolean;\n    hideBaseLineCorrectionTool: boolean;\n    hideFFTTool: boolean;\n    hideMultipleSpectraAnalysisTool: boolean;\n  }>;\n}>;\n\nexport type Molecules = Array<{ molfile: string }>;\nexport type Spectra = Array<Partial<Datum1D> | Partial<Datum2D>>;\n\nexport interface NMRiumData {\n  molecules?: Molecules;\n  spectra: Spectra;\n}\n\nfunction NMRium({\n  data: dataProp,\n  onDataChange,\n  docsBaseUrl,\n  preferences,\n  getSpinner = defaultGetSpinner,\n  emptyText = undefined,\n}: NMRiumProps) {\n  const rootRef = useRef<HTMLDivElement>(null);\n  const elementsWraperRef = useRef<HTMLDivElement>(null);\n  const [show, toggle] = useToggle(false);\n  const isFullscreen = useFullscreen(rootRef, show, {\n    onClose: () => {\n      toggle(false);\n    },\n  });\n  const [isRightPanelHide, hideRightPanel] = useState(false);\n  const [isResizeEventStart, setResizeEventStart] = useState(false);\n  const [helpData, setHelpData] = useState(helpList);\n\n  const [state, dispatch] = useReducer<Reducer<any, any>>(\n    spectrumReducer,\n    initialState,\n  );\n  const [preferencesState, dispatchPreferences] = useReducer<Reducer<any, any>>(\n    preferencesReducer,\n    preferencesInitialState,\n  );\n\n  const { selectedTool, displayerMode, data: spectraData } = state;\n\n  useEffect(() => {\n    if (checkActionType(state.actionType)) {\n      onDataChange?.(state);\n    }\n  }, [onDataChange, state]);\n\n  const dispatchMiddleWare = useMemo(() => {\n    return dispatchMiddleware(dispatch);\n  }, []);\n\n  useEffect(() => {\n    rootRef.current?.focus();\n  }, [isFullscreen]);\n\n  useEffect(() => {\n    dispatchPreferences({\n      type: INIT_PREFERENCES,\n      payload: { display: preferences, dispatch: dispatchPreferences },\n    });\n  }, [preferences]);\n\n  useEffect(() => {\n    dispatchMiddleWare({ type: SET_LOADING_FLAG, isLoading: true });\n    dispatchMiddleWare({ type: INITIATE, payload: dataProp });\n  }, [dataProp, dispatchMiddleWare]);\n\n  useEffect(() => {\n    setBaseUrl(docsBaseUrl);\n    setHelpData(helpList());\n  }, [docsBaseUrl]);\n\n  const handleSplitPanelDragFinished = useCallback(\n    (size) => {\n      if (size && !isRightPanelHide) {\n        setResizeEventStart(false);\n        dispatch({ type: SET_WIDTH, width: size });\n      }\n    },\n    [isRightPanelHide],\n  );\n\n  const preventAutoHelp = useMemo(() => {\n    return lodashGet(\n      preferencesState,\n      'controllers.help.preventAutoHelp',\n      false,\n    );\n  }, [preferencesState]);\n\n  const rightPanelHandler = useCallback((e) => {\n    e.stopPropagation();\n    hideRightPanel((prevFlag) => !prevFlag);\n  }, []);\n\n  const preventContextMenuHandler = useCallback((e) => {\n    if (!checkModifierKeyActivated(e)) {\n      e.preventDefault();\n    }\n  }, []);\n  const mouseEnterHandler = useCallback(() => {\n    dispatchMiddleWare({ type: SET_MOUSE_OVER_DISPLAYER, payload: true });\n  }, [dispatchMiddleWare]);\n  const mouseLeaveHandler = useCallback(() => {\n    dispatchMiddleWare({ type: SET_MOUSE_OVER_DISPLAYER, payload: false });\n  }, [dispatchMiddleWare]);\n\n  return (\n    <ErrorBoundary>\n      <GlobalProvider\n        value={{\n          rootRef: rootRef.current,\n          elementsWraperRef: elementsWraperRef.current,\n        }}\n      >\n        <PreferencesProvider value={preferencesState}>\n          <div\n            onMouseEnter={mouseEnterHandler}\n            onMouseLeave={mouseLeaveHandler}\n            style={{ height: '100%', position: 'relative' }}\n          >\n            {/* @ts-expect-error: TODO remove when HelpProvider is migrated */}\n            <HelpProvider\n              data={helpData}\n              wrapperRef={elementsWraperRef.current}\n              preventAutoHelp={preventAutoHelp}\n            >\n              {/* @ts-expect-error: TODO remove when AlertProvider is migrated */}\n              <AlertProvider wrapperRef={elementsWraperRef.current}>\n                <DispatchProvider value={dispatchMiddleWare}>\n                  <ChartDataProvider value={{ ...state, isResizeEventStart }}>\n                    <ModalProvider wrapperRef={elementsWraperRef.current}>\n                      <HighlightProvider>\n                        <AssignmentProvider spectraData={spectraData}>\n                          <SpinnerProvider value={getSpinner}>\n                            <div\n                              ref={rootRef}\n                              css={containerStyles}\n                              onContextMenu={preventContextMenuHandler}\n                            >\n                              <Header\n                                isFullscreen={isFullscreen}\n                                onMaximize={toggle}\n                              />\n\n                              <div\n                                style={{\n                                  height: 'calc(100% - 36px)',\n                                  width: '100%',\n                                  backgroundColor: 'white',\n                                }}\n                              >\n                                <DropZone>\n                                  <KeysListenerTracker />\n\n                                  <ToolBar selectedTool={selectedTool} />\n                                  <SplitPane\n                                    style={splitPaneStyles.container}\n                                    resizerStyle={splitPaneStyles.resizer}\n                                    paneStyle={splitPaneStyles.pane}\n                                    pane1Style={\n                                      isRightPanelHide\n                                        ? {\n                                            maxWidth: '100%',\n                                            width: 'calc(100% - 10px)',\n                                          }\n                                        : { maxWidth: '80%' }\n                                    }\n                                    split=\"vertical\"\n                                    defaultSize={\n                                      isRightPanelHide\n                                        ? '99%'\n                                        : 'calc(100% - 600px)'\n                                    }\n                                    minSize=\"80%\"\n                                    onDragFinished={\n                                      handleSplitPanelDragFinished\n                                    }\n                                    onResizerDoubleClick={rightPanelHandler}\n                                    onDragStarted={() => {\n                                      setResizeEventStart(true);\n                                    }}\n                                  >\n                                    {displayerMode === DISPLAYER_MODE.DM_1D ? (\n                                      <Viewer1D emptyText={emptyText} />\n                                    ) : (\n                                      <Viewer2D emptyText={emptyText} />\n                                    )}\n                                    {!isRightPanelHide ? (\n                                      <Panels\n                                        selectedTool={selectedTool}\n                                        displayerMode={displayerMode}\n                                      />\n                                    ) : null}\n                                  </SplitPane>\n                                </DropZone>\n                              </div>\n                              <div\n                                ref={elementsWraperRef}\n                                key={String(isFullscreen)}\n                                id=\"main-wrapper\"\n                                style={{\n                                  position: 'absolute',\n                                  pointerEvents: 'none',\n                                  zIndex: 0,\n                                  left: 0,\n                                  right: 0,\n                                  top: 0,\n                                  bottom: 0,\n                                }}\n                              />\n                            </div>\n                          </SpinnerProvider>\n                        </AssignmentProvider>\n                      </HighlightProvider>\n                    </ModalProvider>\n                  </ChartDataProvider>\n                </DispatchProvider>\n              </AlertProvider>\n            </HelpProvider>\n          </div>\n        </PreferencesProvider>\n      </GlobalProvider>\n    </ErrorBoundary>\n  );\n}\n\nNMRium.propTypes = {\n  docsBaseUrl: PropTypes.string,\n  onDataChange: PropTypes.func,\n  preferences: PropTypes.shape({\n    general: PropTypes.shape({\n      disableMultipletAnalysis: PropTypes.bool,\n      hideSetSumFromMolecule: PropTypes.bool,\n    }),\n    panels: PropTypes.shape({\n      hideSpectraPanel: PropTypes.bool,\n      hideInformationPanel: PropTypes.bool,\n      hidePeaksPanel: PropTypes.bool,\n      hideIntegralsPanel: PropTypes.bool,\n      hideRangesPanel: PropTypes.bool,\n      hideStructuresPanel: PropTypes.bool,\n      hideFiltersPanel: PropTypes.bool,\n    }),\n    toolBarButtons: PropTypes.shape({\n      hideZoomTool: PropTypes.bool,\n      hideZoomOutTool: PropTypes.bool,\n      hideImport: PropTypes.bool,\n      hideExportAs: PropTypes.bool,\n      hideSpectraStackAlignments: PropTypes.bool,\n      hideSpectraCenterAlignments: PropTypes.bool,\n      hideRealImaginary: PropTypes.bool,\n      hidePeakTool: PropTypes.bool,\n      hideIntegralTool: PropTypes.bool,\n      hideAutoRangesTool: PropTypes.bool,\n      hideZeroFillingTool: PropTypes.bool,\n      hidePhaseCorrectionTool: PropTypes.bool,\n      hideBaseLineCorrectionTool: PropTypes.bool,\n      hideFFTTool: PropTypes.bool,\n      hideExclusionZonesTool: PropTypes.bool,\n    }),\n  }),\n};\n\nNMRium.defaultProps = {\n  docsBaseUrl: 'https://docs.nmrium.org',\n  onDataChange: () => null,\n  preferences: {\n    general: {\n      disableMultipletAnalysis: false,\n      hideSetSumFromMolecule: false,\n    },\n\n    panels: {\n      hideSpectraPanel: false,\n      hideInformationPanel: false,\n      hidePeaksPanel: false,\n      hideIntegralsPanel: false,\n      hideRangesPanel: false,\n      hideStructuresPanel: false,\n      hideFiltersPanel: false,\n      hideZonesPanel: false,\n      hideSummaryPanel: false,\n      hideMultipleSpectraAnalysisPanel: false,\n    },\n\n    toolBarButtons: {\n      hideZoomTool: false,\n      hideZoomOutTool: false,\n      hideImport: false,\n      hideExportAs: false,\n      hideSpectraStackAlignments: false,\n      hideSpectraCenterAlignments: false,\n      hideRealImaginary: false,\n      hidePeakTool: false,\n      hideIntegralTool: false,\n      hideAutoRangesTool: false,\n      hideZeroFillingTool: false,\n      hidePhaseCorrectionTool: false,\n      hideBaseLineCorrectionTool: false,\n      hideFFTTool: false,\n      hideMultipleSpectraAnalysisTool: false,\n      hideExclusionZonesTool: false,\n    },\n  },\n};\n\nexport default memo(NMRium);\n"],"sourceRoot":""}