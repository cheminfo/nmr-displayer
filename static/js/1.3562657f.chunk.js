(this.webpackJsonpnmrium=this.webpackJsonpnmrium||[]).push([[1],{188:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return HighlightProvider})),n.d(t,"d",(function(){return useHighlightData})),n.d(t,"c",(function(){return useHighlight}));var a=n(42),i=n(46),o=n(6),r=n(1),c=n(3),l={PEAK:"PEAK",INTEGRAL:"INTEGRAL",RANGE:"RANGE",ZONE:"ZONE"},s=Object(r.createContext)();function highlightReducer(e,t){switch(t.type){case"SHOW":var n,a=t.payload,r=a.convertedHighlights,c=a.type,l=Object(o.a)(Object(o.a)({},e),{},{highlights:Object(o.a)({},e.highlights),type:c}),s=Object(i.a)(r);try{for(s.s();!(n=s.n()).done;){var u=n.value;u in l.highlights||(l.highlights[u]=1)}}catch(g){s.e(g)}finally{s.f()}return l.highlighted=Object.keys(l.highlights),l;case"HIDE":var d,b=t.payload.convertedHighlights,p=Object(o.a)(Object(o.a)({},e),{},{highlights:Object(o.a)({},e.highlights),type:null}),f=Object(i.a)(b);try{for(f.s();!(d=f.n()).done;){var h=d.value;h in p.highlights&&delete p.highlights[h]}}catch(g){f.e(g)}finally{f.f()}return p.highlighted=Object.keys(p.highlights),p;case"SET_PERMANENT":return Object(o.a)(Object(o.a)({},e),{},{highlightedPermanently:t.payload});case"UNSET_PERMANENT":return Object(o.a)(Object(o.a)({},e),{},{highlightedPermanently:[]});default:throw new Error("unknown action type: ".concat(t.type))}}var u={highlights:{},highlighted:[],highlightedPermanently:[],type:null};function HighlightProvider(e){var t=Object(r.useReducer)(highlightReducer,u),n=Object(a.a)(t,2),i=n[0],o=n[1],l=Object(r.useMemo)((function(){return{highlight:i,dispatch:o}}),[i]);return Object(c.jsx)(s.Provider,{value:l,children:e.children})}function useHighlightData(){return Object(r.useContext)(s)}function useHighlight(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Array.isArray(e))throw new Error("highlights must be an array");var n=useHighlightData(),a=Object(r.useMemo)((function(){var t,n=[],a=Object(i.a)(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;if("string"!==typeof o&&"number"!==typeof o)throw new Error("highlight key must be a string or number");""!==o&&n.push(String(o))}}catch(r){a.e(r)}finally{a.f()}return n}),[e]);Object(r.useEffect)((function(){return function(){n.dispatch({type:"HIDE",payload:{convertedHighlights:a}}),n.dispatch({type:"UNSET_PERMANENT"})}}),[]);var o=Object(r.useMemo)((function(){return n.highlight.highlighted.some((function(e){return a.includes(e)}))}),[n.highlight.highlighted,a]),c=Object(r.useMemo)((function(){return n.highlight.highlightedPermanently.some((function(e){return a.includes(e)}))}),[n.highlight.highlightedPermanently,a]),l=Object(r.useCallback)((function(){n.dispatch({type:"SHOW",payload:{convertedHighlights:a,type:t}})}),[n,a,t]),s=Object(r.useCallback)((function(){n.dispatch({type:"HIDE",payload:{convertedHighlights:a}})}),[n,a]),u=Object(r.useCallback)((function(e){n.dispatch({type:"SHOW",payload:{convertedHighlights:[],id:e}})}),[n]),d=Object(r.useCallback)((function(e){n.dispatch({type:"HIDE",payload:{convertedHighlights:[],id:e}})}),[n]),b=Object(r.useCallback)((function(e){e&&(e.preventDefault(),e.stopPropagation()),c?n.dispatch({type:"UNSET_PERMANENT"}):n.dispatch({type:"SET_PERMANENT",payload:a})}),[n,a,c]),p={onMouseEnter:l,onMouseLeave:s},f={onClick:b};return{isActive:o,show:l,hide:s,onHover:p,onClick:f,isActivePermanently:c,click:b,add:u,remove:d}}},211:function(e,t,n){"use strict";n.d(t,"g",(function(){return exportAsSVG})),n.d(t,"d",(function(){return exportAsJSON})),n.d(t,"e",(function(){return exportAsNMRE})),n.d(t,"f",(function(){return exportAsPng})),n.d(t,"b",(function(){return copyPNGToClipboard})),n.d(t,"c",(function(){return copyTextToClipboard})),n.d(t,"a",(function(){return copyHTMLToClipboard}));var a=n(91),i=n(62),o=n.n(i),r=n(89),c=n(585),l=n(289),s=n.n(l);function copyFormattedHtml(e){var t=document.createElement("div");t.innerHTML=e,t.style.position="fixed",t.style.pointerEvents="none",t.style.opacity=0;var n=Array.prototype.slice.call(document.styleSheets).filter((function(e){return!e.disabled}));document.body.appendChild(t),window.getSelection().removeAllRanges();var a=document.createRange();a.selectNode(t),window.getSelection().addRange(a),document.execCommand("copy");for(var i=0;i<n.length;i++)n[i].disabled=!0;document.execCommand("copy");for(var o=0;o<n.length;o++)n[o].disabled=!1;document.body.removeChild(t)}function copyHTMLToClipboard(e){return _copyHTMLToClipboard.apply(this,arguments)}function _copyHTMLToClipboard(){return(_copyHTMLToClipboard=Object(r.a)(o.a.mark((function _callee3(e){return o.a.wrap((function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,copyFormattedHtml(e),t.abrupt("return",!0);case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",!1);case 8:case"end":return t.stop()}}),_callee3,null,[[0,5]])})))).apply(this,arguments)}function copyTextToClipboard(e){return _copyTextToClipboard.apply(this,arguments)}function _copyTextToClipboard(){return(_copyTextToClipboard=Object(r.a)(o.a.mark((function _callee4(e){return o.a.wrap((function _callee4$(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.clipboard.writeText(e);case 3:return t.abrupt("return",!0);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",!1);case 9:case"end":return t.stop()}}),_callee4,null,[[0,6]])})))).apply(this,arguments)}function exportAsJSON(e){return _exportAsJSON.apply(this,arguments)}function _exportAsJSON(){return(_exportAsJSON=Object(r.a)(o.a.mark((function _callee5(e){var t,n,a,i,r,l,u,d=arguments;return o.a.wrap((function _callee5$(o){for(;;)switch(o.prev=o.next){case 0:if(t=d.length>1&&void 0!==d[1]?d[1]:"experiment",n=d.length>2&&void 0!==d[2]?d[2]:0,a=d.length>3&&void 0!==d[3]&&d[3],i=JSON.stringify(e,(function(e,t){return ArrayBuffer.isView(t)?Array.from(t):t}),n),a){o.next=9;break}r=new Blob([i],{type:"text/plain"}),Object(c.saveAs)(r,"".concat(t,".nmrium")),o.next=21;break;case 9:return o.prev=9,(l=new s.a).file("".concat(t,".nmrium"),i),o.next=14,l.generateAsync({type:"blob"});case 14:u=o.sent,Object(c.saveAs)(u,"".concat(t,".zip")),o.next=21;break;case 18:o.prev=18,o.t0=o.catch(9),console.log(o.t0);case 21:case"end":return o.stop()}}),_callee5,null,[[9,18]])})))).apply(this,arguments)}function exportAsNMRE(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"experiment";e.generateAsync({type:"blob"}).then((function(e){Object(c.saveAs)(e,"".concat(t,".zip"))}))}function exportAsSVG(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"experiment",t=arguments.length>1?arguments[1]:void 0,n=getBlob(t),a=n.blob;Object(c.saveAs)(a,"".concat(e,".svg"))}function exportAsPng(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"experiment",t=arguments.length>1?arguments[1]:void 0,n=getBlob(t),a=n.blob,i=n.width,l=n.height;try{var s=document.createElement("canvas");s.width=i,s.height=l;var u=s.getContext("2d");u.fillStyle="white",u.fillRect(0,0,s.width,s.height);var d=new Image,b=URL.createObjectURL(a);d.onload=Object(r.a)(o.a.mark((function _callee(){var t;return o.a.wrap((function _callee$(n){for(;;)switch(n.prev=n.next){case 0:u.drawImage(d,0,0),t=s.toDataURL("image/png",1),Object(c.saveAs)(t,"".concat(e,".png")),URL.revokeObjectURL(t);case 4:case"end":return n.stop()}}),_callee)}))),d.src=b}catch(p){console.log(p)}}function copyDataURLCliboard(e){var t=document.createElement("img");t.src=e,t.style.position="fixed",t.style.pointerEvents="none",t.style.opacity=0,document.body.appendChild(t);var n=document.createRange();n.selectNode(t),window.getSelection().addRange(n),document.execCommand("Copy"),document.body.removeChild(t)}function copyBlobToCliboard(e){e.toBlob((function(e){var t=new ClipboardItem(Object(a.a)({},e.type,e));navigator.clipboard.write([t]).then((function(){console.log("experiment copied.")}),(function(e){console.log(e)}))}))}function copyPNGToClipboard(e){var t=getBlob(e),n=t.blob,a=t.width,i=t.height;try{var c=document.createElement("canvas");c.width=a,c.height=i;var l=c.getContext("2d");l.fillStyle="white",l.fillRect(0,0,c.width,c.height);var s=new Image,u=URL.createObjectURL(n);s.onload=Object(r.a)(o.a.mark((function _callee2(){var e;return o.a.wrap((function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:l.drawImage(s,0,0),e=c.toDataURL("image/png",1),navigator.clipboard.write?copyBlobToCliboard(c):copyDataURLCliboard(e),URL.revokeObjectURL(e);case 4:case"end":return t.stop()}}),_callee2)}))),s.src=u}catch(d){d instanceof ReferenceError&&alert("Your browser does not support this feature, please use Google Chrome"),console.log(d)}}function getBlob(e){var t=document.getElementById(e).cloneNode(!0),n=t.getAttribute("width").replace("px",""),a=t.getAttribute("height").replace("px","");t.querySelectorAll('[data-no-export="true"]').forEach((function(e){return e.remove()}));var i='<svg class="nmr-svg"  viewBox=\'0 0 '.concat(n," ").concat(a,"' width=\"").concat(n,'"  height="').concat(a,'"  version="1.1" xmlns="http://www.w3.org/2000/svg">'),o="".concat(i+"<style>.grid line,.grid path{stroke:none;} .peaks-text{fill:#730000} .x path{stroke-width:1px} .x text{\n    font-size: 12px;\n    font-weight: bold;\n  } \n \n  .nmr-svg,.contours{\n    background-color:white;\n    fill:white;\n  }\n  \n\n  \n  </style>"+t.innerHTML,"</svg>");return{blob:new Blob([o],{type:"image/svg+xml"}),width:n,height:a}}},216:function(e,t,n){"use strict";var a={};n.r(a),n.d(a,"id",(function(){return ma})),n.d(a,"name",(function(){return ja})),n.d(a,"apply",(function(){return apply})),n.d(a,"isApplicable",(function(){return isApplicable})),n.d(a,"reduce",(function(){return reduce}));var i={};n.r(i),n.d(i,"id",(function(){return va})),n.d(i,"name",(function(){return Oa})),n.d(i,"apply",(function(){return autoPhaseCorrection_apply})),n.d(i,"isApplicable",(function(){return autoPhaseCorrection_isApplicable})),n.d(i,"reduce",(function(){return autoPhaseCorrection_reduce}));var o={};n.r(o),n.d(o,"id",(function(){return Sa})),n.d(o,"name",(function(){return wa})),n.d(o,"baselineAlgorithms",(function(){return Ta})),n.d(o,"apply",(function(){return baselineCorrection_apply})),n.d(o,"isApplicable",(function(){return baselineCorrection_isApplicable})),n.d(o,"reduce",(function(){return baselineCorrection_reduce}));var r={};n.r(r),n.d(r,"id",(function(){return Ma})),n.d(r,"name",(function(){return Aa})),n.d(r,"apply",(function(){return digitalFilter_apply})),n.d(r,"isApplicable",(function(){return digitalFilter_isApplicable})),n.d(r,"reduce",(function(){return digitalFilter_reduce}));var c={};n.r(c),n.d(c,"id",(function(){return Ea})),n.d(c,"name",(function(){return Pa})),n.d(c,"apply",(function(){return fft_apply})),n.d(c,"isApplicable",(function(){return fft_isApplicable})),n.d(c,"reduce",(function(){return fft_reduce}));var l={};n.r(l),n.d(l,"id",(function(){return Ia})),n.d(l,"name",(function(){return Fa})),n.d(l,"apply",(function(){return lineBroadening_apply})),n.d(l,"isApplicable",(function(){return lineBroadening_isApplicable})),n.d(l,"reduce",(function(){return lineBroadening_reduce}));var s={};n.r(s),n.d(s,"id",(function(){return Ra})),n.d(s,"name",(function(){return _a})),n.d(s,"apply",(function(){return phaseCorrection_apply})),n.d(s,"isApplicable",(function(){return phaseCorrection_isApplicable})),n.d(s,"reduce",(function(){return phaseCorrection_reduce}));var u={};n.r(u),n.d(u,"id",(function(){return Na})),n.d(u,"name",(function(){return La})),n.d(u,"apply",(function(){return shiftX_apply})),n.d(u,"isApplicable",(function(){return shiftX_isApplicable})),n.d(u,"reduce",(function(){return shiftX_reduce}));var d={};n.r(d),n.d(d,"id",(function(){return za})),n.d(d,"name",(function(){return Ha})),n.d(d,"apply",(function(){return zeroFilling_apply})),n.d(d,"isApplicable",(function(){return zeroFilling_isApplicable})),n.d(d,"reduce",(function(){return zeroFilling_reduce}));var b={};n.r(b),n.d(b,"id",(function(){return Ba})),n.d(b,"name",(function(){return Xa})),n.d(b,"apply",(function(){return filter2d_shiftX_apply})),n.d(b,"isApplicable",(function(){return filter2d_shiftX_isApplicable})),n.d(b,"reduce",(function(){return filter2d_shiftX_reduce}));var p={};n.r(p),n.d(p,"id",(function(){return Va})),n.d(p,"name",(function(){return Ya})),n.d(p,"apply",(function(){return shiftY_apply})),n.d(p,"isApplicable",(function(){return shiftY_isApplicable})),n.d(p,"reduce",(function(){return shiftY_reduce}));var f=n(6),h=n(42),g=n(15),m=n(12),j=n(183),v=n.n(j),O=n(1),x=n(505),y=n(743),k=n(744);function checkModifierKeyActivated(e){for(var t=0,n=["Alt","AltGraph","CapsLock","Control","Meta","NumLocK","ScrollLock","Shift","OS"];t<n.length;t++){var a=n[t];if(e.getModifierState(a))return!0}return!1}var C=n(753),D=n(754),S=n(249),w=n.n(S),T=n(202),M=n.n(T),A=n(3),E=Object(O.createContext)(),P={step:"initial",brush:{start:null,end:null}},I=[];function BrushTracker(e){var t=e.children,n=e.className,a=e.style,i=e.onBrush,o=e.onZoom,r=e.onDoubleClick,c=e.onClick,l=e.noPropagation,s=Object(O.useReducer)(reducer,P),u=Object(h.a)(s,2),d=u[0],b=u[1],p=Object(O.useState)(),g=Object(h.a)(p,2),m=g[0],j=g[1],v=Object(O.useCallback)((function(e){return 0===e.button&&(l&&e.stopPropagation(),b({type:"DOWN",shiftKey:e.shiftKey,altKey:e.altKey,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY,boundingRect:e.currentTarget.getBoundingClientRect()}),j(e.timeStamp)),!1}),[l]),x=Object(O.useCallback)((function(e){e.persist();var t=e.timeStamp,n=e.currentTarget.getBoundingClientRect(),a=e.clientX-n.x,i=e.clientY-n.y,o=w()((function(){t-m<=150&&1===I.length&&c(Object(f.a)(Object(f.a)({},e),{},{x:a,y:i})),I=[]}),200);I.push(o),o(),I.length>1&&(M()(I,(function(e){return e.cancel()})),I=[],r(Object(f.a)(Object(f.a)({},e),{},{x:a,y:i})))}),[m,c,r]),y=Object(O.useCallback)((function(e){var t=e.currentTarget.getBoundingClientRect(),n=e.clientX-t.x,a=e.clientY-t.y,i=e.deltaY,r=e.deltaX,c=e.shiftKey,l=e.deltaMode;o({deltaY:i||r,shiftKey:c,deltaMode:l,x:n,y:a})}),[o]);Object(O.useEffect)((function(){var e=d.step,t=d.startX,n=d.endX;"end"===e&&Math.abs(t-n)>5&&(i(d),b({type:"DONE"}))}),[i,d]);var k=Object(O.useCallback)((function(e){b({type:"MOVE",screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY})}),[]),C=Object(O.useCallback)((function(e){return b({type:"UP",clientX:e.clientX,clientY:e.clientY}),!1}),[]);return Object(A.jsx)(E.Provider,{value:d,children:Object(A.jsx)("div",{className:n,style:a,onMouseDown:v,onMouseUp:C,onMouseMove:k,onClick:x,onWheel:y,children:t})})}function reducer(e,t){switch(t.type){case"UP":if("brushing"===e.step||"start"===e.step){var n=t.clientX,a=t.clientY;return Object(f.a)(Object(f.a)({},e),{},{endX:n-e.boundingRect.x,endY:a-e.boundingRect.y,step:"start"===e.step?"initial":"end"})}return e;case"DOWN":if("initial"===e.step||"end"===e.step){var i=t.screenX,o=t.screenY,r=t.clientX,c=t.clientY,l=t.boundingRect,s=t.shiftKey,u=t.altKey,d=r-l.x,b=c-l.y;return Object(f.a)(Object(f.a)({},e),{},{shiftKey:s,altKey:u,startX:d,startY:b,startScreenX:i,startScreenY:o,startClientX:r,startClientY:c,boundingRect:l,step:"start"})}return e;case"MOVE":if("start"===e.step||"brushing"===e.step){var p=t.clientX,h=t.clientY;return Object(f.a)(Object(f.a)({},e),{},{step:"brushing",endX:p-e.boundingRect.x,endY:h-e.boundingRect.y})}return e;case"DONE":if("end"===e.step)return Object(f.a)(Object(f.a)({},e),{},{step:"initial"});break;default:return e}}BrushTracker.defaultProps={onBrush:function onBrush(){return null},onZoom:function onZoom(){return null},onDoubleClick:function onDoubleClick(){return null},onClick:function onClick(){return null}};var F=Object(O.createContext)(),R=F.Provider;function MouseTracker(e){var t=e.children,n=e.className,a=e.style,i=e.noPropagation,o=Object(O.useState)(null),r=Object(h.a)(o,2),c=r[0],l=r[1],s=Object(O.useCallback)((function(e){var t=e.currentTarget.getBoundingClientRect(),n=e.clientX-t.x,a=e.clientY-t.y;l({x:n,y:a}),i&&e.stopPropagation()}),[i]),u=Object(O.useCallback)((function(e){l(null),i&&e.stopPropagation()}),[i]);return Object(A.jsx)(R,{value:c,children:Object(A.jsx)("div",{className:n,style:a,onMouseMove:s,onMouseLeave:u,children:t})})}var _=Object(O.createContext)(),N=_.Provider;function useChartData(){return Object(O.useContext)(_)}var L=Object(O.createContext)(),z=L.Provider;function useDispatch(){return Object(O.useContext)(L)}var H=Object(O.createContext)(),B=H.Provider;function usePreferences(){return Object(O.useContext)(H)}var X=Object(O.createContext)(),V=X.Provider;function useScale(){return Object(O.useContext)(X)}var Y={TOP_LEFT:"top left",TOP_CENTER:"top center",TOP_RIGHT:"top right",MIDDLE_LEFT:"middle left",MIDDLE:"middle",MIDDLE_RIGHT:"middle right",BOTTOM_LEFT:"bottom left",BOTTOM_CENTER:"bottom center",BOTTOM_RIGHT:"bottom right"},Z="info",U="success",K="error",W="fade",G="scale",q=Object(O.createContext)(),J=q.Provider,$=function useModal(){return Object(O.useContext)(q)},Q={outerContainer:{position:"fixed",top:0,right:0,bottom:0,left:0,backgroundColor:"rgba(255,255,255,0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1},innerContainer:{boxSizing:"initial",backgroundColor:"#fff",boxShadow:"0 0 0 0, 0 8px 16px rgba(0,0,0,.30)",display:"flex",flexDirection:"column",minWidth:"300px",minHeight:"140px",justifyContent:"space-between",borderRadius:"5px"}},ee=function Modal(e){var t=e.children,n=e.open,a=e.onClose,i=e.style,o=Object(O.useCallback)((function(e){a(e)}),[a]);return Object(O.useEffect)((function(){!1===n&&o()}),[o,n]),n&&Object(A.jsx)("div",{style:Q.outerContainer,onClick:o,children:Object(A.jsx)("div",{style:Object(f.a)(Object(f.a)({},Q.innerContainer),i),onClick:function onClick(e){e.preventDefault(),e.stopPropagation()},children:t})})};ee.defaultProps={onClose:function onClose(){return null},open:!1};var te,ne,ae=ee,ie=n(91),oe=n(4),re=n(397),ce=n(752),le=n(182),se=n(755),ue=(te={},Object(ie.a)(te,W,{transition:"opacity ".concat(250,"ms ease"),opacity:0}),Object(ie.a)(te,G,{transform:"scale(1)",transition:"all ".concat(250,"ms ease-in-out")}),te),de=(ne={},Object(ie.a)(ne,W,{entering:{opacity:0},entered:{opacity:1}}),Object(ie.a)(ne,G,{entering:{transform:"scale(0)"},entered:{transform:"scale(1)"},exiting:{transform:"scale(0)"},exited:{transform:"scale(1)"}}),ne),be=function Transtion(e){var t=e.children,n=e.type,a=e.transitionStyles,i=Object(le.a)(e,["children","type","transitionStyles"]),o=Object(O.useRef)(null);return Object(A.jsx)(se.a,Object(f.a)(Object(f.a)({nodeRef:o},i),{},{timeout:250,children:function children(e){return Object(A.jsx)("div",{ref:o,style:Object(f.a)(Object(f.a)(Object(f.a)({},ue[n]),a[n][e]),a.default),children:t})}}))};be.defaultProps={transitionStyles:de};var pe=be;var fe,he,ge=function Wrapper_Wrapper(e){var t=e.children,n=e.options.position,a=Object(le.a)(e,["children","options"]),i=Object(O.useMemo)((function(){return function getStyles(e,t){var n=Object(f.a)({position:"fixed",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",pointerEvents:"none",overflow:"visible"},t.containerStyle?{top:"".concat(t.containerStyle.top,"px"),left:"".concat(t.containerStyle.left,"px"),height:"".concat(t.containerStyle.height,"px"),width:"".concat(t.containerStyle.width,"px")}:{width:"100%",height:"100%"});switch(e){case Y.TOP_LEFT:return Object(f.a)(Object(f.a)({},n),{},{justifyContent:"flex-start",alignItems:"flex-start"});case Y.TOP_CENTER:return Object(f.a)(Object(f.a)({},n),{},{justifyContent:"flex-start"});case Y.TOP_RIGHT:return Object(f.a)(Object(f.a)({},n),{},{justifyContent:"flex-start",alignItems:"flex-end"});case Y.MIDDLE_LEFT:return Object(f.a)(Object(f.a)({},n),{},{justifyContent:"center",alignItems:"flex-start"});case Y.MIDDLE:return Object(f.a)(Object(f.a)({},n),{},{justifyContent:"center"});case Y.MIDDLE_RIGHT:return Object(f.a)(Object(f.a)({},n),{},{justifyContent:"center",alignItems:"flex-end"});case Y.BOTTOM_LEFT:return Object(f.a)(Object(f.a)({},n),{},{justifyContent:"flex-end",alignItems:"flex-start"});case Y.BOTTOM_CENTER:return Object(f.a)(Object(f.a)({},n),{},{justifyContent:"flex-end"});case Y.BOTTOM_RIGHT:return Object(f.a)(Object(f.a)({},n),{},{justifyContent:"flex-end",alignItems:"flex-end"});default:return n}}(n,a)}),[n,a]);return t.length>0&&Object(A.jsx)("div",Object(f.a)(Object(f.a)({style:i},a),{},{children:t}))},me=n(5),je=Object(m.b)(fe||(fe=Object(g.a)(["\n  font-size: 16px;\n  text-align: center;\n  color: white;\n  text-align: center;\n  margin: 35px 10px;\n  flex: 1;\n"]))),ve=Object(m.b)(he||(he=Object(g.a)(["\n  display: flex;\n  align-items: flex-end;\n  justify-content: flex-end;\n  padding: 5px;\n  background-color: #ffffff52;\n\n  button:first-of-type {\n    border-radius: 5px 0 0 5px;\n    border-weight: 0 1px 0 0;\n  }\n  button:last-child {\n    border-radius: 0px 5px 5px 0px;\n    border-weight: 0 0 0 1px;\n  }\n  button {\n    border: 1px solid #dcdcdc;\n    background-color: white;\n    display: inline-block;\n    cursor: pointer;\n    color: #666666;\n    font-weight: bold;\n    padding: 6px 24px;\n    text-decoration: none;\n  }\n  button:hover {\n    background: -webkit-gradient(\n      linear,\n      left top,\n      left bottom,\n      color-stop(0.05, #f6f6f6),\n      color-stop(1, #ffffff)\n    );\n    background: -moz-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: -webkit-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: -o-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: -ms-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: linear-gradient(to bottom, #f6f6f6 5%, #ffffff 100%);\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#f6f6f6', endColorstr='#ffffff',GradientType=0);\n    background-color: #f6f6f6;\n  }\n"]))),Oe=function ConfirmationDialog(e){var t=e.onYes,n=e.onNo,a=e.onClose,i=e.message,o=Object(O.useCallback)((function(e){t(e),a()}),[a,t]),r=Object(O.useCallback)((function(e){n(e),a()}),[a,n]);return Object(me.c)("div",{style:{display:"flex",flexDirection:"column",backgroundColor:"#ff3636",flex:1},children:[Object(me.b)("p",{css:je,children:i}),Object(me.c)("div",{css:ve,children:[Object(me.b)("button",{type:"button",onClick:r,children:"No"}),Object(me.b)("button",{type:"button",onClick:o,children:"Yes"})]})]})};Oe.defaultProps={onYes:function onYes(){return null},onNo:function onNo(){return null}};var xe,ye,ke=Oe,Ce=(xe={},Object(ie.a)(xe,W,{entering:{opacity:0},entered:{opacity:1}}),Object(ie.a)(xe,G,{entering:{transform:"scale(0)"},entered:{transform:"scale(1)"},exiting:{transform:"scale(0)"},exited:{transform:"scale(0)"}}),xe);function Provider(e){var t=e.children,n=e.style,a=e.offset,i=e.position,o=e.transition,r=e.wrapperRef,c=Object(O.useRef)(),l=Object(O.useState)(),s=Object(h.a)(l,2),u=s[0],d=s[1];Object(O.useEffect)((function(){c.current=document.createElement("div");var e=c.current;return r&&r.appendChild(e),function(){e&&r&&r.removeChild(e)}}),[r]);var b=function remove(){d(null)},p=Object(O.useMemo)((function(){return r?r.getBoundingClientRect():{top:0,left:0,width:window.innerWidth,height:window.innerHeight}}),[r]),j=Object(O.useCallback)((function(){b()}),[]),v=Object(O.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={component:e,options:Object(f.a)({isBackgroundBlur:!0,enableResizing:!1},t),close:function(){return b()}};return d(n),n.options.onOpen&&n.options.onOpen(),n}),[]),x=Object(O.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={component:Object(me.b)(ke,{message:e}),options:Object(f.a)({isBackgroundBlur:!0},t),close:function(){return b()}};return d(n),n.options.onOpen&&n.options.onOpen(),n}),[]);Object(O.useEffect)((function(){var e=function keyHandler(e){["Escape","Esc"].includes(e.key)&&j()};return document.addEventListener("keydown",e,!1),function(){return document.removeEventListener("keydown",e,!1)}}),[j]);var y=Object(m.b)(ye||(ye=Object(g.a)(["\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    z-index: 0;\n\n    .handle {\n      cursor: move;\n    }\n\n    .rnd-container {\n      box-sizing: initial;\n      background-color: #fff;\n      box-shadow: 0 0 0 0, 0 8px 16px rgba(0, 0, 0, 0.3);\n      borderradius: 5px;\n    }\n  "]))),k=u&&u.options.isBackgroundBlur?{backgroundColor:"rgba(255,255,255,0.8)"}:{pointerEvents:"none"};return Object(me.c)(J,{value:{show:v,close:function close(){j()},modal:u,showConfirmDialog:x},children:[t,c.current&&Object(oe.createPortal)(Object(me.b)(O.Fragment,{children:u?Object(me.b)("div",{css:y,style:Object(f.a)({},k),children:Object(me.b)(ce.a,{appear:!0,options:{position:u.options.position?u.options.position:i},containerStyle:p,component:ge,children:Object(me.b)(pe,{type:u.options.transition?u.options.transition:o,transitionStyles:Object(f.a)(Object(f.a)({},Ce),{},{default:{width:u.options.width?"".concat(u.options.width,"px"):"auto"},height:u.options.height?"".concat(u.options.height,"px"):"auto"}),children:Object(me.b)(re.a,{default:{width:u.options.width?u.options.width:"auto",height:u.options.height?u.options.height:"auto",x:0,y:0},className:"rnd-container",style:Object(f.a)(Object(f.a)({},n),{},{margin:a,pointerEvents:"all",position:"none",userSelect:"none"}),enableResizing:u.options.enableResizing,dragHandleClassName:"handle",enableUserSelectHack:!1,children:u.options&&Object(O.cloneElement)(u.component,Object(f.a)(Object(f.a)({},u.options),{},{onClose:j,style:{cursor:"default"}}))})},u.id)},Y[u.options.transition?u.options.transition:o])}):null}),c.current)]})}Provider.defaultProps={offset:"10px",position:Y.CENTER,transition:G,wrapperRef:null,style:{}};var De,Se,we=Provider,Te=n(62),Me=n.n(Te),Ae=n(89),Ee=n(187),Pe=n(46),Ie=n(289),Fe=n.n(Ie),Re=n(733),_e=n(88),Ne="INITIATE",Le="LOAD_JSON_FILE",ze="LOAD_JCAMP_FILE",He="LOAD_MOL_FILE",Be="LOAD_ZIP_FILE",Xe="LOAD_JDF_FILE",Ve="ADD_PEAK",Ye="ADD_PEAKS",Ze="DELETE_PEAK_NOTATION",Ue="SHIFT_SPECTRUM",Ke="SET_X_DOMAIN",We="SET_Y_DOMAIN",Ge="SET_ORIGINAL_DOMAIN",qe="SET_WIDTH",Je="SET_DIMENSIONS",$e="SET_SELECTED_TOOL",Qe="SET_SELECTED_FILTER",et="CHANGE_SPECTRUM_SETTING",tt="FULL_ZOOM_OUT",nt="CHANGE_VISIBILITY",at="CHANGE_PEAKS_MARKERS_VISIBILITY",it="CHANGE_ACTIVE_SPECTRUM",ot="CHANGE_SPECTRUM_COLOR",rt="ADD_INTEGRAL",ct="DELETE_INTEGRAL",lt="TOGGLE_REAL_IMAGINARY_VISIBILITY",st="SET_ZOOM_FACTOR",ut="ADD_MOLECULE",dt="SET_MOLECULE",bt="DELETE_MOLECULE",pt="SET_CORRELATION",ft="SET_CORRELATIONS",ht="SET_CORRELATIONS_MF",gt="SET_CORRELATIONS_TOLERANCE",mt="DELETE_SPECTRA",jt="CHANGE_SPECTRUM_DISPLAY_VIEW_MODE",vt="RESIZE_INTEGRAL",Ot="BRUSH_END",xt="RESET_X_DOMAIN",yt="CHANGE_INTEGRAL_ZOOM",kt="ENABLE_FILTER",Ct="DELETE_FILTER",Dt="APPLY_ZERO_FILLING_FILTER",St="APPLY_FFT_FILTER",wt="CALCULATE_MANUAL_PHASE_CORRECTION_FILTER",Tt="APPLY_MANUAL_PHASE_CORRECTION_FILTER",Mt="APPLY_AUTO_PHASE_CORRECTION_FILTER",At="APPLY_ABSOLUTE_FILTER",Et="SET_VERTICAL_INDICATOR_X_POSITION",Pt="AUTO_PEAK_PICKING",It="AUTO_RANGES_DETECTION",Ft="AUTO_ZONES_DETECTION",Rt="DELETE_RANGE",_t="SET_SELECTED_OPTIONS_PANEL",Nt="SET_LOADING_FLAG",Lt="RESET_SELECTED_TOOL",zt="SET_SPECTRUMS_VERTICAL_AlIGN",Ht="CHANGE_INTEGRAL_DATA",Bt="SET_ACTIVE_TAB",Xt="CHANGE_INTEGRAL_SUM",Vt="ADD_BASE_LINE_ZONE",Yt="DELETE_BASE_LINE_ZONE",Zt="APPLY_BASE_LINE_CORRECTION_FILTER",Ut="SET_KEY_PREFERENCES",Kt="APPLY_KEY_PREFERENCES",Wt="RESIZE_RANGE",Gt="CHANGE_RANGE_SUM",qt="ADD_RANGE",Jt="SET_2D_LEVEL",$t="ADD_2D_ZONE",Qt="DELETE_2D_ZONE",en="ADD_MISSING_PROJECTION",tn="SET_FILTER_SNAPSHOT",nn="CHANGE_RANGE_RELATIVE",an="CHANGE_RANGE_SIGNAL_VALUE",rn="CHANGE_RANGE_SIGNAL_KIND",cn="SAVE_EDITED_RANGE",ln="UNLINK_RANGE",sn="SET_DIAID_RANGE",un="CHANGE_INTEGRAL_RELATIVE",dn="ANALYZE_SPECTRA",bn="DELETE_ANALYZE_SPECTRA_RANGE",pn="RESIZE_ANALYZE_SPECTRA_RANGE",fn="SET_ANALYZE_SPECTRA_COLUMNS",hn="FILTER_SPECTRA_COLUMN",gn="ALIGN_SPECTRA",mn="CHANGE_ZONE_SIGNAL_VALUE",jn="CHANGE_ZONE_SIGNAL_KIND",vn="UNLINK_ZONE",On="SET_DIAID_ZONE",xn="PREDICT_SPECTRA",yn="SET_SPECTRA_SAME_TOP",kn="RESET_SPECTRA_SCALE",Cn="SET_MOUSE_OVER_DISPLAYER",Dn={MOL:"mol",NMRIUM:"nmrium",JSON:"json",DX:"dx",JDX:"jdx",JDF:"jdf",ZIP:"zip"};function _loadFile(){return(_loadFile=Object(Ae.a)(Me.a.mark((function _callee(e){var t,n;return Me.a.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch(e);case 2:return checkStatus(t=a.sent),a.next=6,t.text();case 6:return n=a.sent,a.abrupt("return",n);case 8:case"end":return a.stop()}}),_callee)})))).apply(this,arguments)}function checkStatus(e){if(!e.ok)throw new Error("HTTP ".concat(e.status," - ").concat(e.statusText));return e}function getFileExtension(e){return e.replace(/^.*\./,"").toLowerCase()}function getFileName(e){return e.substr(0,e.lastIndexOf("."))}function loadFiles(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Promise.all([].map.call(e,(function(e){return new Promise((function(n,a){var i=new FileReader;i.onabort=function(e){return a(e)},i.onerror=function(e){return a(e)},i.onload=function(){if(i.result){var t=i.result,a=getFileName(e.name),o=getFileExtension(e.name);n({binary:t,name:a,extension:o})}},t.asBuffer?i.readAsArrayBuffer(e):i.readAsBinaryString(e)}))})))}function loadFilesFromZip(e){return _loadFilesFromZip.apply(this,arguments)}function _loadFilesFromZip(){return(_loadFilesFromZip=Object(Ae.a)(Me.a.mark((function _callee2(e){var t,n,a,i,o,r,c,l,s=arguments;return Me.a.wrap((function _callee2$(u){for(;;)switch(u.prev=u.next){case 0:t=s.length>1&&void 0!==s[1]?s[1]:{},n=[],a=Object(Pe.a)(e),u.prev=3,a.s();case 5:if((i=a.n()).done){u.next=21;break}return o=i.value,u.prev=7,u.next=10,o.async(t.asBuffer?"uint8array":"text");case 10:r=u.sent,c=getFileName(o.name),l=getFileExtension(o.name),n.push({binary:r,name:c,extension:l}),u.next=19;break;case 16:u.prev=16,u.t0=u.catch(7),console.log(u.t0);case 19:u.next=5;break;case 21:u.next=26;break;case 23:u.prev=23,u.t1=u.catch(3),a.e(u.t1);case 26:return u.prev=26,a.f(),u.finish(26);case 29:return u.abrupt("return",n);case 30:case"end":return u.stop()}}),_callee2,null,[[3,23,26,29],[7,16]])})))).apply(this,arguments)}var Sn=Object(m.b)(De||(De=Object(g.a)(["\n  height: 100%;\n  background-color: #b5b5b599;\n  position: absolute;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-flow: column;\n  z-index: 99999;\n\n  p {\n    color: white;\n    background-color: rgb(104, 104, 104);\n    padding: 1.5%;\n    border-radius: 30px;\n    margin: 0px;\n  }\n\n  svg {\n    stroke-width: 0;\n    font-size: 3rem !important;\n    fill: white;\n  }\n"]))),wn=Object(m.b)(Se||(Se=Object(g.a)(["\n  border: 0.55px #e6e6e6 solid;\n  display: flex;\n  flex: 1;\n  flex-direction: 'column';\n  height: 100%;\n"]))),Tn=Object(O.createRef)();var Mn,An=function DropZone(e){var t=useChartData(),n=t.width,a=t.height,i=useDispatch(),o=Object(O.useCallback)((function(e,t){var n,a=Object(Pe.a)(t);try{var o=function _loop(){var t=n.value,a=e.filter((function(e){return getFileExtension(e.name)===t}));switch(t){case Dn.MOL:loadFilesFromZip(a).then((function(e){return i({type:He,files:e})}));break;case Dn.NMRIUM:case Dn.JSON:loadFilesFromZip(a).then((function(e){1===a.length?i({type:Le,files:e}):(i({type:Nt,isLoading:!1}),alert("You can add only one json file"))}));break;case Dn.JDX:case Dn.DX:loadFilesFromZip(a).then((function(e){return i({type:ze,files:e})}));break;case Dn.JDF:loadFilesFromZip(a,{asBuffer:!0}).then((function(e){return i({type:Xe,files:e})}))}};for(a.s();!(n=a.n()).done;)o()}catch(r){a.e(r)}finally{a.f()}}),[i]),r=Object(O.useCallback)((function(e){var t,n=Object(Ee.a)(new Set(e.map((function(e){return getFileExtension(e.name)})))),a=Object(Pe.a)(n);try{var r=function _loop2(){var n=t.value,a=e.filter((function(e){return getFileExtension(e.name)===n}));switch(n){case Dn.MOL:loadFiles(a).then((function(e){i({type:He,files:e})}),(function(e){alert(e)}));break;case Dn.NMRIUM:case Dn.JSON:1===a.length?loadFiles(a).then((function(e){i({type:Le,files:e})}),(function(e){alert(e)})):alert("You can add only one json file");break;case Dn.JDX:case Dn.DX:loadFiles(a).then((function(e){i({type:ze,files:e})}),(function(e){alert(e)}));break;case Dn.JDF:loadFiles(a,{asBuffer:!0}).then((function(e){i({type:Xe,files:e})}),(function(e){alert(e)}));break;case Dn.ZIP:loadFiles(a).then(function(){var e=Object(Ae.a)(Me.a.mark((function _callee(e){var t,n,a,r,c;return Me.a.wrap((function _callee$(l){for(;;)switch(l.prev=l.next){case 0:t=Object(Pe.a)(e),l.prev=1,t.s();case 3:if((n=t.n()).done){l.next=13;break}return a=n.value,l.next=7,Fe.a.loadAsync(a.binary);case 7:r=l.sent,c=Object(Ee.a)(new Set(Object.values(r.files).map((function(e){return getFileExtension(e.name)})))),c.some((function(e){return Dn[e.toUpperCase()]&&e!==Dn.ZIP}))?o(Object.values(r.files),c):i({type:Be,files:e});case 11:l.next=3;break;case 13:l.next=18;break;case 15:l.prev=15,l.t0=l.catch(1),t.e(l.t0);case 18:return l.prev=18,t.f(),l.finish(18);case 21:case"end":return l.stop()}}),_callee,null,[[1,15,18,21]])})));return function(t){return e.apply(this,arguments)}}(),(function(e){alert(e)}));break;default:alert("The file extension must be zip, dx, jdx, json, mol or nmrium.")}};for(a.s();!(t=a.n()).done;)r()}catch(c){a.e(c)}finally{a.f()}}),[i,o]),c=Object(O.useCallback)((function(e){i({type:Nt,isLoading:!0}),r(e)}),[i,r]);Tn.current=Object(Re.a)({onDrop:c,noClick:!0});var l=Tn.current,s=l.getRootProps,u=l.getInputProps,d=l.isDragActive;return Object(me.c)("div",Object(f.a)(Object(f.a)({},s()),{},{css:wn,children:[Object(me.b)("input",Object(f.a)({},u())),d&&Object(me.c)("div",{css:Sn,style:{width:"".concat(n+41,"px"),height:"".concat(a,"px")},children:[Object(me.b)(_e.I,{}),Object(me.b)("p",{children:"Drop your files here"})]}),e.children]}))},En=Object(m.b)(Mn||(Mn=Object(g.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: rgba(255, 255, 255, 0.25);\n  height: 100%;\n  flex-direction: column;\n  user-select: none;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  outline: 10px dashed rgba(0, 0, 0, 0.3);\n  outline-offset: -10px;\n  padding-left: 20px;\n  padding-right: 20px;\n\n  p {\n    padding: 15px 30px;\n    background-color:rgba(0, 0, 0, 0.5);\n    border-radius: 39px;\n    color: white;\n    font-size: x-large;\n    font-weight: bold;\n\n  }\n}\n"])));var Pn,In=function NoData(e){var t=e.isEmpty,n=void 0===t||t,a=e.message,i=void 0===a?"Drag and drop here a JCAMP-DX, zipped Bruker folder, Jeol jdf or NMRium file":a,o=Object(O.useCallback)((function(){Tn.current.open()}),[]);return n?Object(me.b)("div",{css:En,onClick:o,children:Object(me.b)("p",{children:i})}):null},Fn=Object(m.b)(Pn||(Pn=Object(g.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: rgba(255, 255, 255, 0.25);\n  height: 100%;\n  flex-direction: column;\n  user-select: none;\n  position: absolute;\n  width: 100%;\n\n  svg {\n    animation-duration: 0.5s;\n    animation-name: spinAnimation;\n    animation-iteration-count: infinite;\n    animation-fill-mode: forwards;\n    animation-direction: inherit;\n    animation-timing-function: linear;\n    animation-duration: 1s;\n    width: 100px;\n    height: 100px;\n  }\n\n  @keyframes spinAnimation {\n    from {\n      transform: rotate(0deg);\n    }\n\n    to {\n      transform: rotate(360deg);\n    }\n  }\n"])));function DefaultSpinnerComponent(){return Object(me.c)("div",{css:Fn,children:[Object(me.b)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 841.9 595.3",children:Object(me.c)("g",{fill:"#61DAFB",children:[Object(me.b)("path",{d:"M666.3 296.5c0-32.5-40.7-63.3-103.1-82.4 14.4-63.6 8-114.2-20.2-130.4-6.5-3.8-14.1-5.6-22.4-5.6v22.3c4.6 0 8.3.9 11.4 2.6 13.6 7.8 19.5 37.5 14.9 75.7-1.1 9.4-2.9 19.3-5.1 29.4-19.6-4.8-41-8.5-63.5-10.9-13.5-18.5-27.5-35.3-41.6-50 32.6-30.3 63.2-46.9 84-46.9V78c-27.5 0-63.5 19.6-99.9 53.6-36.4-33.8-72.4-53.2-99.9-53.2v22.3c20.7 0 51.4 16.5 84 46.6-14 14.7-28 31.4-41.3 49.9-22.6 2.4-44 6.1-63.6 11-2.3-10-4-19.7-5.2-29-4.7-38.2 1.1-67.9 14.6-75.8 3-1.8 6.9-2.6 11.5-2.6V78.5c-8.4 0-16 1.8-22.6 5.6-28.1 16.2-34.4 66.7-19.9 130.1-62.2 19.2-102.7 49.9-102.7 82.3 0 32.5 40.7 63.3 103.1 82.4-14.4 63.6-8 114.2 20.2 130.4 6.5 3.8 14.1 5.6 22.5 5.6 27.5 0 63.5-19.6 99.9-53.6 36.4 33.8 72.4 53.2 99.9 53.2 8.4 0 16-1.8 22.6-5.6 28.1-16.2 34.4-66.7 19.9-130.1 62-19.1 102.5-49.9 102.5-82.3zm-130.2-66.7c-3.7 12.9-8.3 26.2-13.5 39.5-4.1-8-8.4-16-13.1-24-4.6-8-9.5-15.8-14.4-23.4 14.2 2.1 27.9 4.7 41 7.9zm-45.8 106.5c-7.8 13.5-15.8 26.3-24.1 38.2-14.9 1.3-30 2-45.2 2-15.1 0-30.2-.7-45-1.9-8.3-11.9-16.4-24.6-24.2-38-7.6-13.1-14.5-26.4-20.8-39.8 6.2-13.4 13.2-26.8 20.7-39.9 7.8-13.5 15.8-26.3 24.1-38.2 14.9-1.3 30-2 45.2-2 15.1 0 30.2.7 45 1.9 8.3 11.9 16.4 24.6 24.2 38 7.6 13.1 14.5 26.4 20.8 39.8-6.3 13.4-13.2 26.8-20.7 39.9zm32.3-13c5.4 13.4 10 26.8 13.8 39.8-13.1 3.2-26.9 5.9-41.2 8 4.9-7.7 9.8-15.6 14.4-23.7 4.6-8 8.9-16.1 13-24.1zM421.2 430c-9.3-9.6-18.6-20.3-27.8-32 9 .4 18.2.7 27.5.7 9.4 0 18.7-.2 27.8-.7-9 11.7-18.3 22.4-27.5 32zm-74.4-58.9c-14.2-2.1-27.9-4.7-41-7.9 3.7-12.9 8.3-26.2 13.5-39.5 4.1 8 8.4 16 13.1 24 4.7 8 9.5 15.8 14.4 23.4zM420.7 163c9.3 9.6 18.6 20.3 27.8 32-9-.4-18.2-.7-27.5-.7-9.4 0-18.7.2-27.8.7 9-11.7 18.3-22.4 27.5-32zm-74 58.9c-4.9 7.7-9.8 15.6-14.4 23.7-4.6 8-8.9 16-13 24-5.4-13.4-10-26.8-13.8-39.8 13.1-3.1 26.9-5.8 41.2-7.9zm-90.5 125.2c-35.4-15.1-58.3-34.9-58.3-50.6 0-15.7 22.9-35.6 58.3-50.6 8.6-3.7 18-7 27.7-10.1 5.7 19.6 13.2 40 22.5 60.9-9.2 20.8-16.6 41.1-22.2 60.6-9.9-3.1-19.3-6.5-28-10.2zM310 490c-13.6-7.8-19.5-37.5-14.9-75.7 1.1-9.4 2.9-19.3 5.1-29.4 19.6 4.8 41 8.5 63.5 10.9 13.5 18.5 27.5 35.3 41.6 50-32.6 30.3-63.2 46.9-84 46.9-4.5-.1-8.3-1-11.3-2.7zm237.2-76.2c4.7 38.2-1.1 67.9-14.6 75.8-3 1.8-6.9 2.6-11.5 2.6-20.7 0-51.4-16.5-84-46.6 14-14.7 28-31.4 41.3-49.9 22.6-2.4 44-6.1 63.6-11 2.3 10.1 4.1 19.8 5.2 29.1zm38.5-66.7c-8.6 3.7-18 7-27.7 10.1-5.7-19.6-13.2-40-22.5-60.9 9.2-20.8 16.6-41.1 22.2-60.6 9.9 3.1 19.3 6.5 28.1 10.2 35.4 15.1 58.3 34.9 58.3 50.6-.1 15.7-23 35.6-58.4 50.6zM320.8 78.4z"}),Object(me.b)("path",{d:"M520.5 78.1z"})]})}),Object(me.b)("p",{children:"Loading ..."})]})}function defaultGetSpinner(){return Object(A.jsx)(DefaultSpinnerComponent,{})}var Rn=Object(O.createContext)(defaultGetSpinner),_n=Rn.Provider;var Nn=function Spinner(e){var t=e.isLoading,n=void 0===t||t,a=e.message,i=void 0===a?void 0:a,o=useChartData().data,r=Object(O.useState)(!1),c=Object(h.a)(r,2),l=c[0],s=c[1];Object(O.useEffect)((function(){var e=null;return n||(e=setTimeout((function(){s(!0)}),500)),function(){clearTimeout(e)}}),[n]);var u=Object(O.useContext)(Rn);return Object(A.jsxs)(O.Fragment,{children:[n&&u(),l&&!n&&Object(A.jsx)(In,{isEmpty:o&&0===o.length,message:i})]})},Ln=n(185),zn=n(394),Hn=n(734),Bn=Object(O.createContext)(),Xn=Bn.Provider;function useGlobal(){return Object(O.useContext)(Bn)}var Vn={position:"fixed",top:0,left:0,pointerEvents:"none",backgroundColor:"gray",padding:"3px",borderRadius:"2px",color:"white",whiteSpace:"nowrap",fontSize:"10px",fontFamily:"tahoma",textShadow:"none"};function ToolTip(e){var t=e.style,n=e.className,a=e.popupPlacement,i=void 0===a?"right":a,o=e.children,r=e.title,c=e.offset,l=void 0===c?{x:0,y:0}:c,s=Object(O.useRef)(),u=Object(O.useRef)(),d=Object(O.useState)({x:0,y:0}),b=Object(h.a)(d,2),p=b[0],g=b[1],m=Object(O.useState)(!1),j=Object(h.a)(m,2),v=j[0],x=j[1],y=useGlobal().elementsWraperRef;Object(O.useLayoutEffect)((function(){if(v){var e=function getPopupPlacement(){var e,t,n=s.current.getBoundingClientRect(),a=u.current.getBoundingClientRect();switch(i){case"left":e=-a.width,t=n.height/2-n.height/2*a.height/n.height;break;case"right":e=n.width,t=n.height/2-n.height/2*a.height/n.height;break;case"top":e=n.width/2-n.width/2*a.width/n.width,t=-n.height;break;case"bottom":e=n.width/2-n.width/2*a.width/n.width,t=n.height;break;default:e=0,t=0}return{x:e+n.x,y:t+n.y}}();g(e)}}),[i,v]);var k=Object(O.useCallback)((function(){x(!0)}),[]),C=Object(O.useCallback)((function(){x(!1)}),[]);return Object(A.jsxs)(O.Fragment,{children:[Object(A.jsx)("div",{style:Object(f.a)({position:"relative",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},t.mainContainer),ref:s,onMouseOver:k,onMouseOut:C,children:o}),v&&Object(oe.createPortal)(Object(A.jsx)("div",{ref:u,style:Object(f.a)(Object(f.a)({},Vn),{},{transform:"translate(".concat(p.x+l.x,"px,").concat(p.y+l.y,"px)"),zIndex:999999999},t.popup),className:n,children:Object(A.jsx)("span",{style:{pointerEvents:"none"},children:r})}),y)]})}ToolTip.defaultProps={style:{popup:{},mainContainer:{}}};var Yn,Zn=Object(O.memo)(ToolTip),Un=Object(m.b)(Yn||(Yn=Object(g.a)(["\n  background-color: transparent;\n  border: none;\n  height: 100%;\n  display:flex,\n  justify-content:center;\n  align-items:center;\n\n  svg {\n    fill: #ca0000;\n    font-size: 16px;\n  }\n"])));function CloseButton(e){var t=e.onClick,n=e.popupTitle,a=e.popupPlacement,i=e.className;return Object(me.b)("div",{className:i,children:Object(me.b)(Zn,{title:n,popupPlacement:a,children:Object(me.b)("button",{css:Un,type:"button",onClick:t,children:Object(me.b)(_e.G,{})})})})}CloseButton.defaultProps={onClick:function onClick(){return null},popupTitle:"Close",popupPlacement:"left",className:""};var Kn,Wn,Gn=Object(O.memo)(CloseButton),qn=Object(m.b)(Kn||(Kn=Object(g.a)(["\n  display: flex;\n  flex-direction: column;\n  width: 900px;\n  height: 400px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    overflow-y: auto;\n    background-color: white;\n    padding-top: 10px;\n\n    .row {\n      outline: none;\n      display: flex !important;\n      flex-direction: row;\n      margin: 0;\n      div {\n        flex: 4;\n      }\n      .multiplicity {\n        flex: 2;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n    }\n\n    .row:nth-child(odd) {\n      background: #fafafa;\n    }\n  }\n"]))),Jn=Object(m.b)(Wn||(Wn=Object(g.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n  user-select: none;\n  width: 900px;\n  height: 400px;\n\n  svg {\n    animation-duration: 0.5s;\n    animation-name: spinAnimation;\n    animation-iteration-count: infinite;\n    animation-fill-mode: forwards;\n    animation-direction: inherit;\n    animation-timing-function: linear;\n    animation-duration: 1s;\n    width: 100px;\n    height: 100px;\n  }\n\n  @keyframes spinAnimation {\n    from {\n      transform: rotate(0deg);\n    }\n\n    to {\n      transform: rotate(360deg);\n    }\n  }\n"])));function MultipletAnalysisModal(e){var t=e.data,n=e.activeSpectrum,a=e.scaleX,i=e.startX,o=e.endX,r=e.onClose,c=Object(O.useState)(),l=Object(h.a)(c,2),s=l[0],u=l[1],d=Object(O.useState)(!1),b=Object(h.a)(d,2),p=b[0],f=b[1],g=Object(O.useState)(!1),m=Object(h.a)(g,2),j=m[0],v=m[1];return Object(O.useEffect)((function(){setTimeout((function(){f(!0)}),400)}),[]),Object(O.useEffect)((function(){if(n&&i&&o&&p){var e=t[n.index],r=e.data,c=r.x,l=r.y,s=e.info,d=a().invert(i),b=a().invert(o),f=Object(Ln.g)(c,{from:d,to:b}),h=f.fromIndex,g=f.toIndex,m={x:c.slice(h,g),y:l.slice(h,g)};try{var j=Object(zn.a)(m,{frequency:s.originFrequency,takeBestPartMultiplet:!0,symmetrizeEachStep:!0,debug:!0});v(!0),u(j)}catch(O){console.log(O)}}}),[i,o,t,a,n,p]),j?Object(me.c)("div",{css:qn,children:[Object(me.c)("div",{className:"header handle",children:[Object(me.b)("span",{children:"Analyse Multiplet"}),Object(me.b)(Gn,{onClick:r})]}),Object(me.b)("div",{className:"container",children:s&&s.debug&&s.debug.steps.map((function(e,t){var n,a;return Object(me.c)("div",{className:"row",children:[Object(me.b)(Hn.a,{chart:{series:{type:"line",data:e.multiplet}},style:{height:200,width:400,overflow:"auto"}}),Object(me.b)("div",{className:"multiplicity",children:Object(me.b)("p",{children:s.j[t]?"".concat(null===(n=s.j[t])||void 0===n?void 0:n.multiplicity,": ").concat(null===(a=s.j[t])||void 0===a?void 0:a.coupling.toFixed(3)," Hz"):""})}),Object(me.b)(Hn.a,{chart:{series:{type:"line",data:e.errorFunction}},style:{height:200,width:400,overflow:"auto"}})]},t)}))})]}):Object(me.c)("div",{css:Jn,children:[Object(me.b)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 841.9 595.3",children:Object(me.c)("g",{fill:"#61DAFB",children:[Object(me.b)("path",{d:"M666.3 296.5c0-32.5-40.7-63.3-103.1-82.4 14.4-63.6 8-114.2-20.2-130.4-6.5-3.8-14.1-5.6-22.4-5.6v22.3c4.6 0 8.3.9 11.4 2.6 13.6 7.8 19.5 37.5 14.9 75.7-1.1 9.4-2.9 19.3-5.1 29.4-19.6-4.8-41-8.5-63.5-10.9-13.5-18.5-27.5-35.3-41.6-50 32.6-30.3 63.2-46.9 84-46.9V78c-27.5 0-63.5 19.6-99.9 53.6-36.4-33.8-72.4-53.2-99.9-53.2v22.3c20.7 0 51.4 16.5 84 46.6-14 14.7-28 31.4-41.3 49.9-22.6 2.4-44 6.1-63.6 11-2.3-10-4-19.7-5.2-29-4.7-38.2 1.1-67.9 14.6-75.8 3-1.8 6.9-2.6 11.5-2.6V78.5c-8.4 0-16 1.8-22.6 5.6-28.1 16.2-34.4 66.7-19.9 130.1-62.2 19.2-102.7 49.9-102.7 82.3 0 32.5 40.7 63.3 103.1 82.4-14.4 63.6-8 114.2 20.2 130.4 6.5 3.8 14.1 5.6 22.5 5.6 27.5 0 63.5-19.6 99.9-53.6 36.4 33.8 72.4 53.2 99.9 53.2 8.4 0 16-1.8 22.6-5.6 28.1-16.2 34.4-66.7 19.9-130.1 62-19.1 102.5-49.9 102.5-82.3zm-130.2-66.7c-3.7 12.9-8.3 26.2-13.5 39.5-4.1-8-8.4-16-13.1-24-4.6-8-9.5-15.8-14.4-23.4 14.2 2.1 27.9 4.7 41 7.9zm-45.8 106.5c-7.8 13.5-15.8 26.3-24.1 38.2-14.9 1.3-30 2-45.2 2-15.1 0-30.2-.7-45-1.9-8.3-11.9-16.4-24.6-24.2-38-7.6-13.1-14.5-26.4-20.8-39.8 6.2-13.4 13.2-26.8 20.7-39.9 7.8-13.5 15.8-26.3 24.1-38.2 14.9-1.3 30-2 45.2-2 15.1 0 30.2.7 45 1.9 8.3 11.9 16.4 24.6 24.2 38 7.6 13.1 14.5 26.4 20.8 39.8-6.3 13.4-13.2 26.8-20.7 39.9zm32.3-13c5.4 13.4 10 26.8 13.8 39.8-13.1 3.2-26.9 5.9-41.2 8 4.9-7.7 9.8-15.6 14.4-23.7 4.6-8 8.9-16.1 13-24.1zM421.2 430c-9.3-9.6-18.6-20.3-27.8-32 9 .4 18.2.7 27.5.7 9.4 0 18.7-.2 27.8-.7-9 11.7-18.3 22.4-27.5 32zm-74.4-58.9c-14.2-2.1-27.9-4.7-41-7.9 3.7-12.9 8.3-26.2 13.5-39.5 4.1 8 8.4 16 13.1 24 4.7 8 9.5 15.8 14.4 23.4zM420.7 163c9.3 9.6 18.6 20.3 27.8 32-9-.4-18.2-.7-27.5-.7-9.4 0-18.7.2-27.8.7 9-11.7 18.3-22.4 27.5-32zm-74 58.9c-4.9 7.7-9.8 15.6-14.4 23.7-4.6 8-8.9 16-13 24-5.4-13.4-10-26.8-13.8-39.8 13.1-3.1 26.9-5.8 41.2-7.9zm-90.5 125.2c-35.4-15.1-58.3-34.9-58.3-50.6 0-15.7 22.9-35.6 58.3-50.6 8.6-3.7 18-7 27.7-10.1 5.7 19.6 13.2 40 22.5 60.9-9.2 20.8-16.6 41.1-22.2 60.6-9.9-3.1-19.3-6.5-28-10.2zM310 490c-13.6-7.8-19.5-37.5-14.9-75.7 1.1-9.4 2.9-19.3 5.1-29.4 19.6 4.8 41 8.5 63.5 10.9 13.5 18.5 27.5 35.3 41.6 50-32.6 30.3-63.2 46.9-84 46.9-4.5-.1-8.3-1-11.3-2.7zm237.2-76.2c4.7 38.2-1.1 67.9-14.6 75.8-3 1.8-6.9 2.6-11.5 2.6-20.7 0-51.4-16.5-84-46.6 14-14.7 28-31.4 41.3-49.9 22.6-2.4 44-6.1 63.6-11 2.3 10.1 4.1 19.8 5.2 29.1zm38.5-66.7c-8.6 3.7-18 7-27.7 10.1-5.7-19.6-13.2-40-22.5-60.9 9.2-20.8 16.6-41.1 22.2-60.6 9.9 3.1 19.3 6.5 28.1 10.2 35.4 15.1 58.3 34.9 58.3 50.6-.1 15.7-23 35.6-58.4 50.6zM320.8 78.4z"}),Object(me.b)("path",{d:"M520.5 78.1z"})]})}),Object(me.b)("p",{children:"Analyse Multiplet in progress. Please wait ..."})]})}MultipletAnalysisModal.defaultProps={onClose:function onClose(){return null}};var $n=MultipletAnalysisModal,Qn=n(198),ea=n(86),ta=n(87),na={controllers:{mws:{low:2,high:20}},formatting:{nucleus:[{key:"1H",name:"1H",value:"0.00"},{key:"13C",name:"13C",value:"0.00"},{key:"15N",name:"15N",value:"0.00"},{key:"19F",name:"19F",value:"0.00"},{key:"29Si",name:"29Si",value:"0.00"},{key:"31P",name:"31P",value:"0.00"}]}},aa=n(235),ia=n.n(aa);function useStateWithLocalStorage(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Object(O.useState)(localStorage.getItem(e)||"{}"),a=Object(h.a)(n,2),i=a[0],o=a[1];Object(O.useEffect)((function(){localStorage.setItem(e,i)}),[e,i]);var r=Object(O.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=JSON.parse(i);t?ia()(n,t,e):n=Object(f.a)(Object(f.a)({},n),e),o(JSON.stringify(n))}),[i]);return[t?v()(JSON.parse(i),t,{}):JSON.parse(i),r]}var oa=function getLocalStorage(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=localStorage.getItem(e);return n&&t?JSON.parse(n):n},ra=function getValue(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return v()(e,t,n)},ca={lowStep:na.controllers.mws.low,highStep:na.controllers.mws.high,speedThreshold:3},la=function(){function Spectrum1DZoomHelper(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(ea.a)(this,Spectrum1DZoomHelper),this.scale=e,this.speedThreshold=t.speedThreshold||ca.speedThreshold,this.slowZoomStep=t.slowZoomStep||ca.lowStep,this.fastZoomStep=t.fastZoomStep||ca.highStep}return Object(ta.a)(Spectrum1DZoomHelper,[{key:"wheel",value:function wheel(e,t){var n=1===Math.abs(e).toString().length?Math.abs(e):Math.abs(e)/100,a=oa("nmr-general-settings"),i=ra(a,"general.controllers.mws.low"),o=ra(a,"general.controllers.mws.high"),r=i?.01*i:.01*this.slowZoomStep,c=o?.05*o:.05*this.fastZoomStep,l=n<=this.speedThreshold?r:c,s=-1===Math.sign(e)?this.scale+l:this.scale-l;this.scale=s>=0||0===s?s:0}},{key:"getScale",value:function getScale(){return this.scale}},{key:"setScale",value:function setScale(e){this.scale=e}}]),Spectrum1DZoomHelper}(),sa={},ua=new la(.5),da="HORIZONTAL",ba="VERTICAL",pa="STEP_HROZENTAL";function initZoom1DHandler(e){e.forEach((function(e){sa[e.id]||1!==e.info.dimension||(sa[e.id]=new la)}))}function Zoom_wheel(e,t,n){var a=n.data,i=n.activeSpectrum,o=n.activeTab,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;i||r?sa[r||i.id].wheel(e,t):a.forEach((function(n){1===n.info.dimension&&o===n.info.nucleus&&sa[n.id].wheel(e,t)}))}function getScaleByID(e){return Object(ie.a)({},e,sa[e].getScale(e))}function getScale(e){var t=e.data,n=e.activeTab;return t.reduce((function(e,t){return 1===t.info.dimension&&n===t.info.nucleus&&(e[t.id]=sa[t.id].getScale()),e}),{})}function setScale(e){if("number"===typeof e)Object.keys(sa).forEach((function(t){sa[t].setScale(e)}));else{if("object"!==typeof e)throw Error("scale must be number or Object");Object.keys(e).forEach((function(t){sa[t].setScale(e[t])}))}}function setZoom(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=e.height,i=e.margin,o=e.activeSpectrum;t&&setScale(t);var r=getScale(e);if(e.zoomFactor={scale:r},null===o&&null===n)e.yDomains=Object.keys(e.yDomains).reduce((function(t,n){var o=Object(Qn.f)(e.originDomain.yDomains[n],[a-i.bottom,i.top]),c=Object(h.a)(e.originDomain.yDomains[n],2),l=c[0],s=c[1],u=Math.max(Math.abs(s),Math.abs(l))===s?0:l,d=Qn.h.translate(0,(Math.sign(u),o(u))).scale(r[n]).translate(0,-o(0)).rescaleY(o).domain();return t[n]=d,t}),{});else{var c=n||o.id,l=Object(Qn.f)(e.originDomain.yDomains[c],[a-i.bottom,i.top]),s=Qn.h.translate(0,l(0)).scale(r[c]).translate(0,-l(0)),u=s.rescaleY(l).domain();e.yDomains=Object(f.a)(Object(f.a)({},e.yDomains),{},Object(ie.a)({},c,u))}}function setZoom1D(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=e.originDomain,r=e.tabActiveSpectrum,c=e.activeTab,l=r[c.split(",")[a]].id;i&&setScale(i);var s=getScaleByID(l);e.zoomFactor={scale:s};var u=Object(Qn.f)(o.yDomains[l],[t-n,n]),d=Qn.h.translate(0,u(0)).scale(s[l]).translate(0,-u(0)),b=d.rescaleY(u).domain();e.yDomains[l]=b}function setIntegralZoom(e,t){if(t.activeSpectrum){var n=t.height,a=t.margin;if(t.originIntegralYDomain[t.activeSpectrum.id]){var i=Object(Qn.f)(t.originIntegralYDomain[t.activeSpectrum.id],[n-a.bottom,a.top]),o=e<.1?.05:e,r=Qn.h.translate(0,i(0)).scale(o).translate(0,-i(0)).rescaleY(i).domain();t.integralZoomFactor={scale:e};var c=t.activeSpectrum;t.integralsYDomains[c.id]=r}}}var fa=n(196);function getXScale(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=e.width,a=e.margin,i=e.xDomains,o=e.xDomain,r=e.mode,c="RTL"===r?[n-a.right,a.left]:[a.left,n-a.right];return Object(Qn.f)(t?i[t]:o,c)}function getYScale(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=e.height,a=e.margin,i=e.verticalAlign,o=e.yDomain,r=e.yDomains,c=i.flag&&!i.stacked?(n-30)/2:n-a.bottom-30,l=[];return l=null===t||void 0===r[t]?[0,o[1]]:[0,r[t][1]],Object(Qn.f)(l,[c,a.top])}var ha="SET_SCALE",ga={scaleX:null,scaleY:null};function scaleReducer(e,t){switch(t.type){case"SET_X_SCALE":return Object(fa.b)(e,(function(e){e.scaleX=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return getXScale(t,e)}}));case"SET_Y_SCALE":return Object(fa.b)(e,(function(e){e.scaleY=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return getYScale(t,e)}}));case ha:return Object(fa.b)(e,(function(e){e.scaleX=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return getXScale(t.payload,e)},e.scaleY=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return getYScale(t.payload,e)}}));default:return e}}var ma="absolute",ja="Absolute";function apply(e){if(!isApplicable(e))throw new Error("absolute not applicable on this data");e.data.re=Object(Ln.a)(e.data),e.data.im=new Float64Array(0),e.info=Object(f.a)(Object(f.a)({},e.info),{},{isComplex:!1})}function isApplicable(e){return!(!e.info.isComplex||e.info.isFid)}function reduce(){return{once:!1,reduce:null}}var va="autoPhaseCorrection",Oa="Automatic phase correction",xa={magnitudeMode:!1,minRegSize:30,maxDistanceToJoin:256};function autoPhaseCorrection_apply(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!autoPhaseCorrection_isApplicable(e))throw new Error("phaseCorrection not applicable on this data");return t=Object.assign({},xa,t),Object(Ln.b)(e.data,t)}function autoPhaseCorrection_isApplicable(e){return!(!e.info.isComplex||e.info.isFid)}function autoPhaseCorrection_reduce(e,t){var n=Object.assign({},e);for(var a in n)n[a]+=t[a];return{once:!0,reduce:n}}var ya=n(736),ka=n(732),Ca=n(573),Da=n(395),Sa="baselineCorrection",wa="Baseline correction",Ta={airpls:"airPLS",polynomial:"Polynomial"};function baselineCorrection_apply(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!baselineCorrection_isApplicable(e))throw new Error("baselineCorrection not applicable on this data");var n,a=t.algorithm,i=t.zones,o=e.data,r=o.x,c=o.re;switch(a){case"airpls":n=Object(ya.a)(r,c,t).corrected;break;case"polynomial":var l=Object(ka.a)({x:r,y:c},{numberOfPoints:4096,zones:i});if(0===i.length){var s=Object(Ca.a)(l.x,l.y,t),u=s.regression;n=new Float64Array(r.length);for(var d=0;d<c.length;d++)n[d]=c[d]-u.predict(r[d])}else{var b=new Da.a(r,c,t.degree);n=new Float64Array(r.length);for(var p=0;p<c.length;p++)n[p]=c[p]-b.predict(r[p])}break;default:throw new Error("baselineCorrection: algorithm unknown: ".concat(a))}Object.assign(e.data,{re:n})}function baselineCorrection_isApplicable(e){return!e.info.isFid}function baselineCorrection_reduce(){return{once:!1,reduce:null}}var Ma="digitalFilter",Aa="Digital Filter";function digitalFilter_apply(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!digitalFilter_isApplicable(e))throw new Error("Digital Filter is not applicable on this data");var n=t.digitalFilterValue,a=void 0===n?0:n,i=new Float64Array(e.data.re),o=new Float64Array(e.data.im),r=Math.floor(a),c=0;r+=0;var l=new Float64Array(i.length),s=new Float64Array(o.length);l.set(i.slice(r)),l.set(i.slice(c,r),i.length-r),s.set(o.slice(r)),s.set(o.slice(c,r),o.length-r),e.data.re=l,e.data.im=s}function digitalFilter_isApplicable(e){return!(!e.info.isComplex||!e.info.isFid)}function digitalFilter_reduce(){return{once:!0,reduce:void 0}}var Ea="fft",Pa="FFT";function fft_apply(e){if(!fft_isApplicable(e))throw new Error("fft not applicable on this data");var t=e.filters.some((function(e){return"digitalFilter"===e.name&&e.flag}));if(Object.assign(e.data,Object(Ln.c)(e.data,{applyZeroShift:!0})),t){var n=e.info.digitalFilter,a=(n-Math.floor(n))*Math.PI*2;Object.assign(e.data,Object(Ln.d)(e.data,0,a))}e.data.x=function generateXAxis(e){for(var t=e.info,n=parseFloat(t.baseFrequency),a=parseFloat(t.frequencyOffset),i=parseFloat(t.spectralWidth),o=a/n,r=.5*i,c=e.data.x.length,l=o-r,s=i/(c-1),u=new Array(c),d=0;d<c;d++)u[d]=l,l+=s;return u}(e),e.info=Object(f.a)(Object(f.a)({},e.info),{},{isFid:!1})}function fft_isApplicable(e){return!(!e.info.isComplex||!e.info.isFid)}function fft_reduce(){return{once:!0,reduce:void 0}}var Ia="lineBroadening",Fa="Line broadening";function lineBroadening_apply(e,t){if(!lineBroadening_isApplicable(e))throw new Error("lineBroadening not applicable on this data");var n,a=e.info.digitalFilter;n=a>0?Math.floor(a):0;for(var i=e.data.re,o=e.data.im,r=e.data.x,c=i.length,l=new Float64Array(c),s=new Float64Array(c),u=(r[c-1]-r[0])/(c-1),d=-t*Math.exp(1),b=Math.exp(d*u),p=Math.exp(d*r[0]),h=0;h<c-n;h++)l[h]=i[h]*p,s[h]=o[h]*p,p*=b;p=Math.exp(d*r[0]);for(var g=c;g>c-n;g--)l[g]=i[g]*p,s[g]=o[g]*p,p*=b;e.data=Object(f.a)(Object(f.a)({},e.data),{re:l,im:s})}function lineBroadening_isApplicable(e){return!(!e.info.isComplex||!e.info.isFid)}function lineBroadening_reduce(e,t){return{once:!0,reduce:e+t}}var Ra="phaseCorrection",_a="Phase correction";function phaseCorrection_apply(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!phaseCorrection_isApplicable(e))throw new Error("phaseCorrection not applicable on this data");var n=t.ph0,a=t.ph1;n*=Math.PI/180,a*=Math.PI/180,Object.assign(e.data,Object(Ln.d)(e.data,n,a))}function phaseCorrection_isApplicable(e){return!(!e.info.isComplex||e.info.isFid)}function phaseCorrection_reduce(e,t){var n=Object.assign({},e);for(var a in n)n[a]+=t[a];return{once:!0,reduce:n}}var Na="shiftX",La="Shift X";function shiftX_apply(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.data.x=e.data.x.map((function(e){return e+t}))}function shiftX_isApplicable(){return!0}function shiftX_reduce(e,t){return{once:!0,reduce:e+t}}var za="zeroFilling",Ha="Zero Filling";function zeroFilling_apply(e,t){if(!zeroFilling_isApplicable(e))throw new Error("zeroFilling not applicable on this data");var n,a=e.filters.some((function(e){return"digitalFilter"===e.name&&e.flag})),i=e.info.digitalFilter;n=i>0&&a?Math.floor(i):0;var o=e.data,r=o.re,c=o.im,l=o.x,s=new Float64Array(t),u=new Float64Array(t),d=new Float64Array(t),b=Math.min(t,r.length);s.set(r.slice(0,b-n)),u.set(c.slice(0,b-n)),d.set(l.slice(0,b-n));for(var p=l[1]-l[0],h=l[b-n-1],g=b-n;g<t;g++)h+=p,d[g]=h;n>0&&n<t&&(s.set(r.slice(r.length-n),t-n),u.set(c.slice(r.length-n),t-n)),e.data=Object(f.a)(Object(f.a)({},e.data),{re:s,im:u,x:d})}function zeroFilling_isApplicable(e){return!(!e.info.isComplex||!e.info.isFid)}function zeroFilling_reduce(e,t){return{once:!0,reduce:t}}var Ba="shift2DX",Xa="Shift 2D X";function filter2d_shiftX_apply(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.data.minX+=t,e.data.maxX+=t}function filter2d_shiftX_isApplicable(){return!0}function filter2d_shiftX_reduce(e,t){return{once:!0,reduce:e+t}}var Va="shift2DY",Ya="Shift 2D Y";function shiftY_apply(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.data.minY+=t,e.data.maxY+=t}function shiftY_isApplicable(){return!0}function shiftY_reduce(e,t){return{once:!0,reduce:e+t}}var Za={absolute:a,baselineCorrection:o,lineBroadening:l,fft:c,phaseCorrection:s,autoPhaseCorrection:i,shiftX:u,zeroFilling:d,digitalFilter:r,shift2DX:b,shift2DY:p},Ua={zoom:{id:"zoom",label:"Zoom",hasOptionPanel:!1,isFilter:!1},peakPicking:{id:"peakPicking",label:"Peaks Picking",hasOptionPanel:!0,isFilter:!1},integral:{id:"integral",label:"integral Tool",hasOptionPanel:!1,isFilter:!1},zone2D:{id:"zone2D",label:"Zone Tool",hasOptionPanel:!0,isFilter:!1},slicingTool:{id:"slicingTool",label:"Slicing Tool",hasOptionPanel:!1,isFilter:!1},HMove:{id:"HMove",label:"Move spectrum horizontally",hasOptionPanel:!1,isFilter:!1},equalizerTool:{id:"equalizerTool",label:"Equalizer Tool",hasOptionPanel:!1,isFilter:!1},rangesPicking:{id:"rangesPicking",label:"Ranges Picking ( Press r )",hasOptionPanel:!0,isFilter:!1},zeroFilling:{id:Za.zeroFilling.id,label:Za.zeroFilling.name,hasOptionPanel:!0,isFilter:!0},phaseCorrection:{id:Za.phaseCorrection.id,label:"".concat(Za.phaseCorrection.name," ( Press a )"),hasOptionPanel:!0,isFilter:!0},baseLineCorrection:{id:"baseLineCorrection",label:"baseline correction ( Press b )",hasOptionPanel:!0,isFilter:!0},generalSelector:{id:"generalSelector",label:"range general selecttor",hasOptionPanel:!1,isFilter:!1},editRange:{id:"editRange",label:"edit range",hasOptionPanel:!1,isFilter:!1},multipleSpectraAnalysis:{id:"multipleSpectraAnalysis",label:"Multiple Spectra Analysis",hasOptionPanel:!1,isFilter:!1}},Ka={transformOrigin:"top left",position:"absolute",top:"0px",left:"0px",zoom:"100%"},Wa=[Ua.zoom.id,Ua.zeroFilling.id,Ua.peakPicking.id,Ua.integral.id,Ua.phaseCorrection.id,Ua.baseLineCorrection.id,Ua.rangesPicking.id,Ua.zone2D.id,Ua.slicingTool.id,Ua.editRange.id,Ua.multipleSpectraAnalysis.id],Ga=1,qa=2,Ja=3;function BrushXY(e){var t=e.brushType,n=e.dimensionBorder,a=e.width,i=e.height,o=useChartData(),r=o.width,c=o.height,l=o.selectedTool,s=Object(O.useContext)(E),u=s.startX,d=s.endX,b=s.startY,p=s.endY,h=s.step;if(!Wa.includes(l)||"brushing"!==h||!n||n.startX&&u<n.startX||n.startY&&b<n.startY||(n.endX&&1===Math.sign(d-u)?d>n.endX:d<n.startX)&&(n.endX&&1===Math.sign(p-b)?p>n.endY:p<n.startY))return null;r=a||r,c=i||c,d=n.endX&&d>n.endX?n.endX:n.startX&&d<n.startX?n.startX:d,p=n.endY&&p>n.endY?n.endY:n.startY&&p<n.startY?n.startY:p;var g=t===Ga||t===Ja?(d-u)/r:1;u=t===Ga||t===Ja?u:0;var m=t===qa||t===Ja?(p-b)/c:1;return b=t===qa||t===Ja?b:0,Object(A.jsx)("div",{style:Object(f.a)(Object(f.a)({},Ka),{},{transform:"translate(".concat(u,"px, ").concat(b,"px) scale(").concat(g,",").concat(m,")"),willChange:"transform"}),children:Object(A.jsx)("svg",{width:r,height:c,children:Object(A.jsx)("rect",{x:"0",y:"0",width:r,height:c,fill:"gray",opacity:"0.2"})})})}BrushXY.defaultProps={brushType:Ja,dimensionBorder:{startX:0,startY:0},width:null,height:null};var $a=BrushXY,Qa={line:{stroke:"black",strokeOpacity:"1",shapeRendering:"crispEdges",strokeWidth:"1",willChange:"transform"}},ei=[Ua.zoom.id,Ua.equalizerTool.id,Ua.baseLineCorrection.id,Ua.zone2D.id,Ua.slicingTool.id,Ua.integral.id,Ua.rangesPicking.id,Ua.editRange.id,Ua.multipleSpectraAnalysis.id];var ti=function CrossLinePointer(){var e=useChartData(),t=e.height,n=e.width,a=e.margin,i=e.selectedTool,o=Object(O.useContext)(F),r=Object(O.useContext)(E);return!ei.includes(i)||"brushing"===r.step||!o||o.x>n-a.right||o.y>t-a.bottom||!n||!t?null:Object(A.jsx)("div",{style:{willChange:"transform",cursor:"crosshair",transform:"translate(".concat(-n+o.x,"px, ").concat(-t+o.y,"px)"),position:"absolute",top:0,left:0,pointerEvents:"none",overflow:"visible",width:2*n,height:2*t},children:Object(A.jsxs)("svg",{width:2*n,height:2*t,children:[Object(A.jsx)("line",{style:Qa.line,x1:n,y1:"0",x2:n,y2:2*t},"vertical_line"),Object(A.jsx)("line",{style:Qa.line,x1:"0",y1:t,x2:2*n,y2:t},"horizontal_line")]})},"crossLine")},ni=n(574),ai=new(n.n(ni).a),ii={on:function on(e,t){return ai.on(e,t)},once:function once(e,t){return ai.once(e,t)},off:function off(e,t){return ai.off(e,t)},emit:function emit(e,t){return ai.emit(e,t)}};Object.freeze(ii);var oi=ii;function DeleteButton(e){var t=e.x,n=e.y,a=e.onDelete,i=e.fill;return Object(A.jsxs)("svg",{className:"delete-button",x:t,y:n,onClick:a,"data-no-export":"true",children:[Object(A.jsx)("rect",{rx:"5",width:"16",height:"16",fill:i}),Object(A.jsx)("line",{x1:"5",x2:"10",y1:"8",y2:"8",stroke:"white",strokeWidth:"2"})]})}DeleteButton.defaultProps={onDelete:function onDelete(){return null},fill:"#c81121",x:"initial",y:"initial"};var ri,ci=DeleteButton,li=Object(m.b)(ri||(ri=Object(g.a)(["\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  .zone-area {\n    height: 100%;\n    fill: #b8b8b857;\n    cursor: pointer;\n  }\n  .delete-button {\n    display: none;\n    cursor: pointer;\n  }\n  :hover .delete-button {\n    display: block;\n  }\n"])));var si=function BaseLineZones(){var e=useChartData().baseLineZones,t=useScale().scaleX,n=useDispatch(),a=Object(O.useCallback)((function(e){n({type:Yt,id:e})}),[n]);return e&&Array.isArray(e)&&e.length>0&&Object(me.b)("g",{children:e.map((function(e){return Object(me.c)("g",{transform:"translate(".concat(t()(e.to),",0)"),css:li,children:[Object(me.b)(ci,{x:-20,y:10,onDelete:function onDelete(){return a(e.id)}}),Object(me.b)("rect",{x:"0",width:"".concat(t()(e.from)-t()(e.to)),className:"zone-area"})]},e.id)}))})},ui={showAbsolute:!1,absoluteFormat:"0.00",showRelative:!0,relativeFormat:"0.00",color:"#000000",strokeWidth:1},di={showFrom:!1,fromFormat:"0.00",showTo:!1,toFormat:"0.00",showAbsolute:!1,absoluteFormat:"0.00",showRelative:!0,relativeFormat:"0.00"},bi={showPeakNumber:!0,peakNumberFormat:"0",showPeakIndex:!1,peakIndexFormat:"0.00",showDeltaPPM:!0,deltaPPMFormat:"0.00",showDeltaHz:!1,deltaHzFormat:"0.00",showPeakWidth:!1,peakWidthFormat:"00.0000",showIntensity:!0,intensityFormat:"0.00"},pi=n(188),fi=n(343),hi=n.n(fi);var gi,mi,ji=function Resizable(e){var t=e.from,n=e.to,a=e.onDrag,i=e.onDrop,o=useChartData(),r=o.height,c=o.margin,l=o.mode,s=Object(O.useState)(!1),u=Object(h.a)(s,2),d=u[0],b=u[1],p=Object(O.useState)(!1),f=Object(h.a)(p,2),g=f[0],m=f[1],j=Object(O.useState)(!0),v=Object(h.a)(j,2),x=v[0],y=v[1],k=Object(O.useRef)(null),C=Object(O.useRef)(null),D=useScale().scaleX,S=Object(O.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),b(!0),a&&a()}),[a]),w=Object(O.useCallback)((function(){}),[]),T=Object(O.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),b(!1);var a="RTL"===l?[D().invert(e.layerX),n]:[n,D().invert(e.layerX)];i(a[1]>a[0]?{from:a[0],to:a[1]}:{from:t,to:n})}),[t,l,i,D,n]),M=Object(O.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),m(!0),a&&a()}),[a]),A=Object(O.useCallback)((function(){}),[]),E=Object(O.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),m(!1);var a="RTL"===l?[t,D().invert(e.layerX)]:[D().invert(e.layerX),t];i(a[1]>a[0]?{from:a[0],to:a[1]}:{from:t,to:n})}),[t,l,i,D,n]),P=Object(O.useCallback)((function(e){e.shiftKey&&y(!1)}),[]),I=Object(O.useCallback)((function(){y(!0)}),[]),F=Object(O.useCallback)((function(e){var t=e.target,n=e.shiftKey;t.style.cursor=n?"crosshair":"ew-resize"}),[]);return Object(me.c)(O.Fragment,{children:[Object(me.b)(hi.a,{axis:"x",defaultPosition:{x:D()(t),y:0},position:{x:D()(t),y:0},scale:1,handle:".handle",onStart:S,onDrag:w,onStop:T,nodeRef:k,children:Object(me.b)("rect",{ref:k,className:x?"handle":"",width:d?1:6,fill:"red",height:r+c.top,style:{fillOpacity:d?1:0},onMouseDownCapture:P,onMouseUpCapture:I,onMouseEnter:F})}),Object(me.b)(hi.a,{axis:"x",defaultPosition:{x:D()(n),y:0},position:{x:D()(n),y:0},handle:".handle",scale:1,onStart:M,onDrag:A,onStop:E,nodeRef:C,children:Object(me.b)("rect",{ref:C,className:x?"handle":"",width:g?1:6,fill:"red",height:r+c.top,style:{fillOpacity:g?1:0},onMouseDownCapture:P,onMouseUpCapture:I,onMouseEnter:F})})]})},vi=Object(m.b)(gi||(gi=Object(g.a)(["\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  // // disabled because Resizable component appears now when hovering over it\n  // :hover .target {\n  //   visibility: visible !important;\n  //   cursor: pointer;\n  // }\n  .highlight {\n    fill: transparent;\n  }\n  .target {\n    visibility: hidden;\n  }\n"]))),Oi=Object(m.b)(mi||(mi=Object(g.a)(["\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  fill: #ff6f0057;\n\n  .target {\n    visibility: visible;\n  }\n"])));var xi=function IntegralResizable(e){var t=e.integralSeries,n=e.integralData,a=useChartData(),i=a.height,o=a.margin,r=useScale().scaleX,c=n.id,l=n.integral,s=Object(pi.c)([c],pi.b.INTEGRAL),u=Object(O.useMemo)((function(){return t?Qn.c(t.x):[]}),[t]),d=useDispatch(),b=Object(O.useCallback)((function(e){d({type:vt,data:Object(f.a)(Object(f.a)({},n),e)})}),[d,n]),p=Object(O.useCallback)((function(){s.show()}),[s]),h=Object(O.useCallback)((function(){s.hide()}),[s]),g=u[0]?r()(u[0]):0,m=u[1]?r()(u[1]):0;return Object(me.b)(O.Fragment,{children:Object(me.c)("g",{css:s.isActive?Oi:vi,onMouseEnter:p,onMouseLeave:h,children:[Object(me.b)("rect",{"data-no-export":"true",x:"".concat(m),y:"0",width:"".concat(g-m),height:i-o.bottom,className:"highlight"}),Object(me.b)("text",{x:m,y:i-o.bottom+30,fill:"black",style:{fontSize:"12px",fontWeight:"bold"},children:void 0!==l?l.toFixed(2):""}),Object(me.b)(ji,{from:n.from,to:n.to,onDrop:b,"data-no-export":"true"})]})})};var yi=function Integral(e){var t=e.integralData,n=e.x,a=e.y,i=e.xDomain,o=e.isActive,r=e.spectrumID,c=e.scaleY,l=e.scaleX,s=t.from,u=t.to,d=Object(O.useState)(),b=Object(h.a)(d,2),p=b[0],f=b[1],g=usePreferences(),m=Object(O.useMemo)((function(){var e=ra(g,"formatting.panels.integrals")||{},t=e.color,n=void 0===t?ui.color:t,a=e.strokeWidth;return{color:n,strokeWidth:void 0===a?ui.strokeWidth:a}}),[g]);Object(O.useEffect)((function(){var e=Object(Ln.j)({x:n,y:a},{from:s,to:u,reverse:!0});f(e)}),[s,u,n,a]);var j=Object(O.useCallback)((function(){if(p&&c){var e=Object(Ln.n)(p,{from:i[0],to:i[1],nbPoints:200,optimize:!0}),t="M ".concat(l()(e.x[0])," ").concat(c(e.y[0]));return t+=e.x.slice(1).reduce((function(t,n,a){return t+=" L ".concat(l()(n)," ").concat(c(e.y[a+1]))}),"")}return""}),[p,l,c,i]);return Object(A.jsxs)(O.Fragment,{children:[Object(A.jsx)("path",{className:"line",stroke:m.color,strokeWidth:m.strokeWidth,fill:"none",style:{transformOrigin:"center top",opacity:o?1:.2},d:j()}),Object(A.jsx)(xi,{spectrumID:r,integralSeries:p,integralData:t,scaleY:c})]})};var ki=function IntegralsSeries(){var e=useChartData(),t=e.xDomain,n=e.activeSpectrum,a=e.data,i=e.height,o=e.margin,r=e.verticalAlign,c=e.integralsYDomains,l=e.displayerKey,s=useScale().scaleX,u=Object(O.useMemo)((function(){return n&&c[n.id]?function getIntegralYScale(e,t){var n=e.height,a=e.margin,i=e.verticalAlign,o=e.integralsYDomains,r=i.flag&&!i.stacked?n/2:n;return Object(Qn.f)(o[t],[r-(a.bottom+.3*r),a.top])}({height:i,margin:o,verticalAlign:r,integralsYDomains:c},n.id):null}),[n,i,c,o,r]),d=Object(O.useMemo)((function(){var e=function IsActive(e){return null===n||e===n.id};return a&&a[0]&&a.filter((function(e){return!0===e.display.isVisible&&!0===e.display.isVisibleInDomain})).map((function(n){return n.integrals&&n.integrals.values&&n.integrals.values.map((function(a){return Object(A.jsx)(yi,{spectrumID:n.id,integralData:a,x:n.data.x,y:n.data.y,isActive:e(n.id),xDomain:t,scaleY:u,scaleX:s},a.id)}))}))}),[n,a,s,u,t]);return Object(A.jsx)("g",{clipPath:"url(#".concat(l,"clip-chart-1d)"),children:d})};var Ci=function Line(e){var t=e.data,n=e.id,a=e.display,i=e.index,o=useChartData(),r=o.xDomain,c=o.activeSpectrum,l=o.verticalAlign,s=usePreferences(),u=useScale(),d=u.scaleX,b=u.scaleY,p=Object(O.useMemo)((function(){return null===c||n===c.id}),[c,n]),f=Object(O.useMemo)((function(){return l.flag&&l.stacked?i*l.value:0}),[i,l.flag,l.stacked,l.value]),h=Object(O.useMemo)((function(){var e=d(),a=b(n);if((null===t||void 0===t?void 0:t.x)&&(null===t||void 0===t?void 0:t.y)&&e(0)){var i=Object(Ln.n)({x:t.x,y:t.y},{from:r[0],to:r[1]}),o="M ".concat(e(i.x[0])," ").concat(a(i.y[0])," ");return o+=i.x.slice(1).reduce((function(t,n,o){return t+=" L ".concat(e(n)," ").concat(a(i.y[o+1]))}),"")}return""}),[n,d,b,t,r]);return Object(A.jsx)("path",{className:"line",stroke:a.color,fill:"none",style:{opacity:p?1:v()(s,"controllers.dimmedSpectraTransparency",.1)},d:h,transform:"translate(0,-".concat(f,")")},n)};var Di=function LinesSeries(){var e=useChartData(),t=e.data,n=e.tempData,a=e.displayerKey,i=n||t;return Object(A.jsx)("g",{clipPath:"url(#".concat(a,"clip-chart-1d)"),children:i&&i.filter((function(e){return!0===e.display.isVisible&&!0===e.display.isVisibleInDomain})).map((function(e,t){return Object(A.jsx)(Ci,Object(f.a)(Object(f.a)({},e),{},{index:t}),e.id)}))})},Si=n(575),wi=n.n(Si);function useFormatNumberByNucleus(e){var t=usePreferences(),n=v()(t,"formatting.nucleusByKey",{ppm:"0.0",hz:"0.0"}),a=function formatFun(e){return function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ppm",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return i+wi()(Number(t)).format(v()(n,"".concat(e.toLowerCase(),".").concat(a),"0.0"))+o}};if(e){if("string"===typeof e)return a(e);if(Array.isArray(e))return e.map((function(e){return a(e)}));throw Error("nuclus must be string or array of string")}}function getNumberOfDecimals(e){var t=(e=String(e).trim()).lastIndexOf(".");return t>0?e.substr(t).split("").length-1:0}var Ti,Mi=function FormatNumber(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return n+wi()(e).format(t)+a},Ai=Object(m.b)(Ti||(Ti=Object(g.a)(["\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  text,\n  input {\n    -webkit-user-select: none; /* Safari 3.1+ */\n    -moz-user-select: none; /* Firefox 2+ */\n    -ms-user-select: none; /* IE 10+ */\n    user-select: none; /* Standard syntax */\n  }\n\n  input[type='number']::-webkit-outer-spin-button,\n  input[type='number']::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n\n  input[type='number'] {\n    -moz-appearance: textfield;\n  }\n\n  .notification-input {\n    width: calc(100% - 10px) !important;\n    user-select: 'none';\n    -webkit-user-select: none; /* Chrome all / Safari all */\n    -moz-user-select: none; /* Firefox all */\n  }\n\n  .notification-input-normal {\n    opacity: 1;\n    left: 4px;\n    position: absolute;\n    font-size: 10px;\n    outline: none;\n    user-select: 'none';\n    -webkit-user-select: none; /* Chrome all / Safari all */\n    -moz-user-select: none; /* Firefox all */\n    background-color: transparent;\n  }\n\n  .notification-input-normal input:focus {\n    outline: none;\n    background-color: white;\n  }\n\n  .input-over {\n    background-color: white;\n    outline: none;\n  }\n\n  .notification-label {\n    display: none;\n  }\n\n  .notification-group-over {\n    z-index: 9999999999;\n  }\n\n  .notification-group {\n    z-index: 1;\n  }\n\n  .notifcate-selected {\n    opacity: 0;\n  }\n\n  input[type='number']::-webkit-inner-spin-button,\n  input[type='number']::-webkit-outer-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n"])));var Ei=function PeakNotation(e){var t=e.id,n=e.x,a=e.y,i=e.sign,o=e.value,r=e.color,c=e.isActive,l=e.nucleus,s=Object(O.useRef)(),u=Object(O.useState)(!1),d=Object(h.a)(u,2),b=d[0],p=d[1],f=Object(O.useState)(o),g=Object(h.a)(f,2),j=g[0],v=g[1],x=Object(O.useState)({width:0,height:0}),y=Object(h.a)(x,2),k=y[0],C=y[1],D=useFormatNumberByNucleus(l),S=Object(pi.c)([t],pi.b.PEAK),w=useDispatch(),T=Object(O.useCallback)((function(e){return w({type:Ue,shiftValue:e.shiftValue})}),[w]);Object(O.useLayoutEffect)((function(){var e=s.current.getBBox();C({width:e.width,height:e.height})}),[b]),Object(O.useEffect)((function(){v(o)}),[o]);var M=Object(O.useCallback)((function(e){if("Enter"===e.key){var n=parseFloat(e.target.value),a=parseFloat(o),i=parseFloat(e.target.value)-parseFloat(o);T({id:t,value:n,oldValue:a,shiftValue:i}),e.target.blur(),p(!1)}else 27===e.keyCode&&(v(o),e.target.blur(),p(!1))}),[o,T,t]),A=Object(O.useCallback)((function(e){v(e.target.value)}),[]),E=Object(O.useCallback)((function(e){return e.preventDefault(),e.stopPropagation(),p(!0),!1}),[]),P=Object(O.useCallback)((function(){S.show()}),[S]),I=Object(O.useCallback)((function(){S.hide()}),[S]),F=Object(O.useMemo)((function(){return b?o:D(o)}),[D,b,o]),R=Object(O.useMemo)((function(){return b?j:D(j)}),[j,D,b]);return Object(me.c)(O.Fragment,{children:[Object(me.b)(m.a,{styles:Ai}),Object(me.c)("g",{id:t,style:{outline:"none"},transform:"translate(".concat(n,", ").concat(a,")"),onMouseEnter:P,onMouseLeave:I,children:[Object(me.b)("line",{x1:"0",x2:"0",y1:-1===i?10:0,y2:-1===i?28:-18,stroke:r,strokeWidth:S.isActive?"7px":"1px"}),Object(me.b)("text",{ref:s,className:"peaks-text",x:"0",y:-1===i?28:-12,dy:"0",dx:"0.35em",fill:"transparent",fontSize:"10px",fontWeight:"100",style:{position:"absolute"},children:F}),Object(me.b)("foreignObject",{x:"0",y:-1===i?16:-22,dy:"0.1em",dx:"0.35em",width:k.width+20,height:"40px","data-no-export":"true",children:Object(me.b)("div",{style:{width:k.width+20,height:"100%",paddingRight:5},xmlns:"http://www.w3.org/1999/xhtml",children:Object(me.b)("input",{onClick:E,className:b?"notification-input input-over":"notification-input-normal",style:{width:"inherit",border:b?"1px solid ".concat(r):"0",opacity:c?1:.2,userSelect:"none",color:r},value:R,onKeyDown:M,onChange:A,type:"number",disabled:!c})})})]})]})};var Pi,Ii,Fi=function PeaksNotations(){var e=useChartData(),t=e.data,n=e.activeSpectrum,a=e.verticalAlign,i=e.displayerKey,o=useScale(),r=o.scaleX,c=o.scaleY,l=Object(O.useMemo)((function(){var e=function getVerticalAlign(e){var n=t.findIndex((function(t){return t.id===e}));return a.flag&&a.stacked?(n+1)*a.value:0};return t&&function reSortData(){var e=Object(Ee.a)(t);return n?e.sort((function(e,t){return e.id===n.id?1:t.id===n.id?-1:0})):e}().filter((function(e){return!0===e.display.isVisible&&!0===e.display.isVisibleInDomain})).map((function(t){return t.peaks&&t.peaks.values&&t.display.isPeaksMarkersVisible&&Object(A.jsx)("g",{transform:"translate(0,-".concat(e(t.id),")"),children:t.peaks.values.map((function(e){var a=e.delta,i=e.intensity,o=e.id;return Object(A.jsx)(Ei,{x:r()(a),y:c(t.id)(i)-5,sign:Math.sign(i),id:o,spectrumID:t.id,value:a,color:"#730000",nucleus:t.info.nucleus,isActive:null!=n&&n.id===t.id},o)}))},t.id)}))}),[t,a.flag,a.stacked,a.value,n,r,c]);return Object(A.jsx)("g",{className:"peaks",clipPath:"url(#".concat(i,"clip-chart-1d)"),children:l})},Ri=n(2),_i=n.n(Ri),Ni=Object(m.b)(Pi||(Pi=Object(g.a)(["\n  user-select: none;\n\n  path,\n  line {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    shape-rendering: crispEdges;\n    user-select: none;\n  }\n"]))),Li=Object(m.b)(Ii||(Ii=Object(g.a)(["\n  user-select: none;\n\n  line {\n    stroke: rgb(104, 104, 104);\n    stroke-opacity: 0.2;\n    shape-rendering: crispEdges;\n    stroke-dasharray: 3;\n    stroke-width: 1;\n    user-select: none;\n  }\n\n  path {\n    stroke-width: 0;\n  }\n"])));function XAxis(e){var t=e.label,n=e.show,a=e.showGrid,i=e.mode,o=useChartData(),r=o.xDomain,c=o.height,l=o.width,s=o.margin,u=useScale().scaleX,d=Object(O.useRef)(),b=Object(O.useRef)();t=t||("RTL"===i?"\u03b4 [ppm]":"time [s]"),Object(O.useEffect)((function(){var e=Qn.a().ticks(8).tickFormat(Qn.d("0")),t=Qn.a().ticks(50).tickSize(-(c-s.top-s.bottom)).tickFormat("");n&&u&&(Qn.g(d.current).call(e.scale(u().domain(r))),Qn.g(b.current).call(t.scale(u().domain(r))))}),[c,s.bottom,s.top,u,n,r]);var p=Object(O.useMemo)((function(){return n&&!0===n&&Object(me.b)("g",{className:"x",css:Ni,transform:"translate(0,".concat(c-s.bottom,")"),ref:d,children:Object(me.b)("text",{fill:"#000",x:l-10,y:"30",dy:"0.70em",textAnchor:"end",children:t})})}),[c,t,s.bottom,n,l]),f=Object(O.useMemo)((function(){return a&&!0===a&&Object(me.b)("g",{css:Li,className:"grid",ref:b,transform:"translate(0,".concat(c-s.bottom,")")})}),[a,c,s.bottom]);return l&&c&&u?Object(me.c)(me.a,{children:[p,f]}):null}XAxis.propTypes={showGrid:_i.a.bool,show:_i.a.bool,label:_i.a.string},XAxis.defaultProps={showGrid:!1,show:!0,label:""};var zi=XAxis;var Hi,Bi,Xi=function MultiAnalysisWrapper(e){var t=function Wrapper(t){var n=useChartData(),a=n.activeTab,i=n.spectraAnalysis,o=n.displayerKey,r=t.forwardedRef,c=Object(le.a)(t,["forwardedRef"]);return Object(A.jsx)(e,Object(f.a)(Object(f.a)({},c),{},{activeTab:a,spectraAnalysis:i,displayerKey:o,ref:r}))};return Object(O.forwardRef)((function(e,n){return Object(A.jsx)(t,Object(f.a)(Object(f.a)({},e),{},{forwardedRef:n}))}))},Vi=Object(m.b)(Hi||(Hi=Object(g.a)(["\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  .delete-button {\n    visibility: hidden;\n  }\n"]))),Yi=Object(m.b)(Bi||(Bi=Object(g.a)(["\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  .range-area {\n    height: 100%;\n    fill: #ff6f0057;\n  }\n  .delete-button {\n    visibility: visible;\n    cursor: pointer;\n  }\n"])));var Zi=function AnalysisRange(e){var t=e.rangeData,n=e.columnKey,a=t.from,i=t.to,o=Object(pi.c)([n]),r=useScale().scaleX,c=useDispatch(),l=Object(O.useCallback)((function(){c({type:bn,colKey:n})}),[n,c]),s=Object(O.useCallback)((function(e){c({type:pn,payload:Object(f.a)(Object(f.a)(Object(f.a)({},t),e),{},{columnKey:n})})}),[n,c,t]);return Object(me.c)("g",Object(f.a)(Object(f.a)({},o.onHover),{},{css:o.isActive?Yi:Vi,children:[Object(me.c)("g",{transform:"translate(".concat(r()(i),",25)"),children:[Object(me.b)("rect",{x:"0",width:r()(a)-r()(i),height:"6",className:"range-area",fill:"green"}),Object(me.b)("text",{textAnchor:"middle",x:(r()(a)-r()(i))/2,y:"-5",fontSize:"12",fill:"red",fontWeight:"bolder",fillOpacity:o.isActive?1:.6,children:n})]}),Object(me.b)(ji,{from:t.from,to:t.to,onDrop:s}),Object(me.b)(ci,{x:r()(i)-20,y:10,onDelete:l})]}))};function MultiAnalysisRanges(e){var t=e.activeTab,n=e.spectraAnalysis,a=e.displayerKey,i=Object(O.useMemo)((function(){return(n[t]||{options:{columns:{}}}).options.columns}),[t,n]),o=Object(O.useMemo)((function(){return Object.keys(i).map((function(e){return e}),[])}),[i]);return o&&0!==o.length?Object(A.jsx)("g",{clipPath:"url(#".concat(a,"clip-chart-1d)"),children:o.map((function(e){return Object(A.jsx)(Zi,{columnKey:e,rangeData:i[e]},e)}))}):null}var Ui=Xi(Object(O.memo)(MultiAnalysisRanges));var Ki=function RangesWrapper(e){var t=function Wrapper(t){var n=useChartData(),a=n.data,i=n.activeSpectrum,o=n.xDomain,r=n.activeTab,c=n.molecules,l=n.tabActiveSpectrum,s=n.displayerKey,u=n.selectedTool,d=usePreferences(),b=Object(O.useMemo)((function(){return a&&i&&i.id?a.find((function(e){return e.id===i.id}))||{ranges:{},x:[],y:[],info:{}}:{}}),[i,a]),p=b.ranges,h=void 0===p?{}:p,g=b.x,m=void 0===g?[]:g,j=b.y,v=void 0===j?[]:j,x=b.info,y=void 0===x?{}:x,k=Object(O.useMemo)((function(){return l&&Object.keys(l).length>0?Object.keys(l):null}),[l]),C=t.forwardedRef,D=Object(le.a)(t,["forwardedRef"]);return Object(A.jsx)(e,Object(f.a)(Object(f.a)({},D),{},{ranges:h,x:m,y:v,info:y,xDomain:o,preferences:d,activeTab:r,molecules:c,nucleus:k,displayerKey:s,selectedTool:u,ref:C}))};return Object(O.memo)(Object(O.forwardRef)((function(e,n){return Object(A.jsx)(t,Object(f.a)(Object(f.a)({},e),{},{forwardedRef:n}))})))},Wi=[{key:"signal",label:"Signal",value:"signal"},{key:"reference",label:"Reference",value:"reference"},{key:"solvent",label:"Solvent",value:"solvent"},{key:"impurity",label:"Impurity",value:"impurity"},{key:"standard",label:"Standard",value:"standard"},{key:"p1",label:"P1",value:"p1"},{key:"p2",label:"P2",value:"p2"},{key:"p3",label:"P3",value:"p3"}],Gi=["signal"],qi="signal",Ji="mixed",$i=function getPubIntegral(e){return function getDiaIDs(e){return[].concat(e.diaID||[],e.signal?e.signal.map((function(e){return e.diaID||[]})).flat():[])}(e).length},Qi=function unlink(e,t,n){return void 0!==t?!0===t?delete e.diaID:void 0!==n&&delete e.signal[n].diaID:function resetDiaIDs(e){delete e.diaID,e.signal.forEach((function(e){delete e.diaID})),delete e.pubIntegral}(e),function setPubIntegral(e){e.pubIntegral=$i(e),0===e.pubIntegral&&delete e.pubIntegral}(e),e},eo=function checkRangeKind(e){return e.kind===qi},to=function unlinkInAssignmentData(e,t){var n=t.reduce((function(e,t){return e.push(t.id),t.signal&&e.concat(t.signal.map((function(e){return e.id}),[])),e}),[]);e.dispatch({type:"REMOVE_ALL",payload:{id:n,axis:"x"}})},no=Object(O.createContext)();function assignmentReducer(e,t){switch(t.type){case"ADD":var n=Object(f.a)(Object(f.a)({},e),{},{assignment:Object(f.a)({},e.assignment)});return void 0===n.assignment[t.payload.id[0]]&&(n.assignment[t.payload.id[0]]={}),void 0===n.assignment[t.payload.id[0]][t.payload.axis]&&(n.assignment[t.payload.id[0]][t.payload.axis]=[]),n.assignment[t.payload.id[0]][t.payload.axis].includes(t.payload.id[1])||n.assignment[t.payload.id[0]][t.payload.axis].push(t.payload.id[1]),n;case"REMOVE":var a=Object(f.a)(Object(f.a)({},e),{},{assignment:Object(f.a)({},e.assignment)});return void 0!==a.assignment[t.payload.id[0]]&&void 0!==a.assignment[t.payload.id[0]][t.payload.axis]&&(a.assignment[t.payload.id[0]][t.payload.axis]=a.assignment[t.payload.id[0]][t.payload.axis].filter((function(e){return e!==t.payload.id[1]})),0===a.assignment[t.payload.id[0]][t.payload.axis].length&&delete a.assignment[t.payload.id[0]][t.payload.axis],0===Object.keys(a.assignment[t.payload.id[0]]).length&&delete a.assignment[t.payload.id[0]]),a;case"REMOVE_ALL":var i=Object(f.a)(Object(f.a)({},e),{},{assignment:Object(f.a)({},e.assignment)});return t.payload.id.forEach((function(e){void 0!==i.assignment[e]&&void 0!==i.assignment[e][t.payload.axis]&&(delete i.assignment[e][t.payload.axis],0===Object.keys(i.assignment[e]).length&&delete i.assignment[e])})),i;case"SET_IS_ACTIVE":return Object(f.a)(Object(f.a)({},e),{},{isActive:void 0!==t.payload.id&&void 0!==t.payload.axis,activeID:t.payload.id,activeAxis:t.payload.axis});case"SET_IS_ON_HOVER":return Object(f.a)(Object(f.a)({},e),{},{isOnHover:void 0!==t.payload.id,onHoverID:t.payload.id,onHoverAxis:t.payload.axis});case"DELETE_RECORD":var o=Object(f.a)(Object(f.a)({},e),{},{assignment:Object(f.a)({},e.assignment)});return delete o.assignment[t.payload.id],o.isActive&&o.activeID===t.payload.id&&(o.isActive=!1,o.activeID=void 0,o.activeAxis=void 0),o.isOnHover&&o.onHoverID===t.payload.id&&(o.isOnHover=!1,o.onHoverID=void 0,o.onHoverAxis=void 0),o;default:throw new Error("unknown action type: ".concat(t.type))}}var ao={assignment:{},isActive:!1,activeID:void 0,activeAxis:void 0,isOnHover:!1,onHoverID:void 0,onHoverAxis:void 0};function AssignmentProvider(e){var t=e.spectraData,n=Object(O.useReducer)(assignmentReducer,ao),a=Object(h.a)(n,2),i=a[0],o=a[1],r=Object(O.useMemo)((function(){return{assignment:i,dispatch:o}}),[i]);return Object(O.useEffect)((function(){t&&t.forEach((function(e){1===e.info.dimension?e.ranges.values.forEach((function(e){return function initAssignmentDataRanges(e,t){t.dispatch({type:"DELETE_RECORD",payload:{id:e.id}}),(e.diaID||[]).forEach((function(n){return t.dispatch({type:"ADD",payload:{id:[e.id,n],axis:"x"}})})),e.signal.forEach((function(e){return(e.diaID||[]).forEach((function(n){return t.dispatch({type:"ADD",payload:{id:[e.id,n],axis:"x"}})}))}))}(e,r)})):2===e.info.dimension&&e.zones.values.forEach((function(e){return function initAssignmentDataZones(e,t){t.dispatch({type:"DELETE_RECORD",payload:{id:e.id}}),(e.y.diaID||[]).forEach((function(n){return t.dispatch({type:"ADD",payload:{id:[e.id,n],axis:"y"}})})),(e.x.diaID||[]).forEach((function(n){return t.dispatch({type:"ADD",payload:{id:[e.id,n],axis:"x"}})})),e.signal.forEach((function(e){(e.x.diaID||[]).forEach((function(n){return t.dispatch({type:"ADD",payload:{id:[e.id,n],axis:"x"}})})),(e.y.diaID||[]).forEach((function(n){return t.dispatch({type:"ADD",payload:{id:[e.id,n],axis:"y"}})}))}))}(e,r)}))}))}),[t]),Object(A.jsx)(no.Provider,{value:r,children:e.children})}function useAssignmentData(){return Object(O.useContext)(no)}function useAssignment(e){var t=useAssignmentData();if("string"!==typeof e&&"number"!==typeof e||""===e)throw new Error("assignment key must be a non-empty string or number");var n=String(e),a=Object(O.useMemo)((function(){return t.assignment.isActive&&t.assignment.activeID===n}),[t.assignment.activeID,t.assignment.isActive,n]),i=Object(O.useMemo)((function(){return a?t.assignment.activeAxis:void 0}),[t.assignment.activeAxis,a]),o=Object(O.useMemo)((function(){return t.assignment.assignment[n]?t.assignment.assignment[n]:[]}),[t.assignment.assignment,n]),r=Object(O.useMemo)((function(){return t.assignment.isOnHover&&t.assignment.onHoverID===n}),[t.assignment.isOnHover,t.assignment.onHoverID,n]),c=Object(O.useMemo)((function(){return r?t.assignment.onHoverAxis:void 0}),[t.assignment.onHoverAxis,r]),l=Object(O.useCallback)((function(e){t.dispatch({type:"ADD",payload:{id:[n,e],axis:i}})}),[i,t,n]),s=Object(O.useCallback)((function(e){t.dispatch({type:"REMOVE",payload:{id:[n,e],axis:i}})}),[i,t,n]),u=Object(O.useCallback)((function(e){t.dispatch({type:"REMOVE_ALL",payload:{id:[n],axis:e}})}),[t,n]),d=Object(O.useCallback)((function(e){void 0!==o[i]&&o[i].includes(e)?s(e):l(e)}),[i,l,o,s]),b=Object(O.useCallback)((function(){t.dispatch({type:"DELETE_RECORD",payload:{id:n}})}),[t,n]),p=Object(O.useCallback)((function(e){t.dispatch({type:"SET_IS_ACTIVE",payload:{id:a?void 0:n,axis:a||void 0===n?void 0:e}})}),[t,n,a]),f=Object(O.useCallback)((function(e,a){"enter"===e?t.dispatch({type:"SET_IS_ON_HOVER",payload:{id:n,axis:void 0!==n?a:void 0}}):"leave"===e&&t.dispatch({type:"SET_IS_ON_HOVER",payload:{}})}),[t,n]),h=Object(O.useCallback)((function(e){return f("enter",e)}),[f]),g=Object(O.useCallback)((function(e){return f("leave",e)}),[f]);return{id:n,isActive:a,activeAxis:i,assigned:o,add:l,remove:s,removeAll:u,toggle:d,deleteRecord:b,onClick:p,isOnHover:r,onHoverAxis:c,onMouseEnter:h,onMouseLeave:g}}var io=[{label:"massive (m)",value:"m",multiplicity:null},{label:"singlet (s)",value:"s",multiplicity:1},{label:"doublet (d)",value:"d",multiplicity:2},{label:"triplet (t)",value:"t",multiplicity:3},{label:"quartet (q)",value:"q",multiplicity:4},{label:"quintet (i)",value:"i",multiplicity:5},{label:"sextet (x)",value:"x",multiplicity:6},{label:"septet (p)",value:"p",multiplicity:7},{label:"octet (o)",value:"o",multiplicity:8},{label:"nonet (n)",value:"n",multiplicity:9}];function checkMultiplet(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(void 0===e||0===e.length)return!1;var n=io.find((function(t){return t.value===e||t.label===e}));return n&&!t.includes(n.value)&&!t.includes(n.label)}function checkMultiplicity(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return void 0!==e&&0!==e.length&&!e.split("").find((function(e){return!checkMultiplet(e,t)}))}function translateMultiplet(e){return 1===e.length?io.find((function(t){return t.value===e})).label:io.find((function(t){return t.label===e})).value}function hasCouplingConstant(e){return e.length>1&&(e=translateMultiplet(e)),checkMultiplicity(e,["m","s"])}var oo=["red","green","blue","magenta"];var ro=function LevelNode(e){var t=e.signal,n=e.startY,a=e.levelHeight,i=useScale().scaleX;return Object(A.jsx)("line",{x1:i()(t.delta),y1:n,x2:i()(t.delta),y2:n+a,stroke:oo[0]},"startLevelNode_".concat(t.id))};var co=function StringNode(e){var t=e.signal,n=e.startY,a=e.levelHeight,i=e.fontSize,o=e.showLabels,r=useScale().scaleX;return Object(A.jsx)("text",{textAnchor:"middle",x:r()(t.delta),y:n+a/2,fontSize:i,lengthAdjust:"spacing",fill:"black",visibility:o?"visible":"hidden",children:t.multiplicity},"multiplicityString_".concat(t.id))};var lo=function TreeNodes(e){var t=e.nodesData,n=e.levelHeight,a=e.startY,i=e.signalID,o=e.labelOptions,r=e.showLabels,c=useScale().scaleX,l=Object(O.useCallback)((function(e){var t=e.startX,l=e._startX,s=e.ratio,u=e.multiplicityIndex,d=e.color,b=2*u+2,p=a+b*n,f=a+(b+1)*n;return Object(A.jsxs)("g",{children:[Object(A.jsx)("text",{textAnchor:"middle",x:c()(l)+o.distance,y:f+n/3*2,fontSize:o.fontSize,fill:d,visibility:r?"visible":"hidden",children:s}),Object(A.jsx)("line",{x1:c()(t),y1:p,x2:c()(l),y2:f,stroke:d}),Object(A.jsx)("line",{x1:c()(l),y1:f,x2:c()(l),y2:f+n,stroke:d})]},"treeNode_".concat(i,"_").concat(t,"_").concat(l,"_").concat(s))}),[i,o.distance,o.fontSize,c,r,a,n]);return t&&t.map((function(e){return l(e)}))},so=function createTreeNodes(e,t){return function buildTreeNodesData(n,a,i,o){if(n>=e.multiplicity.length)return i;var r=oo[n%oo.length],c=a.findIndex((function(e){return e===n})),l=v()(t,"info.originFrequency",0),s=c>=0&&l>0?e.j[c].coupling/l:null;if(s){var u=function getPascal(e,t){if(void 0===e||0===e||void 0===t)return[1];for(var n=2*t+1,a=[],i=0;i<n-1;i++)a.push(1);for(var o=0;o<e-1;o++){for(var r=a.slice(),c=1;c<n;c++){for(var l=0;l<a.length-1;l++)r[l+c]+=a[l];r.push(1)}a=r.slice()}return a}(function getMultiplicityNumber(e){var t=io.find((function(t){return e===t.label||e===t.value}));return t?t.multiplicity:null}(e.multiplicity.charAt(n)),.5),d=u.length%2===0?o-u.length/2*s+s/2:o-(u.length/2-.5)*s;u.forEach((function(e,t){t>0&&(d+=s),i.push({startX:o,_startX:d,ratio:e,multiplicityIndex:n,color:r}),buildTreeNodesData(n+1,a,i,d)}))}else i.push({startX:o,_startX:o,ratio:1,multiplicityIndex:n,color:r}),buildTreeNodesData(n+1,a,i,o);return i}},uo={cursor:"default",opacity:.6,strokeWidth:1};var bo,po,fo=function MultiplicityTree(e){var t=e.rangeFrom,n=e.rangeTo,a=e.signal,i=e.labelOptions,o=void 0===i?{distance:10,fontSize:11}:i,r=useScale(),c=r.scaleX,l=r.scaleY,s=useChartData(),u=s.data,d=s.activeSpectrum,b=s.selectedTool,p=s.width,g=useAssignment(a.id),m=Object(pi.c)([g.id].concat(g.assigned.x||[])),j=Object(O.useMemo)((function(){return v()(u,"".concat(d.index),null)}),[d,u]),x=Object(O.useState)({x1:a.delta,x2:a.delta}),y=Object(h.a)(x,2),k=y[0],C=y[1],D=Object(O.useState)({width:0,height:0,levelHeight:0}),S=Object(h.a)(D,2),w=S[0],T=S[1],M=Object(O.useState)(!1),A=Object(h.a)(M,2),E=A[0],P=A[1],I=Object(O.useState)(!1),F=Object(h.a)(I,2),R=F[0],_=F[1];Object(O.useEffect)((function(){var e=!checkMultiplicity(a.multiplicity,["m"]),t=e?Math.abs(c()(k.x1)-c()(k.x2)):Math.abs(c()(k.x1)-c()(k.x2))+o.distance,n=e?t/3:t/2,i=e?n/(a.multiplicity.length+2):n/(2*a.multiplicity.length+2);T({width:t,height:n,levelHeight:i}),P(e)}),[o.distance,c,a.multiplicity,k.x1,k.x2]),Object(O.useEffect)((function(){w.width/p>=.1?_(!0):_(!1)}),[w.width,p]);var N=Object(O.useMemo)((function(){var e;return j.data.x.forEach((function(a,i){a>=t&&a<=n&&(!e||j.data.y[i]>e)&&(e=j.data.y[i])})),l(j.id)(e)-w.height-30}),[j.data.x,j.data.y,j.id,l,w.height,t,n]),L=Object(O.useMemo)((function(){return so(a,j)(0,a.multiplicity.split("").map((function(e,t){return hasCouplingConstant(e)?t:void 0})).filter((function(e){return void 0!==e})),[],a.delta)}),[a,j]);Object(O.useEffect)((function(){if(E)C({x1:t,x2:n});else{var e={x1:a.delta,x2:a.delta};L.forEach((function(t){t.startX<e.x1&&(e.x1=t.startX),t.startX>e.x2&&(e.x2=t.startX),t._startX<e.x1&&(e.x1=t._startX),t._startX>e.x2&&(e.x2=t._startX)})),C(e)}}),[E,t,n,a.delta,a.multiplicity,L]);var z=Object(O.useMemo)((function(){var e=w.levelHeight,i=N,r=i,l=N+e;if(r=l,r+=e,E){var s=c()(t),u=c()(n),d="M ".concat(s," ").concat(r+e," ").concat(s," ").concat(r," ").concat(c()(a.delta)," ").concat(r," ").concat(u," ").concat(r," ").concat(u," ").concat(r+e);return Object(me.c)("g",{children:[Object(me.b)(co,{signal:a,startY:i,levelHeight:e,fontSize:o.fontSize,showLabels:R}),Object(me.b)(ro,{signal:a,startY:l,levelHeight:e}),Object(me.b)("path",{d:d,stroke:"blue",fill:"none"})]})}return Object(me.c)("g",{children:[Object(me.b)(co,{signal:a,startY:i,levelHeight:e,fontSize:o.fontSize,showLabels:R}),Object(me.b)(ro,{signal:a,startY:l,levelHeight:e}),Object(me.b)(lo,{nodesData:L,signalID:L,showLabels:R,startY:N,labelOptions:o,levelHeight:e})]})}),[w,N,E,a,o,R,L,c,t,n]);return Object(me.b)("g",{css:m.isActive||g.isActive?Object(f.a)(Object(f.a)({},uo),{},{opacity:1,strokeWidth:1.5}):uo,onMouseEnter:function onMouseEnter(){g.onMouseEnter("x"),m.show()},onMouseLeave:function onMouseLeave(){g.onMouseLeave("x"),m.hide()},onClick:b&&b===Ua.editRange.id?null:function(e){e.shiftKey&&(e.stopPropagation(),g.onClick("x"))},children:z})},ho=Object(m.b)(bo||(bo=Object(g.a)(["\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  // // disabled because Resizable component appears now when hovering over it\n  // :hover .range-area {\n  //   height: 100%;\n  //   fill: #ff6f0057;\n  //   cursor: pointer;\n  // }\n\n  .delete-button {\n    visibility: hidden;\n  }\n"]))),go=Object(m.b)(po||(po=Object(g.a)(["\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  .range-area {\n    height: 100%;\n    fill: #ff6f0057;\n  }\n  .delete-button {\n    visibility: visible;\n    cursor: pointer;\n  }\n"])));var mo=function Range(e){var t=e.rangeData,n=e.showMultiplicityTrees,a=e.selectedTool,i=t.id,o=t.from,r=t.to,c=t.integral,l=t.signal,s=useAssignment(i),u=Object(pi.c)([s.id].concat(s.assigned.x||[]),pi.b.RANGE),d=useScale().scaleX,b=useDispatch(),p=Object(O.useState)(!1),g=Object(h.a)(p,2),m=g[0],j=g[1],v=Object(O.useState)(!1),x=Object(h.a)(v,2),y=x[0],k=x[1];Object(O.useEffect)((function(){a&&a===Ua.editRange.id?k(!0):k(!1)}),[a]),Object(O.useEffect)((function(){j(!eo(t))}),[t]);var C=Object(O.useCallback)((function(e){b({type:Wt,data:Object(f.a)(Object(f.a)({},t),e)})}),[b,t]),D=Object(O.useCallback)((function(){s.onMouseEnter("x"),u.show()}),[s,u]),S=Object(O.useCallback)((function(){s.onMouseLeave("x"),u.hide()}),[s,u]),w=Object(O.useCallback)((function(e){a===Ua.rangesPicking.id&&e.shiftKey&&!y&&s.onClick("x")}),[s,y,a]);return Object(me.c)("g",{style:{outline:"none"},css:y||u.isActive||s.isActive?go:ho,onMouseEnter:D,onMouseLeave:S,onClick:w,children:[Object(me.c)("g",{transform:"translate(".concat(d()(r),",10)"),children:[Object(me.b)("rect",{x:"0",width:Math.abs(d()(o)-d()(r)),height:"6",className:"range-area",fill:"green",fillOpacity:!m||u.isActive||s.isActive?1:.4}),Object(me.b)("text",{textAnchor:"middle",x:Math.abs(d()(o)-d()(r))/2,y:"20",fontSize:"10",fill:"red",fillOpacity:!m||u.isActive||s.isActive?1:.6,children:void 0!==c?c.toFixed(2):""})]}),Object(me.b)(ji,{from:t.from,to:t.to,onDrop:C}),n&&l&&l.length>0?l.map((function(e){return Object(me.b)(fo,{rangeFrom:o,rangeTo:r,signal:e},l.id)})):null]},i)};function Ranges(e){var t=e.ranges,n=e.displayerKey,a=e.selectedTool,i=Object(O.useState)(!1),o=Object(h.a)(i,2),r=o[0],c=o[1];return Object(O.useEffect)((function(){oi.on("showMultiplicityTrees",(function(e){c(e)}))}),[]),Object(A.jsx)("g",{clipPath:"url(#".concat(n,"clip-chart-1d)"),children:t&&t.values&&t.values.map((function(e){return Object(A.jsx)(mo,{rangeData:e,selectedTool:a,showMultiplicityTrees:r},e.id)}))})}var jo=Ki(Object(O.memo)(Ranges));var vo=function Chart1D(e){var t=e.mode,n=e.width,a=e.height,i=e.margin,o=e.displayerKey;return Object(A.jsxs)("svg",{viewBox:"0 0 ".concat(n," ").concat(a),width:n,height:a,id:"nmrSVG",children:[Object(A.jsx)("defs",{children:Object(A.jsx)("clipPath",{id:"".concat(o,"clip-chart-1d"),children:Object(A.jsx)("rect",{width:"".concat(n-i.left-i.right),height:"".concat(a),x:"".concat(i.left),y:"".concat(0)})})}),Object(A.jsx)(Di,{}),Object(A.jsx)(ki,{}),Object(A.jsx)(Fi,{}),Object(A.jsx)(jo,{}),Object(A.jsx)(Ui,{}),Object(A.jsx)(si,{}),Object(A.jsx)("g",{className:"container",style:{pointerEvents:"none"},children:Object(A.jsx)(zi,{showGrid:!0,mode:t})})]})},Oo=n(576),xo=n(355),yo=Object(O.createContext)(),ko=yo.Provider;function useHelp(){var e=Object(O.useContext)(yo),t=Object(O.useCallback)((function(t){var n=t.target.getAttribute("data-helpid");n&&(t.target.style.cursor="help",e.dispatch({type:"SHOW",id:n}),e.show(n,{delay:t.ctrlKey?0:null}))}),[e]),n=Object(O.useCallback)((function(){e.dispatch({type:"HIDE"}),e.clear()}),[e]);return{show:t,hide:n,onHover:{onMouseEnter:t,onMouseLeave:n}}}var Co=function groupBy(e,t){return e.reduce((function(e,n){var a=t(n);return e[a]||(e[a]=[]),e[a].push(n),e}),{})};function load(e){return _load.apply(this,arguments)}function _load(){return(_load=Object(Ae.a)(Me.a.mark((function _callee(e){var t,n;return Me.a.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch(e);case 2:return utility_checkStatus(t=a.sent),a.next=6,t.text();case 6:return n=a.sent,a.abrupt("return",n);case 8:case"end":return a.stop()}}),_callee)})))).apply(this,arguments)}function utility_checkStatus(e){if(!e.ok)throw new Error("HTTP ".concat(e.status," - ").concat(e.statusText));return e}var Do,So={helpText:null,helpObject:null};function helpReducer(e,t){switch(t.type){case"SHOW":var n=e.data[t.id].text;return Object(f.a)(Object(f.a)({},e),{},{helpText:n});case"HIDE":return Object(f.a)(Object(f.a)({},e),{},{helpText:null});default:throw new Error("unknown action type: ".concat(t.type))}}var wo=(Do={},Object(ie.a)(Do,W,{entering:{opacity:0},entered:{opacity:1}}),Object(ie.a)(Do,G,{entering:{transform:"scale(0)"},entered:{transform:"scale(1)"},exiting:{transform:"scale(0)"},exited:{transform:"scale(0)"}}),Do),To={innerContainer:{display:"flex",flexDirection:"column",width:"100%",height:"100%",borderRadius:"5px",padding:"10px"},outerContainer:{boxSizing:"initial",backgroundColor:"rgba(255, 255, 255, 1)",boxShadow:"0px 0px 0px 0px, rgba(0, 0, 0, 0.1) 0px 3px 5px",pointerEvents:"all"},closeButton:{border:"none",color:"red",backgroundColor:"transparent",outline:"none"}},Mo=null;function Provider_Provider(e){var t=e.children,n=e.data,a=e.offset,i=e.position,o=e.timeout,r=e.delay,c=e.type,l=e.transition,s=e.containerStyle,u=e.wrapperRef,d=e.multiple,b=e.preventAutoHelp,p=Object(O.useRef)(),g=Object(O.useRef)([]),m=Object(O.useState)([]),j=Object(h.a)(m,2),v=j[0],x=j[1];Object(O.useEffect)((function(){p.current=document.createElement("div");var e=p.current;u&&u.appendChild(e);var t=g.current;return function(){t.forEach(clearTimeout),u&&u.removeChild(e)}}),[u]);var y=Object(O.useCallback)((function(e){x((function(t){var n=t.length,a=t.filter((function(t){return t.id!==e.id}));return n>a.length&&e.options.onClose&&e.options.onClose(),a}))}),[]),k=Object(O.useCallback)(function(){var e=Object(Ae.a)(Me.a.mark((function _callee(e){var t,a,l,s,u,p,h=arguments;return Me.a.wrap((function _callee$(m){for(;;)switch(m.prev=m.next){case 0:if(t=h.length>1&&void 0!==h[1]?h[1]:{delay:null},v.some((function(t){return t.helpid===e}))){m.next=18;break}return m.prev=2,m.next=5,load(n[e].filePath);case 5:return a=m.sent,l=Math.random().toString(36).substr(2,9),s=Object(f.a)({position:t.position||i,timeout:o,type:c},t),(u={helpid:e,id:l,mdtext:a,options:s}).close=function(){return y(u)},p=function startModal(){if(u.options.timeout){var e=setTimeout((function(){y(u),g.current.splice(g.current.indexOf(e),1)}),u.options.timeout);g.current.push(e)}x((function(e){return d?e.concat(u):[u]})),u.options.onOpen&&u.options.onOpen()},0===t.delay?p():b||(Mo=setTimeout((function(){p()}),t.delay>0?t.delay:r)),m.abrupt("return",u);case 15:m.prev=15,m.t0=m.catch(2),console.log(m.t0);case 18:case"end":return m.stop()}}),_callee,null,[[2,15]])})));return function(t){return e.apply(this,arguments)}}(),[n,r,v,d,i,b,y,o,c]),C=Object(O.useCallback)((function(){clearTimeout(Mo)}),[]),D=Object(O.useMemo)((function(){return u?u.getBoundingClientRect():{top:0,left:0,width:window.innerWidth,height:window.innerHeight}}),[u]),S=Object(O.useReducer)(helpReducer,Object(f.a)(Object(f.a)({},So),{},{data:n})),w=Object(h.a)(S,2),T=w[0],M=w[1],E=Co(v,(function(e){return e.options&&e.options.position}));return Object(A.jsxs)(ko,{value:{helpState:T,dispatch:M,show:k,clear:C},children:[t,p.current&&Object(oe.createPortal)(Object(A.jsx)(O.Fragment,{children:Object.keys(Y).map((function(e){var t=Y[e];return Object(A.jsx)(ce.a,{appear:!0,options:{position:i,containerStyle:s},containerStyle:D,component:ge,children:E[t]?E[t].map((function(e){return Object(A.jsx)(pe,{type:l,transitionStyles:Object(f.a)(Object(f.a)({},wo),{},{default:{width:"400px",height:"400px"}}),children:Object(A.jsx)(re.a,{style:Object(f.a)({margin:a},To.outerContainer),default:{x:0,y:0,width:400,height:400},children:Object(A.jsxs)("div",{style:To.innerContainer,children:[Object(A.jsx)("div",{children:Object(A.jsx)("button",{type:"button",onClick:function onClick(){return y(e)},style:To.closeButton,children:Object(A.jsx)(_e.G,{})})}),e.mdtext&&Object(A.jsx)("div",{style:{cursor:"default",width:"100%",height:"100%"},children:Object(A.jsx)("iframe",{title:"Tool User Manual",src:n[e.helpid].filePath,frameBorder:"0",scrolling:"auto",style:{width:"100%",height:"100%"}})})]})})},e.id)})):null},t)}))}),p.current)]})}Provider_Provider.defaultProps={offset:"10px",position:Y.TOP_RIGHT,timeout:0,delay:2e3,transition:G,containerStyle:{zIndex:100},wrapperRef:null,multiple:!1,preventAutoHelp:!1};var Ao=Object(O.memo)(Provider_Provider);var Eo,Po,Io=function FooterWarpper(e){var t=function Wrapper(t){var n=useChartData(),a=n.margin,i=n.width,o=n.height,r=n.activeSpectrum,c=n.data,l=n.activeTab,s=t.forwardedRef,u=Object(le.a)(t,["forwardedRef"]);return Object(A.jsx)(e,Object(f.a)(Object(f.a)({},u),{},{data:c,activeSpectrum:r,activeTab:l,margin:a,width:i,height:o,ref:s}))};return Object(O.forwardRef)((function(e,n){return Object(A.jsx)(t,Object(f.a)(Object(f.a)({},e),{},{forwardedRef:n}))}))},Fo=Object(m.b)(Eo||(Eo=Object(g.a)(["\n  display: flex;\n  flex-firection: row;\n  align-items: center;\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n  background-color: #f7f7f7;\n  height: 30px;\n  padding: 6px;\n  color: #8d0018;\n  position: absolute;\n  width: 100%;\n  bottom: 0;\n\n  .help {\n    font-size: 6px;\n    color: black;\n  }\n\n  div {\n    margin: 0px 10px;\n    display: inline-block;\n\n    .label {\n      font-size: 12px;\n      color: #4d4d4d;\n      font-weight: bold;\n    }\n    .value {\n      font-weight: bold;\n      font-size: 14px;\n      display: inline-block;\n    }\n    .unit {\n      font-weight: bold;\n      font-size: 10px;\n    }\n    .xvalue {\n      min-width: 50px;\n    }\n    .yvalue {\n      min-width: 80px;\n    }\n  }\n\n  .separator {\n    border-left: 2px solid gray;\n    margin: 0 20px;\n    width: 1px;\n    height: 100%;\n  }\n"]))),Ro=Object(m.b)(Po||(Po=Object(g.a)(["\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n  background-color: #f7f7f7;\n  height: 30px;\n  padding: 6px;\n  color: #8d0018;\n  position: absolute;\n  width: 100%;\n  bottom: 0;\n  span {\n    font-size: 10px;\n    color: black;\n    display: inline-block;\n    text-overflow: ellipsis;\n    width: 100%;\n    white-space: nowrap;\n    overflow: hidden;\n  }\n"])));function FooterBanner(e){var t=e.margin,n=e.width,a=e.height,i=e.activeSpectrum,o=e.data,r=e.activeTab,c=Object(O.useContext)(F),l=Object(O.useContext)(E),s=l.startX,u=l.endX,d=l.step,b=useScale().scaleX,p=function useHelptData(){return Object(O.useContext)(yo).helpState}().helpText,f=(i?o[i.index].info:{}).originFrequency,h=useFormatNumberByNucleus(r),g=Object(O.useCallback)((function(e){if(i){var t=Object(Ln.f)(o[i.index].data.x,b().invert(e));return o[i.index].data.y[t]}return 1}),[i,o,b]);return p?Object(me.b)("div",{css:Ro,children:Object(me.b)("span",{className:"help",children:p})}):!c||c.y<t.top||c.x<t.left||c.x>n-t.right||c.y>a-t.bottom?Object(me.b)("div",{css:Fo}):Object(me.c)("div",{css:Fo,children:[Object(me.b)(Oo.a,{}),Object(me.c)("div",{children:[Object(me.b)("span",{className:"label",children:" X :"}),Object(me.b)("span",{className:"value",children:h(b().invert(c.x))}),Object(me.b)("span",{className:"unit",children:"ppm"})]}),i&&f&&Object(me.c)("div",{children:[Object(me.b)("span",{className:"label",children:" X :"}),Object(me.b)("span",{className:"value xvalue",children:h(b().invert(c.x)*f,"hz")}),Object(me.b)("span",{className:"unit",children:"Hz"})]}),"brushing"===d&&Object(me.c)("div",{children:[Object(me.b)("span",{className:"label",children:" \u0394ppm :"}),Object(me.b)("span",{className:"value",children:(b().invert(s)-b().invert(u)).toPrecision(6)})]}),i&&Object(me.c)(O.Fragment,{children:[f&&"brushing"===d&&Object(me.c)("div",{children:[Object(me.b)("span",{className:"label",children:" \u0394Hz :"}),Object(me.b)("span",{className:"value",children:((b().invert(s)-b().invert(u))*f).toPrecision(5)})]}),"brushing"===d&&Object(me.c)("div",{children:[Object(me.b)("span",{className:"label",children:" ratio :"}),Object(me.c)("span",{className:"value",children:[(g(s)/(g(u)||Number.MIN_VALUE)*100).toFixed(2),"%"]})]})]}),i&&Object(me.c)(O.Fragment,{children:[Object(me.b)("div",{className:"separator"}),Object(me.b)(xo.b,{}),Object(me.c)("div",{children:[Object(me.b)("span",{className:"label",children:" Y :"}),Object(me.b)("span",{className:"value yvalue",children:h(g(c.x))})]})]})]})}var _o=Io(Object(O.memo)(FooterBanner)),No={container:{position:"absolute",left:"10px",top:"10px"},value:{width:"67px",display:"inline-block",margin:"0 5px",fontSize:"12px"},colorIndicator:{width:"10px",height:"1px",borderBottom:"2px solid",display:"inline-block",marginBottom:"3px"},name:{fontSize:"12px"}};function YTracker(e){var t=e.datum,n=useScale().scaleX,a=Object(O.useContext)(F);if(!n||!a)return null;var i=Object(Ln.f)(t.x,n().invert(a.x));return Object(A.jsx)("span",{style:No.value,children:t.y[i]})}var Lo=function SpectraTracker(){var e=useChartData(),t=e.data,n=e.activeTab,a=Object(O.useState)(!1),i=Object(h.a)(a,2),o=i[0],r=i[1];Object(O.useEffect)((function(){return oi.on("showYSpectraTrackers",(function(e){r(e)})),function(){return oi.off("showYSpectraTrackers")}}),[]);var c=Object(O.useMemo)((function(){return o&&t.map((function(e){return e.display.isVisible&&e.display.isVisibleInDomain&&e.info.nucleus===n&&Object(A.jsxs)("div",{style:{display:"block"},children:[Object(A.jsx)("span",{style:Object(f.a)(Object(f.a)({},No.colorIndicator),{},{borderColor:e.display.color})}),Object(A.jsx)(YTracker,{datum:e.data}),Object(A.jsx)("span",{style:No.value,children:e.display.name})]},e.id)}),[])}),[n,t,o]);return o?Object(A.jsx)("div",{style:No.container,children:c}):null},zo=n(233),Ho=10,Bo="#1f1f1f",Xo=1,Vo=0,Yo=1;var Zo=function PeakPointer(){var e=useChartData(),t=e.height,n=e.width,a=e.margin,i=e.activeSpectrum,o=e.data,r=e.mode,c=e.selectedTool,l=e.verticalAlign,s=useScale(),u=s.scaleX,d=s.scaleY,b=Object(O.useContext)(F),p=Object(O.useContext)(E),f=Object(O.useState)(),g=Object(h.a)(f,2),m=g[0],j=g[1];return Object(O.useEffect)((function(){var e=function getClosePeak(e,t){if(i&&b&&c===Ua.peakPicking.id){var n=[u().invert(t.x-e),u().invert(t.x+e)].sort((function(e,t){return e-t})),a=o.find((function(e){return e.id===i.id})),r=a.data.x.findIndex((function(e){return e>=n[1]}))-1,s=a.data.x.findIndex((function(e){return e>=n[0]})),p=a.data.y.slice(s,r);if(p&&p.length>0){var f=Object(zo.a)(p),h=p.findIndex((function(e){return e===f})),g=a.data.x[s+h];return{x:u()(g),y:d(i.id)(f)-(i&&l.flag&&l.stacked?(i.index+1)*l.value:0),xIndex:s+h}}}return null}(10,b);j(e)}),[i,o,r,b,u,d,c,l]),c!==Ua.peakPicking.id||!m||!i||"brushing"===p.step||!b||b.y<a.top||b.left<a.left||b.x>n-a.right||b.y>t-a.bottom?null:Object(A.jsx)("div",{style:{cursor:"crosshair",transform:"translate(".concat(m.x,"px, ").concat(m.y,"px)"),transformOrigin:"top left",position:"absolute",top:-(Ho+Yo),left:-(Ho+Yo),pointerEvents:"none",overflow:"visible"},children:Object(A.jsxs)("svg",{width:2*Ho+2*Yo,height:2*Ho+2*Yo,children:[Object(A.jsx)("circle",{cx:Ho+Yo,cy:Ho+Yo,r:Ho,stroke:Bo,strokeWidth:Xo,fillOpacity:Vo}),Object(A.jsx)("line",{x1:Ho+Yo,y1:Yo,x2:Ho+Yo,y2:2*Ho+Yo,stroke:Bo,strokeWidth:Xo}),Object(A.jsx)("line",{x1:Yo,y1:Ho+Yo,x2:2*Ho+Yo,y2:Ho+Yo,stroke:Bo,strokeWidth:Xo})]})},"peakPointer")},Uo={transformOrigin:"top left",position:"absolute",top:"0px",left:"0px",width:1,backgroundColor:"red"};var Ko=function VerticalIndicator(){var e=useChartData(),t=e.height,n=e.selectedTool,a=e.pivot,i=useScale().scaleX;return Ua.phaseCorrection.id!==n?null:Object(A.jsx)("div",{style:Object(f.a)(Object(f.a)({},Uo),{},{transform:"translate(".concat(i()(a),"px, 0px)"),height:t})})},Wo={cursor:"crosshair",transformOrigin:"bottom right",position:"absolute",top:"-18px",left:"-30px",pointerEvents:"none",overflow:"visible",userSelect:"none"};var Go=function XLabelPointer(){var e=useChartData(),t=e.height,n=e.width,a=e.margin,i=e.data,o=e.activeSpectrum,r=useScale().scaleX,c=Object(O.useContext)(F),l=Object(O.useContext)(E),s=Object(O.useMemo)((function(){return o?i.find((function(e){return e.id===o.id})):null}),[o,i]),u=useFormatNumberByNucleus(s&&s.info.nucleus),d=Object(O.useCallback)((function(e){if(s){var t=r().invert(e);return u(t)}}),[s,u,r]);return!o||"brushing"===l.step||!c||c.y<a.top||c.x<a.left||c.x>n-a.right||c.y>t-a.bottom?null:Object(A.jsx)("div",{style:Object(f.a)(Object(f.a)({},Wo),{},{transform:"translate(".concat(c.x,"px, ").concat(c.y,"px)")}),children:Object(A.jsx)("span",{children:d(c.x)})},"xLabelPointer")};var qo=function Viewer1D(e){var t=e.message,n=void 0===t?void 0:t,a=usePreferences().display.general,i=useChartData(),o=i.selectedTool,r=i.isLoading,c=i.data,l=i.mode,s=i.width,u=i.height,d=i.margin,b=i.activeSpectrum,p=i.xDomain,g=i.xDomains,m=i.yDomain,j=i.yDomains,v=i.verticalAlign,x=i.displayerKey,y=useDispatch(),k=$(),S=Object(O.useReducer)(scaleReducer,ga),w=Object(h.a)(S,2),T=w[0],M=w[1];Object(O.useEffect)((function(){p.length>0&&m.length>0&&s&&u&&M({type:ha,payload:{yDomain:m,yDomains:j,xDomain:p,xDomains:g,margin:d,height:u,width:s,verticalAlign:v,mode:l}})}),[u,d,l,v,s,p,g,m,j]);var E=Object(O.useCallback)((function(e){if(e.altKey)switch(o){case Ua.rangesPicking.id:a.disableMultipletAnalysis||k.show(Object(A.jsx)($n,Object(f.a)({data:c,activeSpectrum:b,scaleX:T.scaleX},e)),{onClose:function onClose(){k.close()}})}else if(e.shiftKey)switch(o){case Ua.integral.id:y(Object(f.a)({type:rt},e));break;case Ua.rangesPicking.id:y(Object(f.a)({type:qt},e));break;case Ua.multipleSpectraAnalysis.id:y(Object(f.a)({type:dn},e));break;case Ua.peakPicking.id:y(Object(f.a)({type:Ye},e));break;default:!function propagateEvent(){var t=e.startX,n=e.endX,a=T.scaleX().invert(t),i=T.scaleX().invert(n);oi.emit("brushEnd",Object(f.a)(Object(f.a)({},e),{},{range:[a,i].sort()}))}()}else switch(o){case Ua.baseLineCorrection.id:y({type:Vt,zone:{from:e.startX,to:e.endX}});break;default:null!=o&&y(Object(f.a)({type:Ot},e))}}),[T,o,a,k,c,b,y]),P=Object(O.useCallback)((function(){y({type:tt,zoomType:pa})}),[y]),I=Object(O.useCallback)((function(e){switch(o){case Ua.integral.id:y(Object(f.a)({type:yt},e));break;default:return void y(Object(f.a)({type:st},e))}}),[y,o]),F=Object(O.useCallback)((function(e){if(e.shiftKey)switch(o){case Ua.peakPicking.id:y({type:Ve,mouseCoordinates:e})}else switch(o){case Ua.phaseCorrection.id:y({type:Et,position:e.x});break;case"editRange":e.shiftKey&&function propagateEvent(){var t=T.scaleX().invert(e.x);oi.emit("mouseClick",Object(f.a)(Object(f.a)({},e),{},{xPPM:t}))}()}}),[y,T,o]),R=Object(C.a)((function(){return Object(A.jsxs)(O.Fragment,{children:[Object(A.jsx)(Nn,{isLoading:r,message:n}),T.scaleX&&T.scaleY&&c&&c.length>0&&Object(A.jsx)(BrushTracker,{onBrush:E,onDoubleClick:P,onClick:F,onZoom:I,style:{width:"100%",height:"100%",margin:"auto",position:"relative",overflow:"hidden"},children:Object(A.jsxs)(MouseTracker,{style:{width:"100%",height:"100%",position:"absolute"},children:[Object(A.jsx)(Lo,{}),Object(A.jsx)(ti,{}),Object(A.jsx)($a,{brushType:Ga}),Object(A.jsx)(Go,{}),Object(A.jsx)(Zo,{}),Object(A.jsx)(Ko,{}),Object(A.jsx)(_o,{}),Object(A.jsx)(vo,{width:s,height:u,margin:d,mode:l,displayerKey:x})]})})]})}),[]),_=Object(h.a)(R,2),N=_[0],L=_[1],z=L.width,H=L.height,B=Object(O.useState)(),X=Object(h.a)(B,2),Y=X[0],Z=X[1];return Object(D.a)((function(){return Z({width:z,height:H})}),400,[z,H]),Object(O.useEffect)((function(){Y&&isFinite(Y.width)&&isFinite(Y.height)&&y(Object(f.a)({type:Je},Y))}),[y,Y]),Object(A.jsx)(V,{value:T,children:N})},Jo={TOP_1D:"TOP_1D",LEFT_1D:"LEFT_1D",CENTER_2D:"CENTER_2D"};function getLayoutID(e,t){for(var n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];if(t.startX>=e[i].startX&&t.startX<=e[i].endX&&t.startY>=e[i].startY&&t.startY<=e[i].endY)return i}return null}function get2DXScale(e){var t=e.width,n=e.margin,a=e.xDomain;return Object(Qn.f)(a,[t-n.right,n.left])}function get2DYScale(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.height,a=e.margin,i=e.yDomain;return Object(Qn.f)(i,t?[n-a.bottom,a.top]:[a.top,n-a.bottom])}function get1DYScale(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return Object(Qn.f)(e,[t-n,n])}function ContoursPaths(e){var t=e.id,n=e.sign,a=e.color,i=useChartData(),o=i.margin,r=i.width,c=i.height,l=i.xDomain,s=i.yDomain,u=i.contours,d=i.activeSpectrum,b=usePreferences(),p=Object(O.useMemo)((function(){return null===d||t===d.id}),[d,t]);var f=Object(O.useMemo)((function(){return v()(u,"".concat(t,".").concat(n),[])}),[u,n,t]);return Object(A.jsx)("path",{fill:"none",stroke:a,strokeWidth:"1",style:{opacity:p?1:v()(b,"controllers.dimmedSpectraTransparency",.1)},d:function buildContourPath(e){for(var t=get2DXScale({margin:o,width:r,xDomain:l}),n=get2DYScale({margin:o,height:c,yDomain:s}),a="",i=0;i<e.length;i++)if(e[i].lines){var u=e[i].lines;if(u.length<1e6)for(var d=0;d<u.length;d+=4)a+="M".concat(t(u[d])," ").concat(n(u[d+1])," "),a+="L".concat(t(u[d+2])," ").concat(n(u[d+3])," ")}else{a+="M".concat(t(e[i][0].x)," ").concat(n(e[i][0].y)," ");for(var b=1;b<e[i].length;b++)a+="L".concat(t(e[i][b].x)," ").concat(n(e[i][b].y)," ")}return a||(a="M0 0 "),a+="Z"}(f)})}var $o,Qo=function Contours(){var e=useChartData(),t=e.data,n=e.displayerKey;return Object(A.jsx)("g",{clipPath:"url(#".concat(n,"clip-chart-2d)"),className:"contours",children:t.filter((function(e){return 2===e.info.dimension})).map((function(e,t){return Object(A.jsxs)("g",{children:[e.display.isPositiveVisible&&Object(A.jsx)(ContoursPaths,{id:e.id,sign:"positive",color:e.display.positiveColor}),e.display.isNegativeVisible&&Object(A.jsx)(ContoursPaths,{id:e.id,sign:"negative",color:e.display.negativeColor})]},"".concat(e.id+t))}))})},er={DM_1D:"1D",DM_2D:"2D"},tr={top:100,right:50,bottom:70,left:100},nr={top:10,right:10,bottom:70,left:10},ar=Object(m.b)($o||($o=Object(g.a)(["\n  stroke: lightgrey;\n  opacity: 0.7;\n"])));var ir=function IndicationLines(e){var t=e.axis,n=e.show,a=useChartData(),i=a.data,o=a.activeTab,r=a.margin,c=a.width,l=a.height,s=a.xDomain,u=a.yDomain,d=a.displayerMode,b=Object(O.useState)([]),p=Object(h.a)(b,2),f=p[0],g=p[1],m=get2DXScale({margin:r,width:c,xDomain:s}),j=get2DYScale({margin:r,height:l,yDomain:u});Object(O.useEffect)((function(){var e=o.split(",");if(d===er.DM_2D&&2===e.length){var n="X"===t?e[0]:"Y"===t?e[1]:null;if(null!==n){var a=i.filter((function(e){return 1===e.info.dimension&&!0===e.display.isVisible&&e.info.nucleus===n&&"1d"===e.info.experiment})).map((function(e){return e.ranges.values})).flat().map((function(e){return e.signal.filter((function(e){return Gi.some((function(t){return e.kind===t}))})).map((function(e){return e.delta}))})).flat();g(a)}else g([])}else g([])}),[o,t,i,d]);var v=Object(O.useMemo)((function(){if(!0===n&&f.length>0)return f.map((function(e,n){return"X"===t?Object(me.b)("line",{css:ar,x1:m(e),x2:m(e),y1:j(u[0]),y2:j(u[1])},"indicationLine".concat(t).concat(n)):"Y"===t?Object(me.b)("line",{css:ar,x1:m(s[0]),x2:m(s[1]),y1:j(e),y2:j(e)},"indicationLine".concat(t).concat(n)):null}))}),[t,f,m,j,n,s,u]);return Object(me.b)("g",{children:v})};function Left1DChart(e){var t=e.margin,n=e.data,a=useChartData(),i=a.height,o=a.margin,r=a.yDomain,c=a.yDomains,l=a.displayerKey,s=o.left,u=Object(O.useMemo)((function(){if(n){var e=get2DYScale({height:i,yDomain:[r[0],r[1]],margin:o}),a=get1DYScale(c[n.id],s,t),l=n.data,u=l.x,d=l.y,b=Object(Ln.n)({x:u,y:d},{from:r[0],to:r[1]}),p=b.x.length-1,f=b.y.length-1,h="M  ".concat(a(b.y[f])," ").concat(e(p)," ");return h+=b.x.slice(0,p).reduceRight((function(t,n,i){return t+=" L  ".concat(a(b.y[i])," ").concat(e(n))}),"")}return null}),[s,o,t,i,n,r,c]),d=i-o.bottom-o.top;return d&&s?Object(A.jsxs)("svg",{viewBox:"0 0 ".concat(s," ").concat(d+o.top),width:s,height:d+o.top,children:[Object(A.jsx)("defs",{children:Object(A.jsx)("clipPath",{id:"".concat(l,"clip-left"),children:Object(A.jsx)("rect",{width:s,height:d,x:"0",y:o.top})})}),Object(A.jsx)("g",{clipPath:"url(#".concat(l,"clip-left)"),children:Object(A.jsx)("path",{className:"line",stroke:"black",fill:"none",d:u})})]}):null}Left1DChart.defaultProps={margin:10};var or=Object(O.memo)(Left1DChart);function Top1DChart(e){var t=e.margin,n=e.data,a=useChartData(),i=a.width,o=a.margin,r=a.xDomain,c=a.yDomains,l=a.displayerKey,s=o.top,u=Object(O.useMemo)((function(){if(n){var e=get2DXScale({width:i,xDomain:r,margin:o}),a=get1DYScale(c[n.id],s,t),l=n.data,u=l.x,d=l.y,b=Object(Ln.n)({x:u,y:d},{from:r[0],to:r[1]}),p="M ".concat(e(b.x[0])," ").concat(a(b.y[0])," ");return p+=b.x.slice(1).reduce((function(t,n,i){return t+=" L ".concat(e(n)," ").concat(a(b.y[i+1]))}),"")}return null}),[s,t,o,n,i,r,c]);return i&&s?Object(A.jsxs)("svg",{viewBox:"0 0 ".concat(i," ").concat(s),width:i,height:s,children:[Object(A.jsx)("defs",{children:Object(A.jsx)("clipPath",{id:"".concat(l,"clip-top"),children:Object(A.jsx)("rect",{width:i-o.left-o.right,height:s,x:o.left,y:"".concat(0)})})}),Object(A.jsx)("g",{clipPath:"url(#".concat(l,"clip-top)"),children:Object(A.jsx)("path",{className:"line",stroke:"red",fill:"none",strokeWidth:"1px",d:u})})]}):null}Top1DChart.defaultProps={margin:10};var rr,cr=Object(O.memo)(Top1DChart),lr=Object(m.b)(rr||(rr=Object(g.a)(["\n  user-select: none;\n\n  path,\n  line {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    shape-rendering: crispEdges;\n    user-select: none;\n  }\n"])));function XAxis_XAxis(e){var t=e.show,n=e.label,a=e.margin,i=useChartData(),o=i.xDomain,r=i.height,c=i.width,l=i.margin,s=i.tabActiveSpectrum,u=i.activeTab,d=Object(O.useRef)();Object(O.useEffect)((function(){var e=Qn.a().ticks(8).tickFormat(Qn.d("0"));if(t){var n=get2DXScale({width:c,margin:l,xDomain:o});Qn.g(d.current).call(e.scale(n))}}),[u,r,l,l.bottom,l.left,l.right,l.top,t,s,c,o]);var b=Object(O.useMemo)((function(){return t&&!0===t&&Object(me.b)("g",{className:"x",css:lr,transform:"translate(0,".concat(r-(l.bottom+a.bottom),")"),ref:d,children:Object(me.b)("text",{fill:"#000",x:c-60,y:"20",dy:"0.71em",textAnchor:"end",children:n})})}),[r,n,l.bottom,a.bottom,t,c]);return c&&r?b:null}XAxis_XAxis.propTypes={margin:_i.a.shape({top:_i.a.number.isRequired,right:_i.a.number.isRequired,bottom:_i.a.number.isRequired,left:_i.a.number.isRequired}),show:_i.a.bool,label:_i.a.string},XAxis_XAxis.defaultProps={show:!0,label:"\u03b4 [ppm]",margin:{right:100,top:0,left:0,bottom:0}};var sr,ur=Object(O.memo)(XAxis_XAxis),dr=Object(m.b)(sr||(sr=Object(g.a)(["\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  path,\n  line {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    shape-rendering: crispEdges;\n    user-select: 'none';\n    -webkit-user-select: none; /* Chrome all / Safari all */\n    -moz-user-select: none; /* Firefox all */\n  }\n"])));function YAxis(e){var t=e.show,n=e.label,a=e.margin,i=Object(O.useRef)(),o=useChartData(),r=o.yDomain,c=o.width,l=o.height,s=o.activeTab,u=o.tabActiveSpectrum,d=o.margin;Object(O.useEffect)((function(){var e=Qn.b().ticks(8).tickFormat(Qn.d("0"));if(t&&r){var n=get2DYScale({height:l,yDomain:r,margin:d});Qn.g(i.current).call(e.scale(n))}}),[t,r,s,u,l,d]);var b=Object(O.useMemo)((function(){return t&&!0===t&&Object(me.b)(O.Fragment,{children:Object(me.b)("g",{className:"y",css:dr,transform:"translate(".concat(c-a.right,")"),ref:i,children:Object(me.b)("text",{fill:"#000",x:-a.top,y:-(a.right-5),dy:"0.71em",transform:"rotate(-90)",textAnchor:"end",children:n})})})}),[n,a.right,a.top,t,c]);return c&&l?b:null}YAxis.defaultProps={show:!0,label:"",margin:{right:50,top:0,bottom:0,left:0}};var br=Object(O.memo)(YAxis);var pr,fr=function ZonesWrapper(e){var t=function Wrapper(t){var n=useChartData(),a=n.data,i=n.activeSpectrum,o=n.xDomain,r=n.yDomain,c=n.activeTab,l=n.tabActiveSpectrum,s=n.displayerKey,u=usePreferences(),d=Object(O.useMemo)((function(){return a&&i&&i.id?a.find((function(e){return e.id===i.id}))||{zones:{},info:{},display:{}}:{}}),[i,a]),b=d.zones,p=void 0===b?{}:b,h=d.info,g=void 0===h?{}:h,m=d.display,j=void 0===m?{}:m,v=Object(O.useMemo)((function(){return l&&Object.keys(l).length>0?Object.keys(l):null}),[l]),x=t.forwardedRef,y=Object(le.a)(t,["forwardedRef"]);return Object(A.jsx)(e,Object(f.a)(Object(f.a)({},y),{},{zones:p,display:j,info:g,xDomain:o,yDomain:r,preferences:u,activeTab:c,nucleus:v,displayerKey:s,ref:x}))};return Object(O.memo)(Object(O.forwardRef)((function(e,n){return Object(A.jsx)(t,Object(f.a)(Object(f.a)({},e),{},{forwardedRef:n}))})))},hr=function getPubIntegral(e,t){return function getDiaIDs(e,t){return[].concat(e[t].diaID||[],e.signal?e.signal.map((function(e){return e[t].diaID||[]})).flat():[])}(e,t).length},gr=function setPubIntegral(e,t){e[t].pubIntegral=hr(e,t),0===e[t].pubIntegral&&delete e[t].pubIntegral},mr=function resetDiaIDs(e,t){return delete e[t].diaID,delete e.pubIntegral,e.signal.forEach((function(e){delete e[t].diaID})),e},jr=function unlink(e,t,n,a){return void 0!==t&&void 0!==a?(!0===t?delete e[a].diaID:void 0!==n&&delete e.signal[n][a].diaID,gr(e,a)):void 0!==a?(mr(e,a),gr(e,a)):["x","y"].forEach((function(t){mr(e,t),gr(e,t)})),e},vr=function unlinkInAssignmentData(e,t,n){var a=t.reduce((function(e,t){return e.push(t.id),t.signal&&e.concat(t.signal.map((function(e){return e.id}),[])),e}),[]);n?e.dispatch({type:"REMOVE_ALL",payload:{id:a,axis:n}}):(e.dispatch({type:"REMOVE_ALL",payload:{id:a,axis:"x"}}),e.dispatch({type:"REMOVE_ALL",payload:{id:a,axis:"y"}}))},Or=function buildID(e,t){return"".concat(e).concat("___").concat(t)},xr=Object(m.b)(pr||(pr=Object(g.a)(["\n  stroke: green;\n  stroke-width: 2;\n  opacity: 0.5;\n"])));var yr=function SignalDeltaLine(e){var t=e.delta,n=e.axis,a=e.show,i=useChartData(),o=i.margin,r=i.width,c=i.height,l=i.xDomain,s=i.yDomain,u=get2DXScale({margin:o,width:r,xDomain:l}),d=get2DYScale({margin:o,height:c,yDomain:s}),b=Object(O.useMemo)((function(){return!0===a?"X"===n?Object(me.b)("line",{css:xr,x1:u(t),x2:u(t),y1:d(s[0]),y2:d(s[1])},"signalLine_".concat(t,"_X")):"Y"===n?Object(me.b)("line",{css:xr,x1:u(l[0]),x2:u(l[1]),y1:d(t),y2:d(t)},"signalLine_".concat(t,"_Y")):null:null}),[n,t,u,d,a,l,s]);return Object(me.b)("g",{children:b})};var kr,Cr,Dr=function SignalCrosshair(e){var t=e.signal,n=Object(O.useMemo)((function(){return[Or(t.id,"Crosshair"),Or(t.id,"Crosshair_X")]}),[t.id]),a=Object(O.useMemo)((function(){return[Or(t.id,"Crosshair"),Or(t.id,"Crosshair_Y")]}),[t.id]),i=Object(pi.c)(n),o=Object(pi.c)(a);return Object(me.c)("g",{children:[Object(me.b)(yr,{delta:t.x.delta,axis:"X",show:i.isActive}),Object(me.b)(yr,{delta:t.y.delta,axis:"Y",show:o.isActive})]})},Sr=Object(O.memo)((function(e){var t=e.signal,n=e.isVisible,a=useChartData(),i=a.margin,o=a.width,r=a.height,c=a.xDomain,l=a.yDomain,s=get2DXScale({margin:i,width:o,xDomain:c}),u=get2DYScale({margin:i,height:r,yDomain:l}),d=Object(O.useCallback)((function(e){return[e].concat(Or(e,"X"),Or(e,"Y"))}),[]),b=useAssignment(t.id),p=Object(pi.c)(d(b.id)),f=Object(pi.d)(),g=Object(O.useState)(!1),m=Object(h.a)(g,2),j=m[0],v=m[1];return Object(O.useEffect)((function(){f.highlight.highlighted.some((function(e){return d(t.id).includes(e)}))||b.isActive?v(!0):v(!1)}),[b.isActive,d,f.highlight.highlighted,t.id]),t?Object(me.c)("g",{className:"zone-signal",onMouseEnter:function onMouseEnter(){b.onMouseEnter(),p.show()},onMouseLeave:function onMouseLeave(){b.onMouseLeave(),p.hide()},children:[n.signals&&Object(me.c)("g",{children:[Object(me.b)("circle",{cx:s(t.x.delta),cy:u(t.y.delta),r:j?6:4,fill:j?"green":"darkgreen"},t.id),Object(me.b)(Dr,{signal:t})]}),Object(me.b)("g",{className:"zone-signal-peak",children:n.peaks&&t.peak.map((function(e,n){return Object(me.b)("circle",{cx:s(e.x),cy:u(e.y),r:2,fill:"black"},"".concat(t.id+n))}))})]}):null})),wr=Object(m.b)(kr||(kr=Object(g.a)(["\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  // // disabled because Resizable component appears now when hovering over it\n  // :hover .range-area {\n  //   height: 100%;\n  //   fill: #ff6f0057;\n  //   cursor: pointer;\n  // }\n\n  .delete-button {\n    visibility: hidden;\n  }\n"]))),Tr=Object(m.b)(Cr||(Cr=Object(g.a)(["\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  .Integral-area {\n    // height: 100%;\n    fill: #ff6f0057;\n  }\n  .delete-button {\n    visibility: visible;\n    cursor: pointer;\n  }\n"]))),Mr=function Zone(e){var t=e.zoneData,n=e.isVisible,a=t.x,i=t.y,o=t.id,r=t.signal,c=useAssignment(o),l=Object(pi.c)([c.id],pi.b.ZONE),s=useChartData(),u=s.margin,d=s.width,b=s.height,p=s.xDomain,f=s.yDomain,g=get2DXScale({margin:u,width:d,xDomain:p}),m=get2DYScale({margin:u,height:b,yDomain:f}),j=a.from,v=a.to,x=i.from,y=i.to,k=Object(O.useState)(!1),C=Object(h.a)(k,2),D=C[0],S=C[1];return Object(O.useEffect)((function(){S(!function checkZoneKind(e){return e.kind===qi}(t))}),[t]),Object(me.c)("g",{css:l.isActive||c.isActive?Tr:wr,onMouseEnter:function onMouseEnter(){c.onMouseEnter(),l.show()},onMouseLeave:function onMouseLeave(){c.onMouseLeave(),l.hide()},children:[n.zones&&Object(me.b)("g",{transform:"translate(".concat(g(j),",").concat(m(x),")"),children:Object(me.b)("rect",{x:"0",width:g(v)-g(j),height:m(y)-m(x),className:"Integral-area",fill:"#0000000f",stroke:D?"#343a40":"darkgreen",strokeWidth:D?"0":"1"})}),r.map((function(e,t){return Object(me.b)(Sr,{signal:e,isVisible:n},"".concat(o+t))}))]},o)};Mr.defaultProps={onDelete:function onDelete(){return null}};var Ar=Mr,Er=fr((function Zones(e){var t=e.zones,n=e.display,a=e.displayerKey,i=Object(O.useState)({zones:!0,signals:!0,peaks:!0}),o=Object(h.a)(i,2),r=o[0],c=o[1];return Object(O.useEffect)((function(){oi.on("onZonesVisibilityChange",(function(e){var t=e.key;c((function(e){return Object(f.a)(Object(f.a)({},e),{},Object(ie.a)({},t,!e[t]))}))}))}),[]),Object(A.jsx)("g",{clipPath:"url(#".concat(a,"clip-chart-2d)"),className:"2D-Zones",children:n.isVisible&&t.values.map((function(e){return Object(A.jsx)("g",{className:"zone",children:Object(A.jsx)(Ar,{zoneData:e,isVisible:r})},e.id)}))})}));function Chart2D(e){var t=e.data,n=useChartData(),a=n.width,i=n.height,o=n.margin,r=n.displayerKey;return Object(O.useMemo)((function(){return Object(A.jsxs)("svg",{viewBox:"0 0 ".concat(a," ").concat(i),width:a,height:i,id:"nmrSVG",children:[Object(A.jsx)("defs",{children:Object(A.jsx)("clipPath",{id:"".concat(r,"clip-chart-2d"),children:Object(A.jsx)("rect",{width:a-o.left-o.right,height:i-o.top-o.bottom,x:o.left,y:o.top})})}),Object(A.jsx)("rect",{width:a-o.left-o.right,height:i-o.top-o.bottom,x:o.left,y:o.top,stroke:"black",strokeWidth:"1",fill:"transparent"}),t&&t[0]&&Object(A.jsx)(cr,{data:t[0]}),t&&t[1]&&Object(A.jsx)(or,{data:t[1]}),Object(A.jsx)(Qo,{}),Object(A.jsx)(Er,{}),Object(A.jsx)(ir,{axis:"X",show:!0}),Object(A.jsx)(ir,{axis:"Y",show:!0}),Object(A.jsxs)("g",{className:"container",style:{pointerEvents:"none"},children:[Object(A.jsx)(ur,{}),Object(A.jsx)(br,{})]})]})}),[a,i,r,o.left,o.right,o.top,o.bottom,t])}Chart2D.defaultProps={onDimensionChange:function onDimensionChange(){return null}},Chart2D.propsTypes={onDimensionChange:_i.a.func.isRequired};var Pr,Ir=Chart2D,Fr=n(240),Rr=Object(m.b)(Pr||(Pr=Object(g.a)(["\n  display: flex;\n  flex-firection: row;\n  align-items: center;\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n  background-color: #f7f7f7;\n  height: 30px;\n  padding: 6px;\n  color: #8d0018;\n  position: absolute;\n  width: 100%;\n  bottom: 0;\n  div {\n    margin: 0px 10px;\n    display: inline-block;\n\n    .label {\n      font-size: 12px;\n      color: #4d4d4d;\n      font-weight: bold;\n    }\n    .value {\n      font-weight: bold;\n      font-size: 14px;\n    }\n    .unit {\n      font-weight: bold;\n      font-size: 10px;\n    }\n  }\n"])));var _r=function FooterBanner_FooterBanner(e){var t=e.layout,n=e.data1D,a=Object(O.useContext)(F),i=Object(O.useContext)(E),o=i.startX,r=i.endX,c=i.startY,l=i.endY,s=i.step,u=useChartData(),d=u.margin,b=u.width,p=u.height,f=u.activeSpectrum,g=u.xDomain,m=u.yDomain,j=u.yDomains,v=u.activeTab,x=u.data,y=u.selectedTool,k=a&&getLayoutID(t,{startX:a.x,startY:a.y}),C=v.split(","),D=useFormatNumberByNucleus(C),S=Object(h.a)(D,2),w=S[0],T=S[1],M=Object(O.useMemo)((function(){if(!n||0===n.length)return get2DXScale({width:b,margin:d,xDomain:g});if(y!==Ua.slicingTool.id)switch(k){case Jo.TOP_1D:case Jo.CENTER_2D:return get2DXScale({width:b,margin:d,xDomain:g});case Jo.LEFT_1D:return get2DYScale({height:p,margin:d,yDomain:m});default:return null}return null}),[n,p,d,y,k,b,g,m]),A=Object(O.useMemo)((function(){if(!n||0===n.length)return get2DYScale({height:p,margin:d,yDomain:m});if(y!==Ua.slicingTool.id)switch(k){case Jo.CENTER_2D:return get2DYScale({height:p,margin:d,yDomain:m});case Jo.TOP_1D:return n[0]?get1DYScale(j[n[0].id],d.top):null;case Jo.LEFT_1D:return n[1]?get1DYScale(j[n[1].id],d.left):null;default:return null}return null}),[n,p,d,y,k,m,j]);if(!f||!a||a.y<10||a.x<10||a.x>b-d.right||a.y>p-d.bottom)return Object(me.b)("div",{css:Rr});var P=function getRealYValue(e){var t=null;if(k===Jo.TOP_1D?t=0:k===Jo.LEFT_1D&&(t=1),null!=t&&null!=M){var a=Object(Ln.f)(n[t].data.x,M.invert(e));return n[t].data.y[a]}return 1},I=function getXValue(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null!=M)switch(k){case Jo.CENTER_2D:case Jo.TOP_1D:return M.invert(e||a.x);case Jo.LEFT_1D:return M.invert(e||a.y);default:return 0}return 0},R=function getYValue(){if(null!=A)switch(k){case Jo.CENTER_2D:case Jo.TOP_1D:return A.invert(a.y);case Jo.LEFT_1D:return A.invert(a.x);default:return 0}return 0},_=function getLabel(e,t,n){return k===Jo.CENTER_2D?Object(me.c)(O.Fragment,{children:[e," ( ",Object(me.b)(Fr.a,{mf:n})," )"]}):t};return Object(me.c)("div",{css:Rr,children:[Object(me.c)("div",{children:[Object(me.c)("span",{className:"label",children:[_("F2","X",C[0])," :"]}),Object(me.b)("span",{className:"value",children:w(I())}),Object(me.b)("span",{className:"unit",children:"ppm"})]}),Object(me.c)("div",{children:[Object(me.c)("span",{className:"label",children:[_("F1","Y",C[1])," :"]}),Object(me.b)("span",{className:"value",children:T(R())}),Object(me.b)("span",{className:"unit",children:"ppm"})]}),Object(me.c)("div",{children:[Object(me.b)("span",{className:"label",children:"Intensity :"}),Object(me.b)("span",{className:"value",children:function getZValue(){if(k===Jo.CENTER_2D){var e=x[f.index].data,t=e.maxX,n=e.maxY,a=e.minX,i=e.minY,o=e.z,r=(t-a)/(o[0].length-1),c=(n-i)/(o.length-1),l=Math.floor((I()-a)/r),s=Math.floor((R()-i)/c);return l<0||l>=o[0].length||(s<0||s>=o.length)?0:o[s][l]}return 0}()})]}),"brushing"===s&&Object(me.c)("div",{children:[Object(me.b)("span",{className:"label",children:" \u0394ppm :"}),Object(me.b)("span",{className:"value",children:function getDeltaX(){switch(k){case Jo.TOP_1D:return(I(o)-I(r)).toPrecision(6);case Jo.LEFT_1D:return(I(c)-I(l)).toPrecision(6);default:return 0}}()})]}),"brushing"===s&&Object(me.c)("div",{children:[Object(me.b)("span",{className:"label",children:" ratio :"}),Object(me.c)("span",{className:"value",children:[function getRation(){switch(k){case Jo.TOP_1D:return(P(o)/(P(r)||Number.MIN_VALUE)*100).toFixed(2);case Jo.LEFT_1D:return(P(c)/(P(l)||Number.MIN_VALUE)*100).toFixed(2);default:return 0}}(),"%"]})]})]})},Nr={cursor:"crosshair",transformOrigin:"bottom right",position:"absolute",top:"-18px",left:"-88px",fontWeight:"bold",pointerEvents:"none",overflow:"visible",userSelect:"none",width:"85px",textAlign:"right"};var Lr=function XYLabelPointer(e){var t=e.layout,n=e.data1D,a=Object(O.useContext)(F),i=Object(O.useContext)(E).step,o=useChartData(),r=o.margin,c=o.width,l=o.height,s=o.activeSpectrum,u=o.xDomain,d=o.yDomain,b=o.yDomains,p=o.activeTab,g=a&&getLayoutID(t,{startX:a.x,startY:a.y}),m=useFormatNumberByNucleus(p.split(",")),j=Object(h.a)(m,2),v=j[0],x=j[1],y=Object(O.useMemo)((function(){if(!n||0===n.length)return get2DXScale({width:c,margin:r,xDomain:u});switch(g){case Jo.TOP_1D:case Jo.CENTER_2D:return get2DXScale({width:c,margin:r,xDomain:u});case Jo.LEFT_1D:return get2DYScale({height:l,margin:r,yDomain:d});default:return null}}),[n,l,r,g,c,u,d]),k=Object(O.useMemo)((function(){if(!n||0===n.length)return get2DYScale({height:l,margin:r,yDomain:d});switch(g){case Jo.CENTER_2D:return get2DYScale({height:l,margin:r,yDomain:d});case Jo.TOP_1D:return n[0]?get1DYScale(b[n[0].id],r.top):null;case Jo.LEFT_1D:return n[1]?get1DYScale(b[n[1].id],r.left):null;default:return null}}),[n,l,r,g,d,b]);return!s||"brushing"===i||!a||a.y<r.top||a.x<r.left||a.x>c-r.right||a.y>l-r.bottom?null:Object(A.jsxs)("div",{style:Object(f.a)(Object(f.a)({},Nr),{},{transform:"translate(".concat(a.x,"px, ").concat(a.y,"px)")}),children:[Object(A.jsx)("span",{children:x(function getYValue(){switch(g){case Jo.CENTER_2D:case Jo.TOP_1D:return k.invert(a.y);case Jo.LEFT_1D:return k.invert(a.x);default:return 0}}())}),Object(A.jsx)("span",{style:{color:"gray"},children:","}),Object(A.jsx)("span",{style:{color:"red"},children:v(function getXValue(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;switch(g){case Jo.CENTER_2D:case Jo.TOP_1D:return y.invert(e||a.x);case Jo.LEFT_1D:return y.invert(e||a.y);default:return 0}}())})]},"xLabelPointer")},zr=function Base(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var a=0;a<e.length;a++){var i=e.charAt(a),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError("".concat(i," is ambiguous"));t[o]=a}var r=e.length,c=e.charAt(0),l=Math.log(256)/Math.log(r);return{encode:function encode(t){if(0===t.length)return"";for(var n=0,a=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*l+1>>>0,u=new Uint8Array(s);i!==o;){for(var d=t[i],b=0,p=s-1;(0!==d||b<a)&&-1!==p;p--,b++)d+=256*u[p]>>>0,u[p]=d%r>>>0,d=d/r>>>0;if(0!==d)throw new Error("Non-zero carry");a=b,i++}for(var f=s-a;f!==s&&0===u[f];)f++;for(var h=c.repeat(n);f<s;++f)h+=e.charAt(u[f]);return h}}}("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),Hr=new Uint8Array(8);function generateID(){for(var e=0;e<8;e++)Hr[e]=Math.floor(256*Math.random());return zr.encode(Hr).substring(0,8)}function applyFilter(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=!1,i=Object(Pe.a)(n);try{for(i.s();!(t=i.n()).done;){var o=t.value,r={name:o.name,label:Za[o.name].name,value:o.options},c=lookupForFilter(e,o.name);if(c){var l=Za[o.name].reduce(c.value,r.value);l.once?(a||(a=!0),null!=l.reduce&&void 0!==l.reduce&&replaceFilter(e,c.id,l.reduce)):addFilter(e,r,!Object.prototype.hasOwnProperty.call(o,"isDeleteAllow")||o.isDeleteAllow)}else addFilter(e,r,!Object.prototype.hasOwnProperty.call(o,"isDeleteAllow")||o.isDeleteAllow)}}catch(b){i.e(b)}finally{i.f()}if(a)1===n.length&&isLastFilter(e,n[0].name)?Za[n[0].name].apply(e,n[0].options):reapplyFilters(e);else{var s,u=Object(Pe.a)(n);try{for(u.s();!(s=u.n()).done;){var d=s.value;Za[d.name].apply(e,d.options)}}catch(b){u.e(b)}finally{u.f()}}}function isLastFilter(e,t){var n=e.filters.findIndex((function(e){return e.name===t}));return e.filters.length===n+1}function lookupForFilter(e,t){return e.filters.find((function(e){return e.name===t}))}function reapplyFilters(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=t||e.filters;FiltersManager_enableFilter(e,null,null,n)}function FiltersManager_enableFilter(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e.filters=e.filters.slice(0),t&&(e.filters=e.filters.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{flag:e.id===t?n:e.flag})}),[])),e.data=Object(f.a)(Object(f.a)({},e.data),e.originalData),e.info=Object(f.a)(Object(f.a)({},e.info),e.originalInfo);var i=a||e.filters;for(var o in i){var r=e.filters[o];if(e.filters[o]=Object(f.a)(Object(f.a)({},e.filters[o]),{},{error:null}),r.flag)try{Za[r.name].apply(e,r.value)}catch(c){e.filters[o]=Object(f.a)(Object(f.a)({},e.filters[o]),{},{error:c.message})}}}function addFilter(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=generateID();e.filters=e.filters.slice(0),delete t.isSnapshot,e.filters.push(Object(f.a)(Object(f.a)({},t),{},{id:a,flag:!0,isDeleteAllow:n}))}function replaceFilter(e,t,n){e.filters=e.filters.slice(0);var a=e.filters.findIndex((function(e){return e.id===t}));delete e.filters[a].isSnapshot,e.filters[a]=Object(f.a)(Object(f.a)({},e.filters[a]),{},{value:n})}var Br=["#FFB300","#803E75","#FF6800","#A6BDD7","#C10020","#CEA262","#817066","#007D34","#F6768E","#00538A","#FF7A5C","#53377A","#FF8E00","#B32851","#F4C800","#7F180D","#93AA00","#593315","#F13A13","#232C16",""],Xr={cosy:{positiveColor:"darkblue",negativeColor:"blue"},roesy:{positiveColor:"pink",negativeColor:"yellow"},noesy:{positiveColor:"pink",negativeColor:"yellow"},tocsy:{positiveColor:"green",negativeColor:"yellow"},hsqc:{positiveColor:"black",negativeColor:"yellow"},hmbc:{positiveColor:"darkviolet",negativeColor:"yellow"}},Vr=function percentToHex(e){var t=Math.max(0,Math.min(100,e)),n=Math.round(t/100*255).toString(16);return 100===t?"":n.padStart(2,"0")},Yr=function adjustAlpha(e,t){return e+Vr(t)},Zr=function getColor(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,a=Br.filter((function(e){return!t.includes(e)}));if(a.length>0&&!e)return a[0]+Vr(n);var i=-.25,o=String("#".concat(Math.random().toString(16).slice(2,8).toUpperCase())).replace(/[^0-9a-f]/gi,"");o.length<6&&(o=o[0]+o[0]+o[1]+o[1]+o[2]+o[2]);var r,c,l="#";for(c=0;c<3;c++)r=parseInt(o.substr(2*c,2),16),r=Math.round(Math.min(Math.max(0,r+r*i),255)).toString(16),l+="00".concat(r).substr(r.length);return l+Vr(n)},Ur=Zr,Kr=n(206),Wr={minMaxRatio:.05,realTopDetection:!0,maxCriteria:!0,smoothY:!1,nH:100,compile:!0,frequencyCluster:16,clean:!0,keepPeaks:!0,sgOptions:{windowSize:7,polynomial:3}};var Gr=function detectSignal(e,t,n,a,i){var o=Object(Ln.g)(e,{from:n,to:a}),r=o.fromIndex,c=o.toIndex,l={x:e.slice(r,c),y:t.slice(r,c)},s=Object(zn.a)(l,{frequency:i,takeBestPartMultiplet:!0,symmetrizeEachStep:!0});return{multiplicity:s.j.map((function(e){return e.multiplicity})).join(""),kind:"signal",delta:s.chemShift,j:s.j}},qr=[];function initiateDatum1D(e){var t,n={};return n.shiftX=e.shiftX||0,n.id=e.id||generateID(),n.source=Object.assign({jcamp:null,jcampURL:null,original:[]},e.source),n.display=Object.assign(Object(f.a)(Object(f.a)({name:(null===(t=e.display)||void 0===t?void 0:t.name)?e.display.name:generateID(),color:"black"},function Datum1D_getColor(e){if(void 0===e.display||void 0===e.display.color){var t=Ur(!1,qr);return qr.push(t),{color:t}}return{}}(e)),{},{isVisible:!0,isPeaksMarkersVisible:!0,isRealSpectrumVisible:!0,isVisibleInDomain:!0}),e.display),n.info=Object.assign({nucleus:"1H",isFid:!1,isComplex:!1,dimension:1},e.info),n.originalInfo=n.info,n.meta=Object.assign({},e.meta),n.data=Object.assign({x:[],re:[],im:[],y:[]},e.data),n.originalData=n.data,n.peaks=Object.assign({values:[],options:{}},e.peaks),n.integrals=Object.assign({values:[],options:{sum:100}},e.integrals),n.filters=Object.assign([],e.filters),n.ranges=Object.assign({values:[],options:{sum:100}},e.ranges),reapplyFilters(n),function preprocessing(e){e.info.isFid&&-1===e.filters.findIndex((function(e){return e.name===Za.digitalFilter.id}))&&applyFilter(e,[{name:Za.digitalFilter.id,options:{digitalFilterValue:e.info.digitalFilter},isDeleteAllow:!1}])}(n),n.data.y=n.data.re,n}function lookupPeak(e,t){var n=t.from,a=t.to,i=e.x.findIndex((function(e){return e>=n})),o=e.x.findIndex((function(e){return e>=a}))-1;i>o&&(o=i=o);var r=e.re.slice(i,o);if(r&&r.length>0){var c=Object(zo.a)(r),l=r.findIndex((function(e){return e===c}));return{x:e.x[i+l],y:c,xIndex:i+l}}return null}function updateIntegralIntegrals(e){void 0===e.options.sum&&(e.options=Object(f.a)(Object(f.a)({},e.options),{},{sum:100}));e.values=updateRelatives(e.values,e.options.sum,"integral",(function countingCondition(e){return e.kind&&Gi.includes(e.kind)}))}function updateRelatives(e,t,n,a){var i=e.reduce((function(e,t){return a&&!0===a(t)?e+=Math.abs(t.absolute):e}),0),o=i>0?t/i:0;return e.map((function(e){return Object(f.a)(Object(f.a)({},e),{},Object(ie.a)({},n,e.absolute*o))}))}function updateIntegralRanges(e){void 0===e.ranges.options.sum&&(e.ranges.options.sum=100);e.ranges.values=updateRelatives(e.ranges.values,e.ranges.options.sum,"integral",(function countingCondition(e){return e.signal&&function checkSignalKinds(e,t){return!e.signal.some((function(e){return void 0===e.kind||!t.includes(e.kind)}))}(e,Gi)}))}function mapRanges(e,t){var n=t.data,a=n.x,i=n.re,o=getShiftX(t);return e.map((function(e){var t=Object(Ln.k)({x:a,y:i},{from:e.from,to:e.to,reverse:!0}),n=e.signal.map((function(e){return Object(f.a)({kind:"signal",id:generateID(),originDelta:e.delta-o},e)}));return Object(f.a)(Object(f.a)({kind:e.signal[0].kind||qi,originFrom:e.from-o,originTo:e.to-o},e),{},{id:generateID(),absolute:t,signal:n})}))}function detectRanges(e,t){t.impurities={solvent:e.info.solvent};var n=function autoRangesDetection(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(Ln.e)(e.data.re),a=e.data,i=a.re,o=a.x,r=e.info,c=r.originFrequency,l=r.nucleus,s=Object(f.a)(Object(f.a)({},Wr),t.peakPicking),u={frequency:c,nucleus:l,noiseLevel:3*n};return Object(Kr.f)({x:o,y:i},{peakPicking:s,ranges:u})}(e,t);e.ranges.values=e.ranges.values.concat(mapRanges(n,e)),updateIntegralRanges(e)}function updateXShift(e){var t=getShiftX(e);!function updatePeaksXShift(e,t){e.peaks.values=e.peaks.values.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{delta:e.originDelta+t})}))}(e,t),function updateRangesXShift(e,t){e.ranges.values=e.ranges.values.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{from:e.originFrom+t,to:e.originTo+t,signal:(null===e||void 0===e?void 0:e.signal)&&e.signal.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{delta:e.originDelta+t})}))})}))}(e,t),function updateIntegralXShift(e,t){e.integrals.values=e.integrals.values.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{from:e.originFrom+t,to:e.originTo+t})}))}(e,t)}function getShiftX(e){var t=(null===e||void 0===e?void 0:e.filters)&&(null===e||void 0===e?void 0:e.filters.find((function(e){return e.name===Za.shiftX.id})));return(null===t||void 0===t?void 0:t.flag)?t.value:0}var Jr=n(735),$r={positive:{contourLevels:[0,21],numberOfLayers:10},negative:{contourLevels:[0,21],numberOfLayers:10}},Qr=function(){function Processing2D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{positive:10,negative:10};Object(ea.a)(this,Processing2D),this.options=t;var a=n.positive,i=n.negative;this.currentLevelPositive=a,this.currentLevelNegative=i;var o=getRange(e.minX,e.maxX,e.z[0].length),r=getRange(e.minY,e.maxY,e.z.length);this.conrec=new Jr.a(e.z,{xs:o,ys:r,swapAxes:!1}),this.median=e.noise,this.minMax=e}return Object(ta.a)(Processing2D,[{key:"getLevel",value:function getLevel(){return{levelPositive:this.currentLevelPositive,levelNegative:this.currentLevelNegative}}},{key:"setLevel",value:function setLevel(e,t){this.currentLevelPositive=e,this.currentLevelNegative=t}},{key:"setOptions",value:function setOptions(e){var t=e.positive.contourLevels,n=e.negative.contourLevels;this.currentLevelPositive>=t[1]?this.currentLevelPositive=t[1]:this.currentLevelPositive<=t[0]&&(this.currentLevelPositive=t[0]),this.currentLevelNegative>=n[1]?this.currentLevelNegative=n[1]:this.currentLevelNegative<=n[0]&&(this.currentLevelNegative=n[0]),this.options=e}},{key:"wheel",value:function wheel(e){var t=Math.sign(e),n=this.options.positive.contourLevels,a=this.options.negative.contourLevels;(this.currentLevelPositive>n[0]&&-1===t||this.currentLevelPositive<n[1]&&1===t)&&(this.currentLevelPositive+=t),(this.currentLevelNegative>a[0]&&-1===t||this.currentLevelNegative<a[1]&&1===t)&&(this.currentLevelNegative+=t)}},{key:"shiftWheel",value:function shiftWheel(e){var t=Math.sign(e),n=Object(h.a)(this.options.positive.contourLevels,2),a=n[0],i=n[1];if(!(this.currentLevelPositive===a&&-1===t||this.currentLevelPositive>=i&&1===t))return this.currentLevelPositive+=t,[]}},{key:"drawContours",value:function drawContours(){var e=this.currentLevelPositive/2+1,t=this.currentLevelNegative/2+1,n=this.options,a=n.positive.numberOfLayers,i=n.negative.numberOfLayers;return{positive:this.getContours(e,{nbLevels:a}),negative:this.getContours(t,{negative:!0,nbLevels:i})}}},{key:"getContours",value:function getContours(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.negative,a=void 0!==n&&n,i=t.timeout,o=void 0===i?2e3:i,r=t.nbLevels,c=void 0===r?10:r,l=Math.max(Math.abs(this.minMax.maxZ),Math.abs(this.minMax.minZ)),s=getRange(1*this.median*Math.pow(2,e),l,c,2);a&&(s=s.map((function(e){return-e})));var u=[];try{u=this.conrec.drawContour({contourDrawer:"basic",levels:s,timeout:o})}catch(d){throw console.log(d),d}return u}}]),Processing2D}();function getRange(e,t,n,a){if(a){var i=[];i[0]=0;for(var o=1;o<=n;o++)i[o]=i[o-1]+(a-1)/Math.pow(a,o);for(var r=i[n],c=new Array(n),l=0;l<n;l++)c[l]=(t-e)*(1-i[l+1]/r)+e;return c}var s=(t-e)/(n-1);return function Processing2D_range(e,t,n){for(var a=[],i=e;i<t;i+=n)a.push(i);return a}(e,t+s/2,s)}var ec=[];function initiateDatum2D(e){var t={};return t.id=e.id||generateID(),t.source=Object.assign({jcamp:null,jcampURL:null,original:[]},e.source),t.display=Object.assign(Object(f.a)(Object(f.a)({name:e.display.name||generateID(),positiveColor:"red",negativeColor:"blue"},function Datum2D_getColor(e){if(void 0===e.display||void 0===e.display.negativeColor||void 0===e.display.positiveColor){var t=function get2DColor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!Xr[e]){var n=Zr(!1,t);return{positiveColor:n,negativeColor:Yr(n,50)}}return Xr[e]}(e.info.experiment,ec);return ec.push(t.positiveColor),t}return{}}(e)),{},{isPositiveVisible:!0,isNegativeVisible:!0,isVisible:!0,contourOptions:$r,dimension:2}),e.display),t.info=Object.assign({nucleus:["1H","1H"],isFid:!1,isComplex:!1},e.info),t.originalInfo=t.info,t.meta=Object.assign({},e.meta),t.data=Object.assign({z:[],minX:0,minY:0,maxX:0,maxY:0},e.data),t.originalData=t.data,t.filters=Object.assign([],e.filters),t.zones=Object.assign({values:[],options:{}},e.zones),t.processingController=new Qr(t.data,t.display.contourOptions),reapplyFilters(t),t}function getShift(e){var t={xShift:0,yShift:0};return(null===e||void 0===e?void 0:e.filters)&&(t=e.filters.reduce((function(e,t){return t.name===Za.shift2DX.id&&(e.xShift=(null===t||void 0===t?void 0:t.flag)?t.value:0),t.name===Za.shift2DY.id&&(e.yShift=(null===t||void 0===t?void 0:t.flag)?t.value:0),e}),{xShift:0,yShift:0})),t}function updateShift(e){var t=getShift(e);!function updateZonesShift(e,t){var n=t.xShift,a=t.yShift;e.zones.values=e.zones.values.map((function(e){var t;return Object(f.a)(Object(f.a)({},e),{},{signal:null===(t=e.signal)||void 0===t?void 0:t.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{x:Object(f.a)(Object(f.a)({},e.x),{},{delta:e.x.originDelta+n}),y:Object(f.a)(Object(f.a)({},e.y),{},{delta:e.y.originDelta+a})})}))})}))}(e,{xShift:t.xShift,yShift:t.yShift})}function Datum2D_getMissingProjection(e,t){var n=e.info.nucleus.indexOf(t);-1===n&&(n=0);var a={nucleus:e.info.nucleus[n],isFid:!1,isComplex:!1,dimension:1},i=0===n?e.data.minX:e.data.minY,o=0===n?e.data.maxX:e.data.maxY,r=0===n?e.data.z.length:e.data.z[0].length,c=new Float64Array(r);if(1===n)for(var l=0;l<e.data.z.length;l++)for(var s=0;s<e.data.z[0].length;s++)c[l]+=e.data.z[l][s];else for(var u=0;u<e.data.z[0].length;u++)for(var d=0;d<e.data.z.length;d++)c[u]+=e.data.z[d][u];return initiateDatum1D({info:a,data:{x:Object(Ln.o)({from:i,to:o},r),re:c}})}function getDetectionZones(e,t){var n={};return n=t.selectedZone?function getSubMatrix(e,t){for(var n=t.fromX,a=t.toX,i=t.fromY,o=t.toY,r=e.data,c=(r.maxX-r.minX)/r.z[0].length,l=(r.maxY-r.minY)/r.z.length,s=Math.floor((n-r.minX)/c),u=Math.floor((i-r.minY)/l),d=Math.floor((a-r.minX)/c),b=Math.floor((o-r.minY)/l),p={z:[],maxX:r.minX+d*c,minX:r.minX+s*c,maxY:r.minY+b*l,minY:r.minY+u*l},f=Number.MIN_SAFE_INTEGER,h=Number.MAX_SAFE_INTEGER,g=s-d+1,m=u;m<b;m++){for(var j=new Float32Array(g),v=s,O=0;O<g;O++)j[O]=r.z[m][v--];var x,y=Object(Pe.a)(j);try{for(y.s();!(x=y.n()).done;){var k=x.value;f<k&&(f=k),h>k&&(h=k)}}catch(C){y.e(C)}finally{y.f()}p.z.push(Array.from(j))}return p.minZ=h,p.maxZ=f,p}(e,t.selectedZone):e.data,t.info=e.info,function autoZonesDetection(e,t){var n=t.thresholdFactor,a=t.clean,i=t.maxPercentCutOff,o=t.enhanceSymmetry,r=t.convolutionByFFT,c=t.info,l=c.nucleus,s=c.originFrequency,u=l[0]===l[1];return Object(Kr.g)(e,{isHomoNuclear:u,nucleus:l,observeFrequencies:s,thresholdFactor:n,clean:a,maxPercentCutOff:i,enhanceSymmetry:o,convolutionByFFT:r})}(n,t)}function SliceScale_getYScale(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return Object(Qn.f)(Object(Qn.c)(t),[e-n,n])}function HorizontalSliceChart(e){var t=e.margin,n=e.data,a=useChartData(),i=a.width,o=a.margin,r=a.xDomain,c=a.displayerKey,l=o.top,s=Object(O.useMemo)((function(){if(n){var e=n.x,a=n.re,c=get2DXScale({margin:o,width:i,xDomain:r}),s=SliceScale_getYScale(l,a,t),u=Object(Ln.n)({x:e,y:a},{from:r[0],to:r[1]}),d="M ".concat(c(u.x[0])," ").concat(s(u.y[0])," ");return d+=u.x.slice(1).reduce((function(e,t,n){return e+=" L ".concat(c(t)," ").concat(s(u.y[n+1]))}),"")}return null}),[n,l,t,o,i,r]);return i&&l?Object(A.jsxs)("svg",{viewBox:"0 0 ".concat(i," ").concat(l),width:i,height:l,children:[Object(A.jsx)("defs",{children:Object(A.jsx)("clipPath",{id:"".concat(c,"clip-top"),children:Object(A.jsx)("rect",{width:i-o.left-o.right,height:l,x:o.left,y:"".concat(0)})})}),Object(A.jsxs)("g",{clipPath:"url(#".concat(c,"clip-top)"),children:[Object(A.jsx)("rect",{width:i-o.left-o.right,height:l,x:o.left,y:"".concat(0),fillOpacity:"0"}),Object(A.jsx)("path",{className:"line",stroke:"red",fill:"none",d:s})]})]}):null}HorizontalSliceChart.defaultProps={margin:10};var tc=Object(O.memo)(HorizontalSliceChart);function VerticalSliceChart(e){var t=e.margin,n=e.data,a=useChartData(),i=a.height,o=a.margin,r=a.yDomain,c=a.displayerKey,l=o.left,s=Object(O.useMemo)((function(){if(n){var e=n.x,a=n.re,c=get2DYScale({height:i,margin:o,yDomain:r}),s=SliceScale_getYScale(l,a,t),u=Object(Ln.n)({x:e,y:a},{from:r[0],to:r[1]}),d=u.x.length-1,b=u.y.length-1,p="M  ".concat(s(u.y[b])," ").concat(c(d)," ");return p+=u.x.slice(0,d).reduceRight((function(e,t,n){return e+=" L  ".concat(s(u.y[n])," ").concat(c(t))}),"")}return null}),[n,l,o,t,i,r]),u=i-o.bottom-o.top;return u&&l?Object(A.jsxs)("svg",{viewBox:"0 0 ".concat(l," ").concat(u+o.top),width:l,height:u+o.top,children:[Object(A.jsx)("defs",{children:Object(A.jsx)("clipPath",{id:"".concat(c,"clip-left"),children:Object(A.jsx)("rect",{width:l,height:u,x:"0",y:o.top})})}),Object(A.jsx)("g",{clipPath:"url(#".concat(c,"clip-left)"),children:Object(A.jsx)("path",{className:"line",stroke:"red",fill:"none",d:s})})]}):null}VerticalSliceChart.defaultProps={margin:10};var nc=Object(O.memo)(VerticalSliceChart);function SlicingView(){var e=useChartData(),t=e.width,n=e.height,a=e.margin,i=e.activeSpectrum,o=e.data,r=e.xDomain,c=e.yDomain,l=function useMouseTracker(){return Object(O.useContext)(F)}(),s=Object(O.useMemo)((function(){if(l&&i.id){var e=l.x,s=l.y,u=get2DXScale({margin:a,width:t,xDomain:r}),d=get2DYScale({margin:a,height:n,yDomain:c}),b=function getSlice(e,t){var n=e.data,a=(n.maxX-n.minX)/(n.z[0].length-1),i=(n.maxY-n.minY)/(n.z.length-1),o=Math.floor((t.x-n.minX)/a),r=Math.floor((t.y-n.minY)/i);if(!(o<0||o>=n.z[0].length)&&!(r<0||r>=n.z.length)){for(var c={nucleus:e.info.nucleus[0],isFid:!1,isComplex:!1,dimension:1},l={x:Object(Ln.o)({from:e.data.minX,to:e.data.maxX},e.data.z[0].length),re:new Float64Array(e.data.z[0].length)},s=0;s<e.data.z[0].length;s++)l.re[s]+=e.data.z[r][s];for(var u={nucleus:e.info.nucleus[1],isFid:!1,isComplex:!1,dimension:1},d={x:Object(Ln.o)({from:e.data.minY,to:e.data.maxY},e.data.z.length),re:new Float64Array(e.data.z.length)},b=e.data.z.length-1,p=0;p<e.data.z.length;p++)d.re[p]+=e.data.z[b--][o];return{horizontal:initiateDatum1D({info:c,data:l}),vertical:initiateDatum1D({info:u,data:d})}}}(o[i.index],{x:u.invert(e),y:d.invert(s)});return Object(A.jsxs)("svg",{viewBox:"0 0 ".concat(t," ").concat(n),width:t,height:n,style:{position:"absolute",backgroundColor:"rgba(255,255,255,0.8)"},children:[b&&b.horizontal&&Object(A.jsx)(tc,{data:b.horizontal.data}),b&&b.vertical&&Object(A.jsx)(nc,{data:b.vertical.data})]})}return null}),[l,i.id,i.index,a,t,r,n,c,o]);return l?s:null}SlicingView.defaultProps={onDimensionChange:function onDimensionChange(){return null}},SlicingView.propsTypes={onDimensionChange:_i.a.func.isRequired};var ac=SlicingView;var ic=function Viewer2D(e){var t=e.message,n=void 0===t?void 0:t,a=useChartData(),i=a.selectedTool,o=a.isLoading,r=a.data,c=a.margin,l=a.tabActiveSpectrum,s=a.activeTab,u=useDispatch(),d=Object(O.useMemo)((function(){return s.split(",").reduce((function(e,t){if(l[t]&&l[t].id){var n=l[t].id,a=r.find((function(e){return e.id===n&&!e.info.isFid}));a&&e.push(a)}else e.push(null);return e}),[])}),[s,r,l]),b=function get2DDimensionLayout(e){var t=e.width,n=e.height,a=e.margin;return{CENTER_2D:{startX:a.left,startY:a.top,endX:t-a.right,endY:n-a.bottom},TOP_1D:{startX:a.left,startY:0,endX:t-a.right,endY:a.top},LEFT_1D:{startX:0,startY:a.top,endX:a.left,endY:n-a.bottom}}}(a),p=Object(O.useCallback)((function(e){if(getLayoutID(b,e))if(e.altKey)i;else if(e.shiftKey)switch(i){case Ua.zone2D.id:u(Object(f.a)({type:$t},e))}else if(null!=i)return u(Object(f.a)(Object(f.a)({type:Ot},e),{},{trackID:getLayoutID(b,e)}))}),[i,u,b]),g=Object(O.useCallback)((function(e){var t=e.x,n=e.y,a=getLayoutID(b,{startX:t,startY:n});a&&u({type:tt,trackID:a})}),[b,u]),m=function handleZoom(e){var t=e.x,n=e.y,a=getLayoutID(b,{startX:t,startY:n});a&&u("CENTER_2D"===a?Object(f.a)({type:Jt},e):Object(f.a)(Object(f.a)({type:st},e),{},{trackID:a}))},j=Object(O.useCallback)((function(e){e.x,e.y}),[i]),v=Object(C.a)((function(){return Object(A.jsxs)(O.Fragment,{children:[Object(A.jsx)(Nn,{isLoading:o,message:n}),r&&r.length>0&&Object(A.jsx)(BrushTracker,{onBrush:p,onDoubleClick:g,onClick:j,onZoom:m,style:{width:"100%",height:"100%",margin:"auto",position:"relative",overflow:"hidden"},children:Object(A.jsxs)(MouseTracker,{style:{width:"100%",height:"100%",position:"absolute"},children:[i&&i===Ua.slicingTool.id&&Object(A.jsx)(ac,{}),Object(A.jsx)(ti,{}),d&&Object(A.jsx)(Lr,{data1D:d,layout:b}),Object(A.jsx)($a,{brushType:Ja,dimensionBorder:b.CENTER_2D}),Object(A.jsxs)(A.Fragment,{children:[d&&d[0]&&Object(A.jsx)($a,{brushType:Ga,dimensionBorder:b.TOP_1D,height:c.top}),d&&d[1]&&Object(A.jsx)($a,{brushType:qa,dimensionBorder:b.LEFT_1D,width:c.left})]}),d&&Object(A.jsx)(_r,{data1D:d,layout:b}),Object(A.jsx)(Ir,{data:d})]})})]})}),[]),x=Object(h.a)(v,2),y=x[0],k=x[1],S=k.width,w=k.height,T=Object(O.useState)(),M=Object(h.a)(T,2),E=M[0],P=M[1];return Object(D.a)((function(){return P({width:S,height:w})}),400,[S,w]),Object(O.useEffect)((function(){E&&isFinite(E.width)&&isFinite(E.height)&&u(Object(f.a)({type:Je},E))}),[u,E]),y},oc=n(47),rc=n(90),cc={container:{margin:"25px"},header:{backgroundColor:"#ffffff",padding:"20px",borderRadius:"10px",fontSize:"30px",textAlign:"center"},body:{whiteSpace:"pre-wrap",backgroundColor:"white",padding:"20px",borderRadius:"10px",color:"red"}},lc=function(e){Object(oc.a)(ErrorBoundary,e);var t=Object(rc.a)(ErrorBoundary);function ErrorBoundary(e){var n;return Object(ea.a)(this,ErrorBoundary),(n=t.call(this,e)).state={error:null,errorInfo:null},n}return Object(ta.a)(ErrorBoundary,[{key:"componentDidCatch",value:function componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}},{key:"render",value:function render(){return this.state.errorInfo?Object(A.jsxs)("div",{style:cc.container,children:[Object(A.jsx)("p",{style:cc.header,children:"Something went wrong."}),Object(A.jsxs)("details",{style:cc.body,children:[this.state.error,Object(A.jsx)("br",{}),this.state.errorInfo.componentStack]})]}):this.props.children}}]),ErrorBoundary}(O.Component),sc=Object(O.createContext)(),uc=sc.Provider,dc=function useAlert(){return Object(O.useContext)(sc)};function Alert_Provider_Provider(e){var t=e.children,n=e.wrapperRef,a=e.offset,i=e.position,o=e.timeout,r=e.type,c=e.transition,l=Object(le.a)(e,["children","wrapperRef","offset","position","timeout","type","transition"]),s=Object(O.useRef)(null),u=Object(O.useRef)(null),d=Object(O.useRef)([]),b=Object(O.useState)([]),p=Object(h.a)(b,2),g=p[0],m=p[1];Object(O.useEffect)((function(){s.current=document.createElement("div");var e=s.current,t=d.current;return n&&n.appendChild(e),function(){e&&n&&(t.forEach(clearTimeout),n.removeChild(e))}}),[n]);var j=Object(O.useCallback)((function(e){m((function(t){var n=t.length,a=t.filter((function(t){return t.id!==e.id}));return n>a.length&&e.options.onClose&&e.options.onClose(),a}))}),[]),v=Object(O.useCallback)((function(){u.current.alerts.forEach(j)}),[j]),x=Object(O.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Math.random().toString(36).substr(2,9),a=Object(f.a)({position:t.position||i,timeout:o,type:r,backgroundColor:"black",color:"white"},t),c={id:n,message:e,options:a,close:function(){return j(c)}};if(c.options.timeout){var l=setTimeout((function(){j(c),d.current.splice(d.current.indexOf(l),1)}),c.options.timeout);d.current.push(l)}return m((function(e){return e.concat(c)})),c.options.onOpen&&c.options.onOpen(),c}),[i,j,o,r]),y=Object(O.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.type=U,t=Object(f.a)({backgroundColor:"#28ba62",color:"white"},t),x(e,t)}),[x]),k=Object(O.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.type=K,t=Object(f.a)({backgroundColor:"#cf3c4f",color:"white"},t),x(e,t)}),[x]),C=Object(O.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.type=Z,t.color="#28ba62",x(e,t)}),[x]),D=Object(O.useCallback)((function(e){j(e)}),[j]),S=Co(g,(function(e){return e.options.position})),w=Object(O.useMemo)((function(){return n?n.getBoundingClientRect():{top:0,left:0,width:window.innerWidth,height:window.innerHeight}}),[n]);return Object(A.jsxs)(uc,{value:{alerts:g,show:x,remove:j,removeAll:v,success:y,error:k,info:C},children:[t,s.current&&Object(oe.createPortal)(Object(A.jsx)(O.Fragment,{children:Object.keys(Y).map((function(e){var t=Y[e];return Object(A.jsx)(ce.a,Object(f.a)(Object(f.a)({appear:!0,options:{position:t,zIndex:999999},component:ge,containerStyle:w},l),{},{children:S[t]?S[t].map((function(e){return Object(A.jsx)(pe,{type:c,children:Object(A.jsxs)("div",{style:{margin:a,padding:"25px",borderRadius:"10px",pointerEvents:"all",backgroundColor:e.options.backgroundColor,color:e.options.color,minHeight:"60px",position:"relative"},children:[Object(A.jsx)("button",{style:{position:"absolute",right:"5px",top:"5px",border:"none",backgroundColor:"transparent",color:"white"},type:"button",onClick:function onClick(){return D(e)},children:Object(A.jsx)(_e.G,{})}),Object(A.jsx)("span",{children:e.message})]},e.id)},e.id)})):null}),t)}))}),s.current)]})}Alert_Provider_Provider.defaultProps={offset:"5px",position:Y.BOTTOM_CENTER,transition:W,wrapperRef:null,timeout:3e3};var bc=Alert_Provider_Provider,pc=n(730);function fromBruker(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.dependentVariables,a=e.info,i=e.meta,o=getData(n[0].components);o.im&&(a.isComplex=!0),Array.isArray(a.nucleus)&&(a.nucleus=a.nucleus[0]);var r=initiateDatum1D(Object(f.a)(Object(f.a)({},t),{},{info:a,meta:i,data:o,source:{jcamp:null,jcampURL:null,original:o}}));return r}function fromCSD(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.dimensions[0],a=e.dependentVariables,i=n.quantityName,o=n.count,r=n.increment.magnitude,c=n.originOffset.magnitude,l=n.coordinatesOffset.magnitude,s=a[0].components[0],u=[],d=[],b=s.length-1;b>0;b-=2)u.push(s[b-1]),d.push(s[b]);var p,h,g={};switch(i){case"frequency":h=0+l/c*1e6,p=r/c*1e6,g.re=u,g.im=d;break;case"time":h=c,p=r,g.re=u.reverse(),g.im=d.reverse().map((function(e){return-e}))}for(var m=[],j=0;j<o;j++)m.push(h+j*p);g.x=m;var v=initiateDatum1D(Object(f.a)(Object(f.a)({},t),{},{meta:t.meta,data:g,source:{jcamp:null,jcampURL:null,original:g}}));return v}function getData(e){var t=e[0]&&e[0].data&&e[0].data.x?e[0].data.x:[],n=e[0]&&e[0].data&&e[0].data.y?e[0].data.y:[],a=e[1]&&e[1].data&&e[1].data.y?e[1].data.y:null;return t[0]>t[1]&&(t.reverse(),n.reverse(),a&&a.reverse()),{x:t,re:n,im:a}}function Data2DManager_fromBruker(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.dependentVariables,a=e.meta,i=n[0].components,o=initiateDatum2D(Object(f.a)(Object(f.a)({},t),{},{meta:a,data:i,source:{jcamp:null,jcampURL:null,original:i}}));return o}function Data2DManager_fromCSD(e){var t=initiateDatum2D({});return t}function addJcampFromURL(e,t,n){return fetch(t).then((function(e){return e.text()})).then((function(t){addJcamp(e,t,n)}))}function addJcamp(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=Object(pc.b)(t,{noContour:!0,xy:!0,keepRecordsRegExp:/.*/,profiling:!0});if(0!==a.length){var i,o=Object(Pe.a)(a);try{for(o.s();!(i=o.n()).done;){var r=i.value,c=r.dependentVariables;c[0].components&&(c[0].components.length>0||c[0].components.z.length)&&addJcampSS(e,r,n)}}catch(l){o.e(l)}finally{o.f()}}}function addJcampSS(e,t,n){var a=t.info.dimension;1===a&&e.push(function fromParsedJcamp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.dependentVariables,a=e.info,i=e.meta,o=getData(n[0].components);return Array.isArray(a.nucleus)&&(a.nucleus=a.nucleus[0]),initiateDatum1D(Object(f.a)(Object(f.a)({},t),{},{info:a,meta:i,data:o,source:{jcamp:null,jcampURL:t.source&&t.source.jcampURL?t.source.jcampURL:null,original:o}}))}(t,n)),2===a&&e.push(function Data2DManager_fromParsedJcamp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.dependentVariables,a=e.info,i=e.meta,o=n[0].components;return initiateDatum2D(Object(f.a)(Object(f.a)({},t),{},{info:a,meta:i,data:o,source:{jcamp:null,jcampURL:t.source&&t.source.jcampURL?t.source.jcampURL:null,original:o}}))}(t,n))}function addData(e,t){var n=t.info.dimension;1===n&&e.push(initiateDatum1D(Object(f.a)(Object(f.a)({},t),{},{data:t.source.original}))),2===n&&e.push(initiateDatum2D(Object(f.a)(Object(f.a)({},t),{},{data:t.source.original})))}function addJDF(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=Object(pc.c)(t,{}),i=a.description,o=i.metadata;delete i.metadata,i.acquisitionMode=0,i.experiment=1===i.dimension?"1d":"2d",i.type="NMR SPECTRUM",i.nucleus=i.nucleus[0],i.numberOfPoints=i.numberOfPoints[0],i.acquisitionTime=i.acquisitionTime[0],i.baseFrequency=i.baseFrequency[0],i.frequencyOffset=i.frequencyOffset[0],i.spectralWidthClipped=a.application.spectralWidthClipped,1===i.dimension&&a.dependentVariables&&e.push(fromCSD(a,Object(f.a)(Object(f.a)({},n),{},{display:Object(f.a)({},n.display),info:i,meta:o}))),2===i.dimension&&i.isFt&&e.push(Data2DManager_fromCSD(a,Object(f.a)(Object(f.a)({},n),{},{display:Object(f.a)({},n.display),info:i})))}function _fromJSON(){return(_fromJSON=Object(Ae.a)(Me.a.mark((function _callee(){var e,t,n,a,i,o,r=arguments;return Me.a.wrap((function _callee$(c){for(;;)switch(c.prev=c.next){case 0:e=r.length>0&&void 0!==r[0]?r[0]:[],t=[],n=[],a=Object(Pe.a)(e);try{for(a.s();!(i=a.n()).done;)null!=(o=i.value).source.jcamp?addJcamp(t,o.source.jcamp,o):null!=o.source.jcampURL?n.push(addJcampFromURL(t,o.source.jcampURL,o)):addData(t,o)}catch(l){a.e(l)}finally{a.f()}return c.next=7,Promise.all(n);case 7:return c.abrupt("return",t);case 8:case"end":return c.stop()}}),_callee)})))).apply(this,arguments)}function addBruker(e,t){return _addBruker.apply(this,arguments)}function _addBruker(){return(_addBruker=Object(Ae.a)(Me.a.mark((function _callee2(e,t){var n,a,i,o,r,c,l,s;return Me.a.wrap((function _callee2$(u){for(;;)switch(u.prev=u.next){case 0:return n=[],u.next=3,Object(pc.a)(t,{xy:!0,noContours:!0});case 3:a=u.sent,i=a,o=Object(Pe.a)(i);try{for(o.s();!(r=o.n()).done;)c=r.value,l=c.info,s=c.dependentVariables,1===l.dimension?s[0].components&&n.push(fromBruker(c,Object(f.a)(Object(f.a)({},e),{},{display:Object(f.a)({},e.display)}))):2===l.dimension&&l.isFt&&n.push(Data2DManager_fromBruker(c,Object(f.a)(Object(f.a)({},e),{},{info:l,display:Object(f.a)({},e.display)})))}catch(d){o.e(d)}finally{o.f()}return u.abrupt("return",n);case 8:case"end":return u.stop()}}),_callee2)})))).apply(this,arguments)}function SpectraManager_toJSON(e){var t=e||{data:[],molecules:[],preferences:{},correlations:{},multipleAnalysis:{}},n=t.data,a=t.molecules,i=t.preferences,o=t.correlations,r=t.multipleAnalysis;return{spectra:n.map((function(e){return 1===e.info.dimension?function toJSON(e){return{data:e.originalData,id:e.id,source:{jcamp:e.source.jcamp,jcampURL:e.source.jcampURL,original:e.source.jcampURL||e.source.jcamp?[]:e.source.original},display:e.display,info:e.originalInfo,meta:e.meta,peaks:e.peaks,integrals:e.integrals,ranges:e.ranges,filters:e.filters}}(e):function Datum2D_toJSON(e){return{data:e.originalData,id:e.id,source:{jcamp:e.source.jcamp,jcampURL:e.source.jcampURL,original:e.source.jcampURL?[]:e.source.original},zones:e.zones,filters:e.filters,display:e.display,info:e.originalInfo,meta:e.meta}}(e)})),molecules:a,preferences:i,correlations:o,multipleAnalysis:r}}var fc=n(211),hc=n(263),gc=n(204),mc=n.n(gc);function getToFix(e){Array.isArray(e)||(e=[e]);var t,n=[],a=Object(Pe.a)(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;n.push(chooseDecimal(i))}}catch(o){a.e(o)}finally{a.f()}return n}function chooseDecimal(e){switch(e.toUpperCase()){case"1H":return 2;case"13C":default:return 1}}function get1DSignals(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=a.prefix,o=a.nmrRecord,r="",c=[],l=0,s=Object(Pe.a)(e);try{var u=function _loop(){var e=n.value;if(e.info.dimension>1)return"continue";var a=e.ranges.values||[],s=e.info.nucleus,u=1,d="";c.forEach((function(e){e===s&&u++})),c.push(s),u>1&&(d="#".concat(u)),r+="".concat(i,"1D_").concat(s.toUpperCase()).concat(d,">"),e.info.frequency&&(r+="\nLarmor=".concat(Number(e.info.frequency).toFixed(2),"\\")),r+="\nSpectrum_Jcamp=file:./jcamp_folder/1d/".concat(e.display.name,"\\"),e.source.jcamp&&o.file("jcamp_folder/1d/".concat(e.display.name),e.source.jcamp);var b,p=getToFix(s)[0],f=Object(Pe.a)(a);try{for(f.s();!(b=f.n()).done;){var h,g=b.value,m=g.signal,j=Object(Pe.a)(m);try{for(j.s();!(h=j.n()).done;){var v=h.value,O=v.multiplicity;if(O&&"m"!==O||"1H"!==s){if(!v.delta)continue;r+="\n".concat(Number(v.delta).toFixed(p))}else r+="\n".concat(Number(g.from).toFixed(p),"-").concat(Number(g.to).toFixed(p));var x="";if(v.diaID&&v.diaID.length>0&&(v.diaID.forEach((function(e,n,a){var i=", ";n===a.length-1&&(i="");var o=t.byDiaID[e].label||e;x+="(".concat(o,")").concat(i)})),r+=", L=".concat(x)),"1H"===s){v.multiplicity&&(r+=", S=".concat(v.multiplicity));var y=v.j;if(Array.isArray(y)&&y.length)for(var k=", J=",C=0;C<y.length;C++){if(r+="".concat(k).concat(Number(y[C].coupling).toFixed(3)),y[C].diaID){var D=y[C].diaID;if(Array.isArray(D)||(D=[D]),!D.length)continue;var S=t[D[0]].label||String(D[0]);r+="(".concat(S,")")}k=", "}g.integral?r+=", E=".concat(Number(g.integral).toFixed(p)):g.pubIntegral?r+=", E=".concat(g.putIntegral.toFixed(p)):void 0!==g.signal[0].nbAtoms&&(r+=", E=".concat(g.signal[0].nbAtoms))}}}catch(w){j.e(w)}finally{j.f()}m.length&&(r+="\\")}}catch(w){f.e(w)}finally{f.f()}r+="\n",l++};for(s.s();!(n=s.n()).done;)u()}catch(d){s.e(d)}finally{s.f()}return l>0&&o.folder("jcamp_folder/1d"),r}function getCouplingObserved(e){switch(e.toLowerCase()){case"hsqc":case"cosy":return"1J";case"hmbc":default:return"NJ"}}var jc=Array.isArray;function get2DSignals(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=a.prefix,o=a.nmrRecord,r=t.byDiaID,c="",l=[],s=0,u=Object(Pe.a)(e);try{for(u.s();!(n=u.n()).done;){var d=n.value;if(!(d.info.dimension<2)){var b=d.info,p=b.nucleus,f=b.experiment,h=b.pulseSequence;f&&(i="\n> 2D ".concat(f," <NMREDATA_2D_")),l.push(p);var g=getCouplingObserved(f);p&&(c+="".concat(i).concat(p[1],"_").concat(g,"_").concat(p[0],">"));var m=getToFix(p);c+="\nLarmor=".concat(Number(d.info.baseFrequency[0]).toFixed(2),"\\"),c+="\nSpectrum_Jcamp=file:./jcamp_folder/2d/".concat(d.display.name,"\\"),d.source.jcamp&&o.file("jcamp_folder/2d/".concat(d.display.name),d.source.jcamp),f&&(c+="\nCorType=".concat(f," \\")),h&&(c+="\nPulseProgram=".concat(h," \\"));var j,v=d.zones.values||[],O=Object(Pe.a)(v);try{for(O.s();!(j=O.n()).done;){var x,y=j.value,k=y.signal,C=Object(Pe.a)(k);try{for(C.s();!(x=C.n()).done;){var D=x.value,S=D.x,w=D.y,T=D.peak,M=getAssignment(S,r,m[0]),A=getAssignment(w,r,m[1]),E=Math.max.apply(Math,Object(Ee.a)(T.map((function(e){return e.z}))));c+="\n".concat(M,"/").concat(A,", I=").concat(E.toFixed(2),"\\")}}catch(P){C.e(P)}finally{C.f()}}}catch(P){O.e(P)}finally{O.f()}s++}}}catch(P){u.e(P)}finally{u.f()}return s>0&&o.folder("jcamp_folder/2d"),c}function getAssignment(e,t,n){var a=e.diaID,i=e.delta;if(a){jc(a)||(a=[a]),a.length<1&&Number(i).toFixed(n);var o=a.map((function(e){return t[e].label})).join(",");return a.length>1?"(".concat(o,")"):o}return Number(i).toFixed(n)}function flat2DSignals(e){for(var t=[],n=0;n<e.length;n++){var a=e[n],i=a.x,o=a.y;t.push(i,o)}return t}function getLabels(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.groupedDiaIDs,i=n.molecule,o=Object(hc.g)(i,{toLabel:"H",maxLength:1}),r={},c={},l=Object(Pe.a)(e);try{for(l.s();!(t=l.n()).done;){var s,u=t.value,d=u.info,b=d.dimension,p=d.nucleus,f=getToFix(p),g=b>1?["zones",flat2DSignals]:["ranges",function(e){return e||[]}],m=Object(h.a)(g,2),j=m[0],v=m[1],O=u[j].values||[],x=Object(Pe.a)(O);try{for(x.s();!(s=x.n()).done;)for(var y=s.value,k=v(y.signal),C=0;C<k.length;C++){var D,S=k[C].diaID||[],w=Object(Pe.a)(S);try{var T=function _loop(){var e=D.value,t=Number(k[C].delta).toFixed(f[C%b]),n=a.find((function(t){return t.oclID===e})),l={atom:n.atoms[0],molecule:i,connections:o,atomLabel:n.atomLabel};r[e]={atoms:n.atoms.map((function(e){return e+1})),shift:t,label:createLabel(l)};var s,u=Object(Pe.a)(n.atoms);try{for(u.s();!(s=u.n()).done;){var d=s.value;l.atom=d,c[d]={shift:t,diaID:e,label:createLabel(l)}}}catch(p){u.e(p)}finally{u.f()}};for(w.s();!(D=w.n()).done;)T()}catch(M){w.e(M)}finally{w.f()}}}catch(M){x.e(M)}finally{x.f()}}}catch(M){l.e(M)}finally{l.f()}return{byAssignNumber:c,byDiaID:r}}function createLabel(e){var t=e.atom,n=e.molecule,a=e.atomLabel,i=e.connections,o="";if("C"!==a){var r=i[t].find((function(e){return e&&e.length>1})),c="".concat(a).concat(r[0]+1),l="".concat(n.getAtomLabel(r[1])).concat(r[1]+1);o="".concat(c).concat(l)}else o="".concat(a).concat(t+1);return o}var vc={solvent:"SOLVENT",temperature:"TEMPERATURE",assignment:"ASSIGNMENT",j:"J",signals:"SIGNALS",id:"ID"};function formatAssignments(e,t){var n=t.prefix,a="".concat(n+vc.assignment,">\n");for(var i in e){var o=e[i].atoms;a+="".concat(e[i].label,", ").concat(e[i].shift);var r,c=Object(Pe.a)(o);try{for(c.s();!(r=c.n()).done;){var l=r.value;a+=", ".concat(l)}}catch(s){c.e(s)}finally{c.f()}a+="\\\n"}return a}function putTag(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=a.prefix,o="",r=Object(Pe.a)(e);try{for(r.s();!(n=r.n()).done;){var c=n.value;if(c.info[t]){o+="".concat(i+vc[t],">\n").concat(String(c.info[t]),"\\\n");break}}}catch(l){r.e(l)}finally{r.f()}return o}function useExport(){var e=useDispatch(),t=dc(),n=useChartData();return{saveToClipboardHandler:Object(O.useCallback)((function(){n.data.length>0&&(e({type:Nt,isLoading:!0}),setTimeout((function(){copyPNGToClipboard("nmrSVG"),e({type:Nt,isLoading:!1}),t.show("Spectrum copied to clipboard")}),0))}),[t,e,n]),saveAsJSONHandler:Object(O.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n.data.length>0&&(e({type:Nt,isLoading:!0}),setTimeout(Object(Ae.a)(Me.a.mark((function _callee(){var i,o,r,c;return Me.a.wrap((function _callee$(l){for(;;)switch(l.prev=l.next){case 0:return r=null===(i=n.data[0])||void 0===i||null===(o=i.display)||void 0===o?void 0:o.name,c=SpectraManager_toJSON(n),l.next=4,Object(fc.d)(c,r,t,a);case 4:e({type:Nt,isLoading:!1});case 5:case"end":return l.stop()}}),_callee)}))),0))}),[e,n]),saveAsNMREHandler:Object(O.useCallback)((function(){n.data.length>0&&(e({type:Nt,isLoading:!0}),setTimeout((function(){var t,a,i=null===(t=n.data[0])||void 0===t||null===(a=t.display)||void 0===a?void 0:a.name,o=function toNmredata(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e||{data:[],molecules:[]},a=n.data,i=n.molecules,o=t.id,r=t.prefix,c=void 0===r?"\n> <NMREDATA_":r,l=t.filename,s=void 0===l?"nmredata":l,u="",d=new Fe.a,b=gc.Molecule.fromMolfile(i[0].molfile);b.addImplicitHydrogens();var p=Object(hc.f)(b),f={prefix:c,molecule:b,groupedDiaIDs:p,nmrRecord:d};u+=i[0].molfile;var h=getLabels(a,f);return u+="".concat(c,"VERSION>\n1.1\\\n"),u+=putTag(a,"temperature",{prefix:c}),u+=putTag(a,"solvent",{prefix:c}),o&&(u+="".concat(c+vc.id,">\nid\\\n")),u+=formatAssignments(h.byDiaID,f),u+=get1DSignals(a,h,f),u+=get2DSignals(a,h,f),u+="\n$$$$\n",d.file("".concat(s,".sdf"),u),d}(n);Object(fc.e)(o,i),e({type:Nt,isLoading:!1})}),0))}),[e,n]),saveAsSVGHandler:Object(O.useCallback)((function(){n.data.length>0&&(e({type:Nt,isLoading:!0}),setTimeout((function(){var t,a,i=null===(t=n.data[0])||void 0===t||null===(a=t.display)||void 0===a?void 0:a.name;Object(fc.g)(i,"nmrSVG"),e({type:Nt,isLoading:!0})}),0))}),[e,n.data]),saveAsPNGHandler:Object(O.useCallback)((function(){n.data.length>0&&(e({type:Nt,isLoading:!0}),setTimeout((function(){var e,t,a=null===(e=n.data[0])||void 0===e||null===(t=e.display)||void 0===t?void 0:t.name;Object(fc.f)(a,"nmrSVG")}),0))}),[e,n.data])}}function useToolsFunctions(){var e=useDispatch(),t=dc(),n=Object(O.useState)(!1),a=Object(h.a)(n,2),i=a[0],o=a[1],r=Object(O.useState)(!1),c=Object(h.a)(r,2),l=c[0],s=c[1],u=Object(O.useRef)({clicks:[]});return{handleChangeOption:Object(O.useCallback)((function(n){[Ua.peakPicking.id,Ua.integral.id,Ua.zone2D.id].includes(n)&&t.show("Press Shift + Left Mouse button to select zone for integral and peak picking"),e({type:$e,selectedTool:n})}),[t,e]),handleFullZoomOut:Object(O.useCallback)((function(){0===u.current.clicks.length&&e({type:tt,zoomType:da});var t=w()((function(){u.current.clicks=[]}),500);u.current.clicks.push(t),t(),u.current.clicks.length>1&&(M()(u.current.clicks,(function(e){return e.cancel()})),u.current.clicks=[],e({type:tt}))}),[e,u]),handleChangeDisplayViewMode:Object(O.useCallback)((function(){var t=!l;s(t),e({type:jt,flag:t})}),[e,l]),changeSpectrumViewHandler:Object(O.useCallback)((function(){e({type:lt,isRealSpectrumVisible:!i}),o(!i)}),[e,i]),alignSpectrumsVerticallyHandler:Object(O.useCallback)((function(){e({type:zt})}),[e]),isRealSpectrumShown:i,isStacked:l}}var Oc=function KeysListenerTracker(){var e=useChartData(),t=e.keysPreferences,n=e.displayerMode,a=e.overDisplayer,i=e.data,o=useDispatch(),r=dc(),c=useToolsFunctions(),l=c.handleChangeOption,s=c.handleFullZoomOut,u=c.alignSpectrumsVerticallyHandler,d=c.handleChangeDisplayViewMode,b=useExport(),p=b.saveToClipboardHandler,f=b.saveAsJSONHandler,g=Object(pi.d)().highlight,m=useAssignmentData(),j=Object(O.useMemo)((function(){return n===er.DM_1D&&i&&i.length>0}),[i,n]),v=Object(O.useMemo)((function(){return n===er.DM_2D&&i&&i.length>0}),[i,n]),x=Object(O.useCallback)((function(e,t){switch(e){case pi.b.INTEGRAL:o({type:ct,integralID:t.activeKey});break;case pi.b.PEAK:o({type:Ze,data:{id:t.activeKey}});break;case pi.b.RANGE:o({type:Rt,payload:{id:t.activeKey,assignmentData:m}});break;case pi.b.ZONE:o({type:Qt,payload:{id:t.activeKey,assignmentData:m}})}}),[m,o]),y=Object(O.useCallback)((function(e,n){i&&i.length>0&&n>=1&&n<=9&&(e.shiftKey?(o({type:Ut,keyCode:n}),r.show("Configuration Reset, press '".concat(n,"' again to reload it."))):checkModifierKeyActivated(e)||(t&&t[n]?o({type:Kt,keyCode:n}):(o({type:Ut,keyCode:n}),r.show("Configuration saved, press '".concat(n,"' again to reload it.")))))}),[r,i,o,t]),k=Object(O.useCallback)((function(e){if(!e.shiftKey&&!e.metaKey)switch(e.key){case"f":s();break;case"z":case"Escape":l(Ua.zoom.id);break;case"r":j&&l(Ua.rangesPicking.id);break;case"b":j&&l(Ua.baseLineCorrection.id);break;case"p":j&&l(Ua.peakPicking.id);break;case"i":var t=v?Ua.zone2D.id:j?Ua.integral.id:"";l(t);break;case"a":j&&l(Ua.phaseCorrection.id)}if(!e.shiftKey&&!e.metaKey&&!e.ctrlKey)switch(e.key){case"c":j&&u();break;case"s":j&&d()}if(!e.shiftKey&&(e.metaKey||e.ctrlKey))switch(e.key){case"c":p(),e.preventDefault();break;case"s":f(),e.preventDefault()}if(e.shiftKey&&(e.metaKey||e.ctrlKey))switch(e.key){case"S":f(2,!1),e.preventDefault()}}),[u,j,v,d,l,s,f,p]),C=Object(O.useCallback)((function(e){var t=Object(h.a)(g.highlighted,1)[0],n=g.type;if(!["input","textarea"].includes(e.target.localName)&&a){var i=Number(e.code.substr(e.code.length-1))||0;i>0?y(e,i):["Backspace"].includes(e.key)&&n?x(n,{activeKey:t}):k(e)}}),[x,g,y,a,k]);return Object(O.useEffect)((function(){return document.addEventListener("keydown",C,!0),function(){return document.removeEventListener("keydown",C,!0)}}),[C]),null},xc="";var yc,kc=function getHelpList(){return{zoomIn:{text:"Zoom Tool",filePath:"".concat(xc,"/1d/zoom/zoomIn.html")},peakPicking:{text:"peak picking tool",filePath:"".concat(xc,"/1d/peak/peakPicking.html")},integralPicking:{text:"integral tool",filePath:"".concat(xc,"/1d/integral/integration.html")},fullScreen:{text:"Full Screen mode",filePath:"".concat(xc,"/1d/general/fullScreen.html")},loadSpectrum:{text:"load spectrums",filePath:"".concat(xc,"/1d/load/loadSpectrum.html")}}},Cc=Object(m.b)(yc||(yc=Object(g.a)(["\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  .manual-header {\n    .title {\n      text-align: center;\n      padding: 10px 0 10px 0px;\n      margin: 0px;\n      color: #000000;\n      place-items: normal;\n      text-transform: none;\n      background-color: #fafafa;\n    }\n\n    .close-bt {\n      border: none;\n      color: red;\n      background-color: transparent;\n      outline: none;\n      position: absolute;\n      right: 15px;\n      top: 10px;\n    }\n  }\n  .main-content {\n    width: 100%;\n    height: 100%;\n    border: none;\n    padding-left: 5px;\n  }\n\n  .inner-container {\n    padding: 5px;\n    width: 100%;\n    height: 100%;\n  }\n\n  .tab-content {\n    width: 100%;\n  }\n"])));var Dc,Sc=function UserManualModal(e){var t=e.onClose,n=kc().loadSpectrum.filePath;return Object(me.c)("div",{css:Cc,children:[Object(me.c)("div",{className:"manual-header handle",children:[Object(me.b)("h6",{className:"title",children:"User Manual"}),Object(me.b)(Gn,{onClick:t,className:"close-bt"})]}),Object(me.b)("div",{className:"main-content",children:Object(me.b)("div",{className:"inner-container",children:Object(me.b)("iframe",{title:"General User Manual ",src:n,frameBorder:"0",scrolling:"auto",style:{width:"100%",height:"100%"}})})})]})},wc=Object(m.b)(Dc||(Dc=Object(g.a)(["\n  border-radius: 50%;\n  width: 16px;\n  height: 16px;\n  background-color: transparent;\n  border: none;\n  padding: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  :hover {\n    background-color: red;\n    border-radius: 50%;\n\n    .icon {\n      color: white;\n    }\n  }\n\n  .icon {\n    color: #252525;\n    width: 8px;\n  }\n"])));var Tc,Mc=function DeleteButton_DeleteButton(e){var t=e.onDelete,n=e.className,a=void 0===n?"delete":n;return Object(me.b)("button",{css:wc,className:a,type:"button",onClick:t,children:Object(me.b)(_e.G,{className:"icon"})})},Ac=function styles(e){return Object(m.b)(Tc||(Tc=Object(g.a)(["\n  position: relative;\n\n  .delete {\n    position: absolute;\n    top: 2px;\n    left: 2px;\n  }\n\n  ","\n"])),e)};function Tab(e){var t=e.tabid,n=e.tablabel,a=e.activeTab,i=e.onClick,o=e.canDelete,r=e.onDelete,c=e.tabstyles,l="tab-list-item";a===t&&(l+=" tab-list-active");var s=Object(O.useCallback)((function(e){i(Object(f.a)(Object(f.a)({},e),{},{tablabel:n,tabid:t}))}),[i,n,t]),u=Object(O.useCallback)((function(e){e.stopPropagation(),r(Object(f.a)(Object(f.a)({},e),{},{tablabel:n,tabid:t}))}),[r,n,t]);return Object(me.c)("li",{className:l,onClick:s,css:Ac(c),children:[o&&Object(me.b)(Mc,{onDelete:u}),n]})}var Ec,Pc,Ic=Object(O.memo)(Tab),Fc="TOP",Rc="LEFT",_c=Object(m.b)(Ec||(Ec=Object(g.a)(["\n  height: 100%;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n\n  .tab-list {\n    border-bottom: 1px solid #ccc;\n    padding-left: 0;\n    margin: 0;\n  }\n\n  .tab-list li:first-of-type {\n    margin-left: 5px;\n  }\n\n  .tab-list li:hover {\n    background-color: #f7f7f7;\n  }\n\n  .tab-list-item {\n    display: inline-block;\n    list-style: none;\n    margin-bottom: -1px;\n    padding: 0.5rem 2rem;\n  }\n\n  .tab-list-active {\n    background-color: white;\n    border: solid #ccc;\n    border-width: 1px 1px 0 1px;\n  }\n\n  .tab-content {\n    height: 100%;\n    overflow: auto;\n  }\n"]))),Nc=Object(m.b)(Pc||(Pc=Object(g.a)(["\n  display: flex;\n  height: 100%;\n  width: 100%;\n  .tab-list {\n    border-right: 1px solid #ccc;\n    padding-left: 0;\n    margin: 0;\n  }\n\n  .tab-list li:hover {\n    background-color: #f7f7f7;\n  }\n\n  .tab-list li:first-of-type {\n    margin-top: 10px;\n  }\n\n  .tab-list-item {\n    display: block;\n    list-style: none;\n    margin-right: -1px;\n    padding: 0.5rem 0.75rem;\n  }\n\n  .tab-list-active {\n    background-color: white;\n    border: solid #ccc;\n    border-width: 1px 0px 1px 1px;\n  }\n\n  .tab-content {\n    height: 100%;\n    overflow: auto;\n  }\n"])));function Tabs(e){var t=e.children,n=e.onClick,a=e.defaultTabID,i=e.position,o=e.canDelete,r=e.onDelete,c=Object(O.useState)(),l=Object(h.a)(c,2),s=l[0],u=l[1];Object(O.useEffect)((function(){u(a)}),[a]);var d=Object(O.useCallback)((function(e){var t=e.tablabel,a=e.tabid;n({tablabel:t,tabid:a}),u(a)}),[n]),b=Object(O.useMemo)((function(){return O.Children.map(t,(function(e){var t=e.props,n=t.tablabel,a=t.tabid,i=t.candelete,c=t.tabstyles,l=i?"true"===i.toLowerCase():o;return Object(me.b)(Ic,{activeTab:s,tablabel:n,onClick:d,tabid:a,canDelete:l,onDelete:r,tabstyles:c},a)}))}),[s,o,t,d,r]),p=Object(O.useMemo)((function(){return O.Children.map(t,(function(e){var t=e.props,n=t.tabid,a=t.style;return n!==s?Object(O.cloneElement)(e,{style:{display:"none"}}):Object(O.cloneElement)(e,{style:Object(f.a)({display:"block"},a)})}))}),[s,t]),g=Object(O.useMemo)((function(){switch(i){case Fc:return _c;case Rc:return Nc;default:return _c}}),[i]);return Object(me.c)("div",{className:"tabs",css:g,children:[Object(me.b)("ol",{className:"tab-list",children:b}),Object(me.b)("div",{className:"tab-content",children:p})]})}Tabs.defaultProps={onClick:function onClick(){return null},onDelete:function onDelete(){return null},position:"TOP",canDelete:!1};var Lc=Object(O.memo)(Tabs),zc=n(190),Hc=Object(O.forwardRef)((function FormikForm(e,t){var n=e.initialValues,a=e.onSubmit,i=e.validationSchema,o=e.children;return Object(A.jsx)(zc.d,{innerRef:t,initialValues:n,onSubmit:a,validationSchema:i,children:function children(){return Object(A.jsx)(A.Fragment,{children:o})}})}));Hc.defaultProps={initialValues:{},onSubmit:function onSubmit(){return null},validationSchema:null};var Bc=Hc,Xc=n(192),Vc=n.n(Xc),Yc="INIT_PREFERENCES",Zc="SET_PREFERENCES",Uc="SET_PANELS_PREFERENCES",Kc={basePreferences:{},display:{general:{disableMultipletAnalysis:!1,hideSetSumFromMolecule:!1},panels:{hideSpectraPanel:!1,hideInformationPanel:!1,hidePeaksPanel:!1,hideIntegralsPanel:!1,hideRangesPanel:!1,hideStructuresPanel:!1,hideFiltersPanel:!1,hideZonesPanel:!1,hideSummaryPanel:!1,hideMultipleSpectraAnalysisPanel:!1},toolBarButtons:{hideZoomTool:!1,hideZoomOutTool:!1,hideImport:!1,hideExportAs:!1,hideSpectraStackAlignments:!1,hideSpectraCenterAlignments:!1,hideRealImaginary:!1,hidePeakTool:!1,hideIntegralTool:!1,hideAutoRangesTool:!1,hideZeroFillingTool:!1,hidePhaseCorrectionTool:!1,hideBaseLineCorrectionTool:!1,hideFFTTool:!1,hideMultipleSpectraAnalysisTool:!1}},controllers:{mws:{low:2,high:20},help:{preventAutoHelp:!0},dimmedSpectraTransparency:.1},formatting:{nucleus:[{key:"1H",name:"1H",ppm:"0.00",hz:"0.00"},{key:"13C",name:"13C",ppm:"0.00",hz:"0.00"},{key:"15N",name:"15N",ppm:"0.00",hz:"0.00"},{key:"19F",name:"19F",ppm:"0.00",hz:"0.00"},{key:"29Si",name:"29Si",ppm:"0.00",hz:"0.00"},{key:"31P",name:"31P",ppm:"0.00",hz:"0.00"}],nucleusByKey:{},panels:{}},dispatch:null},Wc=function mapNucleus(e){e.formatting.nucleus&&Array.isArray(e.formatting.nucleus)&&(e.formatting.nucleusByKey=e.formatting.nucleus.reduce((function(e,t){return e[t.name.toLowerCase()]=t,Object(f.a)({},e)}),{}))};function preferencesReducer(e,t){switch(t.type){case Yc:var n=oa("nmr-local-storage-version",!1);n&&"1"===n||(function removeData(e){localStorage.removeItem(e)}("nmr-general-settings"),function storeData(e,t){localStorage.setItem(e,t)}("nmr-local-storage-version","1"));var a=oa("nmr-general-settings");return Object(fa.b)(e,(function(e){if(t.payload){var n=t.payload,i=n.dispatch,o=Object(le.a)(n,["dispatch"]);e.basePreferences=o,e.display=o.display,e.dispatch=i,a&&(Object.entries(a).forEach((function(t){var n=Object(h.a)(t,2),a=n[0],i=n[1];e[a]=Vc()(i,o[a]?o[a]:{})})),Wc(e))}}));case Zc:return Object(fa.b)(e,(function(e){if(t.payload){var n=t.payload;e.controllers=n.controllers,e.formatting=n.formatting,e.display.panels=n.display.panels,Wc(e)}}));case Uc:return Object(fa.b)(e,(function(e){if(t.payload){var n=t.payload,a=n.key,i=n.value;e.formatting.panels[a]=i}}));default:return e}}var Gc,qc=function Logo(e){var t=e.size,n=void 0===t?100:t;return Object(A.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 841.9 595.3",style:{width:n,height:n},children:Object(A.jsxs)("g",{fill:"#61DAFB",children:[Object(A.jsx)("path",{d:"M666.3 296.5c0-32.5-40.7-63.3-103.1-82.4 14.4-63.6 8-114.2-20.2-130.4-6.5-3.8-14.1-5.6-22.4-5.6v22.3c4.6 0 8.3.9 11.4 2.6 13.6 7.8 19.5 37.5 14.9 75.7-1.1 9.4-2.9 19.3-5.1 29.4-19.6-4.8-41-8.5-63.5-10.9-13.5-18.5-27.5-35.3-41.6-50 32.6-30.3 63.2-46.9 84-46.9V78c-27.5 0-63.5 19.6-99.9 53.6-36.4-33.8-72.4-53.2-99.9-53.2v22.3c20.7 0 51.4 16.5 84 46.6-14 14.7-28 31.4-41.3 49.9-22.6 2.4-44 6.1-63.6 11-2.3-10-4-19.7-5.2-29-4.7-38.2 1.1-67.9 14.6-75.8 3-1.8 6.9-2.6 11.5-2.6V78.5c-8.4 0-16 1.8-22.6 5.6-28.1 16.2-34.4 66.7-19.9 130.1-62.2 19.2-102.7 49.9-102.7 82.3 0 32.5 40.7 63.3 103.1 82.4-14.4 63.6-8 114.2 20.2 130.4 6.5 3.8 14.1 5.6 22.5 5.6 27.5 0 63.5-19.6 99.9-53.6 36.4 33.8 72.4 53.2 99.9 53.2 8.4 0 16-1.8 22.6-5.6 28.1-16.2 34.4-66.7 19.9-130.1 62-19.1 102.5-49.9 102.5-82.3zm-130.2-66.7c-3.7 12.9-8.3 26.2-13.5 39.5-4.1-8-8.4-16-13.1-24-4.6-8-9.5-15.8-14.4-23.4 14.2 2.1 27.9 4.7 41 7.9zm-45.8 106.5c-7.8 13.5-15.8 26.3-24.1 38.2-14.9 1.3-30 2-45.2 2-15.1 0-30.2-.7-45-1.9-8.3-11.9-16.4-24.6-24.2-38-7.6-13.1-14.5-26.4-20.8-39.8 6.2-13.4 13.2-26.8 20.7-39.9 7.8-13.5 15.8-26.3 24.1-38.2 14.9-1.3 30-2 45.2-2 15.1 0 30.2.7 45 1.9 8.3 11.9 16.4 24.6 24.2 38 7.6 13.1 14.5 26.4 20.8 39.8-6.3 13.4-13.2 26.8-20.7 39.9zm32.3-13c5.4 13.4 10 26.8 13.8 39.8-13.1 3.2-26.9 5.9-41.2 8 4.9-7.7 9.8-15.6 14.4-23.7 4.6-8 8.9-16.1 13-24.1zM421.2 430c-9.3-9.6-18.6-20.3-27.8-32 9 .4 18.2.7 27.5.7 9.4 0 18.7-.2 27.8-.7-9 11.7-18.3 22.4-27.5 32zm-74.4-58.9c-14.2-2.1-27.9-4.7-41-7.9 3.7-12.9 8.3-26.2 13.5-39.5 4.1 8 8.4 16 13.1 24 4.7 8 9.5 15.8 14.4 23.4zM420.7 163c9.3 9.6 18.6 20.3 27.8 32-9-.4-18.2-.7-27.5-.7-9.4 0-18.7.2-27.8.7 9-11.7 18.3-22.4 27.5-32zm-74 58.9c-4.9 7.7-9.8 15.6-14.4 23.7-4.6 8-8.9 16-13 24-5.4-13.4-10-26.8-13.8-39.8 13.1-3.1 26.9-5.8 41.2-7.9zm-90.5 125.2c-35.4-15.1-58.3-34.9-58.3-50.6 0-15.7 22.9-35.6 58.3-50.6 8.6-3.7 18-7 27.7-10.1 5.7 19.6 13.2 40 22.5 60.9-9.2 20.8-16.6 41.1-22.2 60.6-9.9-3.1-19.3-6.5-28-10.2zM310 490c-13.6-7.8-19.5-37.5-14.9-75.7 1.1-9.4 2.9-19.3 5.1-29.4 19.6 4.8 41 8.5 63.5 10.9 13.5 18.5 27.5 35.3 41.6 50-32.6 30.3-63.2 46.9-84 46.9-4.5-.1-8.3-1-11.3-2.7zm237.2-76.2c4.7 38.2-1.1 67.9-14.6 75.8-3 1.8-6.9 2.6-11.5 2.6-20.7 0-51.4-16.5-84-46.6 14-14.7 28-31.4 41.3-49.9 22.6-2.4 44-6.1 63.6-11 2.3 10.1 4.1 19.8 5.2 29.1zm38.5-66.7c-8.6 3.7-18 7-27.7 10.1-5.7-19.6-13.2-40-22.5-60.9 9.2-20.8 16.6-41.1 22.2-60.6 9.9 3.1 19.3 6.5 28.1 10.2 35.4 15.1 58.3 34.9 58.3 50.6-.1 15.7-23 35.6-58.4 50.6zM320.8 78.4z"}),Object(A.jsx)("path",{d:"M520.5 78.1z"})]})})};function AboutTabContent_getData(e){return _getData.apply(this,arguments)}function _getData(){return(_getData=Object(Ae.a)(Me.a.mark((function _callee(e){var t;return Me.a.wrap((function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch(e);case 3:return t=n.sent,n.abrupt("return",t.json());case 7:return n.prev=7,n.t0=n.catch(0),n.abrupt("return",null);case 10:case"end":return n.stop()}}),_callee,null,[[0,7]])})))).apply(this,arguments)}var Jc="https://api.github.com/repos/cheminfo/nmrium",$c=Object(m.b)(Gc||(Gc=Object(g.a)(["\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding-top: 20px;\n\n  span {\n    font-weight: bold;\n    color: #636363;\n  }\n\n  img {\n    width: 100px;\n  }\n\n  a {\n    color: #969696;\n  }\n\n  a:hover,\n  a:focus {\n    color: #00bcd4;\n  }\n\n  .separator {\n    border-bottom: 1px solid gray;\n    width: 15px;\n    height: 1px;\n    margin: 10px 0px;\n  }\n"])));var Qc=function AboutTabContent(){var e=Object(O.useState)(),t=Object(h.a)(e,2),n=t[0],a=t[1];return Object(O.useEffect)((function(){Promise.all([AboutTabContent_getData("".concat(Jc,"/commits")),AboutTabContent_getData("".concat(Jc,"/tags"))]).then((function(e){a(e)}))}),[]),n?Object(me.c)("div",{css:$c,children:[Object(me.b)(qc,{}),Object(me.b)("span",{children:"NMRium"}),Object(me.c)("span",{children:[" ",n[1][0].name]}),Object(me.b)("span",{className:"separator"}),Object(me.c)("a",{href:n[1][0].zipball_url,target:"_blank",rel:"noreferrer",children:["Download Last Version ",n[1][0].name]}),Object(me.b)("span",{className:"separator"}),Object(me.c)("a",{href:n[0][0].html_url,target:"_blank",rel:"noreferrer",children:["Last Commit ",new Date(n[0][0].commit.author.date).toUTCString()," [",n[0][0].sha.substr(0,12)," ]"]})]}):null},el=Object(O.forwardRef)((function CheckBox(e,t){var n=e.name,a=void 0===n?"":n,i=e.checked,o=e.onChange,r=void 0===o?function(){return null}:o,c=e.disabled,l=Object(O.useState)(i),s=Object(h.a)(l,2),u=s[0],d=s[1],b=Object(O.useCallback)((function(e){d(!u),r(e)}),[u,r]);return Object(A.jsx)("input",{ref:t,type:"checkbox",name:a,id:a,onChange:b,defaultChecked:i,disabled:c})}));el.defaultProps={onChange:function onChange(){return null},name:"",disabled:!1};var tl=el;function FormikCheckBox(e){var t=e.label,n=e.name,a=e.onChange,i=e.className,o=e.reverse,r=Object(le.a)(e,["label","name","onChange","className","reverse"]),c=Object(zc.f)(),l=c.values,s=c.setFieldValue,u=o?!v()(l,n):v()(l,n),d=Object(O.useCallback)((function(e){e.persist(),a(e),s(n,o?u:!u)}),[n,a,o,s,u]);return Object(A.jsxs)("div",{className:"".concat(i," check-").concat(u),children:[Object(A.jsx)("label",{htmlFor:n,className:"checkbox-lable",children:t}),Object(A.jsx)(tl,Object(f.a)({id:n,name:n,checked:u,onChange:d,className:"checkbox"},r))]})}FormikCheckBox.defaultProps={className:"",onChange:function onChange(){return null},reverse:!1};var nl=FormikCheckBox,al={lineHeight:2,userSelect:"none"},il={height:"100%",width:"100px",borderRadius:"5px",border:"0.55px solid #c7c7c7",margin:"0px 5px 0px 5px",textAlign:"center"},ol=Object(O.forwardRef)((function Input(e,t){var n=e.label,a=e.value,i=e.name,o=e.style,r=e.onChange,c=e.onKeyDown,l=e.checkValue,s=e.type,u=e.enableAutoSelect,d=e.className,b=e.format,p=Object(le.a)(e,["label","value","name","style","onChange","onKeyDown","checkValue","type","enableAutoSelect","className","format"]),g=Object(O.useState)(a),m=Object(h.a)(g,2),j=m[0],v=m[1];Object(O.useEffect)((function(){v(a)}),[a]),Object(O.useEffect)((function(){u&&t.current.select()}),[u,t]);var x=Object(O.useCallback)((function(e){return b()("number"===s?"-"===String(e).trim()?Number(0):Number(e):e)}),[b,s]),y=Object(O.useCallback)((function(e){e.persist(),e.stopPropagation(),e.preventDefault();var t=e.target.value;if(function check(e){if("number"===s){return!(""!==e.trim()&&!/^(?:-?[0-9]*|[0-9]\d*)(?:\.\d{0,20})?$/.test(e))}return!0}(t)&&l(t)){var n=b();v(n(t)),r(Object(f.a)(Object(f.a)({},e),{},{target:{name:e.target.name,value:x(t)}}))}}),[l,b,x,r,s]),k=Object(O.useCallback)((function(e){e.persist(),c(Object(f.a)(Object(f.a)({},e),{},{target:{name:e.target.name,value:x(j)}}))}),[x,c,j]),C=Object(O.useCallback)((function(e){e.stopPropagation()}),[]);return Object(A.jsxs)("div",{style:Object(f.a)({display:"flex",flexDirection:"row",alignItems:"center"},o&&o.container?o.container:{}),children:[n&&Object(A.jsx)("span",{style:Object(f.a)(Object(f.a)({},al),o&&o.label?o.label:{}),className:"label",children:n}),Object(A.jsx)("input",Object(f.a)(Object(f.a)({},p),{},{ref:t,name:i,style:Object(f.a)(Object(f.a)({},il),o&&o.input?o.input:{}),type:"text",value:j,onChange:y,onKeyDown:k,onKeyPress:C,onDoubleClick:function onDoubleClick(e){return e.stopPropagation()},className:"input ".concat(d)}))]})}));ol.defaultProps={style:{label:{},input:{},container:{}},value:"",onChange:function onChange(){return null},checkValue:function checkValue(){return!0},onKeyDown:function onKeyDown(){return null},type:"text",className:"",enableAutoSelect:!1,format:function format(){return function(e){return e}}};var rl=ol;function FormikInput(e){var t=e.label,n=e.name,a=e.style,i=e.onChange,o=e.checkValue,r=e.type,c=e.className,l=e.value,s=e.format,u=Object(le.a)(e,["label","name","style","onChange","checkValue","type","className","value","format"]),d=Object(zc.f)(),b=d.values,p=d.handleChange,h=d.setFieldValue,g=d.errors,m=d.touched,j=Object(O.useCallback)((function(e){i(e),p(e)}),[p,i]);Object(O.useEffect)((function(){l&&h(n,l)}),[n,h,l]);var x=Object(O.useMemo)((function(){return v()(g,n)&&v()(m,n)}),[g,n,m]);return Object(A.jsx)(rl,Object(f.a)({label:t,name:n,value:l||v()(b,n),onChange:j,type:r,style:{input:Object(f.a)(Object(f.a)({},a),x&&{borderColor:"red"})},checkValue:o,className:c,format:s},u))}FormikInput.defaultProps={style:{label:{},input:{}},onChange:function onChange(){return null},checkValue:function checkValue(){return!0},type:"text",className:"",value:null,format:function format(){return function(e){return e}}};var cl=FormikInput;var ll=function ControllersTabContent(){return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("p",{className:"section-header",children:"Mouse Scroll Wheel Sensitivity"}),Object(A.jsx)(cl,{type:"number",label:"Low",name:"controllers.mws.low"}),Object(A.jsx)(cl,{type:"number",label:"high",name:"controllers.mws.high"}),Object(A.jsx)("p",{className:"section-header",style:{marginTop:"40px"},children:"Show / Hide Panels"}),Object(A.jsx)(nl,{className:"help-checkbox-element",label:"Prevent automatic show help ",name:"controllers.help.preventAutoHelp"}),Object(A.jsx)("p",{className:"section-header",style:{marginTop:"40px"},children:"Spectra"}),Object(A.jsx)(cl,{type:"number",label:"Transparency of Dimmed Spectra [ 0 - 1 ]",name:"controllers.dimmedSpectraTransparency",checkValue:function checkValue(e){return e>=0&&e<=1}})]})},sl=[{label:"Spectra Panel",name:"display.panels.hideSpectraPanel"},{label:"Information Panel",name:"display.panels.hideInformationPanel"},{label:"Peaks Panel",name:"display.panels.hidePeaksPanel"},{label:"Integrals Panel",name:"display.panels.hideIntegralsPanel"},{label:"Ranges Panel",name:"display.panels.hideRangesPanel"},{label:"Structures Panel",name:"display.panels.hideStructuresPanel"},{label:"Filters Panel",name:"display.panels.hideFiltersPanel"},{label:"Zones Panel",name:"display.panels.hideZonesPanel"},{label:"Summary Panel",name:"display.panels.hideSummaryPanel"},{label:"Multiple Spectra Analysis Panel",name:"display.panels.hideMultipleSpectraAnalysisPanel"}];var ul,dl=function DisplayTabContent(e){var t=e.preferences;return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("p",{className:"section-header",children:"Show / Hide Panels"}),sl.map((function(e){return!v()(t,"basePreferences.".concat(e.name),!1)&&Object(A.jsx)(nl,{className:"checkbox-element",label:e.label,name:e.name,reverse:!0},e.name)}))]})},bl=Object(m.b)(ul||(ul=Object(g.a)(["\n  .counter-col {\n    width: 30px;\n  }\n  .nucleus-label-col {\n    display: flex;\n    justify-content: center;\n    width: 80px;\n  }\n\n  .width-100 {\n    width: 100% !important;\n    margin: 0px !important;\n  }\n\n  .nucleus-format-input-col {\n    text-align: center;\n    width: 100px;\n  }\n\n  th {\n    font-size: 11px;\n    font-weight: 600;\n  }\n  .operation-container {\n    display: flex;\n  }\n  .add {\n    background-color: transparent;\n    border: 0;\n    outline: none;\n    svg {\n      font-szie: 14px;\n      fill: green;\n    }\n  }\n"])));var pl,fl=function FormattingTabContent(){var e=Object(zc.f)(),t=e.values,n=e.setFieldValue,a=Object(O.useMemo)((function(){return v()(t,"formatting.nucleus",[])}),[t]),i=Object(O.useCallback)((function(e){var t=a.splice(0,e);n("formatting.nucleus",t)}),[a,n]),o=Object(O.useCallback)((function(){var e={key:generateID(),name:"",ppm:"0.00",hz:"0.00"},t=[].concat(Object(Ee.a)(a),[e]);n("formatting.nucleus",t)}),[a,n]);return Object(me.c)(O.Fragment,{children:[Object(me.b)("p",{className:"section-header",children:"Formating according to Nucleus"}),Object(me.b)("div",{css:bl,children:Object(me.c)("table",{children:[Object(me.b)("thead",{children:Object(me.c)("tr",{children:[Object(me.b)("th",{className:"counter-col",children:"#"}),Object(me.b)("th",{className:"nucleus-label-col",children:"Nucleus "}),Object(me.b)("th",{className:"nucleus-format-input-col",children:"\u03b4 (ppm)"}),Object(me.b)("th",{className:"nucleus-format-input-col",children:"Coupling (Hz)"}),Object(me.b)("th",{className:"nucleus-format-input-col"})]})}),Object(me.b)("tbody",{children:a&&a.map((function(e,t){var n=t+1;return Object(me.c)("tr",{children:[Object(me.c)("td",{className:"counter-col",children:[Object(me.c)("span",{children:[n," - "]})," "]}),Object(me.b)("td",{className:"nucleus-label-col",children:Object(me.b)(cl,{name:"formatting.nucleus.".concat(t,".name"),className:"width-100"})}),Object(me.b)("td",{className:"nucleus-format-input-col",children:Object(me.b)(cl,{name:"formatting.nucleus.".concat(t,".ppm"),className:"width-100"})}),Object(me.b)("td",{className:"nucleus-format-input-col",children:Object(me.b)(cl,{name:"formatting.nucleus.".concat(t,".hz"),className:"width-100"})}),Object(me.c)("td",{className:"operation-container",children:[Object(me.b)(Gn,{onClick:function onClick(){return i(t)},popupTitle:"remove ".concat(e.name),popupPlacement:"right"}),a.length===t+1&&Object(me.b)("button",{className:"add",type:"button",onClick:o,children:Object(me.b)(_e.y,{})})]})]},"".concat(e.key))}))})]})})]})},hl=Object(m.b)(pl||(pl=Object(g.a)(['\n  overflow: auto;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n\n  .header {\n    text-align: center;\n    padding: 10px 0 10px 0px;\n    margin: 0px;\n    color: #005d9e;\n    place-items: normal;\n    text-transform: none;\n    background-color: #fcfcfc;\n  }\n  .main-content {\n    width: 100%;\n    flex: 1;\n    overflow: auto;\n    border: none;\n  }\n\n  .tab-content {\n    width: 100%;\n  }\n\n  .inner-content {\n    padding: 15px 30px;\n    width: 100%;\n    overflow: auto;\n  }\n\n  button:focus {\n    outline: none;\n  }\n  button:hover {\n    color: #007bff;\n  }\n  .save-button:hover {\n    background-color: #ffffff;\n  }\n  .save-button {\n    border: none;\n    padding: 0 15px;\n    background-color: #ffffff5e;\n    border-radius: 5px;\n    height: 25px;\n  }\n\n  .footer-container {\n    display: flex;\n    align-items: flex-end;\n    justify-content: flex-end;\n    background: rgb(242, 242, 242);\n    background: -moz-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: -webkit-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#f2f2f2",endColorstr="#ffffff",GradientType=1);\n    padding: 6px 15px;\n    height: 55px;\n  }\n\n  .section-header {\n    font-size: 13px;\n    color: #2ca8ff;\n    margin-bottom: 10px;\n    border-bottom: 0.55px solid #f9f9f9;\n    padding: 6px 2px;\n  }\n\n  .label {\n    font-size: 12px;\n    font-weight: bold;\n    margin-right: 10px;\n  }\n\n  .input {\n    font-size: 14px;\n    border-radius: 5px;\n    border: 1px solid #cccccc;\n    padding: 5px;\n    width: 100px;\n    margin-right: 10px;\n    height: initial !important;\n  }\n\n  .close-bt {\n    border: none;\n    color: red;\n    background-color: transparent;\n    outline: none;\n    position: absolute;\n    right: 10px;\n    top: 2px;\n    width: 30px;\n    height: 30px;\n  }\n\n  .checkbox-lable {\n    min-width: 300px;\n    display: inline-block;\n  }\n\n  .help-checkbox-element {\n    .checkbox-lable {\n      width: 260px;\n    }\n  }\n  .checkbox-element {\n    margin-bottom: 5px;\n  }\n'])));var gl=function GeneralSettings(e){var t=e.onClose,n=e.onSave,a=Object(O.useState)("controllers"),i=Object(h.a)(a,2),o=i[0],r=i[1],c=usePreferences(),l=useStateWithLocalStorage("nmr-general-settings"),s=Object(h.a)(l,2)[1],u=Object(O.useRef)(),d=Object(O.useCallback)((function(){u.current.submitForm()}),[]),b=Object(O.useCallback)((function(e){e.dispatch,e.basePreferences;var t=Object(le.a)(e,["dispatch","basePreferences"]);s(t),c.dispatch({type:Zc,payload:e}),n()}),[n,c,s]),p=Object(O.useCallback)((function(e){r(e.tabid)}),[]);return Object(me.c)("div",{css:hl,children:[Object(me.c)("div",{className:"header handle",children:[Object(me.b)("span",{children:"General Settings"}),Object(me.b)(Gn,{onClick:t,className:"close-bt"})]}),Object(me.b)("div",{className:"main-content",children:Object(me.b)(Bc,{ref:u,initialValues:c,onSubmit:b,children:Object(me.c)(Lc,{position:"LEFT",defaultTabID:o,onClick:p,children:[Object(me.b)("div",{className:"inner-content",tablabel:"Controllers",tabid:"controllers",children:Object(me.b)(ll,{})}),Object(me.b)("div",{className:"inner-content",tablabel:"Formatting",tabid:"formatting",children:Object(me.b)(fl,{})}),Object(me.b)("div",{className:"inner-content",tablabel:"Display",tabid:"display",children:Object(me.b)(dl,{preferences:c})}),Object(me.b)("div",{className:"inner-content",tablabel:"About",tabid:"about",children:Object(me.b)(Qc,{})})]})})}),Object(me.b)("div",{className:"footer-container",children:Object(me.b)("button",{type:"button",onClick:d,className:"save-button",children:"Save"})})]})},ml={display:"flex"},jl={lineHeight:2,userSelect:"none",flex:"2"},vl={flex:"4",display:"flex",justifyContent:"flex-start"},Ol={height:"100%",width:"100px",borderRadius:"5px",border:"0.55px solid #c7c7c7",margin:"0px 5px 0px 5px",textAlign:"center"},xl=Object(O.forwardRef)((function NumberInput(e,t){var n=e.label,a=e.name,i=e.defaultValue,o=e.style,r=e.onChange,c=e.onInput,l=e.pattern,s=e.step,u=e.min,d=Object(O.useRef)(),b=Object(O.useCallback)((function(e){e.target.checkValidity()?""===e.target.value?r(Object(f.a)(Object(f.a)({},e),{},{target:Object(f.a)(Object(f.a)({},e.target),{},{value:i})})):r(e):(t||d).current.value=i}),[i,r,t]);return Object(A.jsxs)("div",{style:Object(f.a)(Object(f.a)({},ml),o.container),children:[Object(A.jsx)("span",{style:Object(f.a)(Object(f.a)({},jl),o.label),children:n}),Object(A.jsx)("div",{style:Object(f.a)(Object(f.a)({},vl),o.inputContainer),children:Object(A.jsx)("input",{ref:t||d,name:a,style:Object(f.a)(Object(f.a)({},Ol),o.input),type:"number",pattern:l,defaultValue:i,step:s,onChange:b,onInput:c,min:u},i)})]})}));xl.defaultProps={pattern:"^d*(.d{0,2})?$",step:"any",min:"any",style:{label:{},input:{},container:{},inputContainer:{}},defaultValue:0,onChange:function onChange(){return null},onInput:function onInput(){return null}};var yl=xl,kl={container:{padding:"5px",height:"100%",display:"flex",fontSize:"12px"},input:{width:"50px"},inputContainer:{flex:"2"},label:{flex:"5"},actionButton:{height:"100%",width:"60px",borderRadius:"5px",border:"0.55px solid #c7c7c7",margin:"0px 5px",userSelect:"none"}};var Cl,Dl=function AutoPeakPickingOptionPanel(){var e=useDispatch(),t=Object(O.useRef)(),n=Object(O.useRef)(),a=Object(O.useRef)(),i=Object(O.useRef)(),o=Object(O.useCallback)((function(){e({type:Pt,options:{maxNumberOfPeaks:n.current.value,minMaxRatio:t.current.value,noiseFactor:a.current.value,lookNegative:i.current.checked}})}),[e]),r=Object(O.useCallback)((function(){e({type:Lt})}),[e]);return Object(A.jsxs)("div",{style:kl.container,children:[Object(A.jsx)(yl,{ref:n,label:"Max Number Of Peaks:",name:"maxNumberOfPeaks",style:{input:kl.input,inputContainer:kl.inputContainer,label:kl.label},defaultValue:50}),Object(A.jsx)(yl,{ref:a,label:"Noise factor",name:"noiseFactor",style:{input:kl.input,inputContainer:kl.inputContainer,label:kl.label},defaultValue:3}),Object(A.jsx)(yl,{ref:t,label:"Min Max Ratio:",name:"minMaxRatio",style:{input:kl.input,inputContainer:kl.inputContainer,label:kl.label},defaultValue:.1,step:"0.01"}),Object(A.jsxs)("div",{style:{justifyItems:"baseline",marginRight:"3px"},children:[Object(A.jsx)("label",{style:{marginRight:"2px",lineHeight:2,userSelect:"none"},htmlFor:"lookNegative",children:"Detect Negative:"}),Object(A.jsx)(tl,{name:"lookNegative",ref:i})]}),Object(A.jsx)("button",{type:"button",style:kl.actionButton,onClick:o,children:"Apply"}),Object(A.jsx)("button",{type:"button",style:kl.actionButton,onClick:r,children:"Cancel"})]})},Sl=Object(O.forwardRef)((function Select(e,t){var n=e.data,a=e.style,i=e.onChange,o=e.defaultValue,r=e.name,c=Object(O.useCallback)((function(e){var t=e.target.value;isNaN(t)||(t=Number(t)),i(t)}),[i]),l=Object(m.b)(Cl||(Cl=Object(g.a)(["\n    position: relative;\n    padding: 0px 5px;\n    border: 0.55px solid #cacaca;\n    font-size: 14px;\n    width: ","px;\n    margin: 0;\n    height: 100%;\n    background: "," no-repeat right white;\n    -webkit-appearance: none;\n    background-position-x: ","px;\n    background-size: 15px 15px;\n    border-radius: 5px;\n    margin: 0px 5px;\n    :focus,\n    input:focus {\n      outline: none;\n    }\n  "])),a.width?a.width-5:115,'url(\'data:image/svg+xml;utf8,<svg  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="960px" height="560px" viewBox="0 0 960 560" enable-background="new 0 0 960 560" xml:space="preserve"><g id="Rounded_Rectangle_33_copy_4_1_"><path d="M480,344.181L268.869,131.889c-15.756-15.859-41.3-15.859-57.054,0c-15.754,15.857-15.754,41.57,0,57.431l237.632,238.937c8.395,8.451,19.562,12.254,30.553,11.698c10.993,0.556,22.159-3.247,30.555-11.698l237.631-238.937c15.756-15.86,15.756-41.571,0-57.431s-41.299-15.859-57.051,0L480,344.181z"/></g></svg>\')',a.width?a.width-18:97);return Object(me.b)("select",{css:[l,a],ref:t,name:r,onChange:c,defaultValue:o,children:n.map((function(e){return Object(me.b)("option",{value:e.value,children:e.label},"".concat(e.key))}))})}));Sl.defaultProps={onChange:function onChange(){return null},style:{width:100},name:""};var wl=Sl,Tl={container:{padding:"5px",height:"100%",display:"flex"},label:{lineHeight:2,userSelect:"none"},actionButton:{height:"100%",width:"60px",borderRadius:"5px",border:"0.55px solid #c7c7c7",margin:"0px 5px",userSelect:"none"}};var Ml=function BaseLineCorrectionPanel(){var e=useDispatch(),t=Object(O.useRef)(),n=Object(O.useRef)(),a=Object(O.useRef)(),i=Object(O.useRef)(),o=Object(O.useState)("polynomial"),r=Object(h.a)(o,2),c=r[0],l=r[1],s=Object(O.useCallback)((function(){var o={};switch(c){case"airpls":o={algorithm:t.current.value,maxIterations:n.current.value,tolerance:a.current.value};break;case"polynomial":o={algorithm:t.current.value,degree:i.current.value}}e({type:Zt,options:o})}),[c,e]),u=Object(O.useCallback)((function(){e({type:Lt})}),[e]),d=Object(O.useCallback)((function(){return Object.keys(Ta).map((function(e){return{key:e,label:Ta[e],value:e}}))}),[]),b=Object(O.useCallback)((function(e){l(e)}),[]);return Object(A.jsxs)("div",{style:Tl.container,children:[Object(A.jsx)("span",{style:Tl.label,children:"Algorithm: "}),Object(A.jsx)(wl,{ref:t,data:d(),style:{marginLeft:10,marginRight:10},onChange:b,defaultValue:"polynomial"}),c&&"airpls"===c&&Object(A.jsxs)(O.Fragment,{children:[Object(A.jsx)(yl,{label:"maxIterations:",ref:n,name:"maxIterations",defaultValue:100}),Object(A.jsx)(yl,{label:"tolerance:",ref:a,name:"tolerance",defaultValue:.001})]}),c&&"autoPolynomial"===c&&Object(A.jsx)(yl,{label:"degree:",ref:i,name:"degree",defaultValue:3}),c&&"polynomial"===c&&Object(A.jsx)(yl,{label:"degree:",ref:i,name:"degree",defaultValue:3}),Object(A.jsx)("button",{type:"button",style:Tl.actionButton,onClick:s,children:"Apply"}),Object(A.jsx)("button",{type:"button",style:Tl.actionButton,onClick:u,children:"Cancel"})]})},Al={container:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",border:"0.55px solid #c7c7c7",borderRadius:"5px",userSelect:"none",backgroundColor:"#18ce0f14",fontSize:"10px",color:"#00801d",margin:"0px 5px",cursor:"ew-resize"},label:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",maxWidth:"100%"}},El={step:"initial"},Pl=null,Il=1,Fl=0,Rl=!0;function calcSpeed(e){Rl?(Fl=e.clientX,Rl=!1):(Il=e.clientX-Fl,Fl=e.clientX,function setToZero(){clearTimeout(Pl),Pl=setTimeout((function(){Il=0}),50)}())}function InputRange(e){var t=e.name,n=e.minValue,a=e.maxValue,i=e.value,o=e.onChange,r=e.label,c=e.style,l=e.className,s=e.noPropagation,u=Object(O.useCallback)((function(){"moving"!==El.step&&"start"!==El.step||(El=Object(f.a)(Object(f.a)({},El),{},{step:"start"===El.step?"initial":"end"}))}),[]),d=Object(O.useCallback)((function(e){s&&e.stopPropagation();var t=e.currentTarget.getBoundingClientRect(),n=e.clientX-t.x,a=e.clientY-t.y;return"initial"!==El.step&&"end"!==El.step||(El={startX:n,startY:a,startScreenX:e.screenX,startScreenY:e.screenY,boundingRect:e.currentTarget.getBoundingClientRect(),step:"start",clientX:e.clientX,clientY:e.clientY}),!1}),[s]);return Object(A.jsx)("div",{style:Object(f.a)(Object(f.a)({},Al.container),c),className:l,onMouseMove:function mouseMoveCallback(e){if("start"===El.step||"moving"===El.step){var r=e.screenX,c=e.screenY;El=Object(f.a)(Object(f.a)({},El),{},{step:"moving",endX:El.startX+r-El.startScreenX,endY:El.startY+c-El.startScreenY}),calcSpeed(e);var l=a-n,s=El.endX-El.startX,u=Math.abs(s)*(Math.abs(Il)>3?l:5)/El.boundingRect.width;o({value:Il>=0?i+Math.abs(u):i-u,name:t})}},onMouseUp:function mouseUpCallback(){"moving"!==El.step&&"start"!==El.step||(El=Object(f.a)(Object(f.a)({},El),{},{step:"start"===El.step?"initial":"end"}))},onMouseDown:d,onMouseEnter:u,children:Object(A.jsx)("span",{style:Al.label,children:r})})}InputRange.defaultProps={name:"",minValue:0,maxValue:50,value:0,onChange:function onChange(){return null},label:"Drag to Change the value",noPropagation:!0};var _l=InputRange,Nl={container:{padding:"5px",height:"100%",display:"flex"},input:{width:"100px"},actionButton:{height:"100%",width:"60px",borderRadius:"5px",border:"0.55px solid #c7c7c7",margin:"0px 5px",userSelect:"none"},select:{marginLeft:"5px",marginRight:"10px",border:"none",height:"20px"}},Ll="manual",zl="automatic",Hl="absolute",Bl=[{key:Ll,label:"Manual",value:Ll},{key:zl,label:"Automatic",value:zl},{key:Hl,label:"Absolute",value:Hl}];var Xl=function ManualPhaseCorrectionPanel(){var e=useDispatch(),t=Object(O.useState)({ph0:0,ph1:0,pivotIndex:1}),n=Object(h.a)(t,2),a=n[0],i=n[1],o=Object(O.useState)(Ll),r=Object(h.a)(o,2),c=r[0],l=r[1],s=Object(O.useCallback)((function(){switch(c){case zl:e({type:Mt});break;case Ll:e({type:Tt,value:a});break;case Hl:e({type:At})}}),[e,c,a]),u=Object(O.useCallback)((function(t){var n=t.target.name;if(t.target){var o=t.target.value;i((function(t){var i=Object(f.a)(Object(f.a)({},t),{},Object(ie.a)({},n,o));if("-"!==o){var r=Object(f.a)(Object(f.a)({},a),{},Object(ie.a)({},n,o-t[n]));for(var c in t)t[c]===r[c]&&(r[c]-=t[c]);e({type:wt,value:r})}return i}))}}),[e,a]),d=Object(O.useCallback)((function(t){var n=Object(f.a)(Object(f.a)({},a),{},Object(ie.a)({},t.name,t.value)),o={};for(var r in a)o[r]=n[r]-a[r];e({type:wt,value:o}),i(n)}),[e,a]),b=Object(O.useCallback)((function(){e({type:Lt})}),[e]),p=Object(O.useCallback)((function(e){l(e)}),[]);return Object(A.jsxs)("div",{style:Nl.container,children:[Object(A.jsx)(wl,{onChange:p,data:Bl,value:Ll,style:Nl.select}),c===Ll&&Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(rl,{label:"PH0:",name:"ph0",style:{input:Nl.input},onChange:u,value:a.ph0,type:"number"}),Object(A.jsx)(rl,{label:"PH1:",name:"ph1",style:{input:Nl.input},onChange:u,value:a.ph1,type:"number"}),Object(A.jsx)(_l,{name:"ph0",value:a.ph0,label:"Change Ph0 By mouse click and drag",style:{width:"20%"},onChange:d}),Object(A.jsx)(_l,{name:"ph1",value:a.ph1,label:"Change Ph1 By mouse click and drag",style:{width:"20%"},onChange:d})]}),Object(A.jsx)("button",{type:"button",style:Nl.actionButton,onClick:s,children:"Apply"}),Object(A.jsx)("button",{type:"button",style:Nl.actionButton,onClick:b,children:"Cancel"})]})},Vl={container:{padding:"5px",height:"100%",display:"flex",fontSize:"12px",alignItems:"baseline"},input:{height:"100%",width:"50px",borderRadius:"5px",border:"0.55px solid #c7c7c7",margin:"0px 5px 0px 5px",textAlign:"center"},actionButton:{height:"100%",minWidth:"60px",borderRadius:"5px",border:"0.55px solid #c7c7c7",margin:"0px 5px",userSelect:"none"},hint:{lineHeight:2,userSelect:"none",fontSize:"11px"}};var Yl=function RangesPickingOptionPanel(){var e=useDispatch(),t=Object(O.useRef)(),n=Object(O.useCallback)((function(){e({type:It,options:{peakPicking:{minMaxRatio:.05,nH:100,compile:!0,frequencyCluster:16,clean:!0,keepPeaks:!0,lookNegative:t.current.checked}}})}),[e]),a=Object(O.useCallback)((function(){e({type:Lt})}),[e]);return Object(A.jsxs)("div",{style:Vl.container,children:[Object(A.jsxs)("div",{style:{justifyItems:"baseline",margin:"0 10px"},children:[Object(A.jsx)("label",{style:{marginRight:"2px",lineHeight:2,userSelect:"none"},htmlFor:"lookNegative",children:"Detect negative:"}),Object(A.jsx)(tl,{name:"lookNegative",ref:t})]}),Object(A.jsx)("button",{type:"button",style:Vl.actionButton,onClick:n,children:"Auto ranges picking"}),Object(A.jsx)("button",{type:"button",style:Vl.actionButton,onClick:a,children:"Cancel"}),Object(A.jsx)("span",{style:Vl.hint,children:"Manual selection using SHIFT + select zone or click on Auto peak picking"})]})},Zl={container:{padding:"5px",height:"100%",display:"flex"},input:{height:"100%",width:"50px",borderRadius:"5px",border:"0.55px solid #c7c7c7",margin:"0px 5px 0px 5px",textAlign:"center"},actionButton:{height:"100%",width:"60px",borderRadius:"5px",border:"0.55px solid #c7c7c7",margin:"0px 5px",userSelect:"none"},label:{lineHeight:2,userSelect:"none"}};function formatNumber(e){return e>=1048576?"".concat(e/1048576,"M"):e>=1024?"".concat(e/1024,"K"):e}var Ul=function generateSizes(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:21,n=[],a=e;a<=t;a++){var i=Math.pow(2,a);n.push({key:i,label:formatNumber(i),value:i})}return n}();var Kl=function ZeroFillingOptionsPanel(){var e=useDispatch(),t=useChartData(),n=t.data,a=t.activeSpectrum,i=Object(O.useRef)(),o=Object(O.useState)(1),r=Object(h.a)(o,2),c=r[0],l=r[1],s=Object(O.useCallback)((function(){e({type:Dt,value:{zeroFillingSize:Number(i.current.value),lineBroadeningValue:c}})}),[e,c]),u=Object(O.useCallback)((function(){return n&&(null===a||void 0===a?void 0:a.id)?Math.pow(2,Math.round(Math.log2(n[a.index].data.x.length))):""}),[a,n]),d=Object(O.useCallback)((function(e){if(e.target){var t=e.target.validity.valid?Number(e.target.value):c;l(t)}}),[c]),b=Object(O.useCallback)((function(){e({type:Lt})}),[e]);return Object(A.jsxs)("div",{style:Zl.container,children:[Object(A.jsx)("span",{style:Zl.label,children:"Size: "}),Object(A.jsx)(wl,{ref:i,data:Ul,style:{marginLeft:10,marginRight:10},defaultValue:u()}),Object(A.jsx)("span",{style:Zl.label,children:"Line Broadening: "}),Object(A.jsx)("input",{name:"line-broadening",style:Zl.input,type:"number",defaultValue:c,onInput:d,pattern:"^\\d*(\\.\\d{0,2})?$",step:"any"}),Object(A.jsx)("button",{type:"button",style:Zl.actionButton,onClick:s,children:"Apply"}),Object(A.jsx)("button",{type:"button",style:Zl.actionButton,onClick:b,children:"Cancel"})]})},Wl={container:{padding:"5px",height:"100%",display:"flex",fontSize:"12px"},input:{width:"50px"},inputContainer:{flex:"2"},label:{flex:"5"},actionButton:{height:"100%",borderRadius:"5px",border:"0.55px solid #c7c7c7",margin:"0px 5px",userSelect:"none"}};var Gl,ql=function Zones2DOptionPanel(){var e=useDispatch(),t=Object(O.useRef)(),n=Object(O.useCallback)((function(){e({type:Ft,options:{thresholdFactor:t.current.value}})}),[e]),a=Object(O.useCallback)((function(){e({type:Lt})}),[e]),i=Object(O.useCallback)((function(e){if(e.target){var t=e.target.value;oi.emit("noiseFactorChanged",t)}}),[]);return Object(A.jsxs)("div",{style:Wl.container,children:[Object(A.jsx)(yl,{ref:t,label:"NoiseFactor",name:"noiseFactor",style:{input:Wl.input,inputContainer:Wl.inputContainer,label:Wl.label},defaultValue:1,onChange:i}),Object(A.jsx)("button",{type:"button",style:Wl.actionButton,onClick:n,children:"Auto Zones Picking"}),Object(A.jsx)("button",{type:"button",style:Wl.actionButton,onClick:a,children:"Cancel"})]})},Jl=Object(m.b)(Gl||(Gl=Object(g.a)(["\n  display: flex;\n  align-items: flex-start;\n  justify-content: flex-start;\n  height: 36px;\n  min-height: 36px;\n  border-width: 1px 1px 0px 1px;\n  border-style: solid;\n  border-color: rgb(213, 213, 213);\n  outline: none;\n  transition: background-color 0.2s ease-in 0s;\n  box-shadow: rgb(255, 255, 255) 0px 1px 0px 0px inset;\n  background: linear-gradient(rgb(255, 255, 255) 5%, rgb(246, 246, 246) 100%)\n    rgb(255, 255, 255);\n  color: rgb(102, 102, 102);\n  font-family: Arial;\n  font-weight: bold;\n  text-decoration: none;\n  text-shadow: rgb(255, 255, 255) 0px 1px 0px;\n\n  .toolOptionsPanel {\n    flex: 10;\n    padding: 0px;\n    margin: 0px;\n    height: 100%;\n  }\n\n  .windowButtonsContainer {\n    flex: 0.5;\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n    height: 100%;\n  }\n\n  .windowButton {\n    width: 40px !important;\n    min-width: 40px !important;\n    background-color: transparent;\n    border: none;\n  }\n  button:focus {\n    outline: 0;\n  }\n"])));function Button(e){var t=e.title,n=e.popupPlacement,a=e.style,i=e.className,o=e.onClick,r=e.children,c=e.helpID,l=void 0===c?"":c,s=useHelp();return Object(me.b)(Zn,{title:t,popupPlacement:n,style:a,children:Object(me.b)("button",Object(f.a)(Object(f.a)({type:"button",onClick:o,className:i},s.onHover),{},{"data-helpid":l,children:r}))})}function Header_Header(e){var t=e.isFullscreen,n=e.onMaximize,a=useChartData().selectedOptionPanel,i=$(),o=dc(),r=Object(O.useMemo)((function(){switch(a){case Ua.zeroFilling.id:return Object(me.b)(Kl,{});case Ua.phaseCorrection.id:return Object(me.b)(Xl,{});case Ua.peakPicking.id:return Object(me.b)(Dl,{});case Ua.rangesPicking.id:return Object(me.b)(Yl,{});case Ua.baseLineCorrection.id:return Object(me.b)(Ml,{});case Ua.zone2D.id:return Object(me.b)(ql,{})}}),[a]),c=Object(O.useCallback)((function(){i.show(Object(me.b)(gl,{onSave:function onSave(){o.success("Settings saved successfully"),i.close()}}),{position:Y.TOP_CENTER,enableResizing:!0,width:600,height:400})}),[o,i]),l=Object(O.useCallback)((function(){i.show(Object(me.b)(Sc,{}),{isBackgroundBlur:!1,position:Y.TOP_CENTER,enableResizing:!0,width:800,height:600})}),[i]);return Object(me.c)("div",{css:Jl,children:[Object(me.b)("div",{className:"toolOptionsPanel",children:r}),Object(me.c)("div",{className:"windowButtonsContainer",children:[Object(me.b)(Button,{title:"User Manual",popupPlacement:"left",style:{mainContainer:{height:"auto"}},onClick:l,className:"windowButton",children:Object(me.b)(_e.z,{})}),Object(me.b)(Button,{title:"General Settings",popupPlacement:"left",style:{mainContainer:{height:"auto"}},onClick:c,className:"windowButton",children:Object(me.b)(_e.J,{})}),t?"":Object(me.b)(Button,{title:"Full Screen",popupPlacement:"left",style:{mainContainer:{height:"auto"}},onClick:n,className:"windowButton",helpID:"fullScreen",children:Object(me.b)(_e.C,{})})]})]})}Header_Header.defaultProps={onMaximize:function onMaximize(){return null}};var $l=Header_Header,Ql=0,es=!1,ts={container:{display:"flex",flexDirection:"column",margin:"0px",userSelect:"none"},button:{cursor:"pointer",padding:"5px 12px",display:"flex",alignItems:"center",fontSize:"11px",border:"none",outline:"none",transition:"background-color 0.2s ease-in",boxShadow:"inset 0px 1px 0px 0px #ffffff",background:"linear-gradient(to bottom, #f0f0f0 5%, #e1e1e1 100%)",filter:'progid:DXImageTransform.Microsoft.gradient(startColorstr="#f0f0f0", endColorstr="#e1e1e1",GradientType=0)',backgroundColor:"#ffffff",color:"#2d2d2d",fontFamily:"Arial",fontWeight:"bold",textDecoration:"none",textShadow:"0px 1px 0px #ffffff",borderTop:"0.55px  solid #d5d5d5"},buttonTitle:{padding:0,margin:0},content:{backgroundColor:"white",maxHeight:"0",overflow:"hidden",flex:"1 1 1px"}},ns=1,as=2;function AccordionItem(e){var t=e.title,n=e.children,a=e.index,i=e.isOpen,o=e.onOpen,r=e.style,c=Object(O.useState)(null),l=Object(h.a)(c,2),s=l[0],u=l[1],d=Object(O.useRef)(),b=Object(O.useRef)(),p=Object(O.useCallback)((function(e){Ql=setTimeout((function(){es||o(a,{source:ns,shiftKey:e.shiftKey}),es=!1}),200)}),[a,o]),g=Object(O.useCallback)((function(e){e.persist(),clearTimeout(Ql),es=!0,o(a,{source:as,shiftKey:e.shiftKey})}),[a,o]);return Object(O.useEffect)((function(){u(i?{backgroundColor:"#ccc"}:null)}),[i]),Object(A.jsxs)("div",{ref:b,style:Object(f.a)(Object(f.a)({},ts.container),{},{flex:null==s?0:"1 1 1px",transition:i?"flex 0.2s ease":""}),className:"custom-accordion",children:[Object(A.jsx)("button",{type:"button",style:ts.button,onClick:p,onDoubleClick:g,children:Object(A.jsx)("p",{style:ts.buttonTitle,children:t})}),Object(A.jsx)("div",{ref:d,style:Object(f.a)(Object(f.a)({},ts.content),{},{maxHeight:null==s?0:"100%"},r),children:n})]})}AccordionItem.defaultProps={onOpen:function onOpen(){return null}};var is=AccordionItem,os={container:{height:"100%",width:"100%",display:"flex",flexDirection:"column"}},rs=[],cs=null;var ls,ss,us,ds=function Accordion(e){var t=e.children,n=e.defaultOpenIndex,a=void 0===n?0:n,i=Object(O.useState)([]),o=Object(h.a)(i,2),r=o[0],c=o[1],l=Object(O.useRef)(),s=Object(O.useCallback)((function(e,t){var n=r.slice();t.source===ns?n=n.map((function(t,n){return n===e&&cs!==e?!t:t})):(n=n.map((function(t,n){return n===e})),cs=t.shiftKey?cs===e?null:e:null),rs=n,c(n)}),[r]),u=Object(O.useMemo)((function(){return O.Children.map(t,(function(e,t){return e&&Object(O.cloneElement)(e,{onOpen:s,index:t,isOpen:r&&r[t]})}))}),[t,r,s]);return Object(O.useEffect)((function(){null!=a&&c((function(e){return e.length>0?e.map((function(e,t){return rs[t]?e:t===a})):(rs=Array(t.length).fill(!1).map((function(e){return e})),Array(t.length).fill(!1).map((function(e,t){return t===a||e})))}))}),[t.length,a]),Object(A.jsx)("div",{ref:l,style:os.container,children:u})},bs=n(369),ps=Object(m.b)(ls||(ls=Object(g.a)(["\n  background-color: #ff6f0057;\n"]))),fs=Object(m.b)(ss||(ss=Object(g.a)(["\n  background-color: #f5f5dc;\n"]))),hs=Object(m.b)(us||(us=Object(g.a)(["\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  height: 100%;\n  font-size: 12px;\n\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  th,\n  td {\n    margin: 0;\n    padding: 0.15rem 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n    }\n  }\n"])));function ReactTableFlexLayout(e){var t=e.data,n=e.columns,a=e.onMouseDown,i=Object(bs.useTable)({columns:n,data:t},bs.useSortBy,bs.useFlexLayout),o=i.getTableProps,r=i.getTableBodyProps,c=i.headerGroups,l=i.rows,s=i.prepareRow;return Object(me.c)("table",Object(f.a)(Object(f.a)({},o()),{},{css:hs,children:[Object(me.b)("thead",{children:c.map((function(e){return Object(me.b)("tr",Object(f.a)(Object(f.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e){return Object(me.c)("th",Object(f.a)(Object(f.a)({},e.getHeaderProps(e.getSortByToggleProps())),{},{children:[e.render("Header"),Object(me.b)("span",{children:e.isSorted?e.isSortedDesc?" \u25bc":" \u25b2":""})]}),e.getHeaderProps().key)}))}),e.getHeaderGroupProps().key)}))}),Object(me.b)("tbody",Object(f.a)(Object(f.a)({},r()),{},{style:{display:"block",height:"100%",overflowY:"auto"},children:l.map((function(e){return s(e),Object(me.b)("tr",Object(f.a)(Object(f.a)({},e.getRowProps()),{},{onMouseDown:a,children:e.cells.map((function(e){return Object(me.b)("td",Object(f.a)(Object(f.a)({},e.getCellProps()),{},{style:Object(f.a)(Object(f.a)({},e.getCellProps().style),{},{padding:"0px"}),children:e.render("Cell")}),e.getCellProps().key)}))}),e.getRowProps().key)}))}))]}))}ReactTableFlexLayout.defaultProps={onMouseDown:function onMouseDown(){return null}};var gs=Object(O.memo)(ReactTableFlexLayout);var ms={container:{height:"100%"},tableContainer:{height:"calc(100% - 30px)"},searchInput:{width:"100%",borderRadius:"5px",border:"0.55px solid gray",padding:"5px",marginBottom:"2px"}};function InformationPanel(e){var t=e.info,n=e.meta,a=Object(O.useState)({}),i=Object(h.a)(a,2),o=i[0],r=i[1],c=Object(O.useState)([]),l=Object(h.a)(c,2),s=l[0],u=l[1],d=Object(O.useRef)(),b=Object(O.useCallback)((function(e){var t=Object.keys(o).filter((function(t){return t.toLowerCase().includes(e.target?e.target.value.toLowerCase():e.toLowerCase())}));u(t)}),[o]);Object(O.useEffect)((function(){d.current&&b(d.current.value)}),[b,d]),Object(O.useEffect)((function(){if(t&&n){var e=Object.keys(t).concat(Object.keys(n));u(e),r(Object(f.a)(Object(f.a)({},t),n))}}),[t,n]);var p=Object(O.useMemo)((function(){return[{Header:"Parameter",sortType:"basic",minWidth:100,width:20,maxWidth:20,Cell:function Cell(e){var t=e.row;return Object(A.jsx)("p",{style:{padding:"5px",backgroundColor:"white"},children:t.original})}},{Header:"Value",sortType:"basic",resizable:!0,Cell:function Cell(e){var t=e.row;return Object(A.jsx)("p",{style:{backgroundColor:"#efefef",height:"100%",padding:"5px",fontFamily:"monospace",whiteSpace:"pre",overflow:"hidden"},children:o[t.original].toString()})}}]}),[o]);return Object(A.jsxs)("div",{style:ms.container,children:[Object(A.jsx)("div",{children:Object(A.jsx)("input",{type:"text",style:ms.searchInput,placeholder:"Search for parameter...",onChange:b,ref:d})}),Object(A.jsx)("div",{style:ms.tableContainer,children:Object(A.jsx)(gs,{data:s,columns:p})})]})}var js=function InfoWrapper(e){var t=function Wrapper(t){var n=useChartData(),a=n.data,i=n.activeSpectrum,o=Object(O.useMemo)((function(){return a&&i&&i.id?a.find((function(e){return e.id===i.id}))||{info:{},meta:{}}:{}}),[i,a]),r=o.info,c=void 0===r?{}:r,l=o.meta,s=void 0===l?{}:l,u=t.forwardedRef,d=Object(le.a)(t,["forwardedRef"]);return Object(A.jsx)(e,Object(f.a)(Object(f.a)({},d),{},{info:c,meta:s,ref:u}))};return Object(O.forwardRef)((function(e,n){return Object(A.jsx)(t,Object(f.a)(Object(f.a)({},e),{},{forwardedRef:n}))}))}(Object(O.memo)(InformationPanel)),vs=n(205),Os=n(239),xs=n.n(Os);var ys,ks=function IntegralsWrapper(e){var t=function Wrapper(t){var n=useChartData(),a=n.data,i=n.activeSpectrum,o=n.xDomain,r=n.activeTab,c=n.tabActiveSpectrum,l=n.molecules,s=usePreferences(),u=Object(O.useMemo)((function(){return a&&i&&i.id?a.find((function(e){return e.id===i.id}))||{integrals:{},info:{}}:{}}),[i,a]),d=u.integrals,b=void 0===d?{}:d,p=u.info,h=void 0===p?{}:p,g=Object(O.useMemo)((function(){return c&&Object.keys(c).length>0?Object.keys(c):null}),[c]),m=t.forwardedRef,j=Object(le.a)(t,["forwardedRef"]);return Object(A.jsx)(e,Object(f.a)(Object(f.a)({},j),{},{integrals:b,info:h,xDomain:o,preferences:s,activeTab:r,nucleus:g,molecules:l,ref:m}))};return Object(O.forwardRef)((function(e,n){return Object(A.jsx)(t,Object(f.a)(Object(f.a)({},e),{},{forwardedRef:n}))}))},Cs=Object(m.b)(ys||(ys=Object(g.a)(["\n  display: flex;\n  flex-direction: column;\n  width: 450px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    display: flex;\n    margin: 30px 5px;\n    input,\n    button {\n      padding: 5px;\n      border: 1px solid gray;\n      border-radius: 5px;\n      height: 36px;\n      margin: 2px;\n    }\n    input {\n      flex: 10;\n    }\n    button {\n      flex: 2;\n      color: white;\n      background-color: gray;\n    }\n  }\n"])));function changeSum_NumberInput_NumberInput(e){var t=e.onSave,n=e.onClose,a=e.header,i=Object(O.useRef)(),o=Object(O.useCallback)((function(){t(i.current.value)}),[t]),r=Object(O.useCallback)((function(e){"Enter"===e.key&&t(i.current.value)}),[t]);return Object(me.c)("div",{css:Cs,children:[Object(me.c)("div",{className:"header handle",children:[Object(me.b)("span",{children:a}),Object(me.b)(Gn,{onClick:n})]}),Object(me.c)("div",{className:"container",children:[Object(me.b)("input",{ref:i,type:"number",placeholder:"Enter the new value",onKeyDown:r}),Object(me.b)("button",{type:"button",onClick:o,children:"Set"})]})]})}changeSum_NumberInput_NumberInput.defaultProps={onSave:function onSave(){return null},onClose:function onClose(){return null}};var Ds,Ss,ws,Ts,Ms=changeSum_NumberInput_NumberInput,As=n(606),Es=n.n(As),Ps=n(264),Is=n(742);function Arrow(e){var t=e.direction,n=e.onClick;return Object(me.b)("div",{onClick:n,css:Object(m.b)(Ds||(Ds=Object(g.a)(["\n        display: flex;\n        position: absolute;\n        top: calc(50% - 18px);\n        ",";\n        height: 36px;\n        width: 36px;\n        justify-content: center;\n        background: white;\n        border-radius: 50%;\n        cursor: pointer;\n        align-items: center;\n        border: none;\n        transition: transform ease-in 0.1s;\n        &:hover {\n          transform: scale(1.2);\n          background-color: #607d8b;\n          color: white;\n        }\n        img {\n          transform: translateX(","px);\n          &:focus {\n            outline: 0;\n          }\n        }\n      "])),"right"===t?"right: 25px":"left: 25px","left"===t?"-2":"2"),children:Object(me.b)(_e.a,{style:{transform:"scaleX(".concat("right"===t?"-1":"1",")")}})})}function NextPrev(e){var t=e.children,n=e.loop,a=e.defaultIndex,i=e.onChange,o=Object(Is.a)(),r=Object(h.a)(o,2),c=r[0],l=r[1].width,s=Object(O.useState)(0),u=Object(h.a)(s,2),d=u[0],b=u[1];Object(O.useEffect)((function(){b(a)}),[a]);var p=Object(O.useMemo)((function(){return O.Children.map(t,(function(e){return Object(me.b)("div",{css:Object(m.b)(Ss||(Ss=Object(g.a)(["\n              width: ","px;\n              height: 100%;\n            "])),l),children:e},e.key)}))}),[t,l]),f=Object(O.useCallback)((function(){b((function(e){if(e===p.length-1)return i(e),n?0:e;var t=e+1;return i(t),t}))}),[p.length,n,i]),j=Object(O.useCallback)((function(){b((function(e){if(0===e)return i(e),n?0:e;var t=e-1;return i(t),t}))}),[n,i]);return l||p?Object(me.c)("div",{css:Object(m.b)(ws||(ws=Object(g.a)(["\n        position: relative;\n        height: 100%;\n        width: 100%;\n        margin: 0 auto;\n        overflow: hidden;\n      "]))),ref:c,children:[Object(me.b)("div",{css:Object(m.b)(Ts||(Ts=Object(g.a)(["\n          transform: translateX(-","px);\n          transition: transform ease-out ","s;\n          height: 100%;\n          width: ","px;\n          display: flex;\n        "])),l*d,.45,l*p.length),children:p}),0!==d&&Object(me.b)(Arrow,{direction:"left",onClick:j}),d!==p.length-1&&Object(me.b)(Arrow,{direction:"right",onClick:f})]}):null}NextPrev.defaultProps={loop:!1,defaultIndex:0,onChange:function onChange(){return null}};var Fs,Rs,_s=Object(O.memo)(NextPrev),Ns=Object(m.b)(Fs||(Fs=Object(g.a)(["\n  display: flex;\n  flex-direction: row;\n  border-top: 0.55px solid rgb(240, 240, 240);\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n  padding: 0px 5px;\n\n  p {\n    margin: 0;\n    text-align: right;\n    width: 100%;\n    line-height: 22px;\n    padding: 0px 10px;\n  }\n"]))),Ls=Object(m.b)(Rs||(Rs=Object(g.a)(["\n  width: 450px;\n\n  .slider {\n    height: 180px;\n    width: 100%;\n    padding: 0px;\n    height: 180px;\n    width: 100%;\n    padding: 0px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n  }\n  .slider p {\n    width: 100%;\n    margin: 0 auto;\n    display: block;\n    position: relative;\n    text-align: center;\n  }\n  .slider svg polygon {\n    fill: gray !important;\n  }\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 36px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n"])));function MoleculeSelection(e){var t=e.molecules,n=e.onChange,a=Object(O.useState)(),i=Object(h.a)(a,2),o=i[0],r=i[1];Object(O.useEffect)((function(){t&&t.length>0&&r(0)}),[t]);var c=Object(O.useCallback)((function(e){r(e),n(e)}),[n]);return Object(me.c)("div",{children:[Object(me.b)("div",{css:Ns,children:Object(me.c)("p",{children:[t&&t.length>0&&"".concat(+(o+1)," / ").concat(t.length)," "]})}),Object(me.b)("div",{css:Ls,children:Object(me.b)(_s,{onChange:c,children:t&&t.map((function(e,t){return Object(me.c)("div",{className:"slider",children:[Object(me.b)("div",{children:Object(me.b)(Ps.a,{id:"molSVG".concat(t),width:120,molfile:e.molfile})}),Object(me.c)("p",{children:[Object(me.b)(Es.a,{mf:e.mf})," - ",e.mw.toFixed(2)]})]},e.key)}))})})]})}MoleculeSelection.defaultProps={onChange:function onChange(){return null}};var zs,Hs,Bs,Xs=MoleculeSelection,Vs=Object(m.b)(zs||(zs=Object(g.a)(["\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n"]))),Ys=Object(m.b)(Hs||(Hs=Object(g.a)(["\n  display: flex;\n  flex-direction: column;\n  padding: 5px;\n\n  .optional {\n    margin-top: 5px;\n    margin-bottom: 5px;\n    padding: 0px 10px;\n\n    text-align: center;\n    font-size: 18px;\n    font-weight: bold;\n  }\n  .optional2 {\n    margin-top: 5px;\n    margin-bottom: 25px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n"]))),Zs=Object(m.b)(Bs||(Bs=Object(g.a)(["\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 36px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .newSumText {\n    margin-top: 15px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n"])));function SelectMolecule(e){var t=e.onSave,n=e.molecules,a=e.element,i=Object(O.useState)(),o=Object(h.a)(i,2),r=o[0],c=o[1],l=usePreferences().display,s=l.general,u=l.panels,d=Object(O.useMemo)((function(){return a&&n&&n.length>0&&void 0!==r&&n[r].atoms[a]?n[r].atoms[a]:0}),[r,a,n]);Object(O.useEffect)((function(){n&&n.length>0&&c(0)}),[n]);var b=Object(O.useCallback)((function(e){e.preventDefault(),t(d)}),[d,t]),p=Object(O.useCallback)((function(e){c(e)}),[]);return!s.hideSetSumFromMolecule&&!u.hideStructuresPanel&&a&&n&&n.length>0?Object(me.c)("div",{css:Vs,children:[Object(me.c)("div",{css:Ys,children:[Object(me.b)("p",{className:"optional",children:"OR"}),Object(me.b)("p",{className:"optional2",children:"Select a molecule as reference!"})]}),Object(me.c)("div",{css:Zs,children:[Object(me.b)(Xs,{molecules:n,onChange:p}),Object(me.b)("button",{type:"button",onClick:b,children:"Set"}),Object(me.c)("p",{className:"newSumText",children:["New sum for ",a," will be ",d,"!"]})]})]}):null}SelectMolecule.defaultProps={onSave:function onSave(){return null}};var Us,Ks=SelectMolecule,Ws=Object(m.b)(Us||(Us=Object(g.a)(["\n  display: flex;\n  flex-direction: column;\n  padding: 5px;\n"])));function ChangeSumModal(e){var t=e.onSave,n=e.onClose,a=e.header,i=e.molecules,o=e.element,r=Object(O.useCallback)((function(e){t(e)}),[t]),c=Object(O.useCallback)((function(e){t(e)}),[t]);return Object(me.c)("div",{css:Ws,children:[Object(me.b)(Ms,{onSave:r,onClose:n,header:a}),Object(me.b)(Ks,{onSave:c,molecules:i,element:o})]})}ChangeSumModal.defaultProps={onSave:function onSave(){return null},onClose:function onClose(){return null}};var Gs,qs=ChangeSumModal,Js=Object(m.b)(Gs||(Gs=Object(g.a)(["\n  background-color: transparent;\n  border: none;\n  border-radius: 5px;\n\n  &:hover {\n    background-color: lightgray;\n  }\n\n  &.toggle-active {\n    background-color: gray;\n    color: white;\n  }\n"])));function ToggleButton(e){var t=e.children,n=e.style,a=e.onClick,i=e.popupTitle,o=e.popupPlacement,r=e.defaultValue,c=e.disabled,l=Object(O.useState)(r),s=Object(h.a)(l,2),u=s[0],d=s[1],b=Object(O.useCallback)((function(){a(!u),d(!u)}),[a,u]);return Object(me.b)(Zn,{title:i,popupPlacement:o,children:Object(me.b)("button",{disabled:c,css:Js,style:n,className:u?"toogle toggle-active":"toggle",type:"button",onClick:b,children:t})})}ToggleButton.defaultProps={popupTitle:"",popupPlacement:"right",style:{},defaultValue:!1,onClick:function onClick(){return null},disabled:!1};var $s,Qs=Object(O.memo)(ToggleButton),eu=Object(m.b)($s||($s=Object(g.a)(["\n  \n  display: flex;\n  flex-direction: row;\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n  padding: 0px 5px;\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n\n  button:disabled{\n    opacity:0.6;\n  }\n  \n  .counter-label {\n    margin: 0;\n    text-align: right;\n    width: 100%;\n    line-height: 22px;\n    padding: 0px 10px;\n  }\n\n  filter-button{\n    borderRadius: 5px;\n    marginTop: 3px;\n    marginLeft: 5px;\n    color: black;\n    backgroundColor: transparent;\n    border: none;\n    height: 16px;\n    width: 18px;\n    fontSize: 12px;\n    padding: 0;\n  },\n\n"])));function DefaultPanelHeader(e){var t=e.counter,n=e.onDelete,a=e.deleteToolTip,i=e.onFilter,o=e.filterToolTip,r=e.filterIsActive,c=e.counterFiltered,l=e.children,s=e.onSettingClick,u=e.showSettingButton,d=e.canDelete;return Object(me.c)("div",{css:eu,children:[d&&Object(me.b)(Zn,{title:a,popupPlacement:"right",children:Object(me.b)("button",{type:"button",onClick:n,disabled:0===t,children:Object(me.b)(_e.B,{})})}),i&&o?Object(me.b)(Qs,{popupTitle:o,popupPlacement:"right",onClick:i,children:Object(me.b)(_e.s,{style:{pointerEvents:"none",fontSize:"12px"}})}):null,l,t?Object(me.c)("p",{className:"counter-label",children:["["," ",r&&!0===r&&void 0!==c?"".concat(c,"/").concat(t):t," ","]"]}):Object(me.b)("p",{style:{flex:1}}),u&&Object(me.b)(Zn,{title:"preferences",popupPlacement:"left",children:Object(me.b)("button",{type:"button",onClick:s,children:Object(me.b)(_e.d,{})})})]})}DefaultPanelHeader.defaultProps={counter:0,onDelete:function onDelete(){return null},deleteToolTip:"Delete",onFilter:function onFilter(){return null},filterToolTip:"",filterIsActive:!1,counterFiltered:0,onSettingClick:function onSettingClick(){return null},showSettingButton:!1,canDelete:!0};var tu,nu=Object(O.memo)(DefaultPanelHeader),au=Object(m.b)(tu||(tu=Object(g.a)(["\n  background-color: transparent;\n  border: none;\n  height: 100%;\n  svg {\n    fill: green;\n    font-size: 16px;\n  }\n"])));function SaveButton(e){var t=e.onClick,n=e.popupTitle,a=e.popupPlacement,i=e.disabled,o=e.className;return Object(me.b)("div",{className:o,children:Object(me.b)(Zn,{title:n,popupPlacement:a,children:Object(me.b)("button",{css:au,type:"button",onClick:t,disabled:i,className:o,children:Object(me.b)(_e.c,{})})})})}SaveButton.defaultProps={onClick:function onClick(){return null},popupTitle:"Save",popupPlacement:"left",disabled:!1,className:""};var iu,ou=Object(O.memo)(SaveButton),ru=Object(m.b)(iu||(iu=Object(g.a)(["\n  display: flex;\n  flex-direction: row-reverse;\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n  button:disabled {\n    opacity: 0.6;\n  }\n"])));function PreferencesHeader(e){var t=e.onClose,n=e.onSave;return Object(me.c)("div",{css:ru,children:[Object(me.b)(Gn,{onClick:t,popupTitle:"close Preferences"}),Object(me.b)(ou,{onClick:n,popupTitle:"save Preferences"})]})}var cu=Object(O.memo)(PreferencesHeader),lu=Object(O.forwardRef)((function EditableColumn(e,t){var n=e.onSave,a=e.value,i=e.type,o=e.style,r=e.onEditStart,c=e.editStatus,l=Object(O.useState)(),s=Object(h.a)(l,2),u=s[0],d=s[1],b=Object(O.useRef)();Object(O.useEffect)((function(){d(c)}),[c]),Object(O.useImperativeHandle)(t,(function(){return{startEdit:function startEdit(){d(!0)},closeEdit:function closeEdit(){d(!1)}}}));var p=Object(O.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e?(r(t),d(e)):13===t.keyCode?(n(t),d(e)):27===t.keyCode&&d(e)}),[r,n]);return Object(A.jsxs)("div",{style:Object(f.a)({display:"table",width:"100%",height:"100%"},o),onDoubleClick:function onDoubleClick(e){return p(!0,e)},children:[!u&&Object(A.jsx)("span",{style:{display:"table-cell",verticalAlign:"middle"},children:a}),u&&Object(A.jsx)("div",{style:{display:"table-cell",verticalAlign:"middle"},children:Object(A.jsx)(rl,{enableAutoSelect:!0,ref:b,value:a,type:i,onKeyDown:function onKeyDown(e){return p(!1,e)}})})]})}));lu.defaultProps={onSave:function onSave(){return null},onEditStart:function onEditStart(){return null},type:"text",editStatus:!1};var su,uu=lu,du=Object(m.b)(su||(su=Object(g.a)(["\n  box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.25);\n  padding: 0px;\n  margin: 0px;\n  border-radius: 2px;\n  display: flex;\n  flex-direction: column;\n  position: fixed;\n  z-index: 99999;\n  padding: 2px;\n  background-color: white;\n  width: 150px;\n  button {\n    background-color: transparent;\n    border: none;\n    border-bottom: 0.55px solid #f0f0f0;\n    font-size: 11px;\n    padding: 5px;\n    text-align: left;\n    outline: none;\n  }\n  button:hover {\n    background-color: #fafafa;\n    outline: none;\n  }\n\n  button:active {\n    background-color: #eaeaea;\n    outline: none;\n  }\n\n  button:last-of-type {\n    border: none;\n  }\n"])));function ContextMenu(e,t){var n=e.context,a=Object(O.useState)({lef:0,top:0}),i=Object(h.a)(a,2),o=i[0],r=i[1],c=useGlobal(),l=c.rootRef,s=c.elementsWraperRef,u=Object(O.useState)(),d=Object(h.a)(u,2),b=d[0],p=d[1],f=Object(O.useState)(),g=Object(h.a)(f,2),m=g[0],j=g[1],v=Object(O.useState)(null),x=Object(h.a)(v,2),y=x[0],k=x[1],C=Object(O.useRef)();Object(O.useEffect)((function(){return C.current=document.createElement("div"),s&&s.appendChild(C.current),function(){C.current&&s&&s.removeChild(C.current)}}),[s]);Object(O.useImperativeHandle)(t,(function(){return{handleContextMenu:function handleContextMenu(e,t){p(t),function contextMenuHandler(e){e.preventDefault(),k(e.target.parentElement),j(!0);var t=e.clientX,n=e.clientY,a=window.innerWidth-t>150,i=!a,o=window.innerHeight-n>0,c=!o;a&&(i="".concat(t+5,"px")),i&&(i="".concat(t-150-5,"px")),o&&(o="".concat(n+5,"px")),c&&(o="".concat(n-0-5,"px")),r({left:i,top:o})}(e)}}}));var D=Object(O.useCallback)((function(e,t){e.preventDefault(),t(b),j(!1)}),[b]);return Object(O.useEffect)((function(){var e=function _handleGlobalClick(e){y&&e.target.parentElement&&!e.target.parentElement.isSameNode(y)&&m&&j(!1)};return l&&l.addEventListener("click",e),function(){l&&l.removeEventListener("click",e)}}),[m,t,l,y]),m?C.current&&Object(oe.createPortal)(n&&Object(me.b)("div",{ref:t,css:[du,o],children:n.map((function(e,t){return Object(me.b)("button",{type:"button",onClick:function onClick(t){return D(t,e.onClick)},children:e.label},t)}))}),C.current):null}var bu=Object(O.forwardRef)(ContextMenu),pu=function ReactTableHeader(e){var t=e.headerGroups;return Object(A.jsx)("thead",{children:t.map((function(e){return Object(A.jsx)("tr",Object(f.a)(Object(f.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e){return Object(A.jsxs)("th",Object(f.a)(Object(f.a)({},e.getHeaderProps(e.getSortByToggleProps())),{},{children:[e.render("Header"),Object(A.jsx)("span",{children:e.isSorted?e.isSortedDesc?" \u25bc":" \u25b2":""})]}),e.getHeaderProps().key)}))}),e.getHeaderGroupProps().key)}))})},fu=function ReactTableRow(e){var t=e.row,n=e.onContextMenu,a=Object(pi.c)([Object.prototype.hasOwnProperty.call(t.original,"id")?t.original.id:""]);return Object(me.b)("tr",Object(f.a)(Object(f.a)(Object(f.a)({onContextMenu:n,css:a.isActive?ps:Object.prototype.hasOwnProperty.call(t.original,"isConstantlyHighlighted")&&!0===t.original.isConstantlyHighlighted?fs:null},t.getRowProps()),a.onHover),{},{children:t.cells.map((function(e){var t=e.column,n=t.minWidth,a=t.maxWidth,i=t.width,o=t.padding;return Object(me.b)("td",Object(f.a)(Object(f.a)({},e.getCellProps()),{},{onContextMenu:function onContextMenu(e){return e.preventDefault(),!1},style:{minWidth:n,maxWidth:a,width:i,padding:o},children:e.render("Cell")}),e.key)}))}),t.getRowProps().key)};function ReactTable(e){var t=e.data,n=e.columns,a=e.context,i=Object(O.useRef)(),o=Object(bs.useTable)({columns:n,data:t},bs.useSortBy),r=o.getTableProps,c=o.getTableBodyProps,l=o.headerGroups,s=o.rows,u=o.prepareRow,d=Object(O.useCallback)((function(e,t){checkModifierKeyActivated(e)||(e.preventDefault(),i.current.handleContextMenu(e,t.original))}),[i]);return Object(me.c)(O.Fragment,{children:[Object(me.c)("table",Object(f.a)(Object(f.a)({},r()),{},{css:hs,children:[Object(me.b)(pu,{headerGroups:l}),Object(me.b)("tbody",Object(f.a)(Object(f.a)({},c()),{},{children:s.map((function(e){return u(e),Object(me.b)(fu,Object(f.a)(Object(f.a)({row:e},e.getRowProps()),{},{onContextMenu:function onContextMenu(t){return d(t,e)}}),e.key)}))}))]})),Object(me.b)(bu,{ref:i,context:a})]})}ReactTable.defaultProps={context:null};var hu=Object(O.memo)(ReactTable);var gu=function NoTableData(){return Object(A.jsx)("p",{style:{textAlign:"center",width:"100%",fontSize:"11px",padding:"5px",color:"gray"},children:"No Data"})},mu={marginLeft:10,marginRight:10,border:"none"};function IntegralTable(e){var t=e.integrals,n=e.info,a=e.activeTab,i=e.xDomain,o=e.enableFilter,r=e.onFilter,c=e.preferences,l=useDispatch(),s=Object(O.useRef)([]),u=useGlobal().rootRef,d=Object(O.useCallback)((function(e,t){e.preventDefault(),e.stopPropagation();var n=t.original;l({type:ct,integralID:n.id})}),[l]),b=Object(O.useCallback)((function(e,t){var n=Object(f.a)(Object(f.a)({},t.original),{},{kind:e});l({type:Ht,data:n})}),[l]),p=Object(O.useMemo)((function(){return[{orderIndex:1,Header:"#",Cell:function Cell(e){return e.row.index+1},width:10},{orderIndex:2,Header:"From",accessor:"from",sortType:"basic",resizable:!0,Cell:function Cell(e){return e.row.original.from.toFixed(2)}},{orderIndex:3,Header:"To",accessor:"to",sortType:"basic",resizable:!0,Cell:function Cell(e){return e.row.original.to.toFixed(2)}},{orderIndex:6,Header:"Kind",accessor:"kind",sortType:"basic",resizable:!0,Cell:function Cell(e){var t=e.row;return Object(A.jsx)(wl,{onChange:function onChange(e){return b(e,t)},data:Wi,style:mu,defaultValue:t.original.kind})}},{orderIndex:7,Header:"",width:"1%",maxWidth:"24px",minWidth:"24px",id:"delete-button",Cell:function Cell(e){var t=e.row;return Object(A.jsx)("button",{type:"button",className:"delete-button",onClick:function onClick(e){return d(e,t)},children:Object(A.jsx)(_e.B,{})})}}]}),[b,d]),h=Object(O.useCallback)((function(e,t){l({type:un,value:e.target.value,id:t.id})}),[l]),g=Object(O.useCallback)((function(e){s.current.forEach((function(t,n){e!==n&&t&&t.closeEdit()}))}),[]);Object(O.useEffect)((function(){return u&&u.addEventListener("mousedown",g),function(){u&&u.removeEventListener("mousedown",g)}}),[g,u]);var m=Object(O.useMemo)((function(){var e=function setCustomColumn(e,t,n,a){e.push({orderIndex:t,Header:n,sortType:"basic",Cell:function Cell(e){var t=e.row;return a(t)}})},t=ra(c,"formatting.panels.integrals.[".concat(a,"]")),n=Object(Ee.a)(p);if(v()(t,"showAbsolute",ui.showAbsolute)&&e(n,4,"Absolute",(function(e){return Mi(e.original.absolute,v()(t,"absoluteFormat",ui.absoluteFormat))})),v()(t,"showRelative",ui.showRelative)){var i=a&&a.replace(/[0-9]/g,"");e(n,5,"Relative ".concat(i),(function(e){var n=Mi(e.original.integral,v()(t,"relativeFormat",ui.relativeFormat));return Object(A.jsx)(uu,{onEditStart:function onEditStart(){return g(e.index)},ref:function ref(t){return s.current[e.index]=t},value:n,onSave:function onSave(t){return h(t,e.original)},type:"number"})}))}return n.sort((function(e,t){return e.orderIndex-t.orderIndex}))}),[a,p,g,c,h]),j=Object(O.useMemo)((function(){function isInRange(e,t){var n=1e4;return e*=n,(t*=n)>=i[0]*n&&e<=i[1]*n||e<=i[0]*n&&t>=i[1]*n}return 1===n.dimension&&t&&t.values?(o?t.values.filter((function(e){return isInRange(e.from,e.to)})):t.values).map((function(e){return Object(f.a)(Object(f.a)({},e),{},{isConstantlyHighlighted:isInRange(e.from,e.to)})})):[]}),[o,n.dimension,t,i]);return Object(O.useEffect)((function(){r(j.length)}),[j,r]),j&&j.length>0?Object(A.jsx)(hu,{data:j,columns:m}):Object(A.jsx)(gu,{})}var ju,vu=ks(Object(O.memo)(IntegralTable)),Ou=n(371),xu=Object(m.b)(ju||(ju=Object(g.a)(["\n  display: flex;\n  margin: 5px 0px;\n\n.inputLabel{\n  flex: 2;\n  font-size: 11px;\n  font-weight: bold;\n  color: #232323;\n}\n\n.input {\n  width: '60%',\n  text-align: 'center',\n}\n\n.color{\n  width: 36px;\n  height: 14px;\n  border-radius: 2px;\n}\n\n.swatch{\n  padding: 5px;\n  background: #fff;\n  border-radius: 1px;\n  box-shadow: 0 0 0 1px rgba(0,0,0,.1);\n  display: inline-block;\n  cursor: pointer;\n}\n.color-popover {\n  position: absolute;\n  z-index: 2;\n}\n\n.cover {\n  position: fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n}\n  .chrome-picker {\n    border-radius: none !important;\n    width: 200px !important;\n    height: 60px !important;\n    display: flex;\n\n\n  }\n  .chrome-picker > div:first-of-type {\n    padding: 0px !important;\n\n  }\n  .chrome-picker > div:last-child >  div:first-of-type {\n    width: 120px;\n\n  }\n  .chrome-picker > div:last-child >  div:last-child {\n    display:none !important;\n  }\n"])));function ColorInput(e){var t=e.label,n=e.onColorChange,a=e.name,i=e.value,o=Object(O.useState)(!1),r=Object(h.a)(o,2),c=r[0],l=r[1],s=Object(O.useState)(i),u=Object(h.a)(s,2),d=u[0],b=u[1],p=Object(O.useCallback)((function(){l(!c)}),[c]),g=Object(O.useCallback)((function(){l(!1)}),[]),m=Object(O.useCallback)((function(e){var t="".concat(e.hex).concat(Math.round(255*e.rgb.a).toString(16));b(t),n(Object(f.a)(Object(f.a)({},e),{},{hex:t,name:a}))}),[a,n]);return Object(me.c)("div",{css:xu,children:[Object(me.b)("span",{className:"inputLabel",children:t}),Object(me.c)("div",{style:{flex:4},children:[Object(me.c)("div",{className:"swatch",onClick:p,children:[Object(me.b)("div",{className:"color",style:{backgroundColor:d}}),Object(me.b)("input",{type:"hidden",value:d,name:a})]}),c?Object(me.c)("div",{className:"color-popover",children:[Object(me.b)("div",{className:"cover",onClick:g}),Object(me.b)(Ou.ChromePicker,{color:{hex:d},onChangeComplete:m})]}):null]})]})}ColorInput.defaultProps={value:"#000000",label:"Color: ",onColorChange:function onColorChange(){return null}};var yu=Object(O.memo)(ColorInput),ku={row:{display:"flex",margin:"5px 0px",alignItems:"center"},inputLabel:{flex:2,fontSize:"11px",fontWeight:"bold",color:"#232323"},input:{width:"60%",textAlign:"center"}};function ColumnFormatField(e){var t=e.label,n=e.checkControllerName,a=e.checked,i=e.format,o=e.formatControllerName,r=e.inputChangeHandler,c=e.groupID,l=Object(O.useState)(Boolean(a)),s=Object(h.a)(l,2),u=s[0],d=s[1];return Object(A.jsxs)("div",{style:ku.row,children:[Object(A.jsx)("span",{style:ku.inputLabel,children:t}),Object(A.jsxs)("div",{style:{flex:4,display:"flex",flexDirection:"row",alignItems:"center"},children:[Object(A.jsx)("input",{type:"checkbox",onChange:function onChange(e){return d(e.target.checked)},style:{margin:"0px 5px"},defaultChecked:u}),Object(A.jsx)("input",{name:"".concat(c,"-").concat(n),type:"hidden",value:u}),Object(A.jsx)(rl,{style:{container:ku.input},name:"".concat(c,"-").concat(o),type:"text",onChange:r,value:i||""})]})]})}var Cu=Object(O.memo)(ColumnFormatField),Du={container:{padding:10,backgroundColor:"#f1f1f1",height:"100%",flex:1},groupContainer:{padding:"5px",borderRadius:"5px",margin:"10px 0px",backgroundColor:"white"},row:{display:"flex",margin:"5px 0px"},header:{borderBottom:"1px solid #e8e8e8",paddingBottom:"5px",fontWeight:"bold",color:"#4a4a4a"},inputLabel:{flex:2,fontSize:"11px",fontWeight:"bold",color:"#232323"},input:{width:"30%",textAlign:"center"}},Su=[{id:1,label:"Absolute :",checkController:"showAbsolute",formatController:"absoluteFormat",defaultFormat:"0.00"},{id:2,label:"Relative :",checkController:"showRelative",formatController:"relativeFormat",defaultFormat:"00.00"}];function IntegralsPreferences(e,t){var n=e.nucleus,a=e.preferences,i=dc(),o=useStateWithLocalStorage("nmr-general-settings"),r=Object(h.a)(o,2)[1],c=Object(O.useState)(null),l=Object(h.a)(c,2),s=l[0],u=l[1],d=Object(O.useRef)();Object(O.useEffect)((function(){var e=ra(a,"formatting.panels.integrals");e&&u(e)}),[a]);var b=function saveToLocalStorgate(e){r(e,"formatting.panels.integrals")},p=Object(O.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a.dispatch({type:Uc,payload:{key:"integrals",value:e}}),t&&i.success("Integrals preferences saved successfully")}),[i,a]);Object(O.useImperativeHandle)(t,(function(){return{saveSetting:function saveSetting(){"function"===typeof d.current.requestSubmit?d.current.requestSubmit():d.current.dispatchEvent(new Event("submit",{cancelable:!0}))}}}));var f=function(){var e=Object(Ae.a)(Me.a.mark((function _callee(e){var t,n,a,i,o,r,c,l;return Me.a.wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:e.preventDefault(),t=e.target,n=new FormData(t),a={},i=Object(Pe.a)(n.entries());try{for(i.s();!(o=i.n()).done;)r=o.value,c=r[0].split("-").join("."),l=["true","false"].includes(r[1])?"true"===r[1]:r[1],a=ia()(a,c,l)}catch(u){i.e(u)}finally{i.f()}p(a,!0),b(a);case 8:case"end":return s.stop()}}),_callee)})));return function handleSubmit(t){return e.apply(this,arguments)}}(),g=Object(O.useCallback)((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(s){var a=null===t[0]?s[t[1]]:v()(s,t.join("."));return a||null}var i=t.length-1;return ui[t[i]]}),[s]);return Object(A.jsx)("div",{style:Du.container,children:Object(A.jsxs)("form",{onSubmit:f,ref:d,children:[Object(A.jsxs)("div",{style:Du.groupContainer,children:[Object(A.jsx)("p",{style:Du.header,children:"General"}),Object(A.jsx)(yu,{name:"color",value:"".concat(g(null,"color"))}),Object(A.jsx)(yl,{name:"strokeWidth",label:"stroke width :",style:{label:{fontSize:"11px",fontWeight:"bold",color:"#232323"},input:{width:"60%",textAlign:"center",borderRadius:"5px"}},defaultValue:Number(g(null,"strokeWidth")),min:1,pattern:"[1-9]*"})]}),n&&n.map((function(e){return Object(A.jsxs)("div",{style:Du.groupContainer,children:[Object(A.jsx)("p",{style:Du.header,children:Object(A.jsx)(Fr.a,{mf:e})}),Su.map((function(t){return Object(A.jsx)(Cu,{label:t.label,checked:g(e,t.checkController),format:g(e,t.formatController),checkControllerName:t.checkController,formatControllerName:t.formatController,groupID:e},t.id)}))]},e)}))]})})}var wu,Tu=ks(Object(O.forwardRef)(IntegralsPreferences)),Mu=Object(m.b)(wu||(wu=Object(g.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n\n  .sum-button {\n    width: 22px;\n    height: 22px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n"])));function IntegralPanel(e){var t=e.integrals,n=e.activeTab,a=e.molecules,i=Object(O.useState)(!1),o=Object(h.a)(i,2),r=o[0],c=o[1],l=Object(O.useState)(0),s=Object(h.a)(l,2),u=s[0],d=s[1],b=useDispatch(),p=$(),f=Object(O.useState)(!1),g=Object(h.a)(f,2),m=g[0],j=g[1],x=Object(O.useRef)(),y=Object(O.useCallback)((function(){b({type:ct,integralID:null})}),[b]),k=Object(O.useCallback)((function(){p.showConfirmDialog("All records will be deleted, Are You sure?",{onYes:y})}),[p,y]),C=Object(O.useCallback)((function(e){void 0!==e&&b({type:Xt,value:e}),p.close()}),[b,p]),D=Object(O.useMemo)((function(){return v()(t,"options.sum",null)}),[t]),S=Object(O.useCallback)((function(){p.show(Object(me.b)(qs,{onClose:function onClose(){return p.close()},onSave:C,header:D?"Set new Integrals Sum (Current: ".concat(Number(D).toFixed(2),")"):"Set new Integrals Sum",molecules:a,element:n?n.replace(/[0-9]/g,""):null}))}),[n,C,D,p,a]),w=Object(O.useCallback)((function(){j(!m)}),[m]),T=Object(O.useCallback)((function(){x.current.saveSetting(),j(!1)}),[]),M=Object(O.useCallback)((function(){c(!r)}),[r]),A=Object(O.useCallback)((function(e){d(e)}),[]);return Object(me.b)(O.Fragment,{children:Object(me.c)("div",{css:Mu,children:[!m&&Object(me.b)(nu,{counter:u,onDelete:k,deleteToolTip:"Delete All Integrals",onFilter:M,filterToolTip:r?"Show all integrals":"Hide integrals out of view",filterIsActive:r,counterFiltered:u,showSettingButton:"true",onSettingClick:w,children:Object(me.b)(Zn,{title:D?"Change Integrals Sum (".concat(Number(D).toFixed(2),")"):"Change Integrals Sum",popupPlacement:"right",children:Object(me.b)("button",{className:"sum-button",type:"button",onClick:S,children:Object(me.b)(vs.t,{})})})}),m&&Object(me.b)(cu,{onSave:T,onClose:w}),Object(me.b)("div",{style:{height:"100%",overflow:"auto"},children:Object(me.c)(xs.a,{isFlipped:m,infinite:!0,containerStyle:{overflow:"hidden"},children:[Object(me.b)("div",{children:Object(me.b)(vu,{enableFilter:r,onFilter:A})}),Object(me.b)(Tu,{ref:x})]})})]})})}var Au=ks(Object(O.memo)(IntegralPanel)),Eu=n(737);function ButtonToolTip(e){var t=e.children,n=e.style,a=e.onClick,i=e.popupTitle,o=e.popupPlacement,r=Object(le.a)(e,["children","style","onClick","popupTitle","popupPlacement"]);return Object(A.jsx)(Zn,{title:i,popupPlacement:o,children:Object(A.jsx)("button",Object(f.a)(Object(f.a)({style:n,type:"button",onClick:a},r),{},{children:t}))})}ButtonToolTip.defaultProps={popupTitle:"",popupPlacement:"right",style:{},onClick:function onClick(){return null},disabled:!1};var Pu,Iu=ButtonToolTip,Fu=Object(m.b)(Pu||(Pu=Object(g.a)(["\n  .menu {\n    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.5);\n    padding: 0px;\n    margin: 0px;\n    border-radius: 5px;\n    display: flex;\n    flex-direction: column;\n    position: absolute;\n    z-index: 99999;\n    padding: 2px;\n    background-color: white;\n\n    button:hover {\n      background-color: #fafafa;\n    }\n  }\n\n  .menu-cover {\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    z-index: 1;\n  }\n\n  .menu-item {\n    background-color: transparent;\n    border: none;\n    border-bottom: 0.55px solid whitesmoke;\n    height: 35px;\n    outline: outline;\n    display: table-cell;\n    vertical-align: middle;\n    text-align: left;\n    padding: 0 10px;\n\n    svg {\n      display: inline-block;\n    }\n\n    :focus {\n      outline: none !important;\n    }\n    span {\n      font-size: 10px;\n      padding: 0px 10px;\n    }\n  }\n"])));function MenuItem(e){var t=e.icon,n=e.label,a=e.onClick;return Object(me.c)("button",{type:"button",className:"menu-item",onClick:a,children:[t,Object(me.b)("span",{children:n})]})}function MenuList(e){var t=e.items,n=e.boxBounding,a=e.onClick;return Object(me.b)("div",{className:"menu",style:{transform:"translate(".concat(n.width,"px, -").concat(n.height,"px) ")},children:t&&t.map((function(e){return Object(me.b)(MenuItem,Object(f.a)(Object(f.a)({},e),{},{onClick:function onClick(){return a(e)}}),"".concat(e.id))}))})}var Ru=function MenuButton(e){var t=e.style,n=e.component,a=e.toolTip,i=void 0===a?"":a,o=e.className,r=e.items,c=void 0===r?[]:r,l=e.onClick,s=void 0===l?function(){return null}:l,u=Object(O.useRef)(),d=Object(O.useState)(!1),b=Object(h.a)(d,2),p=b[0],f=b[1],g=Object(O.useCallback)((function(){f(!1)}),[]),m=Object(O.useCallback)((function(){f((function(e){return!e}))}),[]),j=Object(O.useCallback)((function(e){f(!1),s(e)}),[s]);return Object(me.c)("div",{style:{height:"auto"},css:Fu,children:[Object(me.b)("button",{ref:u,type:"button",css:t,onClick:m,className:o,style:{boxSizing:"border-box"},children:Object(me.b)(Zn,{title:i,popupPlacement:"right",children:n})}),p&&Object(me.b)(MenuList,{items:c,boxBounding:u.current.getBoundingClientRect(),onClick:j}),p&&Object(me.b)("div",{className:"menu-cover",onClick:g})]})};var _u,Nu=function MoleculeWrapper(e){var t=function Wrapper(t){var n=useChartData(),a=n.data,i=n.activeSpectrum,o=n.molecules,r=n.displayerMode,c=n.activeTab,l=Object(O.useMemo)((function(){return a&&i&&i.id?a.find((function(e){return e.id===i.id}))||{ranges:{},zones:{}}:{}}),[i,a]),s=l.ranges,u=void 0===s?{}:s,d=l.zones,b=void 0===d?{}:d,p=t.forwardedRef,h=Object(le.a)(t,["forwardedRef"]);return Object(A.jsx)(e,Object(f.a)(Object(f.a)({},h),{},{ranges:u,zones:b,molecules:o,displayerMode:r,activeTab:c,ref:p}))};return Object(O.memo)(Object(O.forwardRef)((function(e,n){return Object(A.jsx)(t,Object(f.a)(Object(f.a)({},e),{},{forwardedRef:n}))})))},Lu=Object(m.b)(_u||(_u=Object(g.a)(["\n  -moz-box-shadow: inset 0px 1px 0px 0px #ffffff;\n  -webkit-box-shadow: inset 0px 1px 0px 0px #ffffff;\n  box-shadow: inset 0px 1px 0px 0px #ffffff;\n  background: -webkit-gradient(\n    linear,\n    left top,\n    left bottom,\n    color-stop(0.05, #ffffff),\n    color-stop(1, #f6f6f6)\n  );\n  background: -moz-linear-gradient(top, #ffffff 5%, #f6f6f6 100%);\n  background: -webkit-linear-gradient(top, #ffffff 5%, #f6f6f6 100%);\n  background: -o-linear-gradient(top, #ffffff 5%, #f6f6f6 100%);\n  background: -ms-linear-gradient(top, #ffffff 5%, #f6f6f6 100%);\n  background: linear-gradient(to bottom, #ffffff 5%, #f6f6f6 100%);\n  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffffff', endColorstr='#f6f6f6',GradientType=0);\n  background-color: #ffffff;\n  border: 0.55px solid #dcdcdc;\n  display: inline-block;\n  cursor: pointer;\n  color: #666666;\n  font-weight: bold;\n  padding: 6px 24px;\n  text-decoration: none;\n  text-shadow: 0px 1px 0px #ffffff;\n\n  :hover {\n    background: -webkit-gradient(\n      linear,\n      left top,\n      left bottom,\n      color-stop(0.05, #f6f6f6),\n      color-stop(1, #ffffff)\n    );\n    background: -moz-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: -webkit-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: -o-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: -ms-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: linear-gradient(to bottom, #f6f6f6 5%, #ffffff 100%);\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#f6f6f6', endColorstr='#ffffff',GradientType=0);\n    background-color: #f6f6f6;\n  }\n"])));var zu=function MoleculeStructureEditorModal(e){var t=e.onClose,n=e.open,a=e.selectedMolecule,i=Object(O.useState)(null),o=Object(h.a)(i,2),r=o[0],c=o[1],l=useDispatch();Object(O.useEffect)((function(){c(a?a.molfile:null)}),[a,n]);var s=Object(O.useCallback)((function(e){c(e)}),[c]),u=Object(O.useCallback)((function(){t()}),[t]),d=Object(O.useCallback)((function(){a?(l({type:dt,molfile:r,key:a.key}),t("replace")):(l({type:ut,molfile:r}),t("new"))}),[l,a,r,t]);return Object(me.c)(ae,{open:n,onClose:u,children:[Object(me.b)(Ps.b,{initialMolfile:a&&a.molfile,svgMenu:!0,fragment:!1,onChange:s}),Object(me.c)("div",{style:{display:"flex",alignItems:"flex-end",justifyContent:"flex-end",margin:5},children:[Object(me.b)("button",{type:"button",css:Lu,onClick:u,children:"Close"}),Object(me.b)("button",{type:"button",css:Lu,onClick:d,children:"Save"})]})]})};var Hu=function IsotopesViewer(e){var t=e.value,n=void 0===t?"":t,a=Object(le.a)(e,["value"]);return Object(A.jsx)("div",Object(f.a)(Object(f.a)({},a),{},{dangerouslySetInnerHTML:{__html:n.replace(/([0-9]+)/g,"<sup>$1</sup>")}}))},Bu=function FormikSelect(e){var t=e.name,n=e.value,a=e.onChange,i=Object(le.a)(e,["name","value","onChange"]),o=Object(zc.f)(),r=o.values,c=o.setFieldValue,l=Object(O.useCallback)((function(e){a(e),c(t,e)}),[t,a,c]);return Object(O.useEffect)((function(){n&&c(t,n)}),[t,c,n]),Object(A.jsx)(wl,Object(f.a)({name:t,defaultValue:n||v()(r,t),onChange:l},i))};Bu.defaultProps=wl.defaultProps;var Xu,Vu=Bu,Yu=Object(m.b)(Xu||(Xu=Object(g.a)(['\n  overflow: auto;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n\n  .header {\n    text-align: center;\n    padding: 10px 0 10px 0px;\n    margin: 0px;\n    color: #005d9e;\n    place-items: normal;\n    text-transform: none;\n    background-color: #fcfcfc;\n  }\n\n  .tab-content {\n    width: 100%;\n  }\n  .row {\n    display: flex;\n    align-items: center;\n  }\n\n  .inner-content {\n    padding: 15px 30px;\n    width: 100%;\n    flex: 1;\n  }\n\n  button:focus {\n    outline: none;\n  }\n  button:hover {\n    color: #007bff;\n  }\n  .save-button:hover {\n    background-color: #ffffff;\n  }\n  .save-button {\n    border: none;\n    padding: 0 15px;\n    background-color: #ffffff5e;\n    border-radius: 5px;\n    height: 25px;\n  }\n\n  .footer-container {\n    display: flex;\n    align-items: flex-end;\n    justify-content: flex-end;\n    background: rgb(242, 242, 242);\n    background: -moz-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: -webkit-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#f2f2f2",endColorstr="#ffffff",GradientType=1);\n    padding: 6px 15px;\n    height: 55px;\n  }\n\n  .section-header {\n    font-size: 13px;\n    color: #2ca8ff;\n    margin-bottom: 10px;\n    border-bottom: 0.55px solid #f9f9f9;\n    padding: 6px 2px;\n  }\n\n  .custom-label {\n    font-size: 12px;\n    font-weight: bold;\n    margin-right: 10px;\n    width: 155px;\n  }\n  .margin-10 {\n    margin: 10px 0;\n  }\n\n  .input {\n    font-size: 14px;\n    border-radius: 5px;\n    border: 1px solid #cccccc;\n    padding: 5px;\n    width: 100px;\n    margin-right: 10px;\n    height: initial !important;\n  }\n\n  .close-bt {\n    border: none;\n    color: red;\n    background-color: transparent;\n    outline: none;\n    position: absolute;\n    right: 10px;\n    top: 2px;\n    width: 30px;\n    height: 30px;\n  }\n']))),Zu=[{key:1,value:60,label:"60 MHz"},{key:2,value:100,label:"100 MHz"},{key:3,value:200,label:"200 MHz"},{key:4,value:300,label:"300 MHz"},{key:5,value:400,label:"400 MHz"},{key:6,value:500,label:"500 MHz"},{key:7,value:600,label:"600 MHz"},{key:8,value:800,label:"800 MHz"},{key:9,value:1e3,label:"1000 MHz"},{key:10,value:1200,label:"1200 MHz"}],Uu={"1h":{from:-1,to:12},"13c":{from:-5,to:220},frequency:400,spectra:{"1h":!0,"13c":!1,cosy:!1,hsqc:!1,hmbc:!1}};var Ku,Wu,Gu,qu=function PredictSpectraModal(e){var t=e.onClose,n=e.molfile,a=Object(O.useRef)(),i=useDispatch(),o=Object(O.useCallback)((function(){a.current.submitForm()}),[]),r=Object(O.useCallback)((function(e){i({type:Nt,isLoading:!0}),i({type:xn,payload:{mol:n,options:e}}),t()}),[i,n,t]);return Object(me.c)("div",{css:Yu,children:[Object(me.c)("div",{className:"header handle",children:[Object(me.b)("span",{children:"Predict Spectra"}),Object(me.b)(Gn,{onClick:t,className:"close-bt"})]}),Object(me.b)("div",{className:"inner-content",children:Object(me.c)(Bc,{ref:a,initialValues:Uu,onSubmit:r,children:[Object(me.c)("div",{className:"row margin-10",children:[Object(me.b)("span",{className:"custom-label",children:"Spectrometer Frequency :"}),Object(me.b)(Vu,{data:Zu,style:{width:290,height:30,margin:0},name:"frequency"})]}),Object(me.c)("div",{className:"row margin-10",children:[Object(me.b)(Hu,{value:"1H",className:"custom-label"}),Object(me.b)(cl,{label:"From",name:"1h.from",type:"number",style:{label:{padding:"0 10px 0 0"}}}),Object(me.b)(cl,{label:"To",name:"1h.to",type:"number",style:{label:{padding:"0 10px"}}})]}),Object(me.c)("div",{className:"row margin-10",children:[Object(me.b)(Hu,{value:"13C",className:"custom-label"}),Object(me.b)(cl,{label:"From",name:"13c.from",type:"number",style:{label:{padding:"0 10px 0 0"}}}),Object(me.b)(cl,{label:"To",name:"13c.to",type:"number",style:{label:{padding:"0 10px"}}})]}),Object(me.b)("div",{className:"row margin-10",children:Object(me.b)("span",{className:"custom-label",children:"Spectra "})}),Object(me.c)("div",{className:"row margin-10",style:{justifyContent:"space-between"},children:[Object(me.c)("div",{className:"row",children:[Object(me.b)(nl,{name:"spectra.1h"}),Object(me.b)(Hu,{value:"1H",style:{padding:" 0 10px"}})]}),Object(me.c)("div",{className:"row",children:[Object(me.b)(nl,{disabled:!0,name:"spectra.13c"}),Object(me.b)(Hu,{value:"13C",style:{padding:" 0 10px"}})]}),Object(me.c)("div",{className:"row",children:[Object(me.b)(nl,{disabled:!0,name:"spectra.cosy"}),Object(me.b)(Hu,{value:"cosy",style:{padding:" 0 10px"}})]}),Object(me.c)("div",{className:"row",children:[Object(me.b)(nl,{disabled:!0,name:"spectra.hsqc"}),Object(me.b)(Hu,{value:"HSQC",style:{padding:" 0 10px"}})]}),Object(me.c)("div",{className:"row",children:[Object(me.b)(nl,{disabled:!0,name:"spectra.hmbc"}),Object(me.b)(Hu,{value:"HMBC",style:{padding:" 0 10px"}})]})]})]})}),Object(me.b)("div",{className:"footer-container",children:Object(me.b)("button",{type:"button",onClick:o,className:"save-button",children:"Start Predicting"})})]})},Ju=function extractFromAtom(e,t,n){if(t.length>0&&Object.keys(e).length>0){var a="x"===n?0:"y"===n?1:void 0;if(void 0===a)return{oclIDs:[e.oclID].concat(e.hydrogenOCLIDs),nbAtoms:e.nbAtoms+e.nbAtoms*e.nbHydrogens};if(t[a]===e.atomLabel)return{oclIDs:[e.oclID],nbAtoms:e.nbAtoms};if("H"===t[a])return{oclIDs:e.hydrogenOCLIDs,nbAtoms:e.nbAtoms*e.nbHydrogens}}return{oclIDs:[],nbAtoms:0}},$u=function findDatumAndSignalIndex(e,t){var n,a=e.find((function(e){return e.id===t}));if(!a)for(var i=0;i<e.length;i++)if((n=e[i].signal.findIndex((function(e){return e.id===t})))>=0){a=e[i];break}return{datum:a,signalIndex:n}},Qu=Object(m.b)(Ku||(Ku=Object(g.a)(["\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  width: 100%;\n  height: 100%;\n"]))),ed=Object(m.b)(Wu||(Wu=Object(g.a)(["\n  display: flex;\n  flex-direction: row;\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n  padding: 0px 5px;\n\n  button svg {\n    fill: #4e4e4e;\n  }\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n\n  p {\n    margin: 0;\n    text-align: right;\n    width: 100%;\n    line-height: 22px;\n    padding: 0px 10px;\n  }\n"]))),td=Object(m.b)(Gu||(Gu=Object(g.a)(["\n  width: 100%;\n  height: 100%;\n\n  .slider {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    height: 100%;\n    padding: 0px;\n    .mol-svg-container {\n      height: calc(100% - 25px);\n      width: 100%;\n      div {\n        width: 100%;\n        height: 100%;\n      }\n    }\n\n    p {\n      width: 100%;\n      margin: 0 auto;\n      display: block;\n      position: relative;\n      text-align: center;\n    }\n\n    svg polygon {\n      fill: gray !important;\n    }\n  }\n"]))),nd=[{id:"molfile",icon:Object(me.b)(_e.e,{}),label:"Copy as molfile"},{id:"png",icon:Object(me.b)(_e.q,{}),label:"Copy as PNG"},{id:"svg",icon:Object(me.b)(_e.h,{}),label:"Export as SVG"}];function MoleculePanel(e){var t=e.zones,n=e.ranges,a=e.molecules,i=e.activeTab,o=e.displayerMode,r=Object(Is.a)(),c=Object(h.a)(r,2),l=c[0],s=c[1],u=s.width,d=s.height,b=Object(O.useState)(!1),p=Object(h.a)(b,2),f=p[0],g=p[1],m=Object(O.useState)(),j=Object(h.a)(m,2),v=j[0],x=j[1],y=Object(O.useState)(0),k=Object(h.a)(y,2),C=k[0],D=k[1],S=Object(O.useState)([]),w=Object(h.a)(S,2),T=w[0],M=w[1],A=Object(O.useState)(null),E=Object(h.a)(A,2),P=E[0],I=E[1],F=useDispatch(),R=dc(),_=$(),N=Object(pi.d)(),L=useAssignmentData(),z=Object(O.useState)([]),H=Object(h.a)(z,2),B=H[0],X=H[1];Object(O.useEffect)((function(){if(i){var e=i.split(",");1===e.length?X([i.replace(/[0-9]/g,"")]):2===e.length&&X(e.map((function(e){return e.replace(/[0-9]/g,"")})))}else X([])}),[i]);var V=useAssignment(void 0!==L.assignment.activeID?L.assignment.activeID:"___"),Z=Object(O.useMemo)((function(){if(t||n){if(o===er.DM_1D&&n&&n.values)return n.values;if(o===er.DM_2D&&t&&t.values)return t.values}return[]}),[o,n,t]),U=Object(O.useMemo)((function(){var e={x:[],y:[]};for(var t in L.assignment.assignment){var n,a;if(L.assignment.assignment[t].x)(n=e.x).push.apply(n,Object(Ee.a)(L.assignment.assignment[t].x));if(L.assignment.assignment[t].y)(a=e.y).push.apply(a,Object(Ee.a)(L.assignment.assignment[t].y))}return e}),[L.assignment]),K=Object(O.useMemo)((function(){return U.x.concat(U.y)}),[U.x,U.y]),W=Object(O.useCallback)((function(e,t){return K.some((function(e){return t.oclIDs.includes(e)}))&&!e.some((function(e){return t.oclIDs.includes(e)}))?(R.info("Atom is already assigned to another signal!"),e):function toggleDiaIDs(e,t){var n=e?e.slice():[];if(1===t.oclIDs.length)if(n.includes(t.oclIDs[0]))n=n.filter((function(e){return e!==t.oclIDs[0]}));else for(var a=0;a<t.nbAtoms;a++)n.push(t.oclIDs[0]);else t.oclIDs.length>1&&t.oclIDs.forEach((function(e){n.includes(e)?n=n.filter((function(t){return t!==e})):n.push(e)}));return n}(e,t)}),[R,K]),G=Object(O.useCallback)((function(e){if(V.isActive){var t=Ju(e,B,V.activeAxis);if(t.nbAtoms>0){t.oclIDs.forEach((function(e){V.toggle(e)}));var n=$u(Z,V.id),a=n.datum,i=n.signalIndex;if(a){var r=[];void 0===i?o===er.DM_1D?r=W(a.diaID||[],t):o===er.DM_2D&&(r=W(a[V.activeAxis].diaID||[],t)):a.signal&&a.signal[i]&&(o===er.DM_1D?r=W(a.signal[i].diaID||[],t):o===er.DM_2D&&(r=W(a.signal[i][V.activeAxis].diaID||[],t))),o===er.DM_1D?F({type:sn,payload:{rangeData:a,diaID:r,signalIndex:i}}):o===er.DM_2D&&F({type:On,payload:{zoneData:a,diaID:r,axis:V.activeAxis,signalIndex:i}})}}else R.info("Not assigned! Different atom type or no attached hydrogens found!")}}),[V,R,Z,F,o,B,W]),q=Object(O.useMemo)((function(){return function getCurrentDiaIDsToHighlight(e,t){var n=e.assignment.isOnHover?e.assignment.assignment[e.assignment.onHoverID]:null,a=e.assignment.isOnHover?e.assignment.onHoverAxis:null;return n?t===er.DM_1D?n.x||[]:t===er.DM_2D?a?"x"===a?n.x||[]:"y"===a?n.y||[]:(n.x||[]).concat(n.y||[]):(n.x||[]).concat(n.y||[]):[]:[]}(L,o)}),[L,o]);Object(O.useEffect)((function(){P&&("show"===P?N.dispatch({type:"SHOW",payload:{convertedHighlights:T}}):"hide"===P&&(N.dispatch({type:"HIDE",payload:{convertedHighlights:T}}),M([])),I(null))}),[P,T,N]);var J=Object(O.useCallback)((function(e){var t=Ju(e,B,V.activeAxis).oclIDs;if(t.length>0){var n=function getHighlightsOnHover(e,t,n){var a=[];for(var i in e.assignment.assignment){var o=void 0,r=void 0,c=!1;if(e.assignment.assignment[i].x&&e.assignment.assignment[i].x.some((function(e){return t.includes(e)}))){a=a.concat(e.assignment.assignment[i].x);var l=$u(n,i);o=l.datum,r=l.signalIndex,c=!0}if(e.assignment.assignment[i].y&&e.assignment.assignment[i].y.some((function(e){return t.includes(e)}))){a=a.concat(e.assignment.assignment[i].y);var s=$u(n,i);o=s.datum,r=s.signalIndex,c=!0}if(o&&(a.push(o.id),void 0!==r&&a.push(o.signal[r].id)),c)break}return a}(L,t,Z);M(n),I("show")}else I("hide")}),[V.activeAxis,L,Z,B]),Q=Object(O.useCallback)((function(e){g(!1),"new"===e&&D(a.length)}),[a.length]),ee=Object(O.useCallback)((function(e,t,n){x(n?{molfile:n,key:t}:null),g(!0)}),[]),te=Object(O.useCallback)((function(){navigator.clipboard.readText().then((function(e){F({type:ut,molfile:e})}))}),[F]),ne=Object(O.useCallback)((function(){a[C]&&a[C].key&&(D(0),F({type:bt,payload:{key:a[C].key,assignmentData:L}}))}),[a,C,L,F]),ae=Object(O.useCallback)((function(){Object(fc.g)("molFile","molSVG".concat(C))}),[C]),ie=Object(O.useCallback)((function(){Object(fc.b)("molSVG".concat(C)),R.success("MOL copied as PNG to clipboard")}),[R,C]),oe=Object(O.useCallback)((function(){a[C]&&(Object(fc.c)(a[C].molfile)?R.success("MOLFile copied to clipboard"):R.error("copied not completed"))}),[R,C,a]),re=Object(O.useCallback)((function(e,t){F({type:dt,molfile:t,key:e})}),[F]),ce=Object(O.useCallback)((function(){_.show(Object(me.b)(qu,{onSave:function onSave(){_.close()},molfile:a[C]}),{position:Y.TOP_CENTER,enableResizing:!0,width:600,height:350})}),[_,a,C]),le=Object(O.useCallback)((function(e){switch(e.id){case"molfile":oe();break;case"png":ie();break;case"svg":ae()}}),[oe,ie,ae]);return Object(me.c)("div",{css:Qu,children:[Object(me.c)("div",{css:ed,children:[Object(me.b)(Ru,{component:Object(me.b)(_e.p,{}),toolTip:"Export As",items:nd,onClick:le}),Object(me.b)(Zn,{title:"Paste molfile",popupPlacement:"left",children:Object(me.b)("button",{className:"bar-button",type:"button",onClick:te,children:Object(me.b)(_e.x,{})})}),Object(me.b)(Zn,{title:"Add Molecule",popupPlacement:"left",children:Object(me.b)("button",{className:"bar-button",type:"button",onClick:ee,children:Object(me.b)(_e.y,{})})}),Object(me.b)(Zn,{title:"Delete Molecule",popupPlacement:"left",children:Object(me.b)("button",{className:"bar-button",type:"button",onClick:ne,children:Object(me.b)(_e.B,{})})}),Object(me.b)(Iu,{popupTitle:"Predict Spectra",popupPlacement:"left",onClick:ce,disabled:!a||0===a.length,children:Object(me.b)(vs.g,{})}),Object(me.c)("p",{children:[a&&a.length>0&&"".concat(+(C+1)," / ").concat(a.length)," "]})]}),Object(me.c)("div",{css:td,children:[Object(me.b)(_s,{onChange:function onChange(e){return D(e)},defaultIndex:C,children:a&&a.length>0?a.map((function(e,t){return Object(me.c)("div",{className:"slider",onDoubleClick:function onDoubleClick(t){return ee(t,e.key,e.molfile)},style:{backgroundColor:(t+1)%2!==0?"#fafafa":"white"},children:[Object(me.b)("div",{className:"mol-svg-container",ref:l,children:Object(me.b)(Eu.a,{OCL:mc.a,id:"molSVG".concat(t),width:u>0?u:100,height:d>0?d:100,molfile:e.molfile,setMolfile:function setMolfile(t){return re(e.key,t)},setSelectedAtom:G,atomHighlightColor:q&&q.length>0?"red":"#FFD700",atomHighlightOpacity:.35,highlights:q&&q.length>0?q:K,setHoverAtom:J})}),Object(me.c)("p",{children:[Object(me.b)(Fr.a,{mf:e.mf})," - ",e.mw.toFixed(2)]})]},e.key)})):Object(me.b)("div",{style:{width:"100%",height:"100%"},onClick:ee})}),Object(me.b)(zu,{open:f,onClose:Q,selectedMolecule:v})]})]})}var ad=Nu(Object(O.memo)(MoleculePanel)),id=n(93),od=n(683),rd=n.n(od);var cd="NORMAL",ld="FORMULA",sd={};function addColumnKey(e,t,n,a){var i=Object.keys(e[t].options.columns).length,o=a||function getChar(e){for(var t="a".charCodeAt(0),n="z".charCodeAt(0)-t+1,a="";e>=0;)a=String.fromCharCode(e%n+t)+a,e=Math.floor(e/n)-1;return a}(i).toUpperCase();return e[t].options.columns[o]=n,o}function getSpectraAnalysis(e,t){var n=t.from,a=t.to,i=t.nucleus;return e.reduce((function(e,t){if(1===t.info.dimension&&t.info.nucleus===i&&!t.info.isFid){var o=function detectRange(e,t){var n=t.from,a=t.to,i=e.data,o=i.x,r=i.re,c=Object(Ln.k)({x:o,y:r},{from:n,to:a,reverse:!0}),l=Object(Ln.m)({x:o,y:r},{from:n,to:a}).y,s=Object(Ln.l)({x:o,y:r},{from:n,to:a}).y,u=getShiftX(e);return{id:generateID(),originFrom:n-u,originTo:a-u,from:n,to:a,absolute:c,min:l,max:s}}(t,{from:n,to:a});e.sum+=o.absolute,e.values.push(Object(f.a)({SID:t.id},o))}return e}),{values:[],sum:0})}function init(e,t){void 0===e[t]&&(e[t]={options:{sum:100,code:null,columns:{}},values:{}})}function refreshCalculation(e,t){var n=e[t].options.columns;return Object.entries(e[t].values).reduce((function(e,t){var a=Object(h.a)(t,2),i=a[0],o=a[1];return e[i]=Object(f.a)(Object(f.a)({},o),function refreshByRow(e,t){return Object.keys(t).reduce((function(n,a){return t[a].type===ld&&(n[a]=Object(f.a)(Object(f.a)({colKey:a},e),{},{value:calculate(t,e,t[a].formula)})),n}),{})}(o,n)),e}),{})}function analyzeSpectra(e,t,n){var a=n.from,i=n.to,o=n.nucleus,r=n.columnKey,c=void 0===r?null:r;init(t,o);var l=addColumnKey(t,o,{type:cd,valueKey:"relative",from:a,to:i,index:1},c),s=t[o].options.sum,u=getSpectraAnalysis(e,{from:a,to:i,nucleus:o}),d=u.values,b=u.sum,p=v()(t,"".concat(o,".values"),{}),h=d.reduce((function(e,t){var n=b>0?s/b:0;return e[t.SID]=Object(f.a)(Object(f.a)({},p[t.SID]),{},Object(ie.a)({},l,Object(f.a)(Object(f.a)({colKey:l},t),{},{relative:Math.abs(t.absolute)*n}))),e}),{});t[o].values=h,t[o].values=refreshCalculation(t,o)}function calculate(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"A+B",i=a.split(/\+|-|\*|\/|%|\(|\)/),o=[],r=Object(Pe.a)(i);try{for(r.s();!(n=r.n()).done;){var c=n.value,l=c.trim();e[l]&&o.push(l)}}catch(d){r.e(d)}finally{r.f()}var s,u=o.map((function(n){return t[n]?t[n][e[n].valueKey]:null}));try{s=Object(id.a)(Function,o.concat(["return ".concat(a)])).apply(void 0,Object(Ee.a)(u))}catch(b){console.log(b),s=new Error("Invalid Formula ( ".concat(a," ) "))}return s}var ud,dd={"1H":{tms:{from:-.1,to:.1,nbPeaks:1,delta:0},tsp:{from:-.1,to:.1,nbPeaks:1,delta:0},glucose:{from:5.18,to:5.28,nbPeaks:2,delta:5.23}},"13C":{}};var bd=Object(m.b)(ud||(ud=Object(g.a)(['\n  overflow: auto;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n\n  .header {\n    text-align: center;\n    padding: 10px 0 10px 0px;\n    margin: 0px;\n    color: #005d9e;\n    place-items: normal;\n    text-transform: none;\n    background-color: #fcfcfc;\n  }\n  // .main-content {\n  //   width: 100%;\n  //   flex: 1;\n  //   overflow: auto;\n  //   border: none;\n  // }\n\n  .tab-content {\n    width: 100%;\n  }\n  .row {\n    display: flex;\n  }\n\n  .inner-content {\n    padding: 15px 30px;\n    width: 100%;\n    overflow: auto;\n  }\n\n  button:focus {\n    outline: none;\n  }\n  button:hover {\n    color: #007bff;\n  }\n  .save-button:hover {\n    background-color: #ffffff;\n  }\n  .save-button {\n    border: none;\n    padding: 0 15px;\n    background-color: #ffffff5e;\n    border-radius: 5px;\n    height: 25px;\n  }\n\n  .footer-container {\n    display: flex;\n    align-items: flex-end;\n    justify-content: flex-end;\n    background: rgb(242, 242, 242);\n    background: -moz-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: -webkit-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#f2f2f2",endColorstr="#ffffff",GradientType=1);\n    padding: 6px 15px;\n    height: 55px;\n  }\n\n  .section-header {\n    font-size: 13px;\n    color: #2ca8ff;\n    margin-bottom: 10px;\n    border-bottom: 0.55px solid #f9f9f9;\n    padding: 6px 2px;\n  }\n\n  .custom-label {\n    font-size: 12px;\n    font-weight: bold;\n    margin-right: 10px;\n    width: 120px;\n  }\n  .margin-10 {\n    margin: 10px 0;\n  }\n\n  .input {\n    font-size: 14px;\n    border-radius: 5px;\n    border: 1px solid #cccccc;\n    padding: 5px;\n    width: 100px;\n    margin-right: 10px;\n    height: initial !important;\n  }\n\n  .close-bt {\n    border: none;\n    color: red;\n    background-color: transparent;\n    outline: none;\n    position: absolute;\n    right: 10px;\n    top: 2px;\n    width: 30px;\n    height: 30px;\n  }\n']))),pd=[{key:1,value:"manual",label:"Manual"}];var fd,hd=function AlignSpectraModal(e){var t=e.onClose,n=e.nucleus,a=Object(O.useRef)(),i=useDispatch(),o=Object(O.useMemo)((function(){var e=dd[n]?Object.entries(dd[n]).map((function(e){return{key:e[0],value:e[0],label:e[0]}}),[]):[];return pd.concat(e)}),[n]),r=Object(O.useCallback)((function(){a.current.submitForm()}),[]),c=Object(O.useCallback)((function(e){i({type:gn,payload:e}),t()}),[i,t]);Object(O.useEffect)((function(){return oi.on("brushEnd",(function(e){var t=Object(h.a)(e.range,2),n=t[0],i=t[1];a.current.setValues(Object(f.a)(Object(f.a)({},a.current.values),{},{from:n,to:i}))})),function(){oi.off("brushEnd")}}),[]);var l=Object(O.useCallback)((function(e){var t=dd[n][e]||{delta:0},i=t.delta,o=void 0===i?0:i,r=Object(le.a)(t,["delta"]);a.current.setValues(Object(f.a)(Object(f.a)({},a.current.values),{},{targetX:o},r))}),[n]);return Object(me.c)("div",{css:bd,children:[Object(me.c)("div",{className:"header handle",children:[Object(me.b)("span",{children:"Spectra calibration"}),Object(me.b)(Gn,{onClick:t,className:"close-bt"})]}),Object(me.b)("div",{className:"inner-content",children:Object(me.c)(Bc,{ref:a,initialValues:{from:-1,to:1,nbPeaks:1,targetX:0},onSubmit:c,children:[Object(me.c)("div",{className:"row margin-10",children:[Object(me.b)("span",{className:"custom-label",children:"Options :"}),Object(me.b)(wl,{data:o,style:{width:270,height:30,marginBottom:"20px"},onChange:l})]}),Object(me.c)("div",{className:"row margin-10",children:[Object(me.b)("span",{className:"custom-label",children:"Range :"}),Object(me.b)(cl,{label:"From : ",name:"from",type:"number"}),Object(me.b)(cl,{label:"To :",name:"to",type:"number"})]}),Object(me.c)("div",{className:"row margin-10",children:[Object(me.b)("span",{className:"custom-label",children:"Number of Peaks : "}),Object(me.b)(cl,{name:"nbPeaks",type:"number"})]}),Object(me.c)("div",{className:"row margin-10",children:[Object(me.b)("span",{className:"custom-label",children:"Target PPM :"}),Object(me.b)(cl,{name:"targetX",type:"number"})]})]})}),Object(me.b)("div",{className:"footer-container",children:Object(me.b)("button",{type:"button",onClick:r,className:"save-button",children:"Done"})})]})},gd=n(731),md=n(705),jd=(n(706),n(707),n(708)),vd=n.n(jd),Od=Object(m.b)(fd||(fd=Object(g.a)(["\n  code[class*='language-'],\n  pre[class*='language-'] {\n    color: black;\n    background: none;\n    text-shadow: 0 1px white;\n    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n    font-size: 1em;\n    text-align: left;\n    white-space: pre;\n    word-spacing: normal;\n    word-break: normal;\n    word-wrap: normal;\n    line-height: 1.5;\n\n    -moz-tab-size: 4;\n    -o-tab-size: 4;\n    tab-size: 4;\n\n    -webkit-hyphens: none;\n    -moz-hyphens: none;\n    -ms-hyphens: none;\n    hyphens: none;\n  }\n\n  pre[class*='language-']::-moz-selection,\n  pre[class*='language-'] ::-moz-selection,\n  code[class*='language-']::-moz-selection,\n  code[class*='language-'] ::-moz-selection {\n    text-shadow: none;\n    background: #b3d4fc;\n  }\n\n  pre[class*='language-']::selection,\n  pre[class*='language-'] ::selection,\n  code[class*='language-']::selection,\n  code[class*='language-'] ::selection {\n    text-shadow: none;\n    background: #b3d4fc;\n  }\n\n  @media print {\n    code[class*='language-'],\n    pre[class*='language-'] {\n      text-shadow: none;\n    }\n  }\n\n  /* Code blocks */\n  pre[class*='language-'] {\n    padding: 1em;\n    margin: 0.5em 0;\n    overflow: auto;\n  }\n\n  :not(pre) > code[class*='language-'],\n  pre[class*='language-'] {\n    background: #f5f2f0;\n  }\n\n  /* Inline code */\n  :not(pre) > code[class*='language-'] {\n    padding: 0.1em;\n    border-radius: 0.3em;\n    white-space: normal;\n  }\n\n  .token.comment,\n  .token.prolog,\n  .token.doctype,\n  .token.cdata {\n    color: slategray;\n  }\n\n  .token.punctuation {\n    color: #999;\n  }\n\n  .token.namespace {\n    opacity: 0.7;\n  }\n\n  .token.property,\n  .token.tag,\n  .token.boolean,\n  .token.number,\n  .token.constant,\n  .token.symbol,\n  .token.deleted {\n    color: #905;\n  }\n\n  .token.selector,\n  .token.attr-name,\n  .token.string,\n  .token.char,\n  .token.builtin,\n  .token.inserted {\n    color: #690;\n  }\n\n  .token.operator,\n  .token.entity,\n  .token.url,\n  .language-css .token.string,\n  .style .token.string {\n    color: #9a6e3a;\n    /* This background color was intended by the author of this theme. */\n    background: hsla(0, 0%, 100%, 0.5);\n  }\n\n  .token.atrule,\n  .token.attr-value,\n  .token.keyword {\n    color: #07a;\n  }\n\n  .token.function,\n  .token.class-name {\n    color: #dd4a68;\n  }\n\n  .token.regex,\n  .token.important,\n  .token.variable {\n    color: #e90;\n  }\n\n  .token.important,\n  .token.bold {\n    font-weight: bold;\n  }\n  .token.italic {\n    font-style: italic;\n  }\n\n  .token.entity {\n    cursor: help;\n  }\n"])));function Evaluate_calculate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{return new Function("args","return ".concat(e))(t)}catch(n){return n}}function MulipleAnalysisCodeEditor(e){var t=e.data,n=Object(zc.f)(),a=n.values,i=n.setFieldValue,o=Object(O.useState)(a.code?a.code:"function run(data) {\n\n  return JSON.stringify(data,undefined, 2);\n  \n}(args);\n"),r=Object(h.a)(o,2),c=r[0],l=r[1],s=Object(O.useState)(""),u=Object(h.a)(s,2),d=u[0],b=u[1];Object(O.useEffect)((function(){var e=Evaluate_calculate(c,t);e instanceof Error?b(e.message):(i("code",c),b(e))}),[c,t,i]);var p=Object(O.useCallback)((function(e){l(e)}),[]),f=Object(O.useCallback)((function(e){try{return Object(md.highlight)(e,md.languages.js)}catch(t){return null}}),[]);return Object(me.c)("div",{style:{marginTop:"20px"},css:Od,children:[Object(me.b)(vd.a,{value:c,onValueChange:p,highlight:f,padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,backgroundColor:"#fcfcfc",marginBottom:"10px",minHeight:"100px",overflow:"auto",maxHeight:"200px"}}),Object(me.b)("p",{style:{marginBottom:"5px"},children:"Result:"}),Object(me.b)(vd.a,{value:d,onValueChange:function onValueChange(e){return e},highlight:f,padding:10,style:{border:"0.55px solid #f3f3f3",fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,marginBottom:"10px",minHeight:"100px",overflow:"auto",maxHeight:"200px"}})]})}var xd,yd=Object(O.memo)(MulipleAnalysisCodeEditor),kd=Object(m.b)(xd||(xd=Object(g.a)(["\n  width: 100%;\n  thead {\n    border-bottom: 1px solid lightgray;\n    background-color: #fafafa;\n    font-size: 12px;\n  }\n\n  td,\n  th {\n    padding: 3px 5px;\n    text-align: center;\n  }\n\n  .operation-col {\n    width: 30px;\n  }\n\n  .input {\n    // border: 0.55px solid rgb(237 237 237) !important;\n    height: 25px !important;\n    width: 100% !important;\n    margin: 0 !important;\n    // text-transform: uppercase;\n  }\n\n  .input.disbale {\n    background-color: #e8e8e8;\n    border-radius: 5px;\n  }\n\n  .label,\n  .index {\n    width: 100px;\n  }\n\n  .counter {\n    width: 50px;\n  }\n\n  .add {\n    background-color: transparent;\n    border: 0;\n    outline: none;\n    svg {\n      font-szie: 14px;\n      fill: green;\n    }\n  }\n"]))),Cd=Object(O.forwardRef)((function MultipleSpectraAnalysisPreferences(e,t){var n=e.data,a=e.onAfterSave,i=useDispatch(),o=Object(O.useRef)(),r=Object(O.useState)({}),c=Object(h.a)(r,2),l=c[0],s=c[1];Object(O.useImperativeHandle)(t,(function(){return{saveSetting:function saveSetting(){o.current.submitForm()}}})),Object(O.useEffect)((function(){var e=Object.keys(n.columns).reduce((function(e,t){return e[t]=Object(f.a)(Object(f.a)({},n.columns[t]),{},{tempKey:t}),e}),{});s(e),o.current.setValues({columns:e,code:n.code})}),[n]);var u=Object(O.useMemo)((function(){return Object.keys(l)}),[l]),d=Object(O.useMemo)((function(){return gd.a().shape({columns:gd.a().shape(function columnSchema(){return u.reduce((function(e,t){return e[t]=gd.a().shape(Object(f.a)(Object(f.a)({tempKey:gd.b().required().test("unique","must be unique column name",(function(e){var t=o.current.values.columns;return 1===Object.keys(t).reduce((function(n,a){return t[a].tempKey===e&&n.push(e),n}),[]).length}))},l[t].type===ld?{formula:gd.b().required()}:{}),{},{index:gd.b().required()})),e}),{})}())})}),[l,u,o]),b=Object(O.useCallback)((function(e){a(!0);var t=Object.entries(e.columns).reduce((function(e,t){var n=Object(h.a)(t,2),a=n[0],i=n[1];return e[a]=Object(f.a)(Object(f.a)({},l[a]),i),e}),{});i({type:fn,payload:{code:e.code,columns:t}})}),[l,i,a]),p=Object(O.useCallback)((function(e){s((function(t){return Object(f.a)(Object(f.a)({},t),{},Object(ie.a)({},"temp".concat(e),{tempKey:"",type:"FORMULA",valueKey:"value",formula:"",index:e}))}))}),[]);return Object(me.c)(Bc,{ref:o,initialValues:{columns:l,code:null},validationSchema:d,onSubmit:b,children:[u&&Object(me.c)("table",{css:kd,children:[Object(me.b)("thead",{children:Object(me.c)("tr",{children:[Object(me.b)("th",{className:"counter",children:"#"}),Object(me.b)("th",{className:"label",children:"Label"}),Object(me.b)("th",{children:"value"}),Object(me.b)("th",{className:"index",children:"index"})]})}),Object(me.b)("tbody",{children:u.map((function(e,t){return Object(me.c)("tr",{children:[Object(me.b)("td",{className:"counter",children:t+1}),Object(me.b)("td",{className:"label",children:Object(me.b)(cl,{name:"columns.".concat(e,".tempKey"),value:l[e].tempKey},e)}),Object(me.b)("td",{children:l[e].type===ld?Object(me.b)(cl,{name:"columns.".concat(e,".formula"),value:l[e].formula}):Object(me.b)("div",{className:"input disbale"})}),Object(me.b)("td",{className:"index",children:Object(me.b)(cl,{name:"columns.".concat(e,".index"),value:l[e].index})}),Object(me.b)("td",{className:"operation-col",children:u.length===t+1&&Object(me.b)("button",{className:"add",type:"button",onClick:function onClick(){return p(t+1)},children:Object(me.b)(_e.y,{})})})]},e)}))})]}),Object(me.b)(yd,{data:n})]})}));Cd.defaultProps={onAfterSave:function onAfterSave(){return!1}};var Dd,Sd=Cd,wd=Object(m.b)(Dd||(Dd=Object(g.a)(["\n  background-color: white;\n  position: absolute;\n  height: auto;\n  z-index: 99999999999999;\n  box-shadow: 0 19px 38px rgba(0, 0, 0, 0.3), 0 15px 12px rgba(0, 0, 0, 0.22);\n  border-radius: 10px;\n  margin-bottom: 20px;\n\n  ul {\n    list-style-type: none;\n    padding: 0;\n    margin: 0;\n\n    li {\n      padding: 10px 30px;\n      text-align: center;\n      color: black;\n      border-bottom: 0.55px solid lightgoldenrodyellow;\n      min-width: 150px;\n    }\n\n    li:last-of-type {\n      border-bottom: none;\n    }\n\n    li:hover {\n      background-color: gray;\n      color: white;\n    }\n  }\n"])));var Td,Md=function DropDownList(e){var t=e.data,n=void 0===t?[]:t,a=e.onSelect;return Object(me.b)("div",{css:wd,children:Object(me.b)("ul",{children:n.map((function(e,t){return Object(me.b)("li",{onClick:function onClick(){return a(t)},children:e.label},e.key)}))})})},Ad=Object(m.b)(Td||(Td=Object(g.a)(["\n  // position: absolute;\n  padding: 2px;\n  border-radius: 10px;\n  width: auto;\n  display: inline-block;\n  border: 0.55px solid lightgray;\n  font-size: 10px;\n\n  button {\n    text-transform: Capitalize;\n  }\n"])));function DropDownButton(e){var t=e.data,n=e.selectedKey,a=e.onSelect,i=e.formatSelectedValue,o=Object(O.useState)(!1),r=Object(h.a)(o,2),c=r[0],l=r[1],s=Object(O.useState)(n),u=Object(h.a)(s,2),d=u[0],b=u[1],p=useGlobal().rootRef,f=Object(O.useRef)(null),g=Object(O.useCallback)((function(e){!e.target.closest(".".concat(f.current.className))&&c&&setTimeout((function(){l(!1)}),0)}),[c]);Object(O.useEffect)((function(){return p&&p.addEventListener("click",g),function(){return p.removeEventListener("click",g)}}),[g,c,p]);var m=Object(O.useCallback)((function(e){b(t[e].label),a(t[e].key)}),[t,a]);return Object(me.c)("div",{className:"dropdown",ref:f,css:Ad,children:[Object(me.b)("button",{type:"button",onClick:function onClick(){return l((function(e){return!e}))},children:d?i(d):Object(me.b)(_e.j,{})}),c&&Object(me.b)(Md,{data:t,onSelect:m})]})}DropDownButton.defaultProps={data:null,formatSelectedValue:function formatSelectedValue(e){return e},value:null};var Ed,Pd=DropDownButton,Id=function styles(e){return Object(m.b)(Ed||(Ed=Object(g.a)(["\n  position: relative;\n\n  .delete {\n    position: absolute;\n    right: 0px;\n    top: 0px;\n  }\n\n  .container {\n    display: flex;\n    flex-direction: column;\n    padding: 0;\n    margin: 0;\n  }\n  .dropDown-container {\n    justify-content: flex-start;\n    align-items: flex-start;\n  }\n  .label-container {\n    flex: 1;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n    min-height: 45px;\n  }\n\n  .label {\n    text-align: center;\n  }\n\n  ","\n"])),e)},Fd=[{key:"relative",label:"Relative"},{key:"absolute",label:"Absolute"},{key:"min",label:"Min Intensity"},{key:"max",label:"Max Intensity"}];var Rd=function ColumnHeader(e){var t=e.charLabel,n=e.rangeLabel,a=e.data,i=e.onColumnFilter,o=useDispatch(),r=Object(O.useCallback)((function(){o({type:bn,colKey:t})}),[t,o]);return Object(me.c)("div",{css:Id,children:[Object(me.c)("div",{className:"container",children:[a.type===cd&&Object(me.b)("div",{className:"dropDown-container",children:Object(me.b)(Pd,{data:Fd,formatSelectedValue:function formatSelectedValue(e){return e?e.substr(0,3):e},selectedKey:a.valueKey,onSelect:i})}),Object(me.c)("div",{className:"label-container",children:[Object(me.c)("span",{className:"label",children:[" ",t]}),Object(me.b)("span",{className:"label",children:n})]})]}),Object(me.b)(Mc,{onDelete:r})]})};function MultipleSpectraAnalysisTable(e){var t=e.data,n=useFormatNumberByNucleus(e.activeTab),a=Object(O.useMemo)((function(){return Evaluate_calculate(v()(t,"code",""),t)}),[t]),i=useDispatch(),o=Object(O.useCallback)((function(e,t){i({type:hn,payload:{columnKey:e,valueKey:t}})}),[i]),r=Object(O.useMemo)((function(){var e=[{Header:"#",index:0,Cell:function Cell(e){return e.row.index+1}}],a=e;return t.columns&&Object.keys(t.columns).forEach((function(e){var i=t.columns[e],r=i.valueKey,c=i.index;!function setCustomColumn(e,a,i,r){var c=t.columns[i];e.push({index:a,Header:function Header(){return Object(A.jsx)(Rd,{charLabel:i,data:c,onColumnFilter:function onColumnFilter(e){return o(i,e)},rangeLabel:c.from&&c.to?"".concat(n(c.from)," - ").concat(n(c.to)):""})},id:i,sortType:"basic",Cell:function Cell(e){var t=e.row;return r(t)}})}(a,c+1,e,(function(t){var a=t.original[e][r];return a instanceof Error?Object(A.jsx)("span",{style:{color:"red"},children:a.message}):n(a)}))})),(a||e).sort((function(e,t){return e.index-t.index}))}),[o,t.columns,n]);return t.values&&t.values.length>0?Object(A.jsxs)(O.Fragment,{children:[Object(A.jsx)(hu,{data:t.values,columns:r}),Object(A.jsx)("div",{style:{width:"100%",padding:"10px"},dangerouslySetInnerHTML:{__html:a}})]}):Object(A.jsx)(gu,{})}var _d=Object(O.memo)(MultipleSpectraAnalysisTable),Nd={container:{display:"flex",flexDirection:"column",height:"100%"},button:{backgroundColor:"transparent",border:"none"}};function MultipleSpectraAnalysisPanel(e){var t=e.spectraAnalysis,n=e.activeTab,a=Object(O.useState)(!1),i=Object(h.a)(a,2),o=i[0],r=i[1],c=Object(O.useRef)(),l=dc(),s=$(),u=useDispatch(),d=Object(O.useMemo)((function(){var e=t[n]||{values:{},options:{columns:{},code:null}},a=e.values,i=e.options,o=i.columns,r=i.code;return{values:Object.values(a),columns:o,code:r}}),[n,t]),b=Object(O.useCallback)((function(){r(!o)}),[o]),p=Object(O.useCallback)((function(){c.current.saveSetting()}),[]),f=Object(O.useCallback)((function(){r(!1)}),[]),g=Object(O.useCallback)((function(e){oi.emit("showYSpectraTrackers",e)}),[]),m=Object(O.useCallback)((function(){u({type:Lt}),s.show(Object(A.jsx)(hd,{nucleus:n}),{isBackgroundBlur:!1,position:Y.TOP_CENTER,width:500})}),[n,s,u]),j=Object(O.useCallback)((function(){var e=function getDataAsString(e,t){if(e&&e[t]){var n=e[t],a=n.values,i=n.options.columns,o="";for(var r in i)o+="".concat(r,"\t");o+="\n";for(var c=0,l=Object.values(a);c<l.length;c++){var s=l[c];for(var u in i)o+="".concat(s[u][i[u].valueKey],"\t");o+="\n"}return o}return null}(t,n);Object(fc.c)(e)?l.success("Data copied to clipboard"):l.error("copy to clipboard failed")}),[n,l,t]);return Object(A.jsxs)("div",{style:Nd.container,children:[!o&&Object(A.jsxs)(nu,{deleteToolTip:"Delete All Peaks",showSettingButton:"true",canDelete:!1,onSettingClick:b,children:[Object(A.jsx)(Iu,{popupTitle:"Copy To Clipboard",style:Nd.button,onClick:j,children:Object(A.jsx)(_e.p,{})}),Object(A.jsx)(Iu,{popupTitle:"Spectra calibration",style:Nd.button,onClick:m,children:Object(A.jsx)(vs.j,{style:{fontSize:"18px"}})}),Object(A.jsx)(Qs,{popupTitle:"Y Spectra Tracker",popupPlacement:"right",onClick:g,children:Object(A.jsx)(xo.a,{})})]}),o&&Object(A.jsx)(cu,{onSave:p,onClose:b}),Object(A.jsx)("div",{style:{height:"100%",overflow:"auto"},children:Object(A.jsxs)(xs.a,{isFlipped:o,infinite:!0,containerStyle:{overflow:"hidden"},children:[Object(A.jsx)(_d,{data:d,activeTab:n}),Object(A.jsx)(Sd,{data:d,onAfterSave:f,ref:c})]})})]})}var Ld=Xi(Object(O.memo)(MultipleSpectraAnalysisPanel));var zd=function PeaksWrapper(e){var t=function Wrapper(t){var n=useChartData(),a=n.data,i=n.activeSpectrum,o=n.xDomain,r=n.activeTab,c=n.tabActiveSpectrum,l=usePreferences(),s=Object(O.useMemo)((function(){return a&&i&&i.id?a.find((function(e){return e.id===i.id}))||{peaks:{},info:{},data:{}}:{}}),[i,a]),u=s.peaks,d=void 0===u?{}:u,b=s.info,p=void 0===b?{}:b,h=s.data,g=void 0===h?{}:h,m=Object(O.useMemo)((function(){return c&&Object.keys(c).length>0?Object.keys(c):null}),[c]),j=t.forwardedRef,v=Object(le.a)(t,["forwardedRef"]);return Object(A.jsx)(e,Object(f.a)(Object(f.a)({},v),{},{peaks:d,info:p,x:g.x,y:g.y,xDomain:o,preferences:l,activeTab:r,nucleus:m,ref:j}))};return Object(O.forwardRef)((function(e,n){return Object(A.jsx)(t,Object(f.a)(Object(f.a)({},e),{},{forwardedRef:n}))}))},Hd={container:{padding:10,backgroundColor:"#f1f1f1",height:"100%"},groupContainer:{padding:"5px",borderRadius:"5px",margin:"10px 0px",backgroundColor:"white"},row:{display:"flex",margin:"5px 0px"},header:{borderBottom:"1px solid #e8e8e8",paddingBottom:"5px",fontWeight:"bold",color:"#4a4a4a"},inputLabel:{flex:2,fontSize:"11px",fontWeight:"bold",color:"#232323"},input:{width:"30%",textAlign:"center"}},Bd=[{id:1,label:"Peak Number :",checkController:"showPeakNumber",formatController:"peakNumberFormat",defaultFormat:""},{id:2,label:"Peak Index : ",checkController:"showPeakIndex",formatController:"peakIndexFormat",defaultFormat:""},{id:3,label:"\u03b4 (ppm) :",checkController:"showDeltaPPM",formatController:"deltaPPMFormat",defaultFormat:"00.00"},{id:4,label:"\u03b4 (Hz) :",checkController:"showDeltaHz",formatController:"deltaHzFormat",defaultFormat:"00.00"},{id:5,label:"Peak Width",checkController:"showPeakWidth",formatController:"peakWidthFormat",defaultFormat:"00.0000"},{id:6,label:"Intensity :",checkController:"showIntensity",formatController:"intensityFormat",defaultFormat:"00.00"}];function PeaksPreferences(e,t){var n=e.nucleus,a=e.preferences,i=dc(),o=useStateWithLocalStorage("nmr-general-settings"),r=Object(h.a)(o,2)[1],c=Object(O.useState)(null),l=Object(h.a)(c,2),s=l[0],u=l[1],d=Object(O.useRef)();Object(O.useEffect)((function(){var e=ra(a,"formatting.panels.peaks");e&&u(e)}),[a]);var b=Object(O.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a.dispatch({type:Uc,payload:{key:"peaks",value:e}}),t&&i.success("Peaks preferences saved successfully")}),[i,a]);Object(O.useImperativeHandle)(t,(function(){return{saveSetting:function saveSetting(){"function"===typeof d.current.requestSubmit?d.current.requestSubmit():d.current.dispatchEvent(new Event("submit",{cancelable:!0}))}}}));var p=Object(O.useCallback)((function(e){e.preventDefault();var t,n=e.target,a=new FormData(n),i={},o=Object(Pe.a)(a.entries());try{for(o.s();!(t=o.n()).done;){var c=t.value,l=c[0].split("-").join("."),s=["true","false"].includes(c[1])?"true"===c[1]:c[1];i=ia()(i,l,s)}}catch(u){o.e(u)}finally{o.f()}b(i,!0),r(i,"formatting.panels.peaks")}),[b,r]),f=Object(O.useCallback)((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=t.join(".");if(s){var i=v()(s,a);return i||null}var o=t.length-1;return bi[t[o]]}),[s]);return Object(A.jsx)("div",{style:Hd.container,children:Object(A.jsx)("form",{onSubmit:p,ref:d,children:n&&n.map((function(e){return Object(A.jsxs)("div",{style:Hd.groupContainer,children:[Object(A.jsx)(Hu,{style:Hd.header,value:e}),Bd.map((function(t){return Object(A.jsx)(Cu,{label:t.label,checked:f(e,t.checkController),format:f(e,t.formatController),checkControllerName:t.checkController,formatControllerName:t.formatController,groupID:e},t.id)}))]},e)}))})})}var Xd=zd(Object(O.forwardRef)(PeaksPreferences));function PeaksTable(e){var t=e.peaks,n=e.info,a=e.xDomain,i=e.activeTab,o=e.enableFilter,r=e.onFilter,c=e.preferences,l=useDispatch(),s=Object(O.useRef)([]),u=useFormatNumberByNucleus(n.nucleus),d=Object(O.useCallback)((function(e,t){e.preventDefault(),e.stopPropagation();var n=t.original;l({type:Ze,data:{id:n.id,xIndex:n.xIndex}})}),[l]),b=Object(O.useMemo)((function(){return[{index:20,Header:"",width:"1%",maxWidth:"24px",minWidth:"24px",id:"delete-button",Cell:function Cell(e){var t=e.row;return Object(A.jsx)("button",{type:"button",className:"delete-button",onClick:function onClick(e){return d(e,t)},children:Object(A.jsx)(_e.B,{})})}}]}),[d]),p=Object(O.useCallback)((function(e){s.current.forEach((function(t,n){e!==n&&t&&t.closeEdit()}))}),[]),h=Object(O.useCallback)((function(e,t){var n=parseFloat(e.target.value)-parseFloat(t.value);l({type:Ue,shiftValue:n})}),[l]),g=Object(O.useMemo)((function(){var e=function setCustomColumn(e,t,n,a,i){e.push(Object(f.a)(Object(f.a)({},i),{},{index:t,Header:n,sortType:"basic",Cell:function Cell(e){var t=e.row;return a(t)}}))},t=ra(c,"formatting.panels.peaks.[".concat(i,"]"),bi),n=Object(Ee.a)(b);return t.showPeakNumber&&e(n,1,"#",(function(e){return Mi(e.index+1,t.peakNumberFormat)}),{width:"1%",maxWidth:"40px",minWidth:"40px"}),t.showPeakIndex&&e(n,2,"index",(function(e){return Mi(e.original.xIndex,t.peakIndexFormat)})),t.showDeltaPPM&&e(n,3,"\u03b4 (ppm)",(function(e){return Object(A.jsx)(uu,{onEditStart:function onEditStart(){return p(e.index)},ref:function ref(t){return s.current[e.index]=t},value:Mi(e.original.value,t.deltaPPMFormat),onSave:function onSave(t){return h(t,e.original)},type:"number"})})),t.showDeltaHz&&e(n,4,"\u03b4 (Hz)",(function(e){return Mi(e.original.valueHz,t.deltaHzFormat)})),t.showIntensity&&e(n,5,"Intensity",(function(e){return Mi(e.original.intensity,t.intensityFormat)})),t.showPeakWidth&&e(n,5,"Peak Width",(function(e){return Mi(e.original.peakWidth,t.peakWidthFormat)})),n.sort((function(e,t){return e.index-t.index}))}),[i,p,b,c,h]),m=Object(O.useMemo)((function(){function isInRange(e){var t=1e5;return e*t>=a[0]*t&&e*t<=a[1]*t}return t&&t.values?(o?t.values.filter((function(e){return isInRange(e.delta)})):t.values).map((function(e){var t=u(e.delta);return{value:t,valueHz:n&&n.originFrequency?t*n.originFrequency:"",id:e.id,intensity:e.intensity,peakWidth:e.width?e.width:"",isConstantlyHighlighted:isInRange(t)}})):[]}),[o,u,n,t,a]);return Object(O.useEffect)((function(){r(m.length)}),[m,r]),m&&m.length>0?Object(A.jsx)(hu,{data:m,columns:g}):Object(A.jsx)(gu,{})}var Vd=zd(Object(O.memo)(PeaksTable)),Yd={container:{display:"flex",flexDirection:"column",height:"100%"}};function PeaksPanel(){var e=Object(O.useState)(!1),t=Object(h.a)(e,2),n=t[0],a=t[1],i=Object(O.useState)(0),o=Object(h.a)(i,2),r=o[0],c=o[1],l=useDispatch(),s=$(),u=Object(O.useState)(!1),d=Object(h.a)(u,2),b=d[0],p=d[1],f=Object(O.useRef)(),g=Object(O.useCallback)((function(){l({type:Ze,data:null})}),[l]),m=Object(O.useCallback)((function(){s.showConfirmDialog("All records will be deleted, Are You sure?",{onYes:g})}),[s,g]),j=Object(O.useCallback)((function(){p(!b)}),[b]),v=Object(O.useCallback)((function(){f.current.saveSetting(),p(!1)}),[]),x=Object(O.useCallback)((function(){a(!n)}),[n]),y=Object(O.useCallback)((function(e){c(e)}),[]);return Object(A.jsxs)("div",{style:Yd.container,children:[!b&&Object(A.jsx)(nu,{counter:r,onDelete:m,deleteToolTip:"Delete All Peaks",onFilter:x,filterToolTip:n?"Show all peaks":"Hide peaks out of view",filterIsActive:n,counterFiltered:r,showSettingButton:"true",onSettingClick:j}),b&&Object(A.jsx)(cu,{onSave:v,onClose:j}),Object(A.jsx)("div",{style:{height:"100%",overflow:"auto"},children:Object(A.jsxs)(xs.a,{isFlipped:b,infinite:!0,containerStyle:{overflow:"hidden"},children:[Object(A.jsx)(Vd,{enableFilter:n,onFilter:y}),Object(A.jsx)(Xd,{ref:f})]})})]})}var Zd,Ud=Object(O.memo)(PeaksPanel),Kd=Object(m.b)(Zd||(Zd=Object(g.a)(["\n  overflow: auto;\n  width: 400px;\n  .innerContainer {\n    padding: 5px;\n    width: 100%;\n    height: 180px;\n    border: none;\n  }\n\n  .mainButtonsContainer {\n    padding: 5px 0px;\n    border-bottom: 0.55px solid #ebebeb;\n    display: flex;\n    justify-content: space-between;\n  }\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 0 5px;\n  }\n\n  button:disabled {\n    opacity: 0.6;\n  }\n"])));var Wd=function CopyClipboardModal(e){var t=e.text,n=e.onClose,a=e.onCopyClick;return Object(me.c)("div",{css:Kd,children:[Object(me.c)("div",{className:"mainButtonsContainer handle",children:[Object(me.b)("button",{type:"button",onClick:function onClick(){return a(t)},children:Object(me.b)(_e.e,{})}),Object(me.b)(Gn,{onClick:n})]}),Object(me.b)("div",{className:"innerContainer",dangerouslySetInnerHTML:{__html:t}})]})},Gd={toolbar:{display:"flex",flexDirection:"row",borderBottom:"0.55px solid rgb(240, 240, 240)"},center:{display:"flex",justifyContent:"center",alignItems:"center",padding:"5px"},removeAssignmentsButton:{border:"none",height:"16px",fontSize:"12px",backgroundColor:"transparent"},button:{backgroundColor:"transparent",border:"none"}};var qd=function RangesHeader(e){var t=e.ranges,n=e.info,a=e.activeTab,i=e.molecules,o=e.onUnlink,r=e.onFilterActivated,c=e.onSettingClick,l=e.isFilterActive,s=e.filterCounter,u=useDispatch(),d=$(),b=dc(),p=usePreferences(),g=useAssignmentData(),m=Object(O.useState)(!1),j=Object(h.a)(m,2),x=j[0],y=j[1],k=v()(t,"options.sum",null),C=Object(O.useCallback)((function(e){void 0!==e&&u({type:Gt,value:e}),d.close()}),[u,d]),D=Object(O.useCallback)((function(){d.show(Object(A.jsx)(qs,{onClose:function onClose(){return d.close()},onSave:C,header:k?"Set new Ranges Sum (Current: ".concat(Number(k).toFixed(2),")"):"Set new Ranges Sum",molecules:i,element:a?a.replace(/[0-9]/g,""):null}))}),[a,C,k,d,i]),S=Object(O.useCallback)((function(){var e,n=Object(Pe.a)(t.values);try{for(n.s();!(e=n.n()).done;){var a=e.value;o(a)}}catch(i){n.e(i)}finally{n.f()}}),[t,o]),w=Object(O.useCallback)((function(){d.showConfirmDialog("All assignments will be removed. Are you sure?",{onYes:S})}),[S,d]),T=Object(O.useCallback)((function(){d.showConfirmDialog("All ranges will be deleted. Are You sure?",{onYes:function onYes(){u({type:Rt,payload:{assignmentData:g}})}})}),[g,u,d]),M=Object(O.useCallback)((function(e){oi.emit("showMultiplicityTrees",e),y(e)}),[]),E=Object(O.useCallback)((function(e){Object(fc.a)(e)?b.success("Data copied to clipboard"):b.error("copy to clipboard failed")}),[b]),P=Object(O.useCallback)((function(){var e=n.originFrequency,a=n.nucleus,i=v()(p,"formatting.nucleusByKey[".concat(a.toLowerCase(),"]")),o=getNumberOfDecimals(i.ppm),r=getNumberOfDecimals(i.hz),c=Object(Kr.c)(t.values,{nucleus:a,nbDecimalDelta:o,nbDecimalJ:r,observedFrequency:e});d.show(Object(A.jsx)(Wd,{text:c,onCopyClick:E,onClose:function onClose(){return d.close()}}),{})}),[n,d,p,t.values,E]);return Object(A.jsxs)(nu,{counter:t&&t.values&&t.values.length,onDelete:T,deleteToolTip:"Delete All Ranges",onFilter:r,filterToolTip:l?"Show all ranges":"Hide ranges out of view",filterIsActive:l,counterFiltered:s,showSettingButton:"true",onSettingClick:c,children:[Object(A.jsx)(Zn,{title:"Preview publication string",popupPlacement:"right",children:Object(A.jsx)("button",{style:Gd.button,type:"button",onClick:P,children:Object(A.jsx)(_e.p,{})})}),Object(A.jsx)(Zn,{title:k?"Change Ranges Sum (".concat(Number(k).toFixed(2),")"):"Change Ranges Sum",popupPlacement:"right",children:Object(A.jsx)("button",{css:Gd.button,type:"button",onClick:D,children:Object(A.jsx)(vs.t,{})})}),Object(A.jsx)(Zn,{title:"Remove all Assignments",popupPlacement:"right",children:Object(A.jsx)("button",{style:Object(f.a)(Object(f.a)({},Gd.center),Gd.removeAssignmentsButton),type:"button",onClick:w,disabled:!t||!t.values||0===t.values.length,children:Object(A.jsx)(_e.H,{})})}),Object(A.jsx)(Qs,{popupTitle:x?"Hide Multiplicity Trees in Spectrum":"Show Multiplicity Trees in Spectrum",popupPlacement:"right",onClick:M,disabled:!t||!t.values||0===t.values.length,children:Object(A.jsx)(_e.E,{style:{pointerEvents:"none",fontSize:"12px"}})})]})},Jd={container:{padding:10,backgroundColor:"#f1f1f1",height:"100%",flex:1},groupContainer:{padding:"5px",borderRadius:"5px",margin:"10px 0px",backgroundColor:"white"},row:{display:"flex",margin:"5px 0px"},header:{borderBottom:"1px solid #e8e8e8",paddingBottom:"5px",fontWeight:"bold",color:"#4a4a4a"},inputLabel:{flex:2,fontSize:"11px",fontWeight:"bold",color:"#232323"},input:{width:"30%",textAlign:"center"}};function RangesPreferences(e,t){var n=e.nucleus,a=e.preferences,i=dc(),o=useStateWithLocalStorage("nmr-general-settings"),r=Object(h.a)(o,2)[1],c=Object(O.useState)(null),l=Object(h.a)(c,2),s=l[0],u=l[1],d=Object(O.useRef)();Object(O.useEffect)((function(){var e=ra(a,"formatting.panels.ranges");e&&u(e)}),[a]);var b=function saveToLocalStorgate(e){r(e,"formatting.panels.ranges")},p=Object(O.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a.dispatch({type:Uc,payload:{key:"ranges",value:e}}),t&&i.success("ranges preferences saved successfully")}),[i,a]);Object(O.useImperativeHandle)(t,(function(){return{saveSetting:function saveSetting(){"function"===typeof d.current.requestSubmit?d.current.requestSubmit():d.current.dispatchEvent(new Event("submit",{cancelable:!0}))}}}));var f=[{id:1,label:"From :",checkController:"showFrom",formatController:"fromFormat",defaultFormat:"0.00"},{id:2,label:"To :",checkController:"showTo",formatController:"toFormat",defaultFormat:"0.00"},{id:3,label:"Absolute :",checkController:"showAbsolute",formatController:"absoluteFormat",defaultFormat:"0.00"},{id:4,label:"Relative :",checkController:"showRelative",formatController:"relativeFormat",defaultFormat:"00.00"}],g=function(){var e=Object(Ae.a)(Me.a.mark((function _callee(e){var t,n,a,i,o,r,c,l;return Me.a.wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:e.preventDefault(),t=e.target,n=new FormData(t),a={},i=Object(Pe.a)(n.entries());try{for(i.s();!(o=i.n()).done;)r=o.value,c=r[0].split("-").join("."),l=["true","false"].includes(r[1])?"true"===r[1]:r[1],a=ia()(a,c,l)}catch(u){i.e(u)}finally{i.f()}p(a,!0),b(a);case 8:case"end":return s.stop()}}),_callee)})));return function handleSubmit(t){return e.apply(this,arguments)}}(),m=Object(O.useCallback)((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=t.join(".");if(s){var i=v()(s,a);return i||null}var o=t.length-1;return di[t[o]]}),[s]);return Object(A.jsx)("div",{style:Jd.container,children:Object(A.jsx)("form",{onSubmit:g,ref:d,children:n&&n.map((function(e){return Object(A.jsxs)("div",{style:Jd.groupContainer,children:[Object(A.jsx)(Hu,{style:Jd.header,value:e}),f.map((function(t){return Object(A.jsx)(Cu,{label:t.label,checked:m(e,t.checkController),format:m(e,t.formatController),checkControllerName:t.checkController,formatControllerName:t.formatController,groupID:e},t.id)}))]},e)}))})})}var $d=Object(O.memo)(Object(O.forwardRef)(RangesPreferences)),Qd=null;var eb=function useToggleStatus(e,t){var n=Object(O.useState)({}),a=Object(h.a)(n,2),i=a[0],o=a[1];Object(O.useEffect)((function(){var n={};if(t&&Array.isArray(t)){for(var a=0;a<t.length;a++)n[t[a][e]]=!1;o(n)}}),[t,e]);var r=Object(O.useCallback)((function(e){var t=Object(f.a)({},i);Qd&&(t[Qd]=!1),null!=e&&(Qd=e,t[e]=!0),o(t)}),[i]);return[i,r]},tb=n(380),nb=n.n(tb);function isColumnVisible(e,t){return nb.a.get(e,t,!1)}var ab,ib=function AbsoluteColumn(e){var t=e.rowSpanTags,n=e.value,a=e.onHoverRange,i=e.format;return Object(A.jsx)("td",Object(f.a)(Object(f.a)(Object(f.a)({},t),a),{},{children:Mi(n,i)}))};function SelectUncontrolled(e){var t=e.data,n=e.style,a=e.onChange,i=e.value,o=Object(O.useCallback)((function(e){a(e.target.value)}),[a]),r=Object(m.b)(ab||(ab=Object(g.a)(["\n    position: relative;\n    padding: 0px 5px;\n    border: 0.55px solid #cacaca;\n    font-size: 14px;\n    width: ","px;\n    margin: 0;\n    height: 100%;\n    background: "," no-repeat right white;\n    -webkit-appearance: none;\n    background-position-x: ","px;\n    background-size: 15px 15px;\n    border-radius: 5px;\n    margin: 0px 5px;\n    :focus,\n    input:focus {\n      outline: none;\n    }\n  "])),n.width?n.width-5:95,'url(\'data:image/svg+xml;utf8,<svg  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="960px" height="560px" viewBox="0 0 960 560" enable-background="new 0 0 960 560" xml:space="preserve"><g id="Rounded_Rectangle_33_copy_4_1_"><path d="M480,344.181L268.869,131.889c-15.756-15.859-41.3-15.859-57.054,0c-15.754,15.857-15.754,41.57,0,57.431l237.632,238.937c8.395,8.451,19.562,12.254,30.553,11.698c10.993,0.556,22.159-3.247,30.555-11.698l237.631-238.937c15.756-15.86,15.756-41.571,0-57.431s-41.299-15.859-57.051,0L480,344.181z"/></g></svg>\')',n.width?n.width-18:77);return Object(me.b)("select",{css:[r,n],onChange:o,value:i,children:t.map((function(e){return Object(me.b)("option",{value:e.value,children:e.label},"".concat(e.key))}))})}SelectUncontrolled.defaultProps={onChange:function onChange(){return null}};var ob=SelectUncontrolled;var rb=function Button_Button(e){var t=e.onClick,n=Object(le.a)(e,["onClick"]);return Object(me.b)(O.Fragment,{children:Object(me.b)("button",Object(f.a)({type:"button",onClick:t},n))})};var cb=function ErrorMessage(e){var t=e.style,n=Object(le.a)(e,["style"]),a=Object(zc.e)(n)[1];return Object(me.b)("div",{children:a.error?Object(me.b)("p",{style:Object(f.a)({color:"red",margin:"0.5px"},t),children:a.error}):null})};function formik_Input_Input(e){var t=e.onFocus,n=e.onBlur,a=e.enableErrorMessage,i=Object(le.a)(e,["onFocus","onBlur","enableErrorMessage"]),o=Object(zc.e)(i),r=Object(h.a)(o,1)[0];return Object(A.jsxs)("div",{children:[Object(A.jsx)("input",Object(f.a)(Object(f.a)(Object(f.a)({},r),i),{},{onFocus:function onFocus(){return t(r.name)},onBlur:function onBlur(){return n(r.name)}})),a&&!0===a?Object(A.jsx)(cb,Object(f.a)({},i)):null]})}formik_Input_Input.defaultProps={onFocus:function onFocus(){return null},onBlur:function onBlur(){return null}};var lb,sb=formik_Input_Input,ub=Object(m.b)(lb||(lb=Object(g.a)(["\n  text-align: center;\n  width: 100%;\n  height: 100%;\n\n  .infoText {\n    margin-top: 20px;\n    font-size: 12px;\n  }\n\n  input {\n    background-color: transparent;\n    border: 0.5px solid #dedede;\n    width: 50%;\n    text-align: center;\n  }\n\n  .addSignalButton {\n    margin-top: 15px;\n    margin-top: 20px;\n    background-color: transparent;\n    border: none;\n    padding: 0.3rem;\n    border-radius: 25%;\n  }\n"])));function AddSignalFormTab(e){var t=e.onFocus,n=e.onBlur,a=Object(zc.f)(),i=a.values,o=a.setFieldValue,r=a.errors,c=Object(O.useState)(!1),l=Object(h.a)(c,2),s=l[0],u=l[1],d=Object(O.useCallback)((function(){var e={multiplicity:"m",kind:"signal",delta:Number(i.newSignalDelta),j:[{multiplicity:translateMultiplet("m"),coupling:""}]},t=i.signals.slice().concat(e);o("signals",t),o("activeTab",String(t.length-1))}),[o,i.newSignalDelta,i.signals]);return Object(O.useEffect)((function(){r.newSignalDelta?u(!0):u(!1)}),[r.newSignalDelta,i.signals]),Object(me.c)("div",{css:ub,children:[Object(me.c)("div",{children:[Object(me.b)("p",{className:"infoText",children:"Edit or select a delta value of new signal (ppm):"}),Object(me.b)(sb,{name:"newSignalDelta",type:"number",placeholder:"\u0394".concat(" (ppm)"),onFocus:t,onBlur:n})]}),Object(me.b)("div",{children:Object(me.b)(rb,{className:"addSignalButton",onClick:d,disabled:s,css:{color:s?"grey":"blue",width:"100%"},children:Object(me.b)(_e.y,{title:"Add new signal"})})})]})}var db=Object(O.memo)(AddSignalFormTab);function SelectBox(e){var t=e.values,n=Object(le.a)(e,["values"]),a=Object(zc.e)(n),i=Object(h.a)(a,1)[0];return t&&t.length>0?Object(me.c)("div",{children:[Object(me.b)(zc.a,Object(f.a)(Object(f.a)(Object(f.a)({as:"select"},i),n),{},{children:t.map((function(e,t){return Object(me.b)("option",{children:e},t)}))})),Object(me.b)(cb,Object(f.a)({},n))]}):null}SelectBox.protoTypes={valuePath:_i.a.instanceOf(Array).isRequired,valueSelectionTemplate:_i.a.func};var bb,pb=SelectBox,fb=Object(m.b)(bb||(bb=Object(g.a)(["\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  height: 100%;\n  font-size: 12px;\n\n  th,\n  td {\n    text-align: center;\n    margin: 0;\n    padding: 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    button {\n      background-color: transparent;\n      border: none;\n    }\n\n    .add-button {\n      color: blue;\n    }\n\n    .delete-button {\n      border-radius: 25%;\n      padding: 0;\n      padding-left: 0.3rem;\n      padding-right: 0.3rem;\n    }\n    .delete-button:hover {\n      background-color: red;\n      .icon {\n        color: white;\n      }\n    }\n\n    input {\n      background-color: transparent;\n      border: 0.5px solid #dedede;\n      height: 100%;\n      width: 100%;\n      text-align: center;\n    }\n    .selectBox {\n      background-color: transparent;\n      border: 0.5px solid #dedede;\n      height: 100%;\n      width: 100%;\n      text-align: center;\n    }\n  }\n\n  tr {\n    :last-child {\n      border-top: 3px solid #dedede;\n    }\n  }\n"]))),hb={border:"1px solid red"};function CouplingsTable(e){var t=e.push,n=e.remove,a=e.onFocus,i=e.onBlur,o=Object(zc.f)(),r=o.values,c=o.setFieldValue,l=o.errors;Object(O.useEffect)((function(){r.signals[r.activeTab]&&r.signals[r.activeTab].j.forEach((function(e,t){hasCouplingConstant(e.multiplicity)||c("signals.".concat(r.activeTab,".j.").concat(t,".coupling"),"")}))}),[c,r.activeTab,r.signals]);var s=Object(O.useCallback)((function(e){return v()(l,"signals[".concat(r.activeTab,"].missingCouplings"),[]).some((function(t){return t.index===e}))}),[l,r.activeTab]);return Object(me.b)("table",{css:fb,children:Object(me.c)("tbody",{children:[Object(me.c)("tr",{children:[Object(me.b)("th",{children:"#"}),Object(me.b)("th",{children:"Multiplicity"}),Object(me.b)("th",{children:"J (Hz)"}),Object(me.b)("th",{children:""})]}),v()(r,"signals[".concat(r.activeTab,"].j"),[]).map((function(e,t){return Object(me.c)("tr",{children:[Object(me.b)("td",{children:t+1}),Object(me.b)("td",{children:Object(me.b)(pb,{className:"selectBox",name:"signals.".concat(r.activeTab,".j.").concat(t,".multiplicity"),values:io.map((function(e){return e.label}))})}),Object(me.b)("td",{children:Object(me.b)(sb,{name:"signals.".concat(r.activeTab,".j.").concat(t,".coupling"),type:"number",placeholder:"J (Hz)",disabled:!hasCouplingConstant(e.multiplicity),onFocus:a,onBlur:i,style:s(t)?hb:null})}),Object(me.b)("td",{children:Object(me.b)(rb,{className:"delete-button",onClick:function onClick(){n(t)},children:Object(me.b)(_e.v,{className:"icon",title:"Delete coupling"})})})]},"editCouplings".concat(r.activeTab).concat(t))})),Object(me.b)("tr",{}),Object(me.b)("tr",{children:Object(me.b)("td",{colSpan:4,children:Object(me.b)(rb,{className:"add-button",onClick:function onClick(){return t({multiplicity:translateMultiplet("m"),coupling:""})},children:Object(me.b)(_e.y,{title:"Add new coupling"})})})})]})})}var gb,mb=Object(O.memo)(CouplingsTable),jb=Object(m.b)(gb||(gb=Object(g.a)(["\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  font-size: 12px;\n  height: 100%;\n\n  margin: 0;\n  padding: 0.4rem;\n  text-align: center;\n"])));function SignalFormTab(e){var t=e.onFocus,n=e.onBlur,a=Object(zc.f)().values;return Object(me.b)("div",{css:jb,children:Object(me.b)(zc.b,{name:"signals.".concat(a.activeTab,".j"),render:function render(e){var a=e.push,i=e.remove;return Object(me.b)("div",{children:Object(me.b)(mb,{push:a,remove:i,onFocus:t,onBlur:n})})}})})}var vb,Ob,xb=Object(O.memo)(SignalFormTab),yb=Object(m.b)(vb||(vb=Object(g.a)(["\n  text-align: center;\n  width: 100%;\n\n  .errorText {\n    color: red;\n  }\n\n  .infoText {\n    margin-bottom: 20px;\n    font-size: 11px;\n  }\n"]))),kb=Object(m.b)(Ob||(Ob=Object(g.a)(["\n  color: red;\n"])));function SignalsForm(){var e=Object(zc.f)(),t=e.values,n=e.setFieldValue,a=e.errors,i=useChartData(),o=i.data,r=i.activeSpectrum,c=Object(O.useState)(null),l=Object(h.a)(c,2),s=l[0],u=l[1],d=Object(O.useState)(null),b=Object(h.a)(d,2),p=b[0],f=b[1];Object(O.useEffect)((function(){o&&r&&v()(o,"[".concat(r.index,"].info.originFrequency"),void 0)?f(o[r.index].info.originFrequency):f(null)}),[r,o]),Object(O.useEffect)((function(){return oi.on("brushEnd",(function(e){s&&p&&n(s,Math.abs(e.range[0]-e.range[1])*p)})),function(){oi.off("brushEnd")}}),[s,n,p,t.activeTab]),Object(O.useEffect)((function(){return oi.on("mouseClick",(function(e){"addSignalTab"===t.activeTab&&s&&n(s,e.xPPM)})),function(){oi.off("mouseClick")}}),[t.activeTab,s,n]);var g=Object(O.useCallback)((function(e){u(e)}),[u]),m=Object(O.useCallback)((function(e){var t=e.tabid;n("activeTab",t),u(null)}),[n]),j=Object(O.useCallback)((function(e){var a=e.tabid,i=t.signals.filter((function(e,t){return t!==Number(a)}));n("signals",i)}),[n,t.signals]);Object(O.useEffect)((function(){n("activeTab",t.signals.length>0?(t.signals.length-1).toString():"addSignalTab")}),[n,t.signals.length]);var x=Object(O.useCallback)((function(e){return a.signals&&(v()(a,"signals.noCouplings",[]).some((function(t){return t.index===e}))||v()(a,"signals[".concat(e,"].missingCouplings"),[]).length>0)}),[a]),y=Object(O.useMemo)((function(){var e=t.signals.length>0?t.signals.map((function(e,t){return Object(me.b)("div",{tabid:"".concat(t),tablabel:"\u0394".concat(": ",e.delta.toFixed(5)," (").concat(e.j.map((function(e){return translateMultiplet(e.multiplicity)})).join(""),")"),tabstyles:x(t)?kb:null,children:Object(me.b)(xb,{onFocus:g})},"signalForm".concat(t))})):[],n=Object(me.b)("div",{tablabel:"+",tabid:"addSignalTab",candelete:"false",children:Object(me.b)(db,{onFocus:g})},"addSignalTab");return e.concat(n)}),[g,x,t.signals]),k=Object(me.b)("p",{className:"infoText",children:"Focus on an input field and press Shift + Drag & Drop to draw a coupling constant in spectrum view."}),C=Object(me.b)("p",{className:"infoText",children:"Focus on the input field and press Shift + Left mouse click to select new signal delta value in spectrum view."});return Object(me.c)("div",{children:[Object(me.b)("div",{css:yb,children:a.signals&&(a.signals.noSignals||a.signals.noCouplings)?Object(me.c)("div",{children:[Object(me.b)("p",{className:"errorText",children:a.signals.noSignals||a.signals.noCouplings[0].message}),a.signals.noSignals?C:null]}):"addSignalTab"===t.activeTab?C:k}),Object(me.b)(Lc,{defaultTabID:t.activeTab,onClick:m,canDelete:!0,onDelete:j,children:y})]})}var Cb=Object(O.memo)(SignalsForm);var Db,Sb=function EditRangeValidation(e,t){var n={};e.newSignalDelta?(e.newSignalDelta<t.from||e.newSignalDelta>t.to)&&(n.newSignalDelta=" ".concat(e.newSignalDelta.toFixed(5)," ppm out of the range")):n.newSignalDelta="required";var a=function createSignalsError(e){n.signals||(n.signals={}),void 0===e||n.signals["".concat(e)]||(n.signals["".concat(e)]={missingCouplings:[]})};return 0===e.signals.length?(a(),n.signals.noSignals="There must be at least one signal in a range!"):e.signals.forEach((function(e,t){0===e.j.length&&(a(t),n.signals.noCouplings||(n.signals.noCouplings=[]),n.signals.noCouplings.push({index:t,message:"There must be at least one coupling in signal ".concat(t+1,"!")})),e.j.forEach((function(e,i){hasCouplingConstant(e.multiplicity)&&""===e.coupling&&(a(t),n.signals["".concat(t)].missingCouplings.push({index:i,message:"There are coupling values missing in signal ".concat(t+1,"!")}))}))})),n},wb=Object(m.b)(Db||(Db=Object(g.a)(["\n  overflow: auto;\n  width: 600px;\n  height: 500px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n      border-left: 1px solid #ececec;\n      padding-left: 6px;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      padding: 5px;\n\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    display: flex;\n    margin: 30px 5px;\n    input,\n    button {\n      padding: 5px;\n      border: 1px solid gray;\n      border-radius: 5px;\n      height: 36px;\n      margin: 2px;\n    }\n    input {\n      flex: 10;\n    }\n    button {\n      flex: 2;\n      color: white;\n      background-color: gray;\n    }\n  }\n"])));function EditRangeModal(e){var t=e.onSaveEditRangeModal,n=e.onCloseEditRangeModal,a=e.onZoomEditRangeModal,i=e.rangeData,o=Object(O.useCallback)((function(){a(i)}),[a,i]);Object(O.useEffect)((function(){o()}),[o]);var r=Object(O.useCallback)((function(){n()}),[n]),c=Object(O.useCallback)((function(e){return e.filter((function(e){return""!==e.coupling})).map((function(e){return Object(f.a)(Object(f.a)({},e),{},{multiplicity:translateMultiplet(e.multiplicity)})}))}),[]),l=Object(O.useCallback)((function(e){return e.map((function(e){return Object(f.a)(Object(f.a)({id:generateID()},e),{},{multiplicity:e.j.map((function(e){return translateMultiplet(e.multiplicity)})).join(""),j:c(e.j)})}))}),[c]),s=Object(O.useCallback)(function(){var e=Object(Ae.a)(Me.a.mark((function _callee(e){var n;return Me.a.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return(n=Object(f.a)({},i)).signal=l(e.signals),a.next=4,t(n);case 4:r();case 5:case"end":return a.stop()}}),_callee)})));return function(t){return e.apply(this,arguments)}}(),[l,r,t,i]),u=Object(O.useMemo)((function(){return i.signal.map((function(e){var t,n=0,a=[];return e.multiplicity.split("").forEach((function(i){hasCouplingConstant(i)?(t=Object(f.a)({},e.j[n]),n++):t={multiplicity:i,coupling:""},t.multiplicity=translateMultiplet(t.multiplicity),a.push(t)})),Object(f.a)(Object(f.a)({},e),{},{j:a})}))}),[i.signal]),d=Object(O.useCallback)((function(e){var t=Object.keys(e);return t.length>0&&(1!==t.length||"newSignalDelta"!==t[0])}),[]);return Object(me.b)("div",{css:wb,children:i&&Object(me.b)(zc.d,{initialValues:{signals:u,newSignalDelta:(i.from+i.to)/2,activeTab:"0"},validate:function validate(e){return Sb(e,i)},onSubmit:function onSubmit(e,t){var n=t.setSubmitting;s(e),n(!1)},children:function children(e){var t=e.values,n=e.errors;return Object(me.c)(zc.c,{children:[Object(me.c)("div",{className:"header handle",children:[Object(me.b)(rb,{onClick:o,className:"zoom-button",children:Object(me.b)(_e.D,{title:"Set to default view on range in spectrum"})}),Object(me.b)("span",{children:"Range Information and Editing"}),Object(me.b)(ou,{onClick:function onClick(){return s(t)},disabled:d(n),popupTitle:"Save and exit"}),Object(me.b)(Gn,{onClick:r})]}),Object(me.b)(Cb,{})]})}})})}EditRangeModal.defaultProps={onSave:function onSave(){return null},onClose:function onClose(){return null},onZoom:function onZoom(){return null}};var Tb,Mb=EditRangeModal,Ab=Object(m.b)(Tb||(Tb=Object(g.a)(["\n  width: 66px;\n  padding: 0 !important;\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n\n  button:disabled {\n    opacity: 0.6;\n  }\n"]))),Eb={marginLeft:2,marginRight:2,border:"none",height:"20px"};var Pb=function ActionsColumn(e){var t=e.rowData,n=e.onHoverSignal,a=e.rowSpanTags,i=useDispatch(),o=$(),r=useAssignmentData(),c=Object(O.useCallback)((function(){var e=Math.abs(t.from-t.to);i({type:Ke,xDomain:[t.from-e,t.to+e]})}),[i,t.from,t.to]),l=Object(O.useCallback)((function(){i({type:Rt,payload:{id:t.id,assignmentData:r}})}),[r,i,t]),s=Object(O.useCallback)((function(e){i({type:rn,payload:{rowData:t,value:e}})}),[i,t]),u=Object(O.useCallback)((function(e){i({type:cn,payload:{editedRowData:e,assignmentData:r}})}),[r,i]),d=Object(O.useCallback)((function(){i({type:Lt}),o.close()}),[i,o]),b=Object(O.useCallback)((function(){i({type:$e,selectedTool:"editRange"}),o.show(Object(me.b)(Mb,{onCloseEditRangeModal:d,onSaveEditRangeModal:u,onZoomEditRangeModal:c,rangeData:t}),{position:Y.CENTER_RIGHT,transition:G,isBackgroundBlur:!1})}),[d,i,o,t,u,c]);return Object(me.c)(O.Fragment,{children:[Object(me.b)("td",Object(f.a)(Object(f.a)({},n),{},{children:Object(me.b)(ob,{onChange:s,data:Wi,value:t.tableMetaInfo.signal.kind,style:Eb})})),Object(me.c)("td",Object(f.a)(Object(f.a)({},a),{},{css:Ab,children:[Object(me.b)("button",{type:"button",className:"delete-button",onClick:l,children:Object(me.b)(_e.B,{})}),Object(me.b)("button",{type:"button",className:"zoom-button",onClick:c,children:Object(me.b)(_e.D,{title:"Zoom to range in spectrum"})}),Object(me.b)("button",{type:"button",className:"edit-button",onClick:b,children:Object(me.b)(_e.i,{color:"blue"})})]}))]})};var Ib=function CouplingColumn(e){var t=e.rowData,n=e.onHoverSignal,a=v()(t,"tableMetaInfo.signal.j");return Object(A.jsx)("td",Object(f.a)(Object(f.a)({},n),{},{children:a&&a.map((function(e){return e.coupling.toFixed(1)})).join(",")}))},Fb={color:"red",fontWeight:"bold"};function RangeAssignmentsColumn(e){var t=e.rowData,n=e.assignment,a=e.highlight,i=e.onUnlinkVisibilityChange,o=e.unlinkVisibility,r=e.onLink,c=e.onUnlink,l=e.rowSpanTags,s=e.onHover,u=e.highlightData,d=Object(O.useMemo)((function(){return v()(t,"diaID",[])}),[t]),b=Object(O.useCallback)((function(e){i(e)}),[i]),p=Object(O.useMemo)((function(){return n.isActive||n.isOnHover||a.isActive&&!u.highlight.highlighted.find((function(e){return e===n.id}))?{color:"red",fontWeight:"bold"}:{color:"black",fontWeight:"normal"}}),[n.id,n.isActive,n.isOnHover,a.isActive,u.highlight.highlighted]);return Object(A.jsx)("td",Object(f.a)(Object(f.a)(Object(f.a)({},l),s),{},{onClick:function onClick(e){return r(e,n)},children:void 0!==t.pubIntegral&&t.pubIntegral>0?t.diaID&&t.diaID.length>0?Object(A.jsxs)("div",{onMouseEnter:function onMouseEnter(){return b(!0)},onMouseLeave:function onMouseLeave(){return b(!1)},children:[t.pubIntegral," "," ( ",Object(A.jsx)("span",{style:p,children:d.length})," ) ",Object(A.jsx)("sup",{children:Object(A.jsx)("button",{type:"button",style:{visibility:o?"visible":"hidden",padding:0,margin:0},onClick:function onClick(e){return c(e,!0)},children:Object(A.jsx)(_e.w,{color:"red"})})})]}):n.isActive?Object(A.jsxs)("div",{children:["".concat(t.pubIntegral," ("),Object(A.jsx)("span",{style:Fb,children:"0"}),")"]}):t.pubIntegral:n.isActive?Object(A.jsxs)("div",{children:["0 (",Object(A.jsx)("span",{style:Fb,children:"0"}),")"]}):""}))}RangeAssignmentsColumn.defaultProps={onHover:function onHover(){return null},onUnlinkVisibilityChange:function onUnlinkVisibilityChange(){return null},onLink:function onLink(){return null},onUnlink:function onUnlink(){return null}};var Rb=Object(O.memo)(RangeAssignmentsColumn);function RangeColumn(e){var t=e.value,n=e.rowSpanTags,a=e.onHoverRange,i=e.format;return Object(A.jsx)("td",Object(f.a)(Object(f.a)(Object(f.a)({},n),a),{},{children:Mi(t,i)}))}var _b=Object(O.memo)(RangeColumn);function RelativeColumn(e,t){var n=e.rowData,a=e.rowSpanTags,i=e.onHoverRange,o=e.format,r=e.onEditStart,c=e.editStatus,l=useDispatch(),s=Object(O.useMemo)((function(){var e=eo(n),t=Mi(n.integral,o);return e?t:"[ ".concat(t," ]")}),[o,n]),u=Object(O.useCallback)((function(e){l({type:nn,value:e.target.value,id:n.id})}),[l,n.id]);return Object(A.jsx)("td",Object(f.a)(Object(f.a)(Object(f.a)({},a),i),{},{children:Object(A.jsx)(uu,{ref:t,onEditStart:r,value:s,onSave:u,type:"number",style:{padding:"0.1rem 0.4rem"},editStatus:c})}))}var Nb=Object(O.forwardRef)(RelativeColumn);function SignalAssignmentsColumn(e){var t=e.rowData,n=e.onHover,a=e.assignment,i=e.highlight,o=e.onUnlinkVisibilityChange,r=e.unlinkVisibility,c=e.onLink,l=e.onUnlink,s=Object(O.useMemo)((function(){return v()(t,"tableMetaInfo.signal.diaID",[])}),[t]),u=Object(O.useMemo)((function(){return a.isActive||i.isActive?{color:"red",fontWeight:"bold"}:null}),[a.isActive,i.isActive]),d=Object(O.useCallback)((function(e){o(e)}),[o]),b=Object(O.useCallback)((function(e){c(e,a)}),[a,c]);return Object(A.jsx)("td",Object(f.a)(Object(f.a)({},n),{},{onClick:b,style:u,children:s&&s.length>0?Object(A.jsxs)("div",{onMouseEnter:function onMouseEnter(){return d(!0)},onMouseLeave:function onMouseLeave(){return d(!1)},children:[s.length," ",Object(A.jsx)("sup",{children:Object(A.jsx)("button",{type:"button",style:{visibility:r?"visible":"hidden",padding:0,margin:0},onClick:function onClick(e){return l(e,!1)},children:Object(A.jsx)(_e.w,{color:"red"})})})]}):a.isActive?"0":""}))}SignalAssignmentsColumn.defaultProps={onHover:function onHover(){return null},onUnlinkVisibilityChange:function onUnlinkVisibilityChange(){return null},onLink:function onLink(){return null},onUnlink:function onUnlink(){return null}};var Lb=Object(O.memo)(SignalAssignmentsColumn);function useFormat(e){return function(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=v()(e,n,"0.000");return Mi(t,o,a,i)}}var zb,Hb,Bb=function SignalDeltaColumn(e){var t=e.rowData,n=e.onHoverSignal,a=e.preferences,i=e.onEditStart,o=e.editStatus,r=useDispatch(),c=t.tableMetaInfo.signal,l=useFormat(a),s=Object(O.useCallback)((function(e){r({type:an,payload:{value:e.target.value,rangeID:t.id,signalID:c.id}})}),[r,t,c.id]),u=Object(O.useCallback)((function(){i(c.id)}),[i,c.id]);return c?Object(A.jsx)("td",Object(f.a)(Object(f.a)({},n),{},{children:checkMultiplicity(c.multiplicity,["m"])?Object(A.jsx)(uu,{onEditStart:u,value:c.delta.toFixed(3),onSave:s,type:"number",style:{padding:"0.1rem 0.4rem"},editStatus:o}):"".concat(l(t.from,"fromFormat")," - ").concat(l(t.to,"toFormat"))})):Object(A.jsx)("td",{children:""})},Xb=Object(m.b)(zb||(zb=Object(g.a)(["\n  background-color: #ff6f0057;\n"]))),Vb=Object(m.b)(Hb||(Hb=Object(g.a)(["\n  background-color: #f5f5dc;\n"])));var Yb=function RangesTableRow(e){var t=e.rowData,n=e.onUnlink,a=e.onContextMenu,i=e.onColumnEditStart,o=e.preferences,r=e.editFlags,c=r.relativeFlags,l=r.signalFlags,s=useAssignment(t.id),u=Object(pi.c)([s.id].concat(s.assigned.x||[])),d=useAssignment(t.tableMetaInfo.id),b=Object(pi.c)([d.id].concat(d.assigned.x||[])),p=Object(pi.d)(),g=Object(O.useState)(!1),m=Object(h.a)(g,2),j=m[0],x=m[1],y=Object(O.useState)(!1),k=Object(h.a)(y,2),C=k[0],D=k[1],S=useFormat(o),w=Object(O.useMemo)((function(){return{rowSpan:t.tableMetaInfo.rowSpan,style:v()(t.tableMetaInfo,"hide",!1)?{display:"none"}:null}}),[t.tableMetaInfo]),T=Object(O.useCallback)((function(e,a){e&&e.stopPropagation(),n(t,a,v()(t,"tableMetaInfo.signalIndex",void 0)),void 0!==a?a?(x(!1),s.removeAll("x")):(D(!1),d.removeAll("x")):(x(!1),D(!1))}),[s,d,n,t]),M=Object(O.useCallback)((function(e,t){e.stopPropagation(),t.onClick("x")}),[]),A=Object(O.useMemo)((function(){return{onMouseEnter:function onMouseEnter(){s.onMouseEnter("x"),u.show()},onMouseLeave:function onMouseLeave(){s.onMouseLeave("x"),u.hide()}}}),[s,u]),E=Object(O.useMemo)((function(){return{onMouseEnter:function onMouseEnter(){d.onMouseEnter("x"),b.show()},onMouseLeave:function onMouseLeave(){d.onMouseLeave("x"),b.hide()}}}),[d,b]),P=Object(O.useMemo)((function(){return u.isActive||s.isActive?Xb:v()(t,"tableMetaInfo.isConstantlyHighlighted",!1)?Vb:null}),[s.isActive,u.isActive,t]);return Object(me.c)("tr",Object(f.a)(Object(f.a)({onContextMenu:function onContextMenu(e){return a(e,t)},css:P},u.onHover),{},{children:[Object(me.b)("td",Object(f.a)(Object(f.a)(Object(f.a)({},w),A),{},{children:t.tableMetaInfo.rowIndex+1})),isColumnVisible(o,"showFrom")&&Object(me.b)(_b,{value:t.from,rowSpanTags:w,onHoverRange:A,format:S("showFrom")}),isColumnVisible(o,"showTo")&&Object(me.b)(_b,{value:t.to,rowSpanTags:w,onHoverRange:A,format:S("toFormat")}),Object(me.b)(Bb,{rowData:t,onHoverSignal:E,preferences:o,onEditStart:function onEditStart(e){return i("signal","".concat(e))},editStatus:l[t.tableMetaInfo.signal.id]}),isColumnVisible(o,"showRelative")&&Object(me.b)(Nb,{rowData:t,rowSpanTags:w,onHoverRange:A,format:S("relativeFormat"),onEditStart:function onEditStart(){return i("relative",t.id)},editStatus:c[t.id]}),isColumnVisible(o,"showAbsolute")&&Object(me.b)(ib,{value:t.absolute,rowSpanTags:w,onHoverRange:A,format:S("absoluteFormat")}),Object(me.b)("td",Object(f.a)(Object(f.a)({},E),{},{children:v()(t,"tableMetaInfo.signal.multiplicity","")})),Object(me.b)(Ib,{rowData:t,onHoverSignal:E}),Object(me.b)(Lb,{rowData:t,assignment:d,highlight:b,onHover:E,unlinkVisibility:C,onUnlinkVisibilityChange:function onUnlinkVisibilityChange(e){return D(e)},onLink:M,onUnlink:T}),Object(me.b)(Rb,{rowData:t,assignment:s,highlight:u,onHover:A,unlinkVisibility:j,onUnlinkVisibilityChange:function onUnlinkVisibilityChange(e){return x(e)},onLink:M,onUnlink:T,rowSpanTags:w,highlightData:p}),Object(me.b)(Pb,{rowData:t,onHoverSignal:E,onHoverRange:A,rowSpanTags:w})]}))};var Zb,Ub=function useMapRanges(e){return Object(O.useMemo)((function(){var t=[];return e.forEach((function(e,n){1===e.signal.length?t.push(Object(f.a)(Object(f.a)({},e),{},{tableMetaInfo:Object(f.a)(Object(f.a)({},e.tableMetaInfo),{},{signal:e.signal[0],rowIndex:n,signalIndex:0,id:e.signal[0].id})})):e.signal.length>1&&e.signal.forEach((function(a,i){var o=!1,r=null;i<e.signal.length-1&&0===i?r=e.signal.length:o=!0,t.push(Object(f.a)(Object(f.a)({},e),{},{tableMetaInfo:Object(f.a)(Object(f.a)({},e.tableMetaInfo),{},{signal:a,rowSpan:r,hide:o,rowIndex:n,signalIndex:i,id:a.id})}))}))})),t}),[e])},Kb=Object(m.b)(Zb||(Zb=Object(g.a)(["\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  font-size: 12px;\n  height: 100%;\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  th,\n  td {\n    white-space: nowrap;\n    text-align: center;\n    margin: 0;\n    padding: 0.1rem 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n    }\n  }\n"])));var Wb=function RangesTable(e){var t=e.tableData,n=e.onChangeKind,a=e.onDelete,i=e.onUnlink,o=e.onZoom,r=e.onEdit,c=e.context,l=e.activeTab,s=e.preferences,u=l&&l.replace(/[0-9]/g,""),d=Object(O.useRef)(),b=Ub(t),p=eb("id",b),f=Object(h.a)(p,2),g=f[0],m=f[1],j=eb("id",b),x=Object(h.a)(j,2),y=x[0],k=x[1],C=useGlobal().rootRef,D=function isVisible(e){return v()(s,e,!1)},S=Object(O.useCallback)((function(e,t){checkModifierKeyActivated(e)||(e.preventDefault(),d.current.handleContextMenu(e,t))}),[d]),w=Object(O.useCallback)((function(e,t){"relative"===e?m(t):"signal"===e&&k(t)}),[m,k]);return Object(O.useEffect)((function(){var e=function handleEditStart(){w("realtive",null),w("signal",null)};return C&&C.addEventListener("mousedown",e),function(){C&&C.removeEventListener("mousedown",e)}}),[w,C]),Object(me.c)(O.Fragment,{children:[Object(me.c)("table",{css:Kb,children:[Object(me.b)("thead",{children:Object(me.c)("tr",{children:[Object(me.b)("th",{children:"#"}),D("showFrom")?Object(me.b)("th",{children:"From"}):null,D("showTo")?Object(me.b)("th",{children:"To"}):null,Object(me.b)("th",{children:"\u03b4 (ppm)"}),D("showRelative")?Object(me.c)("th",{children:["Rel. ",u]}):null,D("showAbsolute")?Object(me.b)("th",{children:"Absolute"}):null,Object(me.b)("th",{children:"Mult."}),Object(me.b)("th",{children:"J (Hz)"}),Object(me.b)("th",{children:Object(me.b)(_e.u,{style:{fontSize:10}})}),Object(me.b)("th",{children:"\u03a3"}),Object(me.b)("th",{children:"Kind"}),Object(me.b)("th",{children:""})]})}),Object(me.b)("tbody",{children:b&&b.map((function(e,t){return Object(me.b)(Yb,{rowData:b[t],onChangeKind:n,onDelete:a,onUnlink:i,onZoom:o,onEdit:r,onContextMenu:function onContextMenu(e,t){return S(e,t)},preferences:s,onColumnEditStart:w,editFlags:{relativeFlags:g,signalFlags:y}},"rangesTableRow".concat(t))}))})]}),Object(me.b)(bu,{ref:d,context:c})]})},Gb={toolbar:{display:"flex",flexDirection:"row",borderBottom:"0.55px solid rgb(240, 240, 240)"},container:{flexDirection:"column",height:"100%",display:"flex"},sumButton:{borderRadius:"5px",marginTop:"3px",color:"white",backgroundColor:"#6d6d6d",border:"none",height:"16px",width:"18px",fontSize:"12px",padding:0},removeAssignmentsButton:{borderRadius:"5px",marginTop:"3px",marginLeft:"2px",border:"none",height:"16px",width:"18px",fontSize:"12px",padding:0},setShowMultiplicityTreesButton:{borderRadius:"5px",marginTop:"3px",marginLeft:"5px",color:"black",backgroundColor:"transparent",border:"none",height:"16px",width:"18px",fontSize:"12px",padding:0},button:{backgroundColor:"transparent",border:"none"}};function RangesTablePanel(e){var t=e.ranges,n=e.x,a=e.y,i=e.info,o=e.xDomain,r=e.preferences,c=e.activeTab,l=e.molecules,s=e.nucleus,u=Object(O.useState)(!1),d=Object(h.a)(u,2),b=d[0],p=d[1],g=useAssignmentData(),m=useDispatch(),j=dc(),x=Object(O.useState)(!1),y=Object(h.a)(x,2),k=y[0],C=y[1],D=Object(O.useRef)(),S=Object(O.useMemo)((function(){var e=function isInView(e,t){var n=1e4;return e*=n,(t*=n)>=o[0]*n&&e<=o[1]*n||e<=o[0]*n&&t>=o[1]*n};return t.values?(b?function getFilteredRanges(t){return t.filter((function(t){return e(t.from,t.to)}))}(t.values):t.values).map((function(t){return Object(f.a)(Object(f.a)({},t),{},{tableMetaInfo:{isConstantlyHighlighted:e(t.from,t.to)}})})):[]}),[b,t.values,o]),w=Object(O.useCallback)((function(e,t,n){m({type:ln,payload:{rangeData:e,assignmentData:g,isOnRangeLevel:t,signalIndex:n}})}),[g,m]),T=Object(O.useCallback)((function(e){if(n&&a){var t=e.from,i=e.to,o=Object(Ln.g)(n,{from:t,to:i}),r=o.fromIndex,c=o.toIndex,l=Object(f.a)({x:n.slice(r,c),y:a.slice(r,c)},e);Object(fc.c)(JSON.stringify(l,void 0,2))?j.show("Data copied to clipboard"):j.error("copy to clipboard failed")}}),[n,a,j]),M=Object(O.useMemo)((function(){return v()(r,"formatting.panels.ranges.[".concat(c,"]"))||di}),[c,r]),E=Object(O.useMemo)((function(){return[{label:"Copy to clipboard",onClick:T}]}),[T]),P=Object(O.useCallback)((function(){p(!b)}),[b]),I=Object(O.useCallback)((function(){C(!k)}),[k]),F=Object(O.useCallback)((function(){D.current.saveSetting(),C(!1)}),[]);return Object(A.jsx)(A.Fragment,{children:Object(A.jsxs)("div",{style:Gb.container,children:[!k&&Object(A.jsx)(qd,{ranges:t,info:i,activeTab:c,molecules:l,onUnlink:w,onFilterActivated:P,onSettingClick:I,isFilterActive:b,filterCounter:S.length}),k&&Object(A.jsx)(cu,{onSave:F,onClose:I}),Object(A.jsx)("div",{style:{height:"100%",overflow:"auto"},children:Object(A.jsxs)(xs.a,{isFlipped:k,infinite:!0,containerStyle:{overflow:"hidden"},children:[Object(A.jsx)("div",{children:S&&S.length>0?Object(A.jsx)(Wb,{activeTab:c,tableData:S,onUnlink:w,context:E,preferences:M}):Object(A.jsx)(gu,{})}),Object(A.jsx)($d,{ranges:t,ref:D,nucleus:s,preferences:r})]})})]})})}var qb=Ki(Object(O.memo)(RangesTablePanel));var Jb=function SpectraWraper(e){var t=function Wrapper(t){var n=useChartData(),a=n.data,i=n.activeSpectrum,o=n.activeTab,r=n.displayerMode,c=t.forwardedRef,l=Object(le.a)(t,["forwardedRef"]);return Object(A.jsx)(e,Object(f.a)(Object(f.a)({},l),{},{data:a,activeSpectrum:i,activeTab:o,displayerMode:r,ref:c}))};return Object(O.forwardRef)((function(e,n){return Object(A.jsx)(t,Object(f.a)(Object(f.a)({},e),{},{forwardedRef:n}))}))};function SpectraPanelHeader(e){var t=e.data,n=e.activeSpectrum,a=e.activeTab,i=e.displayerMode,o=e.spectrums,r=$(),c=dc(),l=useDispatch(),s=Object(O.useCallback)((function(){r.showConfirmDialog("All records will be deleted, Are You sure?",{onYes:function onYes(){l({type:mt})}})}),[l,r]),u=Object(O.useCallback)((function(){var e=o.map((function(e){return e.id}));l({type:nt,id:e})}),[l,o]),d=Object(O.useCallback)((function(){l({type:nt,id:[]})}),[l]),b=Object(O.useCallback)((function(){var e=function getMissingProjection(e){var t=a.split(",");t=t[0]===t[1]?[t[0]]:t;var n,i=[],o=Object(Pe.a)(t);try{var r=function _loop(){var t=n.value;e.some((function(e){return e.info.nucleus===t}))||i.push(t)};for(o.s();!(n=o.n()).done;)r()}catch(c){o.e(c)}finally{o.f()}return i}(t);e.length>0?l({type:en,nucleus:e}):c.error("Nothing to calculate")}),[a,c,t,l]),p=Object(O.useCallback)((function(){l({type:yn})}),[l]),f=Object(O.useCallback)((function(){l({type:kn})}),[l]);return Object(A.jsxs)(nu,{onDelete:s,counter:o&&o.length,deleteToolTip:"Delete all spectra",children:[Object(A.jsx)(Zn,{title:"Hide all spectra",popupPlacement:"right",children:Object(A.jsx)("button",{type:"button",onClick:d,children:Object(A.jsx)(_e.m,{})})}),Object(A.jsx)(Zn,{title:"Show all spectra",popupPlacement:"right",children:Object(A.jsx)("button",{type:"button",onClick:u,children:Object(A.jsx)(_e.l,{})})}),n&&a&&a.split(",").length>1&&Object(A.jsx)(Zn,{title:"Add missing projection",popupPlacement:"right",children:Object(A.jsx)("button",{type:"button",onClick:b,children:Object(A.jsx)(_e.f,{})})}),i===er.DM_1D&&Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(Zn,{title:"Reset Scale",popupPlacement:"right",children:Object(A.jsx)("button",{type:"button",onClick:f,children:Object(A.jsx)(vs.r,{})})}),Object(A.jsx)(Zn,{title:"Same Top",popupPlacement:"right",children:Object(A.jsx)("button",{type:"button",onClick:p,children:Object(A.jsx)(vs.s,{})})})]})]})}var $b=Jb(Object(O.memo)(SpectraPanelHeader));function getNucleusSum(e){var t=e.split(",");return t.reduce((function(e,n){var a=2===t.length?100:0;return e+=Number(n.replace(/\D/g,""))+a}),0)}var Qb=function GroupByInfoKey(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t.reduce((function(t,n){var a=n.info[e];return t[a]=(t[a]||[]).concat(n),t}),{});return n?Object.keys(a).sort((function(e,t){return getNucleusSum(e)-getNucleusSum(t)})).reduce((function(e,t){return e[t]=a[t],e}),{}):a}};function ColorIndicator1D(e){var t=e.color,n=e.activated;return Object(A.jsx)("div",{style:{backgroundColor:t,height:"12px",width:"12px",opacity:n?1:.1,display:"inline-block"}})}function ColorIndicator2D(e){var t=e.positiveColor,n=e.negativeColor,a=e.activated;return Object(A.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",opacity:a?1:.1,children:Object(A.jsxs)("g",{children:[Object(A.jsx)("path",{d:"M0,0H12L0,12Z",fill:t,strokeWidth:"0"}),Object(A.jsx)("path",{d:"M12,12H0L12,0Z",fill:n,strokeWidth:"0"})]})})}function ColorIndicator(e){var t=e.dimension,n=e.color,a=e.activated,i=e.onClick,o=e.style;return Object(A.jsx)("button",{style:o,type:"button",onClick:i,children:2===t?Object(A.jsx)(ColorIndicator2D,Object(f.a)(Object(f.a)({},n),{},{activated:a})):Object(A.jsx)(ColorIndicator1D,Object(f.a)({activated:a},n))})}var ep=Object(O.memo)(ColorIndicator);var tp=function ShowHideMarkersButton(e){var t=e.data,n=e.onChangeMarkersVisibility,a=e.markersVisible,i=e.style;return Object(A.jsx)("button",{style:Object(f.a)(Object(f.a)({},i),{},{opacity:function isMarkerVisible(e){return-1!==a.findIndex((function(t){return t.id===e}))}(t.id)&&t.peaks&&t.peaks.values.length>0?1:.1}),type:"button",onClick:function onClick(){return n(t)},disabled:t.peaks&&0===t.peaks.values.length,children:Object(A.jsx)(vs.n,{})})};var np=function ShowHideSpectrumButton(e){var t=e.data,n=e.onChangeVisibility,a=e.style,i=function isVisible(e,n){return!t||t.display[n]};return Object(A.jsxs)(A.Fragment,{children:[1===t.info.dimension&&Object(A.jsx)("button",{style:a,type:"button",onClick:function onClick(){return n(t,"isVisible")},children:Object(A.jsx)(_e.l,{style:Object(f.a)({fill:t.display.color},i(t.id,"isVisible")?{opacity:1,strokeWidth:"1px",fill:t.display.color}:{opacity:.1,fill:t.display.color})})}),2===t.info.dimension&&Object(A.jsxs)("div",{style:{minWidth:"40px"},children:[Object(A.jsx)("button",{style:Object(f.a)(Object(f.a)({},a),{},{width:"20px",minWidth:"20px"}),type:"button",onClick:function onClick(){return n(t,"isPositiveVisible")},children:Object(A.jsx)(_e.l,{style:Object(f.a)({fill:t.display.positiveColor},i(t.id,"isPositiveVisible")?{opacity:1,strokeWidth:"1px",fill:t.display.positiveColor}:{opacity:.1,fill:t.display.positiveColor})})}),Object(A.jsx)("button",{style:Object(f.a)(Object(f.a)({},a),{},{width:"20px",minWidth:"20px"}),type:"button",onClick:function onClick(){return n(t,"isNegativeVisible")},children:Object(A.jsx)(_e.l,{style:Object(f.a)({fill:t.display.negativeColor},i(t.id,"isNegativeVisible")?{opacity:1,strokeWidth:"1px",fill:t.display.negativeColor}:{opacity:.1,fill:t.display.negativeColor})})})]})]})},ap={button:{backgroundColor:"transparent",border:"none",width:"26px",minWidth:"26px"},row:{display:"flex",alignContent:"center",height:"25px",borderBottom:"0.55px solid #f1f1f1"},name:{flex:1,height:"100%",display:"flex"},info:{flex:"1 1 1px",height:"100%",display:"block",alignItems:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",lineHeight:"24px"},icon:{display:"flex",margin:"auto",justifyContent:"center"}};function SpectrumListItem(e){var t=e.activeSpectrum,n=e.markersVisible,a=e.data,i=e.onChangeVisibility,o=e.onChangeMarkersVisibility,r=e.onChangeActiveSpectrum,c=e.onOpenSettingModal,l=e.onContextMenu,s=t&&t.id===a.id,u=a.display,d=u.color,b=u.name,p=u.positiveColor,h=u.negativeColor;return Object(A.jsxs)("div",{style:Object(f.a)(Object(f.a)({},ap.row),s?{backgroundColor:"#fafafa"}:{opacity:t?.2:1}),onContextMenu:l,children:[Object(A.jsx)(np,{data:a,onChangeVisibility:i,style:ap.button}),Object(A.jsxs)("div",{style:ap.name,onClick:function onClick(){return r(a)},children:[Object(A.jsx)("div",{style:Object(f.a)(Object(f.a)({},ap.icon),{},{width:"16px"}),children:a.info.isFid?Object(A.jsx)(vs.e,{}):2===a.info.dimension?Object(A.jsx)(vs.a,{}):Object(A.jsx)(vs.g,{})}),Object(A.jsx)("span",{style:ap.info,children:b}),Object(A.jsx)("div",{style:ap.info,dangerouslySetInnerHTML:{__html:a.info&&function formatValueAsHTML(e){return e&&(e=e.replace(/([0-9]+)/g,"<sub>$1</sub>")),e}(a.info.solvent)}}),Object(A.jsxs)("span",{style:ap.info,children:[Object(A.jsx)("span",{style:{borderLeft:"0.55px solid #e5e5e5",paddingRight:"5px"}}),a.info&&a.info.experiment]}),Object(A.jsx)("span",{style:ap.info,children:a.info&&a.info.pulse})]}),Object(A.jsx)(tp,{data:a,style:Object(f.a)(Object(f.a)({},ap.icon),ap.button),onChangeMarkersVisibility:o,markersVisible:n}),Object(A.jsx)(ep,{style:ap.button,dimension:a.info.dimension,color:{positiveColor:p,color:d,negativeColor:h},activated:s,onClick:function onClick(e){return c(a,e)}})]})}SpectrumListItem.defaultProps={onContextMenu:function onContextMenu(){return null}};var ip=Object(O.memo)(SpectrumListItem);function FormikColorPicker(e){var t=e.onColorChange,n=e.name,a=Object(le.a)(e,["onColorChange","name"]),i=Object(zc.f)(),o=i.values,r=i.setFieldValue,c=Object(O.useCallback)((function(e){t(e),r(n,"".concat(e.hex).concat(Math.round(255*e.rgb.a).toString(16)))}),[n,t,r]);return Object(A.jsx)(Ou.SketchPicker,Object(f.a)({color:{hex:v()(o,n,"#000")},presetColors:Br,onChangeComplete:function onChangeComplete(e){return c(e)}},a))}FormikColorPicker.defaultProps={onColorChange:function onColorChange(){return null}};var op=Object(O.memo)(FormikColorPicker);var rp=function Spectrum1DSetting(e){var t=e.data,n=e.onSubmit,a=Object(O.useRef)(),i=Object(O.useCallback)((function(){a.current&&a.current.submitForm()}),[]);return Object(A.jsx)(Bc,{ref:a,initialValues:t,onSubmit:n,children:Object(A.jsx)("div",{children:Object(A.jsx)(op,{name:"color",onColorChange:i})})})},cp=n(709);function FormikSlider(e){var t=e.onAfterChange,n=e.name,a=Object(le.a)(e,["onAfterChange","name"]),i=Object(zc.f)(),o=i.values,r=i.setFieldValue,c=Object(O.useCallback)((function(e){t(e),r(n,e)}),[n,t,r]);return Object(A.jsx)(cp.a,Object(f.a)({className:"horizontal-slider",thumbClassName:"thumb",trackClassName:"track",defaultValue:v()(o,n,[0,100]),onAfterChange:c,renderThumb:function renderThumb(e,t){return Object(A.jsx)("div",Object(f.a)(Object(f.a)({},e),{},{children:Object(A.jsx)("span",{children:t.valueNow})}))},pearling:!0,minDistance:10},a))}FormikSlider.defaultProps={onColorChange:function onColorChange(){return null}};var lp,sp=Object(O.memo)(FormikSlider);var up,dp=function Spectrum2DSetting(e){var t=e.data,n=e.onSubmit,a=Object(O.useRef)(),i=Object(m.b)(lp||(lp=Object(g.a)(["\n    .positive {\n      display: inline-block;\n      .track-1 {\n        background-color: "," !important;\n      }\n    }\n    .negative {\n      display: inline-block;\n\n      .track-1 {\n        background-color: "," !important;\n      }\n    }\n  "])),t.positiveColor,t.negativeColor),o=Object(O.useCallback)((function(){a.current.submitForm()}),[]);return Object(me.b)(Bc,{ref:a,initialValues:t,onSubmit:n,children:Object(me.c)("div",{css:i,children:[Object(me.c)("div",{className:"positive",children:[Object(me.b)("span",{style:{padding:"0 10px"},children:"Positive"}),Object(me.b)(op,{name:"positiveColor",onColorChange:o}),Object(me.c)("div",{style:{padding:"5px"},children:[Object(me.b)("span",{className:"label",children:"contour Levels [ min - max ]"}),Object(me.b)(sp,{name:"contourOptions.positive.contourLevels",onAfterChange:o}),Object(me.b)("span",{className:"label",children:"number of Layers "}),Object(me.b)(cl,{name:"contourOptions.positive.numberOfLayers",onChange:o,type:"number"})]})]}),Object(me.c)("div",{className:"negative",children:[Object(me.b)("span",{style:{padding:"0 10px"},children:"Negative"}),Object(me.b)(op,{name:"negativeColor",onColorChange:o}),Object(me.c)("div",{style:{padding:"5px"},children:[Object(me.b)("span",{className:"label",children:"contour Levels [ min - max ]"}),Object(me.b)(sp,{name:"contourOptions.negative.contourLevels",onAfterChange:o}),Object(me.b)("span",{className:"label",children:"number of Layers "}),Object(me.b)(cl,{name:"contourOptions.negative.numberOfLayers",onChange:o,type:"number"})]})]})]})})},bp=Object(m.b)(up||(up=Object(g.a)(["\n  position: fixed;\n  z-index: 999999999;\n  width:100%;\n  height:100%;\n  left:0;\n  top:0;\n  .ineer-conatiner{\n    position:absolute;\n    display: flex;\n    flex-direction: row-reverse;\n    border-radius: 4px;\n    background-color: white;\n    box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 0px 1px,\n      rgba(0, 0, 0, 0.15) 0px 8px 16px;\n      overflow: auto;\n      height: 350px;\n  }\n\n\n  .sketch-picker {\n    border-radius: none !important;\n    box-shadow: none !important;\n  }\n\n\n  .horizontal-slider {\n    width: 80%;\n    height: 15px;\n  }\n\n  .thumb {\n    height: 15px;\n    line-height: 15px;\n    width: 20px;\n    text-align: center;\n    color: black;\n    border-radius: 5px;\n    cursor: grab;\n    font-size: 10px;\n    background-image: -webkit-linear-gradient(top, #f4f1ee, #fff);\n    background-image: linear-gradient(top, #f4f1ee, #fff);\n  }\n\n  .track {\n    top: 0;\n    bottom: 0;\n    background: #eaeaea;\n    border-radius: 999px;\n    border-radius: 5px;\n  }\n\n  .track-1 {\n    background: red;\n  }\n   \n  .label{\n    font-size: 12px;\n    margin: 8px 0;\n    display: block;\n  }\n \n  }\n"])));function SpectrumSetting(e){var t=e.position,n=e.data,a=n.id,i=n.info,o=n.display,r=e.onClose,c=useDispatch(),l=Object(O.useCallback)((function(e){c({type:et,id:a,display:e})}),[c,a]),s=Object(O.useCallback)((function(e){e.target===e.currentTarget&&r()}),[r]),u=t.x,d=t.y;return Object(me.b)("div",{css:bp,onClick:s,children:Object(me.b)("div",{className:"ineer-conatiner",style:{left:2===i.dimension?u-450:u-220,padding:2===i.dimension?"10px 0":"",top:d},children:2===i.dimension?Object(me.b)(dp,{onSubmit:l,data:o}):Object(me.b)(rp,{onSubmit:l,data:o})})})}function arePropsEqual(){return!0}var pp=Object(O.memo)(SpectrumSetting,arePropsEqual);var fp=Jb((function SpectrumsTabs(e){var t=e.data,n=e.activeSpectrum,a=e.activeTab,i=e.onTabChange,o=Object(O.useRef)(),r=Object(O.useState)([]),c=Object(h.a)(r,2),l=c[0],s=c[1],u=Object(O.useState)(null),d=Object(h.a)(u,2),b=d[0],p=d[1],f=Object(O.useState)(null),g=Object(h.a)(f,2),m=g[0],j=g[1],v=Object(O.useState)(!1),x=Object(h.a)(v,2),y=x[0],k=x[1],C=dc(),D=useDispatch();Object(O.useEffect)((function(){if(t){var e=t?t.filter((function(e){return!0===e.display.isPeaksMarkersVisible})):[];s(e)}}),[t,D]);var S=Object(O.useMemo)((function(){return t?Qb("nucleus")(t,!0):[]}),[t]);Object(O.useEffect)((function(){i({tab:a,data:S[a]})}),[a,i,S]);var w=Object(O.useCallback)((function(e){var t=l.findIndex((function(t){return t.id===e.id})),n=Object(Ee.a)(l);-1===t?n.push({id:e.id}):n.splice(t,1),D({type:at,data:n}),s(n)}),[D,l]),T=Object(O.useCallback)((function(e){i({tab:e.tabid,data:S[e.tabid]}),D({type:Bt,tab:e.tabid})}),[D,i,S]),M=Object(O.useMemo)((function(){return[{label:"Copy to Clipboard",onClick:function onClick(e){var t=e.x,n=e.y,a=e.info;Object(fc.c)(JSON.stringify({x:t,y:n,info:a},void 0,2))?C.success("Data copied to clipboard"):C.error("Copy to clipboard failed")}},{label:"Delete",onClick:function onClick(e){setTimeout((function(){D({type:mt,id:e.id})}),0)}}]}),[C,D]),E=Object(O.useCallback)((function(e,t){checkModifierKeyActivated(e)||(e.preventDefault(),o.current.handleContextMenu(e,t))}),[o]),P=Object(O.useCallback)((function(e,t){j({x:t.nativeEvent.clientX,y:t.nativeEvent.clientY}),p(e),k(!0)}),[]),I=Object(O.useCallback)((function(e,t){D({type:nt,id:e.id,key:t,value:!e.display[t]})}),[D]),F=Object(O.useCallback)((function(e){setTimeout((function(){n&&n.id===e.id?D({type:it,data:null}):D({type:it,data:{id:e.id}})}),0)}),[n,D]),R=Object(O.useCallback)((function(){k(!1)}),[]);return Object(A.jsxs)(O.Fragment,{children:[Object(A.jsx)(Lc,{defaultTabID:a,onClick:T,children:S&&Object.keys(S).map((function(e){return Object(A.jsx)("div",{tablabel:e,tabid:e,style:{overflow:"auto",height:"100%"},children:S[e]&&S[e].map((function(e){return Object(A.jsx)(ip,{activeSpectrum:n,markersVisible:l,data:e,onChangeVisibility:I,onChangeMarkersVisibility:w,onChangeActiveSpectrum:F,onOpenSettingModal:P,onContextMenu:function onContextMenu(t){return E(t,e)}},e.id)}))},e)}))}),Object(A.jsx)(bu,{ref:o,context:M}),y?Object(A.jsx)(pp,{onClose:R,data:b,position:m}):null]})})),hp={overflow:"hidden",height:"100%",display:"flex",flexDirection:"column"};function SpectrumListPanel(e){var t=e.data,n=e.activeSpectrum,a=e.activeTab,i=Object(O.useState)([]),o=Object(h.a)(i,2),r=o[0],c=o[1],l=Object(O.useCallback)((function(e){c(e.data?e.data:[])}),[]);return Object(A.jsxs)("div",{style:hp,children:[Object(A.jsx)($b,{spectrums:r}),Object(A.jsx)(fp,{onTabChange:l,data:t,activeSpectrum:n,activeTab:a})]})}var gp=Object(O.memo)(SpectrumListPanel),mp=[{key:"outOfLimit",color:"red"},{key:"ambiguousAttachment",color:"orange"},{key:"notAttached",color:"blue"},{key:"incomplete",color:"red"}],jp=mp.map((function(e){return e.key})),vp=[{key:"-",label:"",value:""},{key:"sp",label:"sp",value:"SP"},{key:"sp2",label:"sp2",value:"SP2"},{key:"sp3",label:"sp3",value:"SP3"}],Op={C:.25,H:.02,N:.25,F:.25,Si:.25,P:.25};function getLabelColor(e,t){var n=v()(e,"state.".concat(t.atomType,".error"),null);if(n)for(var a in jp)if("incomplete"!==mp[a].key&&("notAttached"===mp[a].key||"ambiguousAttachment"===mp[a].key)&&v()(n,"".concat(mp[a].key),[]).some((function(n){return e.values[n].id===t.id})))return mp[a].color;return null}function findSpectrum(e,t){return e.filter((function(e){return e.id===t.experimentID&&!0===e.display.isVisible}))[0]}function findSignal(e,t){for(var n=0;n<e.zones.values.length;n++){var a=e.zones.values[n].signal.findIndex((function(e){return e.id===t.signal.id}));if(a>=0)return e.zones.values[n].signal[a]}}var xp=function findRangeOrZoneID(e,t){var n=findSpectrum(e,t);if(n)if(1===n.info.dimension){var a=function findRange(e,t){for(var n=0;n<e.ranges.values.length;n++)if(e.ranges.values[n].signal.findIndex((function(e){return e.id===t.signal.id}))>=0)return e.ranges.values[n]}(n,t);if(a)return a.id}else if(2===n.info.dimension){var i=function findZone(e,t){for(var n=0;n<e.zones.values.length;n++)if(e.zones.values[n].signal.findIndex((function(e){return e.id===t.signal.id}))>=0)return e.zones.values[n]}(n,t);if(i)return i.id}};function findSignalMatch2D(e,t,n,a,i,o,r){if(e&&2===e.info.dimension){var c=findSignal(e,t);if(c)return c.x.delta*n>=a&&c.x.delta*n<=i&&c.y.delta*n>=o&&c.y.delta*n<=r}return!1}var yp=function AdditionalColumnHeader(e){var t=e.spectraData,n=e.correlationsData,a=e.correlation,i=Object(O.useMemo)((function(){if(!0===a.pseudo)return[];var e=[a.signal.id,Or(a.signal.id,"Crosshair_X")],n=xp(t,a);return n&&e.push(n),a.link.forEach((function(n){if(!1===n.pseudo){e.push(n.signal.id),e.push(Or(n.signal.id,"Crosshair_X"));var a=xp(t,n);a&&e.push(a)}})),e}),[a,t]),o=Object(pi.c)(i),r=Object(O.useCallback)((function(e){e.currentTarget.focus(),o.show()}),[o]),c=Object(O.useCallback)((function(e){e.currentTarget.blur(),o.hide()}),[o]),l=Object(O.useMemo)((function(){return{style:Object(f.a)(Object(f.a)({},{color:getLabelColor(n,a)}),{},{backgroundColor:o.isActive?"#ff6f0057":"inherit"}),title:!1===a.pseudo&&[a.experimentType.toUpperCase()].concat(a.link.reduce((function(e,t){return!1!==t.pseudo||t.experimentType===a.experimentType||e.includes(t.experimentType.toUpperCase())||e.push(t.experimentType.toUpperCase()),e}),[])).sort().join("/"),onMouseEnter:r,onMouseLeave:c}}),[a,n,o.isActive,r,c]),s=Object(O.useMemo)((function(){return a.edited.equivalence?{backgroundColor:"#F7F2E0"}:{color:Number.isInteger(a.equivalence)?1===a.equivalence?"#bebebe":"black":"red"}}),[a]);return Object(me.b)("th",Object(f.a)(Object(f.a)({},l),{},{children:Object(me.c)("div",{style:{display:"block"},children:[Object(me.b)("p",{children:a.label.origin}),Object(me.b)("p",{children:a&&a.signal&&a.signal.delta?a.signal.delta.toFixed(2):""}),Object(me.b)("p",{style:s,children:Number.isInteger(a.equivalence)?a.equivalence:a.equivalence.toFixed(2)})]})}))},kp=n(215),Cp=n(214),Dp=n.n(Cp);var Sp=function AdditionalColumnField(e){var t=e.rowCorrelation,n=e.columnCorrelation,a=e.commonLinks,i=e.correlations,o=e.spectraData,r=e.onEdit,c=Object(O.useRef)(),l=Object(O.useState)(!1),s=Object(h.a)(l,2),u=s[0],d=s[1],b=Object(O.useMemo)((function(){var e=[];return a.forEach((function(t){if(!1===t.pseudo){e.push(t.signal.id),e.push(Or(t.signal.id,"Crosshair"));var n=xp(o,t);n&&e.push(n)}})),e}),[a,o]),p=Object(pi.c)(b),g=Object(O.useCallback)((function(e){e.currentTarget.focus(),p.show()}),[p]),m=Object(O.useCallback)((function(e){e.currentTarget.blur(),p.hide()}),[p]);Object(O.useEffect)((function(){a.some((function(e){return!0===e.pseudo}))?d(!0):d(!1)}),[a]);var j=Object(O.useCallback)((function(e,t){e.preventDefault(),c.current.handleContextMenu(e,t)}),[c]),v=Object(O.useCallback)((function(e,a,o){var c=Dp()(t),l=Dp()(n),s=c.link.filter((function(e){return"hsqc"===e.experimentType||"hmqc"===e.experimentType})).length;if("add"===a){var u=generateID(),d=generateID(),b=kp.LinkUtilities.buildLink({experimentType:e,experimentID:d,atomType:[l.atomType,c.atomType],id:u,pseudo:!0,signal:{id:generateID(),sign:0}});kp.CorrelationUtilities.addLink(l,kp.LinkUtilities.buildLink(Object(f.a)(Object(f.a)({},b),{},{axis:"x",match:[kp.GeneralUtilities.getCorrelationIndex(i,c)]}))),kp.CorrelationUtilities.addLink(c,kp.LinkUtilities.buildLink(Object(f.a)(Object(f.a)({},b),{},{axis:"y",match:[kp.GeneralUtilities.getCorrelationIndex(i,l)]}))),c.edited.protonsCount||(c.protonsCount=[s+1])}else"remove"===a&&(kp.CorrelationUtilities.removeLink(c,o.id),kp.CorrelationUtilities.removeLink(l,o.id),c.edited.protonsCount||(c.protonsCount=s-1>0?[s-1]:[]));r(c,l)}),[t,r,n,i]),x=Object(O.useMemo)((function(){var e=a.find((function(e){return"hsqc"===e.experimentType&&!0===e.pseudo}));return!0===t.pseudo?e?[{label:"remove HSQC",onClick:function onClick(){v("hsqc","remove",e)}}]:[{label:"add HSQC",onClick:function onClick(){v("hsqc","add")}}]:[]}),[a,v,t]),y=Object(O.useMemo)((function(){var e=new Set;return a.forEach((function(t){"hsqc"===t.experimentType||"hmqc"===t.experimentType?e.add(t.signal&&0!==t.signal.sign?"S".concat(1===t.signal.sign?"+":"-"):"S"):"hmbc"===t.experimentType||"cosy"===t.experimentType||"tocsy"===t.experimentType?e.add("M"):"noesy"!==t.experimentType&&"roesy"!==t.experimentType||e.add("NOE")})),Object(Ee.a)(e)}),[a]),k=Object(O.useMemo)((function(){return a.reduce((function(e,t){return e.includes(t.experimentType.toUpperCase())||e.push(t.experimentType.toUpperCase()),e}),[]).sort().join("/")}),[a]);return Object(A.jsxs)("td",{onContextMenu:function onContextMenu(e){x.length>0&&j(e,t)},style:{backgroundColor:p.isActive?"#ff6f0057":u?"#F7F2E0":"inherit"},title:k,onMouseEnter:g,onMouseLeave:m,children:[y.join("/"),Object(A.jsx)(bu,{ref:c,context:x})]})},wp={marginLeft:2,marginRight:2,border:"none",height:"20px"};var Tp,Mp=function CorrelationTableRow(e){var t=e.additionalColumnData,n=e.correlations,a=e.correlation,i=e.styleRow,o=e.styleLabel,r=e.onSaveEditEquivalences,c=e.onChangeHybridization,l=e.onSaveEditProtonsCount,s=e.onEditAdditionalColumnField,u=e.spectraData,d=Object(O.useMemo)((function(){if(!0===a.pseudo)return[];var e=[a.signal.id,Or(a.signal.id,"Crosshair_Y")],t=xp(u,a);return t&&e.push(t),a.link.forEach((function(t){if(!1===t.pseudo){e.push(t.signal.id),e.push(Or(t.signal.id,"Crosshair_Y"));var n=xp(u,t);n&&e.push(n)}})),e}),[a,u]),b=Object(pi.c)(d),p=Object(O.useCallback)((function(e){r(a,e.target.value)}),[a,r]),h=Object(O.useCallback)((function(e){l(a,e.target.value)}),[a,l]),g=Object(O.useMemo)((function(){return t.map((function(e){var t=[];return a.link.forEach((function(n){e.link.forEach((function(e){if(n.axis!==e.axis&&n.experimentID===e.experimentID&&n.signal.id===e.signal.id){var a=n.experimentType;n.signal&&0!==n.signal.sign&&(a+=" (edited)"),t.push(kp.LinkUtilities.buildLink(Object(f.a)(Object(f.a)({},n),{},{experimentLabel:a,axis:void 0})))}}))})),Object(A.jsx)(Sp,{rowCorrelation:a,columnCorrelation:e,commonLinks:t,correlations:n,spectraData:u,onEdit:s},"addColData_".concat(a.id,"_").concat(e.id))}))}),[t,a,n,s,u]),m=Object(O.useCallback)((function(e){c(a,e)}),[a,c]),j=Object(O.useMemo)((function(){return a.edited.equivalence?{backgroundColor:"#F7F2E0"}:{color:1===a.equivalence?"#bebebe":"black"}}),[a]),x=Object(O.useCallback)((function(e){e.currentTarget.focus(),b.show()}),[b]),y=Object(O.useCallback)((function(e){e.currentTarget.blur(),b.hide()}),[b]),k=Object(O.useMemo)((function(){return{style:Object(f.a)(Object(f.a)({},i),{},{backgroundColor:b.isActive?"#ff6f0057":"inherit"}),title:!1===a.pseudo&&[a.experimentType.toUpperCase()].concat(a.link.reduce((function(e,t){return!1!==t.pseudo||t.experimentType===a.experimentType||e.includes(t.experimentType.toUpperCase())||e.push(t.experimentType.toUpperCase()),e}),[])).sort().join("/"),onMouseEnter:x,onMouseLeave:y}}),[a.experimentType,a.link,a.pseudo,b.isActive,x,y,i]);return Object(A.jsxs)("tr",{style:i,children:[Object(A.jsx)("td",Object(f.a)(Object(f.a)({},Object(f.a)(Object(f.a)({},k),{},{style:Object(f.a)(Object(f.a)({},k.style),{},{styleLabel:o})})),{},{children:kp.GeneralUtilities.getLabel(n,a)})),Object(A.jsx)("td",Object(f.a)(Object(f.a)({},k),{},{children:v()(a.signal,"delta",!1)?a.signal.delta.toFixed(2):""})),Object(A.jsx)("td",Object(f.a)(Object(f.a)({},k),{},{children:!1===a.pseudo?"H"!==a.atomType?Object(A.jsx)(uu,{type:"number",value:a.equivalence,style:j,onSave:p}):Object(A.jsx)("text",{style:j,children:a.equivalence}):""})),Object(A.jsx)("td",Object(f.a)(Object(f.a)({},k),{},{children:"H"!==a.atomType?Object(A.jsx)(uu,{type:"text",value:a.protonsCount.join(","),style:a.edited.protonsCount?{backgroundColor:"#F7F2E0"}:{},onSave:h}):""})),Object(A.jsx)("td",Object(f.a)(Object(f.a)({},Object(f.a)(Object(f.a)({},k),{},{style:Object(f.a)(Object(f.a)({},k.style),{},{borderRight:"1px solid"})})),{},{children:"H"!==a.atomType?Object(A.jsx)(ob,{onChange:m,data:vp,value:a.hybridization,style:Object(f.a)(Object(f.a)({},wp),{},{backgroundColor:a.edited.hybridization?"#F7F2E0":i.backgroundColor,width:"50px"})}):""})),g]})},Ap=Object(m.b)(Tp||(Tp=Object(g.a)(["\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  font-size: 12px;\n  height: 100%;\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  th,\n  td {\n    white-space: nowrap;\n    text-align: center;\n    margin: 0;\n    padding: 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n    }\n  }\n"])));var Ep=function CorrelationTable(e){var t=e.correlationsData,n=e.filteredCorrelationsData,a=e.additionalColumnData,i=e.editEquivalencesSaveHandler,o=e.changeHybridizationSaveHandler,r=e.editProtonsCountSaveHandler,c=e.editAdditionalColumnFieldSaveHandler,l=e.showProtonsAsRows,s=e.spectraData,u=Object(O.useMemo)((function(){return n?n.values.filter((function(e){return l?"H"===e.atomType:"H"!==e.atomType})).map((function(e){return Object(me.b)(Mp,{additionalColumnData:a,correlations:t.values,correlation:e,styleRow:{backgroundColor:"mintcream"},styleLabel:"H"===e.atomType?{color:getLabelColor(t,e)}:{},onSaveEditEquivalences:i,onChangeHybridization:o,onSaveEditProtonsCount:r,onEditAdditionalColumnField:c,spectraData:s},"correlation".concat(e.atomType).concat(e.id))})):[]}),[n,l,a,t,i,o,r,c,s]),d=Object(O.useMemo)((function(){return a.map((function(e){return Object(me.b)(yp,{spectraData:s,correlationsData:t,correlation:e},"additionalCorrelationHeader_".concat(e.id))}))}),[a,t,s]);return Object(me.b)("div",{className:"table-container",children:Object(me.c)("table",{css:Ap,children:[Object(me.b)("thead",{children:Object(me.c)("tr",{children:[Object(me.b)("th",{children:"Atom"}),Object(me.b)("th",{children:"\u03b4 (ppm)"}),Object(me.b)("th",{children:"Equiv"}),Object(me.b)("th",{children:"#H"}),Object(me.b)("th",{style:{borderRight:"1px solid"},children:"Hybrid"}),d]})}),Object(me.b)("tbody",{children:u})]})})};function Overview(e){var t=e.correlationsData;if(!t)return null;var n=kp.GeneralUtilities.getAtomCounts(t.options.mf);return Object.keys(n).length>0?Object.keys(n).map((function(e,a){var i=t.state[e],o=i?i.error:void 0,r=o?jp.findIndex((function(e){return void 0!==o[e]})):"black";return Object(A.jsx)("span",{style:{color:i?!0!==i.complete||o&&0!==Object.keys(o).length?r>=0?mp[r].color:"black":"green":"black"},children:"".concat(e,": ").concat(i?i.current:"-","/").concat(n[e],"   ")},"molFormulaView_".concat(a))})):Object(A.jsx)("p",{style:{fontStyle:"italic",color:"orange"},children:"Molecular formula is not set"})}var Pp,Ip=Object(O.memo)(Overview),Fp=n(382),Rp=Object(m.b)(Pp||(Pp=Object(g.a)(["\n  text-align: center;\n\n  input {\n    height: 100%;\n    width: 200px;\n    border-radius: 5px;\n    border: 0.55px solid #c7c7c7;\n    margin: 0px 5px 0px 5px;\n    text-align: center;\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 36px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n"])));function MolecularFormulaInput(e){var t=e.onSave,n=e.previousMF,a=Object(O.useState)(""),i=Object(h.a)(a,2),o=i[0],r=i[1],c=Object(O.useState)(!0),l=Object(h.a)(c,2),s=l[0],u=l[1],d=Object(O.useState)(!1),b=Object(h.a)(d,2),p=b[0],f=b[1],g=Object(O.useCallback)((function(e){try{return new Fp.MF(e),!0}catch(t){return!1}}),[]),m=Object(O.useCallback)((function(e){f(!0),g(e.target.value)?(u(!0),r(e.target.value)):(u(!1),r(""))}),[g]),j=Object(O.useCallback)((function(){t(p?o.trim():n)}),[p,o,t,n]);return Object(me.c)("div",{css:Rp,children:[Object(me.b)("input",{type:"text",onChange:m,defaultValue:n}),Object(me.b)("button",{type:"button",onClick:j,disabled:!s,children:"Set"})]})}MolecularFormulaInput.defaultProps={onSave:function onSave(){return null}};var _p,Np=MolecularFormulaInput,Lp=Object(m.b)(_p||(_p=Object(g.a)(["\n  overflow: auto;\n  width: 400px;\n  height: 550px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n\n    button {\n      height: 36px;\n      margin: 2px;\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .info {\n    margin-top: 0;\n    margin-bottom: 10px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n\n  .optional {\n    margin-top: 20px;\n    margin-bottom: 5px;\n    padding: 0px 10px;\n\n    text-align: center;\n    font-size: 18px;\n    font-weight: bold;\n  }\n  .optional2 {\n    margin-top: 5px;\n    margin-bottom: 25px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n"])));function SetMolecularFormulaModal(e){var t=e.onClose,n=e.onSave,a=e.molecules,i=e.previousMF,o=Object(O.useState)(),r=Object(h.a)(o,2),c=r[0],l=r[1];Object(O.useEffect)((function(){a&&a.length>0&&l(0)}),[a]);var s=Object(O.useCallback)((function(e){n(e),t()}),[t,n]),u=Object(O.useCallback)((function(){n(a[c].mf),t()}),[c,a,t,n]),d=Object(O.useCallback)((function(e){l(e)}),[]);return Object(me.c)("div",{css:Lp,children:[Object(me.b)("div",{className:"header",children:Object(me.b)(Gn,{onClick:t})}),Object(me.b)("div",{children:Object(me.b)("p",{className:"info",children:"Please type in a molecular formula!"})}),Object(me.b)(Np,{onSave:s,previousMF:i}),Object(me.c)("div",{children:[Object(me.b)("p",{className:"optional",children:"OR"}),Object(me.b)("p",{className:"optional2",children:"Select a molecule as reference!"})]}),Object(me.b)(Xs,{molecules:a,onChange:d}),Object(me.b)("button",{type:"button",onClick:u,children:"Set"})]})}SetMolecularFormulaModal.defaultProps={onSave:function onSave(){return null},onClose:function onClose(){return null}};var zp,Hp=SetMolecularFormulaModal,Bp=Object(m.b)(zp||(zp=Object(g.a)(["\n  overflow: auto;\n  width: 300px;\n  height: 300px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  text-align: center;\n\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n\n    button {\n      height: 36px;\n      margin: 2px;\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .info {\n    margin-top: 0;\n    margin-bottom: 10px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n\n  input {\n    border-radius: 5px;\n    border: 0.55px solid #c7c7c7;\n    margin: 0px 5px 0px 5px;\n    text-align: center;\n  }\n"])));function SetShiftToleranceModal(e){var t=e.onClose,n=e.onSave,a=e.previousTolerance,i=Object(O.useState)(),o=Object(h.a)(i,2),r=o[0],c=o[1];Object(O.useEffect)((function(){c(a||void 0)}),[a]);var l=Object(O.useCallback)((function(){n(r),t()}),[t,n,r]),s=Object(O.useCallback)((function(e,t){return c(Object(f.a)(Object(f.a)({},r),{},Object(ie.a)({},t,Number(e.target.value))))}),[r]),u=Object(O.useMemo)((function(){return r?Object.keys(r).map((function(e){return Object(me.c)("div",{className:"input-field",children:[Object(me.c)("span",{children:[e,": "]}),Object(me.b)("input",{type:"number",onChange:function onChange(t){return s(t,e)},defaultValue:r[e]})]},"toleranceInputField_".concat(e))})):void 0}),[s,r]);return Object(me.c)("div",{css:Bp,children:[Object(me.b)("div",{className:"header",children:Object(me.b)(Gn,{onClick:t})}),Object(me.b)("div",{children:Object(me.b)("p",{className:"info",children:"Shift tolerances: "})}),u,Object(me.b)("button",{type:"button",onClick:l,children:"Set"})]})}SetShiftToleranceModal.defaultProps={onSave:function onSave(){return null},onClose:function onClose(){return null}};var Xp,Vp=SetShiftToleranceModal,Yp=Object(m.b)(Xp||(Xp=Object(g.a)(["\n  display: flex;\n  flex-direction: column;\n  text-align: center;\n  height: 100%;\n  width: 100%;\n  justify-content: center,\n  align-items: 'center',\n\n  button {\n    border-radius: 5px;\n    margin-top: 3px;\n    margin-left: 2px;\n    border: none;\n    height: 16px;\n    width: 18px;\n    font-size: 12px;\n    padding: 0;\n    background-color: transparent;\n  }\n\n  .overview-container {\n    width: 100%;\n    margin-left: 15px;\n    white-space: nowrap;\n    span {\n      margin-left: 8px;\n    }\n  }\n\n  .homoHeteroKinds-container {\n    width: 100%;\n    margin-left: 15px;\n    span {\n      margin-left: 7px;\n    }\n  }\n\n  .table-container {\n    overflow: auto;\n  }\n"])));function SummaryPanel(){var e=useChartData(),t=e.molecules,n=e.correlations,a=e.data,i=e.xDomain,o=e.yDomain,r=e.displayerMode,c=e.activeTab,l=useDispatch(),s=$(),u=Object(O.useState)([]),d=Object(h.a)(u,2),b=d[0],p=d[1],g=Object(O.useState)("-"),m=Object(h.a)(g,2),j=m[0],v=m[1],x=Object(O.useState)(!1),y=Object(h.a)(x,2),k=y[0],C=y[1],D=Object(O.useState)(!1),S=Object(h.a)(D,2),w=S[0],T=S[1],M=Object(O.useMemo)((function(){var e=function isInView(e){if(!0===e.pseudo)return!1;var t=c.split(",").map((function(e){return function getAtomType(e){return e.split(/\d+/)[1]}(e)})),n=1e4,l=i[0]*n,s=i[1]*n,u=o[0]*n,d=o[1]*n;if(r===er.DM_1D){var b=e.signal.delta*n;if(findSpectrum(a,e)&&t[0]===e.atomType&&b>=l&&b<=s)return!0;if(e.link.some((function(e){return function findSignalMatch1D(e,t,n,a,i){if(e&&2===e.info.dimension){var o=findSignal(e,t);if(o){var r="x"===t.axis?"y":"x";return o[r].delta*n>=a&&o[r].delta*n<=i}}return!1}(findSpectrum(a,e),e,n,l,s)})))return!0}else if(r===er.DM_2D){if(!t.includes(e.atomType))return!1;if(findSignalMatch2D(findSpectrum(a,e),e,n,l,s,u,d))return!0;if(e.link.some((function(e){return findSignalMatch2D(findSpectrum(a,e),e,n,l,s,u,d)})))return!0}return!1};if(n){var t=w?n.values.filter((function(t){return e(t)})):n.values;return Object(f.a)(Object(f.a)({},n),{},{values:t})}}),[c,n,r,w,a,i,o]),A=Object(O.useCallback)((function(e){l({type:ht,payload:{mf:e}})}),[l]),E=Object(O.useCallback)((function(e){l({type:gt,payload:{tolerance:e}})}),[l]),P=Object(O.useCallback)((function(){s.show(Object(me.b)(Hp,{onClose:function onClose(){return s.close()},onSave:A,molecules:t,previousMF:n.options.mf}))}),[n,A,s,t]),I=Object(O.useCallback)((function(){s.show(Object(me.b)(Vp,{onClose:function onClose(){return s.close()},onSave:E,previousTolerance:n.options.tolerance}))}),[n,E,s]),F=Object(O.useMemo)((function(){var e=["-"].concat(n?n.values.map((function(e){return e.atomType})).filter((function(e,t,n){return n.indexOf(e)===t})):[]);return e.includes("H")&&e.push("H-H"),e.includes("H")?v("H"):v("-"),e.map((function(e){return{key:e,label:e,value:e}}))}),[n]);Object(O.useEffect)((function(){var e=j.split("-")[0];p(M?M.values.filter((function(t){return t.atomType===e})).reverse():[])}),[M,j]);var R=Object(O.useCallback)((function(e,t){l({type:pt,payload:{id:e.id,correlation:Object(f.a)(Object(f.a)({},e),{},{equivalence:t,edited:Object(f.a)(Object(f.a)({},e.edited),{},{equivalence:!0})})}})}),[l]),_=Object(O.useCallback)((function(e,t){var n;t.match(/^([0-9],{0,1})+$/g)?n=t.split(",").filter((function(e){return e.length>0})).map((function(e){return Number(e)})):0===t.trim().length&&(n=[]),n&&l({type:pt,payload:{id:e.id,correlation:Object(f.a)(Object(f.a)({},e),{},{protonsCount:n,edited:Object(f.a)(Object(f.a)({},e.edited),{},{protonsCount:!0})})}})}),[l]),N=Object(O.useCallback)((function(e,t){l({type:pt,payload:{id:e.id,correlation:Object(f.a)(Object(f.a)({},e),{},{hybridization:t,edited:Object(f.a)(Object(f.a)({},e.edited),{},{hybridization:!0})})}})}),[l]),L=Object(O.useCallback)((function(e,t){l({type:ft,payload:{ids:[e.id,t.id],correlations:[Object(f.a)(Object(f.a)({},e),{},{edited:Object(f.a)(Object(f.a)({},e.edited),{},{additionalColumnField:!0})}),Object(f.a)(Object(f.a)({},t),{},{edited:Object(f.a)(Object(f.a)({},t.edited),{},{additionalColumnField:!0})})]}})}),[l]),z=Object(O.useCallback)((function(){T(!w)}),[w]);return Object(me.c)("div",{css:Yp,children:[Object(me.c)(nu,{canDelete:!1,counter:n?n.values.length:0,onFilter:z,filterToolTip:w?"Show all correlations":"Hide correlations out of view",filterIsActive:w,counterFiltered:M&&M.values.length,children:[Object(me.b)(Zn,{title:"Set molecular formula (".concat(n.options.mf,")"),popupPlacement:"right",children:Object(me.b)("button",{type:"button",onClick:P,children:Object(me.b)(_e.t,{})})}),Object(me.b)(Zn,{title:"Set shift tolerance",popupPlacement:"right",children:Object(me.b)("button",{type:"button",onClick:I,children:Object(me.b)(_e.F,{})})}),Object(me.b)("div",{className:"overview-container",children:Object(me.b)(Ip,{correlationsData:n})}),Object(me.b)("div",{className:"homoHeteroKinds-container",children:Object(me.b)(ob,{onChange:function onChange(e){v(e),C("H-H"===e)},data:F,value:j,style:{width:"65px",height:"20px",border:"1px solid grey"}})})]}),Object(me.b)(Ep,{correlationsData:n,filteredCorrelationsData:M,additionalColumnData:b,editEquivalencesSaveHandler:R,changeHybridizationSaveHandler:N,editProtonsCountSaveHandler:_,editAdditionalColumnFieldSaveHandler:L,showProtonsAsRows:k,spectraData:a})]})}var Zp=Object(O.memo)(SummaryPanel),Up={container:{padding:10,backgroundColor:"#f1f1f1",height:"100%",flex:1},groupContainer:{padding:"5px",borderRadius:"5px",margin:"10px 0px",backgroundColor:"white"},row:{display:"flex",margin:"5px 0px"},header:{borderBottom:"1px solid #e8e8e8",paddingBottom:"5px",fontWeight:"bold",color:"#4a4a4a"},inputLabel:{flex:2,fontSize:"11px",fontWeight:"bold",color:"#232323"},input:{width:"30%",textAlign:"center"}},Kp=[{id:1,label:"From :",checkController:"showFrom",formatController:"fromFormat",defaultFormat:"0.00"},{id:2,label:"To :",checkController:"showTo",formatController:"toFormat",defaultFormat:"0.00"},{id:3,label:"Absolute :",checkController:"showAbsolute",formatController:"absoluteFormat",defaultFormat:"0.00"},{id:4,label:"Relative :",checkController:"showRelative",formatController:"relativeFormat",defaultFormat:"00.00"}];function ZonesPreferences(e,t){var n=e.nucleus,a=dc(),i=useStateWithLocalStorage("nmr-general-settings"),o=Object(h.a)(i,2)[1],r=usePreferences(),c=Object(O.useState)(null),l=Object(h.a)(c,2),s=l[0],u=l[1],d=Object(O.useRef)();Object(O.useEffect)((function(){var e=ra(r,"formatting.panels.zones");e&&u(e)}),[r]);var b=function saveToLocalStorgate(e){o(e,"formatting.panels.ranges")},p=Object(O.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r.dispatch({type:Uc,payload:{key:"zones",value:e}}),t&&a.success("zones preferences saved successfully")}),[a,r]);Object(O.useImperativeHandle)(t,(function(){return{saveSetting:function saveSetting(){"function"===typeof d.current.requestSubmit?d.current.requestSubmit():d.current.dispatchEvent(new Event("submit",{cancelable:!0}))}}}));var f=function(){var e=Object(Ae.a)(Me.a.mark((function _callee(e){var t,n,a,i,o,r,c,l;return Me.a.wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:e.preventDefault(),t=e.target,n=new FormData(t),a={},i=Object(Pe.a)(n.entries());try{for(i.s();!(o=i.n()).done;)r=o.value,c=r[0].split("-").join("."),l=["true","false"].includes(r[1])?"true"===r[1]:r[1],a=ia()(a,c,l)}catch(u){i.e(u)}finally{i.f()}p(a,!0),b(a);case 8:case"end":return s.stop()}}),_callee)})));return function handleSubmit(t){return e.apply(this,arguments)}}(),g=Object(O.useCallback)((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=t.join(".");if(s){var i=v()(s,a);return i||null}var o=t.length-1;return di[t[o]]}),[s]);return Object(A.jsx)("div",{style:Up.container,children:Object(A.jsx)("form",{onSubmit:f,ref:d,children:n&&n.map((function(e){return Object(A.jsxs)("div",{style:Up.groupContainer,children:[Object(A.jsx)(Hu,{style:Up.header,value:e}),Kp.map((function(t){return Object(A.jsx)(Cu,{label:t.label,checked:g(e,t.checkController),format:g(e,t.formatController),checkControllerName:t.checkController,formatControllerName:t.formatController,groupID:e},t.id)}))]},e)}))})})}var Wp=fr(Object(O.memo)(Object(O.forwardRef)(ZonesPreferences))),Gp={marginLeft:2,marginRight:2,border:"none",height:"20px"};var qp=function ActionsColumn_ActionsColumn(e){var t=e.rowData,n=e.rowSpanTags,a=useDispatch(),i=useAssignmentData(),o=Object(O.useCallback)((function(e){a({type:jn,payload:{rowData:t,value:e}})}),[a,t]),r=Object(O.useCallback)((function(){a({type:Qt,payload:{id:t.id,assignmentData:i}})}),[i,a,t]),c=Object(O.useCallback)((function(){var e=10*Math.abs(t.x.from-t.x.to);a({type:Ke,xDomain:t.x.from<=t.x.to?[t.x.from-e,t.x.to+e]:[t.x.to-e,t.x.from+e]});var n=10*Math.abs(t.y.from-t.y.to);a({type:We,yDomain:t.y.from<=t.y.to?[t.y.from-n,t.y.to+n]:[t.y.to-n,t.y.from+n]})}),[a,t.x.from,t.x.to,t.y.from,t.y.to]);return Object(A.jsxs)(O.Fragment,{children:[Object(A.jsx)("td",{children:Object(A.jsx)(ob,{onChange:function onChange(e){o(e)},data:Wi,value:t.tableMetaInfo.signal.kind,style:Gp})}),Object(A.jsxs)("td",Object(f.a)(Object(f.a)({},n),{},{children:[Object(A.jsx)("button",{type:"button",className:"delete-button",onClick:r,children:Object(A.jsx)(_e.B,{})}),Object(A.jsx)("button",{type:"button",className:"zoom-button",onClick:c,children:Object(A.jsx)(_e.D,{title:"Zoom to zone in spectrum"})})]}))]})};var Jp=function SignalAssignmentsColumn_SignalAssignmentsColumn(e){var t=e.rowData,n=e.assignment,a=e.highlight,i=e.onHover,o=e.onClick,r=e.onUnlink,c=e.axis,l=e.showUnlinkButton,s=e.setShowUnlinkButton;return Object(A.jsx)("td",Object(f.a)(Object(f.a)({},i),{},{onClick:function onClick(e){return o(e,n,c)},style:a.isActive||n.isActive&&n.activeAxis===c?{color:"red",fontWeight:"bold"}:null,children:v()(t,"tableMetaInfo.signal.".concat(c,".diaID"),[]).length>0?Object(A.jsxs)("div",{onMouseEnter:function onMouseEnter(){return s(!0)},onMouseLeave:function onMouseLeave(){return s(!1)},children:[t.tableMetaInfo.signal[c].diaID.length," ",Object(A.jsx)("sup",{children:Object(A.jsx)("button",{type:"button",style:{visibility:l?"visible":"hidden",padding:0,margin:0},onClick:function onClick(e){return r(e,!1,c)},children:Object(A.jsx)(_e.w,{color:"red"})})})]}):n.isActive&&n.activeAxis===c?"0":""}))};var $p=function SignalAssignmentsColumns(e){var t=e.rowData,n=e.assignmentSignal,a=e.onHoverSignalX,i=e.onHoverSignalY,o=e.showUnlinkButtonSignalX,r=e.showUnlinkButtonSignalY,c=e.setShowUnlinkButtonSignalX,l=e.setShowUnlinkButtonSignalY,s=e.onClick,u=e.onUnlink,d=e.highlightSignalX,b=e.highlightSignalY;return Object(A.jsxs)(O.Fragment,{children:[Object(A.jsx)(Jp,{rowData:t,assignment:n,highlight:d,onHover:a,onClick:s,onUnlink:u,axis:"x",showUnlinkButton:o,setShowUnlinkButton:c}),Object(A.jsx)(Jp,{rowData:t,assignment:n,highlight:b,onHover:i,onClick:s,onUnlink:u,axis:"y",showUnlinkButton:r,setShowUnlinkButton:l})]})};var Qp=function SignalDeltaColumn_SignalDeltaColumn(e){var t=e.rowData,n=e.onHoverSignalX,a=e.onHoverSignalY,i=useDispatch(),o=v()(t,"tableMetaInfo.signal.x.delta",null),r=v()(t,"tableMetaInfo.signal.y.delta",null),c=v()(t,"tableMetaInfo.signal.id",void 0),l=Object(O.useCallback)((function(e){var n=e.target.value;i({type:mn,payload:{zoneID:t.id,signal:{id:c,x:n}}})}),[i,c,t.id]),s=Object(O.useCallback)((function(e){var n=e.target.value;i({type:mn,payload:{zoneID:t.id,signal:{id:c,y:n}}})}),[i,c,t.id]);return Object(A.jsxs)(O.Fragment,{children:[Object(A.jsx)("td",Object(f.a)(Object(f.a)({},n),{},{children:null!==o?Object(A.jsx)(uu,{value:o.toFixed(2),onSave:l,type:"number",style:{padding:"0.1rem 0.4rem"}}):""})),Object(A.jsx)("td",Object(f.a)(Object(f.a)({},a),{},{children:null!==r?Object(A.jsx)(uu,{value:r.toFixed(2),onSave:s,type:"number",style:{padding:"0.1rem 0.4rem"}}):""}))]})};var ef=function ZoneAssignmentColumn(e){var t=e.rowData,n=e.assignment,a=e.highlight,i=e.onHover,o=e.onClick,r=e.onUnlink,c=e.axis,l=e.showUnlinkButton,s=e.setShowUnlinkButton,u=e.rowSpanTags;return Object(A.jsx)("td",Object(f.a)(Object(f.a)(Object(f.a)({},u),i),{},{onClick:function onClick(e){return o(e,n,c)},children:v()(t,"".concat(c,".pubIntegral"),0)>0?v()(t,"".concat(c,".diaID"),[]).length>0?Object(A.jsxs)("div",{onMouseEnter:function onMouseEnter(){return s(!0)},onMouseLeave:function onMouseLeave(){return s(!1)},children:[t[c].pubIntegral," ","(",Object(A.jsx)("span",{style:n.isActive&n.activeAxis===c||n.isOnHover&n.onHoverAxis===c||a.isActive?{color:"red",fontWeight:"bold"}:{color:"black",fontWeight:"normal"},children:v()(t,"".concat(c,".diaID"),[]).length}),")"," ",Object(A.jsx)("sup",{children:Object(A.jsx)("button",{type:"button",style:{visibility:l?"visible":"hidden",padding:0,margin:0},onClick:function onClick(e){return r(e,!0,c)},children:Object(A.jsx)(_e.w,{color:"red"})})})]}):n.isActive&&n.activeAxis===c?Object(A.jsxs)("div",{children:["".concat(v()(t,"".concat(c,".pubIntegral"),"")," ("),Object(A.jsx)("span",{style:{color:"red",fontWeight:"bold"},children:"0"}),")"]}):t[c].pubIntegral:n.isActive&&n.activeAxis===c?Object(A.jsxs)("div",{children:["0 (",Object(A.jsx)("span",{style:{color:"red",fontWeight:"bold"},children:"0"}),")"]}):""}))};var tf=function ZoneAssignmentsColumns(e){var t=e.rowData,n=e.assignmentZone,a=e.onHoverZoneX,i=e.onHoverZoneY,o=e.showUnlinkButtonZoneX,r=e.showUnlinkButtonZoneY,c=e.setShowUnlinkButtonZoneX,l=e.setShowUnlinkButtonZoneY,s=e.rowSpanTags,u=e.onClick,d=e.onUnlink,b=e.highlightZoneX,p=e.highlightZoneY;return Object(A.jsxs)(O.Fragment,{children:[Object(A.jsx)(ef,{rowData:t,assignment:n,highlight:b,onHover:a,onClick:u,onUnlink:d,axis:"x",showUnlinkButton:o,setShowUnlinkButton:c,rowSpanTags:s}),Object(A.jsx)(ef,{rowData:t,assignment:n,highlight:p,onHover:i,onClick:u,onUnlink:d,axis:"y",showUnlinkButton:r,setShowUnlinkButton:l,rowSpanTags:s})]})},nf={backgroundColor:"#ff6f0057"},af={backgroundColor:"#f5f5dc"};var of,rf=function ZonesTableRow(e){var t=e.rowData,n=e.onUnlink,a=e.onContextMenu,i=useAssignment(t.id),o=Object(pi.c)([i.id]),r=Object(pi.c)([Or(i.id,"X")].concat(i.assigned.x||[])),c=Object(pi.c)([Or(i.id,"Y")].concat(i.assigned.y||[])),l=useAssignment(t.tableMetaInfo.id),s=Object(pi.c)([Or(l.id,"X")].concat(l.assigned.x||[],Or(l.id,"Crosshair"))),u=Object(pi.c)([Or(l.id,"Y")].concat(l.assigned.y||[],Or(l.id,"Crosshair"))),d=Object(O.useState)(!1),b=Object(h.a)(d,2),p=b[0],g=b[1],m=Object(O.useState)(!1),j=Object(h.a)(m,2),x=j[0],y=j[1],k=Object(O.useState)(!1),C=Object(h.a)(k,2),D=C[0],S=C[1],w=Object(O.useState)(!1),T=Object(h.a)(w,2),M=T[0],A=T[1],E=Object(O.useMemo)((function(){return{rowSpan:t.tableMetaInfo.rowSpan,style:!0===v()(t,"tableMetaInfo.hide",!1)?{display:"none"}:null}}),[t]),P=Object(O.useCallback)((function(e,a,o){e&&e.stopPropagation(),n(t,a,t.tableMetaInfo.signalIndex,o),"x"===o?void 0!==a?a?(g(!1),i.removeAll("x")):(S(!1),l.removeAll("x")):(g(!1),S(!1)):"y"===o?void 0!==a?a?(y(!1),i.removeAll("y")):(A(!1),l.removeAll("y")):(y(!1),A(!1)):(g(!1),i.removeAll("x"),S(!1),l.removeAll("x"),y(!1),i.removeAll("y"),A(!1),l.removeAll("y"))}),[l,i,n,t]),I=Object(O.useCallback)((function(e,t,n){e.stopPropagation(),t.onClick(n)}),[]),F=Object(O.useMemo)((function(){return{onMouseEnter:function onMouseEnter(){i.onMouseEnter("x"),r.show()},onMouseLeave:function onMouseLeave(){i.onMouseLeave("x"),r.hide()}}}),[i,r]),R=Object(O.useMemo)((function(){return{onMouseEnter:function onMouseEnter(){i.onMouseEnter("y"),c.show()},onMouseLeave:function onMouseLeave(){i.onMouseLeave("y"),c.hide()}}}),[i,c]),_=Object(O.useMemo)((function(){return{onMouseEnter:function onMouseEnter(){l.onMouseEnter("x"),s.show()},onMouseLeave:function onMouseLeave(){l.onMouseLeave("x"),s.hide()}}}),[l,s]),N=Object(O.useMemo)((function(){return{onMouseEnter:function onMouseEnter(){l.onMouseEnter("y"),u.show()},onMouseLeave:function onMouseLeave(){l.onMouseLeave("y"),u.hide()}}}),[l,u]);return Object(me.c)("tr",Object(f.a)(Object(f.a)({onContextMenu:function onContextMenu(e){return a(e,t)},style:o.isActive||i.isActive?nf:!0===v()(t,"tableMetaInfo.isConstantlyHighlighted",!1)?af:null},o.onHover),{},{children:[Object(me.b)("td",Object(f.a)(Object(f.a)({},E),{},{children:t.tableMetaInfo.rowIndex+1})),Object(me.b)(Qp,{rowData:t,onHoverSignalX:_,onHoverSignalY:N}),Object(me.b)($p,{rowData:t,assignmentSignal:l,onHoverSignalX:_,onHoverSignalY:N,showUnlinkButtonSignalX:D,showUnlinkButtonSignalY:M,setShowUnlinkButtonSignalX:function setShowUnlinkButtonSignalX(e){return S(e)},setShowUnlinkButtonSignalY:function setShowUnlinkButtonSignalY(e){return A(e)},onClick:I,onUnlink:P,highlightSignalX:s,highlightSignalY:u}),Object(me.b)(tf,{rowData:t,assignmentZone:i,onHoverZoneX:F,onHoverZoneY:R,showUnlinkButtonZoneX:p,showUnlinkButtonZoneY:x,setShowUnlinkButtonZoneX:function setShowUnlinkButtonZoneX(e){return g(e)},setShowUnlinkButtonZoneY:function setShowUnlinkButtonZoneY(e){return y(e)},rowSpanTags:E,onClick:I,onUnlink:P,highlightZoneX:r,highlightZoneY:c}),Object(me.b)(qp,{rowData:t,rowSpanTags:E})]}))},cf=Object(m.b)(of||(of=Object(g.a)(["\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  font-size: 12px;\n  height: 100%;\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  th,\n  td {\n    white-space: nowrap;\n    text-align: center;\n    margin: 0;\n    padding: 0.1rem 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n      padding: 0 5px;\n    }\n  }\n"])));var lf=function ZonesTable(e){var t=e.tableData,n=e.onUnlink,a=e.context,i=e.nuclei,o=e.preferences,r=Object(O.useRef)(),c=Object(O.useCallback)((function(e,t){checkModifierKeyActivated(e)||(e.preventDefault(),r.current.handleContextMenu(e,t))}),[r]),l=Object(O.useMemo)((function(){var e=[];return t.forEach((function(t,n){1===t.signal.length?e.push(Object(f.a)(Object(f.a)({},t),{},{tableMetaInfo:Object(f.a)(Object(f.a)({},t.tableMetaInfo),{},{signal:t.signal[0],rowIndex:n,signalIndex:0,id:t.signal[0].id})})):t.signal.length>1&&t.signal.forEach((function(a,i){var o=!1,r=null;i<t.signal.length-1&&0===i?r=t.signal.length:o=!0,e.push(Object(f.a)(Object(f.a)({},t),{},{tableMetaInfo:Object(f.a)(Object(f.a)({},t.tableMetaInfo),{},{signal:a,rowSpan:r,hide:o,rowIndex:n,signalIndex:i,id:a.id})}))}))})),e}),[t]),s=Object(O.useMemo)((function(){return l.map((function(e){return Object(me.b)(rf,{rowData:e,onUnlink:n,onContextMenu:function onContextMenu(e,t){return c(e,t)},preferences:o},"zonesTableRow_".concat(e.tableMetaInfo.id))}))}),[c,l,n,o]);return Object(me.c)("div",{children:[Object(me.b)("table",{css:cf,children:Object(me.c)("tbody",{children:[Object(me.c)("tr",{children:[Object(me.b)("th",{rowSpan:2,children:"#"}),Object(me.b)("th",{colSpan:2,children:"\u03b4 (ppm)"}),Object(me.b)("th",{colSpan:2,children:Object(me.b)(_e.u,{})}),Object(me.b)("th",{colSpan:2,children:"\u03a3"}),Object(me.b)("th",{rowSpan:2,children:"Kind"}),Object(me.b)("th",{rowSpan:2,children:""})]}),Object(me.c)("tr",{children:[Object(me.b)("th",{children:i[0]}),Object(me.b)("th",{children:i[1]}),Object(me.b)("th",{children:i[0]}),Object(me.b)("th",{children:i[1]}),Object(me.b)("th",{children:i[0]}),Object(me.b)("th",{children:i[1]})]}),s]})}),Object(me.b)(bu,{ref:r,context:a})]})},sf={container:{flexDirection:"column",height:"100%",display:"flex"},removeAssignmentsButton:{borderRadius:"5px",marginTop:"3px",marginLeft:"2px",border:"none",height:"16px",width:"18px",fontSize:"12px",padding:0,backgroundColor:"transparent"},button:{backgroundColor:"transparent",border:"none"},toggle:{width:"22px",height:"22px",marginLeft:"2px",display:"flex",justifyContent:"center",alignItems:"center"}};function ZonesPanel(e){var t=e.zones,n=e.activeTab,a=e.preferences,i=e.xDomain,o=e.yDomain,r=Object(O.useState)(!1),c=Object(h.a)(r,2),l=c[0],s=c[1],u=useAssignmentData(),d=useDispatch(),b=$(),p=Object(O.useState)(!1),g=Object(h.a)(p,2),m=g[0],j=g[1],x=Object(O.useRef)(),y=Object(O.useMemo)((function(){var e=function isInView(e,t,n,a){var r=1e4;return e*=r,n*=r,a*=r,((t*=r)>=i[0]*r&&e<=i[1]*r||e<=i[0]*r&&t>=i[1]*r)&&(a>=o[0]*r&&n<=o[1]*r||n<=o[0]*r&&a>=o[1]*r)};if(t.values)return(l?function getFilteredZones(t){return t.filter((function(t){return e(t.x.from,t.x.to,t.y.from,t.y.to)}))}(t.values):t.values).map((function(t){return Object(f.a)(Object(f.a)({},t),{},{tableMetaInfo:{isConstantlyHighlighted:e(t.x.from,t.x.to,t.y.from,t.y.to)}})}))}),[t,l,i,o]),k=Object(O.useCallback)((function(){s(!l)}),[l]),C=Object(O.useCallback)((function(e,t,n,a){d({type:vn,payload:{zoneData:e,assignmentData:u,isOnZoneLevel:t,signalIndex:n,axis:a}})}),[u,d]),D=Object(O.useCallback)((function(){t.values.forEach((function(e){return C(e)}))}),[t.values,C]),S=Object(O.useCallback)((function(){b.showConfirmDialog("All assignments will be removed. Are you sure?",{onYes:D})}),[D,b]),w=Object(O.useCallback)((function(){b.showConfirmDialog("All zones will be deleted. Are You sure?",{onYes:function onYes(){d({type:Qt,payload:{assignmentData:u}})}})}),[u,d,b]),T=Object(O.useMemo)((function(){return v()(a,"panels.zones.[".concat(n,"]"))}),[n,a]),M=Object(O.useCallback)((function(){j(!m)}),[m]),E=Object(O.useCallback)((function(){x.current.saveSetting(),j(!1)}),[]),P=Object(O.useCallback)((function(e){oi.emit("onZonesVisibilityChange",{key:e})}),[]);return Object(A.jsx)(A.Fragment,{children:Object(A.jsxs)("div",{style:sf.container,children:[!m&&Object(A.jsxs)(nu,{counter:t.values?t.values.length:0,onDelete:w,deleteToolTip:"Delete All Zones",onFilter:k,filterToolTip:l?"Show all zones":"Hide zones out of view",filterIsActive:l,counterFiltered:y&&y.length,showSettingButton:"true",onSettingClick:M,children:[Object(A.jsx)(Zn,{title:"Remove all Assignments",popupPlacement:"right",children:Object(A.jsx)("button",{style:sf.removeAssignmentsButton,type:"button",onClick:S,disabled:!t.values||0===t.values.length,children:Object(A.jsx)(_e.H,{})})}),Object(A.jsx)(Qs,{popupTitle:"show/hide zones",popupPlacement:"right",style:sf.toggle,defaultValue:!0,onClick:function onClick(){return P("zones")},children:Object(A.jsx)("span",{style:{fontSize:"12px",pointerEvents:"none"},children:"z"})}),Object(A.jsx)(Qs,{popupTitle:"show/hide signals",popupPlacement:"right",style:sf.toggle,defaultValue:!0,onClick:function onClick(){return P("signals")},children:Object(A.jsx)("span",{style:{fontSize:"12px",pointerEvents:"none"},children:"s"})}),Object(A.jsx)(Qs,{popupTitle:"show/hide peaks",popupPlacement:"right",style:sf.toggle,defaultValue:!0,onClick:function onClick(){return P("peaks")},children:Object(A.jsx)("span",{style:{fontSize:"12px",pointerEvents:"none"},children:"p"})})]}),m&&Object(A.jsx)(cu,{onSave:E,onClose:M}),Object(A.jsx)("div",{style:{height:"100%",overflow:"auto"},children:Object(A.jsxs)(xs.a,{isFlipped:m,infinite:!0,containerStyle:{overflow:"hidden"},children:[Object(A.jsx)("div",{children:y&&y.length>0?Object(A.jsx)(lf,{tableData:y,onUnlink:C,preferences:T,nuclei:n&&2===n.split(",").length?n.split(","):["?","?"]}):Object(A.jsx)(gu,{})}),Object(A.jsx)(Wp,{ref:x})]})})]})})}var uf=fr(Object(O.memo)(ZonesPanel)),df={width:"100%",height:"100%",padding:"0px",display:"flex",flexDirection:"column"};function Table(e){var t=e.children,n=e.className,a=e.style;return Object(A.jsx)("div",{className:n,style:Object(f.a)(Object(f.a)({},df),a),children:t})}var bf=Object(O.memo)(Table),pf={width:"100%",overflowY:"auto",display:"flex",flexDirection:"column",padding:"5px 0px",color:"gray"};function TableBody(e){var t=e.children,n=e.className,a=e.style,i=Object(O.useMemo)((function(){return O.Children.map(t,(function(e){return Object(O.cloneElement)(e,{style:Object(f.a)({borderBottom:"0.55px solid #d8d8d8"},e.props.style)})}))}),[t]);return Object(A.jsx)("div",{className:n,style:Object(f.a)(Object(f.a)({},pf),{},{style:a}),children:i})}var ff=Object(O.memo)(TableBody),hf={width:"100%",display:"flex",alignItems:"flex-start"};function getVAlign(e){return"top"===e.toLowerCase()?"flex-start":"bottom"===e.toLowerCase()?"flex-end":"center"}function TableHeader(e){var t=e.children,n=e.className,a=e.style,i=e.align,o=void 0===i?"center":i,r=e.vAlign,c=void 0===r?"center":r,l=e.size,s=void 0===l?1:l,u=e.onClick;return Object(A.jsx)("div",{className:n,style:Object(f.a)(Object(f.a)({},hf),{},{alignItems:getVAlign(c),textAlign:o,flex:s},a),onClick:u,children:t})}TableHeader.defaultProps={onClick:function onClick(){return null}};var gf=Object(O.memo)(TableHeader),mf={width:"100%",display:"flex",padding:"0px 5px",color:"#424242",backgroundColor:"#d8d8d8",borderBottom:"0.55px solid #d8d8d8",fontSize:11,fontWeight:"bold"};function TableHead(e){var t=e.children,n=e.className,a=e.style;return Object(A.jsx)("div",{className:n,style:Object(f.a)(Object(f.a)({},mf),a),children:t})}var jf=Object(O.memo)(TableHead),vf={width:"100%",display:"flex",padding:"5px 0px"};function TableRow_TableHeader(e){var t=e.children,n=e.className,a=e.style,i=e.onClick;return Object(A.jsx)("div",{className:n,style:Object(f.a)(Object(f.a)({},vf),a),onClick:i,children:t})}TableRow_TableHeader.defaultProps={onClick:function onClick(){return null}};var Of=Object(O.memo)(TableRow_TableHeader);var xf=function FiltersWrapper(e){var t=function Wrapper(t){var n=useChartData(),a=n.data,i=n.activeSpectrum,o=Object(O.useMemo)((function(){return a&&i&&i.id?a.find((function(e){return e.id===i.id}))||{filters:[]}:{}}),[i,a]).filters,r=void 0===o?[]:o,c=t.forwardedRef,l=Object(le.a)(t,["forwardedRef"]);return Object(A.jsx)(e,Object(f.a)(Object(f.a)({},l),{},{filters:r,ref:c}))};return Object(O.forwardRef)((function(e,n){return Object(A.jsx)(t,Object(f.a)(Object(f.a)({},e),{},{forwardedRef:n}))}))},yf=n(392),kf={button:{backgroundColor:"transparent",border:"none",height:25,width:25,padding:"5px"},active:{backgroundColor:"#fbfbfb",borderTop:"1px solid #817066",borderBottom:"1px solid #817066"}};function FiltersTableRow(e){var t=e.filters,n=useDispatch(),a=Object(O.useState)(),i=Object(h.a)(a,2),o=i[0],r=i[1],c=Object(O.useCallback)((function(e,t){n({type:kt,id:e,checked:t})}),[n]),l=Object(O.useCallback)((function(e){n({type:Ct,id:e})}),[n]),s=Object(O.useCallback)((function(e){r((function(t){var a=t===e?null:e;return n({type:tn,id:a}),a}))}),[n]);return Object(O.useMemo)((function(){return t&&t.map((function(e){return Object(A.jsxs)(Of,{style:e.id===o?Object(f.a)({},kf.active):{},children:[Object(A.jsx)(gf,{align:"center",size:"2",onClick:function onClick(){return s(e.id)},children:e.label}),Object(A.jsx)(gf,{align:"left",size:"3",children:Object(A.jsx)("div",{onClick:function onClick(e){return e.stopPropagation()},children:Object(A.jsx)(yf.a,{data:e.error?e.error:e.value})})}),Object(A.jsxs)(gf,{align:"center",vAlign:"center",size:"1",children:[Object(A.jsx)(tl,{checked:e.flag,onChange:function onChange(t){return c(e.id,t.target.checked)}}),e.isDeleteAllow&&Object(A.jsx)("button",{style:kf.button,type:"button",onClick:function onClick(){return l(e.id)},children:Object(A.jsx)(_e.B,{})})]})]},e.id)}))}),[s,t,l,c,o])}var Cf=Object(O.memo)(FiltersTableRow);function FilterPanel(e){var t=e.filters;return Object(O.useMemo)((function(){return t?Object(A.jsxs)(bf,{children:[Object(A.jsx)(jf,{children:Object(A.jsxs)(Of,{children:[Object(A.jsx)(gf,{align:"center",size:"1",children:"Label"}),Object(A.jsx)(gf,{align:"center",size:"2",children:"Properties"})]})}),Object(A.jsx)(ff,{children:Object(A.jsx)(Cf,{filters:t})})]}):Object(A.jsx)(gu,{})}),[t])}var Df=xf(Object(O.memo)(FilterPanel)),Sf=[{title:"Spectra",component:Object(A.jsx)(gp,{}),openWhen:null,style:"",hidePreferenceKey:"hideSpectraPanel",mode:null},{title:"Information",component:Object(A.jsx)(js,{}),openWhen:null,style:{overflow:"hidden"},hidePreferenceKey:"hideInformationPanel",mode:null},{title:"Peaks",component:Object(A.jsx)(Ud,{}),openWhen:[Ua.peakPicking.id],style:"",hidePreferenceKey:"hidePeaksPanel",mode:null},{title:"Filters",component:Object(A.jsx)(Df,{}),openWhen:null,style:"",hidePreferenceKey:"hideFiltersPanel",mode:null},{title:"Integrals",component:Object(A.jsx)(Au,{}),openWhen:[Ua.integral.id],style:"",hidePreferenceKey:"hideIntegralsPanel",mode:null},{title:"Ranges",component:Object(A.jsx)(qb,{}),openWhen:[Ua.rangesPicking.id],style:"",hidePreferenceKey:"hideRangesPanel",mode:er.DM_1D},{title:"Multiple Spectra Analysis",component:Object(A.jsx)(Ld,{}),openWhen:[Ua.multipleSpectraAnalysis.id],style:"",hidePreferenceKey:"hideMultipleSpectraAnalysisPanel",mode:null},{title:"Zones",component:Object(A.jsx)(uf,{}),openWhen:[Ua.zone2D.id],style:"",hidePreferenceKey:"hideZonesPanel",mode:er.DM_2D},{title:"Summary",component:Object(A.jsx)(Zp,{}),openWhen:[],style:"",hidePreferenceKey:"hideSummaryPanel",mode:null},{title:"Structures",component:Object(A.jsx)(ad,{}),openWhen:[Ua.rangesPicking.id],style:"",hidePreferenceKey:"hideStructuresPanel",mode:null}];function Panels(e){var t=e.selectedTool,n=e.displayerMode,a=Object(O.useState)(0),i=Object(h.a)(a,2),o=i[0],r=i[1],c=usePreferences();Object(O.useEffect)((function(){var e=function getDefaultIndex(){var e=Sf.findIndex((function(e){return e.openWhen&&e.openWhen.includes(t)}));return-1!==e?e:null}();t&&r(e)}),[t]);var l=Object(O.useCallback)((function(e){return!v()(c,"display.panels.".concat(e.hidePreferenceKey))&&(null==e.mode||e.mode===n)}),[n,c]);return Object(A.jsx)(ds,{defaultOpenIndex:o,children:Sf.map((function(e){return l(e)&&Object(A.jsx)(is,{title:e.title,style:e.style,children:e.component},e.title)}))})}var wf=Object(O.memo)(Panels),Tf=[Kt,Ot,xt,Lt,Ut,Nt,Ge,Qe,_t,$e,zt,Et,qe,Je,Ke,We,st,lt,wt,jt,tt,"SAVE_AS_SVG","SAVE_DATA_AS_JSON",Bt,nt,at,it,yt,ot];var Mf=function checkActionType(e){return!Tf.includes(e)};function handleUpdateCorrelations(e){var t=e.data,n=e.correlations;e.correlations=kp.Build.build(t,n.options,Dp()(n.values))}function getActiveData(e){if(e.activeTab){var t=Qb("nucleus")(e.data)[e.activeTab];if(e.displayerMode===er.DM_2D)return t;if(e.activeSpectrum&&t){var n=t.findIndex((function(t){return t.id===e.activeSpectrum.id}));if(-1!==n){var a=t[n].info.isFid||!1;t=t.filter((function(e){return e.info.isFid===a}))}}else t=t?t.filter((function(e){return!1===e.info.isFid})):[];var i,o=Object(Pe.a)(e.data);try{var r=function _loop(){var e=i.value;t.some((function(t){return t.id===e.id}))?e.display.isVisibleInDomain=!0:e.display.isVisibleInDomain=!1};for(o.s();!(i=o.n()).done;)r()}catch(c){o.e(c)}finally{o.f()}return e.data}return e.data}function getDomain(e){var t=[],n=[],a={},i={},o={};try{t=e.reduce((function(e,t){var n=t.display,a=t.data;if(n.isVisibleInDomain){var o=[a.x[0],a.x[a.x.length-1]];return i[t.id]=o,n.isVisible&&(e=e.concat(o)),e}return e.concat([])}),[]),n=e.reduce((function(e,t){var n=t.display,i=t.data,r=t.integrals;if(n.isVisibleInDomain){var c=Object(Qn.c)(i.y);if(a[t.id]=c,r.values&&r.values.length>0){var l=r.values[0],s=l.from,u=l.to,d=i.x,b=i.y,p=Object(Ln.j)({x:d,y:b},{from:s,to:u,reverse:!0});o[t.id]=Object(Qn.c)(p.y)}return n.isVisible&&(e=e.concat(c)),e}return e.concat([])}),[])}catch(r){console.log(r)}return{xDomain:Object(Qn.c)(t),yDomain:Object(Qn.c)(n),yDomains:a,xDomains:i,integralYDomain:o}}function get2DDomain(e){var t=[],n=[],a={},i={},o=e.activeTab,r=e.tabActiveSpectrum,c=e.data,l=o.split(",");try{t=c.reduce((function(e,t){return 2===t.info.dimension&&(e=e.concat([t.data.minX,t.data.maxX])),e}),[]),n=c.reduce((function(e,t){var n;return 2===t.info.dimension&&(null===(n=t.info.nucleus)||void 0===n?void 0:n.join(","))===o&&(e=e.concat([t.data.minY,t.data.maxY])),e}),[])}catch(d){console.log(d)}var s=l.map((function(e){var t;return null===(t=r[e])||void 0===t?void 0:t.id})),u=c.reduce((function(e,t){return s.includes(t.id)&&1===t.info.dimension?e.concat(t):e.concat([])}),[]);try{i=u.reduce((function(e,t){var n=t.data.x,a=[n[0],n[n.length-1]];return e[t.id]=a,e}),{}),a=u.reduce((function(e,t){var n=Object(Qn.c)(t.data.y);return e[t.id]=n,e}),{})}catch(d){console.log(d)}return{xDomain:Object(Qn.c)(t),yDomain:Object(Qn.c)(n),yDomains:a,xDomains:i}}function setDomain(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=getActiveData(e);e.activeTab&&[er.DM_1D,er.DM_2D].includes(e.displayerMode)&&(t=e.displayerMode===er.DM_1D?getDomain(a):get2DDomain(e),e.xDomain=t.xDomain,e.xDomains=t.xDomains,n?(e.yDomain=t.yDomain,e.displayerMode===er.DM_1D?(e.yDomains=Object.keys(t.yDomains).reduce((function(e,n){return e[n]=t.yDomain,e}),{}),e.originDomain=Object(f.a)(Object(f.a)({},t),{},{yDomains:e.yDomains,originYDomains:t.yDomains})):(e.yDomains=t.yDomains,e.originDomain=t),e.integralsYDomains=t.integralYDomain&&t.integralYDomain,e.originIntegralYDomain=t.integralYDomain&&t.integralYDomain):e.originDomain=Object(f.a)(Object(f.a)({},e.originDomain),{},{xDomain:t.xDomain,xDomains:t.xDomains}))}function setMode(e){var t,n=getActiveData(e).filter((function(e){return!0===e.display.isVisibleInDomain}));e.mode=(null===(t=n[0])||void 0===t?void 0:t.info.isFid)?"LTR":"RTL"}var Af=function getClosestNumber(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e.reduce((function(e,n){return Math.abs(n-t)<Math.abs(e-t)?n:e}));return n},Ef=function(){function ZoomHistory(){Object(ea.a)(this,ZoomHistory),this.stack=[]}return Object(ta.a)(ZoomHistory,[{key:"push",value:function push(e){this.stack.push(e)}},{key:"pop",value:function pop(){return this.stack.pop()?this.stack[this.stack.length-1]:null}},{key:"getLast",value:function getLast(){return 0===this.stack.length?null:this.stack[this.stack.length-1]}}],[{key:"getInstance",value:function getInstance(e,t){return e[t]&&e[t]instanceof ZoomHistory||(e[t]=new ZoomHistory),e[t]}}]),ZoomHistory}();function changeSpectrumVerticalAlignment(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.data&&e.data.length>0)if(t||n&&e.data[0].info.isFid&&!e.data.some((function(e){return!1===e.info.isFid}))){var a=e.height/2;e.verticalAlign.flag=!0,e.verticalAlign.value=a,e.verticalAlign.stacked=!1}else e.verticalAlign.flag=!1,e.verticalAlign.value=20,e.verticalAlign.stacked=!1}function setDataByFilters(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&(e.selectedOptionPanel=null,e.selectedTool=Ua.zoom.id);var n=e.data[e.activeSpectrum.index];n.data.y=n.data.re}function FiltersActions_deleteFilter(e,t){var n;if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){var a,i,o=e.activeSpectrum.index;!function deleteFilter(e,t){for(var n in e.filters=e.filters.slice(0),e.filters=e.filters.filter((function(e){return e.id!==t})),e.data=Object(f.a)(Object(f.a)({},e.data),e.originalData),e.info=Object(f.a)(Object(f.a)({},e.info),e.originalInfo),e.filters){var a=e.filters[n];if(e.filters[n]=Object(f.a)(Object(f.a)({},e.filters[n]),{},{error:null}),a.flag)try{Za[a.name].apply(e,a.value)}catch(i){e.filters[n]=Object(f.a)(Object(f.a)({},e.filters[n]),{},{error:i.message})}}}(e.data[o],t),1===(null===(a=e.data[o].info)||void 0===a?void 0:a.dimension)?updateXShift(e.data[o]):2===(null===(i=e.data[o].info)||void 0===i?void 0:i.dimension)&&updateShift(e.data[o]),setDataByFilters(e,!1),setDomain(e),setMode(e)}}function getRange_getRange(e,t){var n=t.startX,a=t.endX,i=getXScale(e),o=i.invert(n),r=i.invert(a),c=[];return o>r?(c[0]=r,c[1]=o):(c[0]=o,c[1]=r),c}function changeIntegral(e,t){var n,a=Object(fa.a)(e),i=t.data;if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){var o=e.activeSpectrum.index,r=a.data[o],c=e.data[o],l=r.data,s=l.x,u=l.re,d=r.integrals.values.findIndex((function(e){return e.id===i.id}));-1!==d&&(c.integrals.values[d]=Object(f.a)(Object(f.a)({originFrom:i.from,originTo:i.to},i),{},{absolute:Object(Ln.k)({x:s,y:u},{from:i.from,to:i.to,reverse:!0})}),updateIntegralIntegrals(c.integrals))}}function handleChangeIntegralsRaltiveValue(e,t){var n,a=t.id,i=t.value;if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){var o=e.activeSpectrum.index;!function changeIntegralsRealtive(e,t,n){var a=e.values.find((function(e){return e.id===t}));if(a){var i=a.absolute/n,o=e.values.reduce((function(e,t,n){var a=t.absolute/i;return e.sum+=a,e.values[n]=Object(f.a)(Object(f.a)({},t),{},{integral:a}),e}),{values:[],sum:0}),r=o.values,c=o.sum;e.values=r,e.options.sum=c}}(e.data[o].integrals,a,i)}}function initMolecule(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};t.key=e.key||generateID(),t.molfile=e.molfile||"";var n=new gc.Molecule.fromMolfile(t.molfile),a=n.getMolecularFormula();t.mf=a.formula,t.em=a.absoluteWeight,t.mw=a.relativeWeight,t.svg=n.toSVG(50,50);var i=new Fp.MF(t.mf);return t.atoms=i.getInfo().atoms,t}function addMolfile(e,t){var n,a=gc.Molecule.fromMolfile(t).getFragments(),i=Object(Pe.a)(a);try{for(i.s();!(n=i.n()).done;){var o=n.value,r=o.getMolecularFormula(),c=r.formula,l=r.absoluteWeight,s=r.relativeWeight;e.push(initMolecule({molfile:o.toMolfileV3(),svg:o.toSVG(150,150),mf:c,em:l,mw:s}))}}catch(u){i.e(u)}finally{i.f()}}function setFilterChanges(e,t){var n=e.activeSpectrum.id;if(t===Za.phaseCorrection.id){e.tempData=e.data;var a=function getStrongestPeak(e){var t=e.activeSpectrum,n=e.data[t.index].data,a=Object(Qn.e)(n.y),i=n.y.findIndex((function(e){return e===a}));return{xValue:n.x[i],yValue:a,index:i}}(e).xValue;e.pivot=a}else if(e.selectedTool===Ua.phaseCorrection.id){var i=e.data.findIndex((function(e){return e.id===n}));e.data[i].data=e.tempData[i].data}}function resetTool(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.selectedOptionPanel=null,t&&(e.selectedTool=Ua.zoom.id),e.baseLineZones=[],e.tempData&&(e.tempData=null,setDomain(e))}function getSpectrumID(e,t){return e.tabActiveSpectrum[e.activeTab.split(",")[t]].id}function hasAcceptedSpectrum(e,t){var n=e.activeTab.split(",");return e.tabActiveSpectrum[n[t]]&&!e.data[e.tabActiveSpectrum[n[t]].index].info.isFid}function setMargin(e){if(e.displayerMode===er.DM_2D&&e.selectedTool!==Ua.slicingTool.id){var t=hasAcceptedSpectrum(e,0)?tr.top:nr.top,n=hasAcceptedSpectrum(e,1)?tr.left:nr.left;e.margin=Object(f.a)(Object(f.a)({},tr),{},{top:t,left:n})}else e.selectedTool===Ua.slicingTool.id?e.margin=tr:e.displayerMode===er.DM_1D&&(e.margin=nr)}function Processing2DData(e,t){if(e.displayerMode===er.DM_2D){var n,a={},i=Object(Pe.a)(t[e.activeTab]);try{for(i.s();!(n=i.n()).done;){var o=n.value;a[o.id]=o.processingController.drawContours()}}catch(r){i.e(r)}finally{i.f()}e.contours=a}}function setDisplayerMode(e,t){e.displayerMode=t&&t.some((function(e){return 2===e.info.dimension}))?er.DM_2D:er.DM_1D}function setTabActiveSpectrum(e,t){var n,a=[],i={},o=Object.keys(t).sort((function(e,t){return e.split(",").length>t.split(",").length?-1:1})),r=Object(Pe.a)(o);try{var c=function _loop(){var o=n.value,r=t[o],c=o.split(",").length;if(2===c&&a.push(o),1===r.length){var l=e.data.findIndex((function(e){return e.id===r[0].id}));i[o]={id:r[0].id,index:l}}else{var s=t[o],u=s.length;if(u>=2){var d=s.filter((function(e){return!e.info.isFid}));if(d.length>0&&(2===c||1===c&&u!==d.length)){var b=e.data.findIndex((function(e){return e.id===d[0].id}));i[o]={id:d[0].id,index:b}}else i[o]=null}else i[o]=null}};for(r.s();!(n=r.n()).done;)c()}catch(l){r.e(l)}finally{r.f()}return e.tabActiveSpectrum=i,a}function setTab(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=Object.keys(t).sort((function(e,t){return e.split(",").length>t.split(",").length?-1:1}));if(JSON.stringify(i)!==JSON.stringify(Object.keys(e.tabActiveSpectrum))||a){var o=setTabActiveSpectrum(e,t);o.length>0&&null==n?(e.activeSpectrum=e.tabActiveSpectrum[o[0]],e.activeTab=o[0]):(e.activeSpectrum=n?e.tabActiveSpectrum[n]:n,e.activeTab=n)}else e.activeTab=n,e.activeSpectrum=e.tabActiveSpectrum[n];setDisplayerMode(e,t[e.activeTab]),setMargin(e)}function ToolsActions_setActiveTab(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=Qb("nucleus"),i=a(e.data),o=Object.keys(i),r=t&&o.includes(null!==t&&void 0!==t?t:"")?t:o[0];setTab(e,i,r,n),resetTool(e),Processing2DData(e,i),setDomain(e);var c=Ef.getInstance(e.ZoomHistory,e.activeTab),l=c.getLast();l&&(e.xDomain=l.xDomain,e.yDomain=l.yDomain),setMode(e)}function LoadActions_setData(e,t){var n=t||{spectra:[],molecules:[],preferences:{},correlations:{},multipleAnalysis:{}},a=n.spectra,i=n.molecules,o=n.preferences,r=n.correlations;e.data=a,e.molecules=function MoleculeManager_fromJSON(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[],n=0;n<e.length;n++){var a,i=gc.Molecule.fromMolfile(e[n].molfile).getFragments(),o=Object(Pe.a)(i);try{for(o.s();!(a=o.n()).done;){var r=a.value;t.push(initMolecule({molfile:r.toMolfileV3()}))}}catch(c){o.e(c)}finally{o.f()}}return t}(i),e.preferences=o,r&&0!==Object.keys(r).length?e.correlations=kp.Build.init(r):e.correlations=kp.Build.init({values:[],options:{tolerance:Op,mf:""},state:{}})}function loadJDFFile(e,t){var n,a=function addJDFs(e){for(var t=[],n=0;n<e.length;n++)addJDF(t,e[n].binary,{display:{name:e[n].name},source:{jcampURL:e[n].jcampURL?e[n].jcampURL:null}});return t}(t),i=Object(Pe.a)(a);try{for(i.s();!(n=i.n()).done;){var o=n.value;e.data.push(o)}}catch(r){i.e(r)}finally{i.f()}ToolsActions_setActiveTab(e),initZoom1DHandler(e.data),e.isLoading=!1}function loadJcampFile(e,t){var n,a=function addJcamps(e){for(var t=[],n=0;n<e.length;n++)addJcamp(t,e[n].binary.toString(),{display:{name:e[n].name},source:{jcampURL:e[n].jcampURL?e[n].jcampURL:null}});return t}(t),i=Object(Pe.a)(a);try{for(i.s();!(n=i.n()).done;){var o=n.value;e.data.push(o)}}catch(r){i.e(r)}finally{i.f()}changeSpectrumVerticalAlignment(e,!1,!0),ToolsActions_setActiveTab(e),initZoom1DHandler(e.data),e.isLoading=!1}function getRangeIndex(e,t,n){return e.data[t].ranges.values.findIndex((function(e){return e.id===n}))}function handleUnlinkRange(e,t){var n,a=Object(fa.a)(e);if(null===(n=a.activeSpectrum)||void 0===n?void 0:n.id){var i,o=a.activeSpectrum.index,r=t.payload,c=r.rangeData,l=r.assignmentData,s=r.isOnRangeLevel,u=r.signalIndex,d=Object(Pe.a)(c?[c]:a.data[o].ranges.values);try{for(d.s();!(i=d.n()).done;){var b=i.value,p=Qi(Dp()(b),s,u);to(l,s?[{id:p.id}]:[{id:p.signal[u].id}]);var f=getRangeIndex(a,o,p.id);e.data[o].ranges.values[f]=p}}catch(h){d.e(h)}finally{d.f()}}}function handleResizeRange(e,t){var n;if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){var a=e.activeSpectrum.index;!function changeRange(e,t){var n=t.from,a=t.to,i=e.data,o=i.x,r=i.re,c=e.ranges.values.findIndex((function(e){return e.id===t.id})),l=Object(Ln.k)({x:o,y:r},{from:n,to:a,reverse:!0});-1!==c&&(e.ranges.values[c]=Object(f.a)(Object(f.a)(Object(f.a)({},e.ranges.values[c]),{},{originFrom:n,originTo:a},t),{},{absolute:l}),updateIntegralRanges(e))}(e.data[a],t.data)}}function handleAddRange(e,t){var n,a=getRange_getRange(e,{startX:t.startX,endX:t.endX});if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){var i=e.activeSpectrum.index,o=Object(h.a)(a,2),r=o[0],c=o[1];!function addRange(e,t){var n=t.from,a=t.to,i=e.data,o=i.x,r=i.re,c=Object(Ln.k)({x:o,y:r},{from:n,to:a,reverse:!0}),l=Gr(o,r,n,a,e.info.originFrequency);try{var s={id:generateID(),from:n,to:a,absolute:c,signal:[Object(f.a)({id:generateID()},l)],kind:qi};e.ranges.values=e.ranges.values.concat(mapRanges([s],e)),updateIntegralRanges(e)}catch(u){throw new Error("Could not calculate the multiplicity")}}(e.data[i],{from:r,to:c}),handleOnChangeRangesData(e)}}function handleChangeRangeRaltiveValue(e,t){var n,a=t.id,i=t.value;if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){var o=e.activeSpectrum.index;!function changeRangesRealtive(e,t,n){var a=e.ranges.values.find((function(e){return e.id===t}));if(a){var i=a.absolute/n;e.ranges.options.sum=n/a.integral*e.ranges.options.sum,e.ranges.values=e.ranges.values.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{integral:e.absolute/i})}))}}(e.data[o],a,i)}}function handleOnChangeRangesData(e){handleUpdateCorrelations(e)}var Pf=1;function add2dZoneHandler(e,t){var n;if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){var a=e.activeSpectrum.index,i=function get2DRange(e,t){var n=t.startX,a=t.startY,i=t.endX,o=t.endY,r=get2DXScale(e),c=get2DYScale(e),l=1e6*n>1e6*i?i:n,s=1e6*n>1e6*i?n:i,u=1e6*a>1e6*o?o:a,d=1e6*a>1e6*o?a:o,b=c.invert(u),p=r.invert(l),f=c.invert(d);return{fromX:p,fromY:b,toX:r.invert(s),toY:f}}(e,t);!function detectZonesManual(e,t){var n,a=getDetectionZones(e,t),i=getShift(e),o=i.xShift,r=i.yShift,c=Object(Pe.a)(a);try{for(c.s();!(n=c.n()).done;){var l=n.value,s=l.fromTo;e.zones.values.push({id:generateID(),x:s[0],y:s[1],signal:[{id:generateID(),peak:l.peaks,x:{originDelta:l.shiftX-o,delta:l.shiftX,diaID:[]},y:{originDelta:l.shiftY-r,delta:l.shiftY,diaID:[]},kind:"signal"}],kind:qi})}}catch(u){c.e(u)}finally{c.f()}}(e.data[a],{selectedZone:i,thresholdFactor:Pf,convolutionByFFT:!1}),handleOnChangeZonesData(e)}}function handleAutoZonesDetection(e,t){var n;if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){var a=e.activeSpectrum.index;!function detectZones(e,t){var n=getDetectionZones(e,t),a=getShift(e),i=a.xShift,o=a.yShift,r=n.map((function(e){return{id:generateID(),x:{from:e.fromTo[0].from,to:e.fromTo[0].to},y:{from:e.fromTo[1].from,to:e.fromTo[1].to},signal:[{id:generateID(),peak:e.peaks,x:{originDelta:e.shiftX-i,delta:e.shiftX,diaID:[]},y:{originDelta:e.shiftY-o,delta:e.shiftY,diaID:[]},kind:"signal"}],kind:qi}}));e.zones.values=e.zones.values.concat(r)}(e.data[a],t),handleOnChangeZonesData(e)}}function getZoneIndex(e,t,n){return e.data[t].zones.values.findIndex((function(e){return e.id===n}))}function handleUnlinkZone(e,t){var n,a=Object(fa.a)(e);if(null===(n=a.activeSpectrum)||void 0===n?void 0:n.id){var i,o=a.activeSpectrum.index,r=t.payload,c=r.zoneData,l=r.assignmentData,s=r.isOnZoneLevel,u=r.signalIndex,d=r.axis,b=Object(Pe.a)(c?[c]:a.data[o].zones.values);try{for(b.s();!(i=b.n()).done;){var p=i.value,f=jr(Dp()(p),s,u,d);vr(l,s?[{id:f.id}]:[{id:f.signal[u].id}],d);var h=getZoneIndex(a,o,f.id);e.data[o].zones.values[h]=f}}catch(g){b.e(g)}finally{b.f()}}}function handleOnChangeZonesData(e){handleUpdateCorrelations(e)}function setMoleculeHandler(e,t,n){!function MoleculeManager_setMolfile(e,t,n){var a=gc.Molecule.fromMolfile(t).getFragments();if(a.length>1){e=this.molecules.filter((function(e){return e.key!==n}));var i,o=Object(Pe.a)(a);try{for(o.s();!(i=o.n()).done;){var r=i.value,c=r.getMolecularFormula(),l=c.formula,s=c.absoluteWeight,u=c.relativeWeight;e.push(new initMolecule({molfile:r.toMolfileV3(),svg:r.toSVG(150,150),mf:l,em:s,mw:u}))}}catch(j){o.e(j)}finally{o.f()}}else if(1===a.length){var d=a[0],b=d.getMolecularFormula(),p=b.formula,f=b.absoluteWeight,h=b.relativeWeight,g=initMolecule({molfile:d.toMolfileV3(),svg:d.toSVG(150,150),mf:p,em:f,mw:h,key:n}),m=e.findIndex((function(e){return e.key===n}));e.splice(m,1,g)}}(e.molecules,t,n)}oi.on("noiseFactorChanged",(function(e){Pf=e}));var If=n(232);function handleAutoPeakPicking(e,t){var n;if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){e.selectedTool=Ua.zoom.id,e.selectedOptionPanel=null;var a=e.activeSpectrum.index,i=function autoPeakPicking(e,t){var n=t.minMaxRatio,a=t.maxNumberOfPeaks,i=t.noiseFactor,o=t.lookNegative,r=Object(If.a)(e.data.re.map((function(e){return Math.abs(e)}))),c=e.data,l=c.re,s=c.x,u=Object(Kr.e)({x:s,y:l},{lookNegative:o,noiseLevel:r*i,minMaxRatio:n,realTopDetection:!0,maxCriteria:!0,smoothY:!1,sgOptions:{windowSize:15,polynomial:3}});u.sort((function(e,t){return t.y-e.y})),a<u.length&&(u=u.slice(0,a));var d=getShiftX(e);return u.map((function(e){return{id:generateID(),originDelta:e.x-d,delta:e.x,intensity:e.y,width:e.width}}))}(e.data[a],t);e.data[a].peaks.values=i}}function handleDeleteSpectraRanges(e,t){var n=t.colKey;!function deleteSpectraAnalysis(e,t,n){var a=Object.entries(e[n].values).reduce((function(e,n){return delete n[1][t],n[1]&&Object.keys(n[1]).length>0?(e[n[0]]=n[1],e):e}),{});delete e[n].options.columns[t],e[n].values=a,e[n].values=refreshCalculation(e,n),rd()(e[n].values)&&(sd[n]=[])}(e.spectraAnalysis,n,e.activeTab)}function handleSetcolumns(e,t){var n=t.payload;!function setColumn(e,t,n){var a=n.columns,i=n.code;init(e,t),e[t].options.code=i,e[t].options.columns=Object.values(a).reduce((function(e,t){var n=Object(f.a)({},t);return delete n.tempKey,e[t.tempKey]=n,e}),{});var o=e[t].options.columns,r=Object.entries(e[t].values).reduce((function(e,t){var n=Object(h.a)(t,2),i=n[0],o=n[1];return e[i]=Object.keys(a).reduce((function(e,t){var n=a[t].tempKey;return o[t]&&(e[n]=o[t]),e}),{}),e}),{});r=Object.entries(r).reduce((function(e,t){return e[t[0]]=Object.keys(o).reduce((function(e,n){var a=o[n].type===ld;return e[n]=a?{colKey:n,value:calculate(o,r[t[0]],o[n].formula)}:Object(f.a)(Object(f.a)({},t[1][n]),{},{colKey:n}),e}),{}),e}),{}),e[t].values=r}(e.spectraAnalysis,e.activeTab,n)}function handleFiltercolumn(e,t){var n=t.payload,a=n.columnKey,i=n.valueKey;!function changeColumnValueKey(e,t,n,a){e[t].options.columns[n].valueKey=a,e[t].values=refreshCalculation(e,t)}(e.spectraAnalysis,e.activeTab,a,i)}function getReferenceShift(e,t){var n=t.from,a=t.to,i=t.nbPeaks,o=t.targetX,r=t.reference;if(r){var c=function References_getRange(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.nucleus,n=void 0===t?"1H":t,a=e.reference,i=void 0===a?"tms":a;if(!dd[n])throw new Error("Nucleus not found: ",n);var o=dd[n][i.toLowerCase()];if(!o)throw new Error("Reference not found: ",i);return{from:o.delta-.05,to:o.delta+.05,delta:o.delta,nbPeaks:o.nbPeaks}}({reference:r,nucleus:e.nucleus});n=c.from,a=c.to,i=c.nbPeaks,o=c.delta}var l=e.data,s=l.re,u=l.x;return Object(Ln.h)({x:u,y:s},{from:n,to:a},{nbPeaks:i,targetX:o})}function checkIsVisible2D(e){return!1!==e.display.isPositiveVisible||!1!==e.display.isNegativeVisible}function setVisible(e,t){2===e.info.dimension?(e.display.isPositiveVisible=t,e.display.isNegativeVisible=t,e.display.isVisible=checkIsVisible2D(e)):e.display.isVisible=t}var Ff={data:null,contours:null,tempData:null,xDomain:[],yDomain:[],yDomains:{},xDomains:{},originDomain:{},integralsYDomains:{},originIntegralYDomain:{},selectedTool:Ua.zoom.id,selectedFilter:null,selectedOptionPanel:null,activeTab:null,width:0,height:0,margin:{top:10,right:20,bottom:70,left:0},activeSpectrum:null,mode:"RTL",zoomFactor:{scale:1},integralZoomFactor:{scale:.5},molecules:[],verticalAlign:{flag:!1,stacked:!1,value:20},history:{past:[],present:null,future:[],hasUndo:!1,hasRedo:!1},pivot:0,isLoading:!1,preferences:{},baseLineZones:[],keysPreferences:{},displayerMode:er.DM_1D,tabActiveSpectrum:{},spectraAnalysis:{},correlations:kp.Build.init({values:[],options:{tolerance:Op,mf:""},state:{}}),displayerKey:"",ZoomHistory:{},overDisplayer:!1};function dispatchMiddleware(e){return function(t){switch(t.type){case Ne:if(t.payload){var n=t.payload,a=n.spectra,i=Object(le.a)(n,["spectra"]);(function fromJSON(){return _fromJSON.apply(this,arguments)})(a).then((function(n){t.payload=Object(f.a)({spectra:n},i),e(t)}))}else e(t);break;case Be:var o,r=Object(Pe.a)(t.files);try{for(r.s();!(o=r.n()).done;){var c=o.value;addBruker({display:{name:c.name}},c.binary).then((function(n){t.payload=n,e(t)}))}}catch(s){r.e(s)}finally{r.f()}break;case xn:var l=mc.a.Molecule.fromMolfile(t.payload.mol.molfile);Object(Kr.b)(l,{}).then((function(n){t.payload.fromMolfile=n,e(t)}));break;default:e(t)}}}var Rf=Object(fa.b)((function innerSpectrumReducer(e,t){switch(e.actionType=t.type,t.type){case Ne:return function initiate(e,t){e.displayerKey=generateID(),LoadActions_setData(e,t.payload),initZoom1DHandler(e.data),changeSpectrumVerticalAlignment(e,v()(e.preferences,"display.center",null),!0),ToolsActions_setActiveTab(e),e.isLoading=!1}(e,t);case Nt:return function setIsLoading(e,t){e.isLoading=t}(e,t.isLoading);case Le:return function handleLoadJsonFile(e,t){var n=JSON.parse(t[0].binary.toString());for(var a in n.spectra){var i,o;1===(null===(i=n.spectra[a].info)||void 0===i?void 0:i.dimension)?n.spectra[a]=initiateDatum1D(n.spectra[a]):2===(null===(o=n.spectra[a].info)||void 0===o?void 0:o.dimension)&&(n.spectra[a]=initiateDatum2D(n.spectra[a]))}LoadActions_setData(e,n),changeSpectrumVerticalAlignment(e,v()(e.preferences,"display.center",null),!0),ToolsActions_setActiveTab(e),initZoom1DHandler(e.data),e.isLoading=!1}(e,t.files);case ze:return loadJcampFile(e,t.files);case Xe:return loadJDFFile(e,t.files);case He:return function handleLoadMOLFile(e,t){var n,a=Object(Pe.a)(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;addMolfile(e.molecules,i.binary.toString())}}catch(o){a.e(o)}finally{a.f()}e.isLoading=!1}(e,t.files);case Be:return function handleLoadZIPFile(e,t){e.data=t.payload,ToolsActions_setActiveTab(e),initZoom1DHandler(e.data),e.isLoading=!1}(e,t);case Ve:return function addPeak(e,t){var n,a=Object(fa.a)(e);if((null===(n=e.activeSpectrum)||void 0===n?void 0:n.id)&&a){var i=e.activeSpectrum.index,o=getRange_getRange(e,{startX:t.x-10,endX:t.x+10}),r=Object(h.a)(o,2),c=r[0],l=r[1],s=lookupPeak(a.data[i].data,{from:c,to:l}),u=getShiftX(e.data[i]);if(s){var d={id:generateID(),originDelta:s.x-u,delta:s.x,intensity:s.y};e.data[i].peaks.values.push(d)}}}(e,t.mouseCoordinates);case Ye:return function addPeaks(e,t){var n=Object(fa.a)(e);if(e.activeSpectrum){var a=e.activeSpectrum.index,i=n.data[a],o=getRange_getRange(e,{startX:t.startX,endX:t.endX}),r=Object(h.a)(o,2),c=r[0],l=r[1];if(c!==l){var s=lookupPeak(i.data,{from:c,to:l}),u=getShiftX(e.data[a]);if(s&&!i.peaks.values.some((function(e){return e.delta===s.x}))){var d={id:generateID(),originDelta:s.x-u,delta:s.x,intensity:s.y};e.data[a].peaks.values.push(d)}}}}(e,t);case Ze:return function deletePeak(e,t){var n=e.activeSpectrum.index,a=Object(fa.a)(e);if(null==t)e.data[n].peaks.values=[];else{var i=a.data[n].peaks.values.findIndex((function(e){return e.id===t.id}));e.data[n].peaks.values.splice(i,1)}}(e,t.data);case rt:return function addIntegral(e,t){var n,a=Object(fa.a)(e),i=getRange_getRange(e,{startX:t.startX,endX:t.endX}),o=Object(h.a)(i,2),r=o[0],c=o[1];if((null===(n=e.activeSpectrum)||void 0===n?void 0:n.id)&&a){var l=e.activeSpectrum,s=l.id,u=l.index,d=e.data[u],b=d.data,p=b.x,f=b.re,g=getShiftX(d),m={id:generateID(),originFrom:r-g,originTo:c-g,from:r,to:c,absolute:Object(Ln.k)({x:p,y:f},{from:r,to:c,reverse:!0}),kind:"signal"};if(d.integrals.values.push(m),updateIntegralIntegrals(d.integrals),1===d.integrals.values.length){var j=d.integrals.values[0],v=j.from,O=j.to,x=d.data,y=x.x,k=x.y,C=Object(Ln.j)({x:y,y:k},{from:v,to:O,reverse:!0}),D=Object(Qn.c)(C.y);e.integralsYDomains[s]=D,e.originIntegralYDomain[s]=D,setIntegralZoom(e.integralZoomFactor.scale,e)}}}(e,t);case ct:return function deleteIntegral(e,t){var n=Object(fa.a)(e),a=e.activeSpectrum.index,i=t.integralID,o=e.data[a];if(null==i)o.integrals.values=[];else{var r=n.data[a].integrals.values.findIndex((function(e){return e.id===i}));o.integrals.values.splice(r,1),updateIntegralIntegrals(o.integrals)}}(e,t);case Ht:case vt:return changeIntegral(e,t);case yt:return function handleChangeIntegralZoom(e,t){var n=t.deltaY,a=t.deltaMode;ua.wheel(n,a),setIntegralZoom(ua.getScale(),e)}(e,t);case Xt:return function handleChangeIntegralSum(e,t){var n;if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){var a=e.activeSpectrum,i=a.index,o=a.id;e.data[i].integrals.options.sum=t,updateIntegralIntegrals(e.data[i].integrals),e.integralsYDomains||(e.integralsYDomains[o]=e.yDomains[o])}}(e,t.value);case un:return handleChangeIntegralsRaltiveValue(e,t);case Ge:return function setOriginalDomain(e,t){e.originDomain=t}(e,t.domain);case Ke:return function setXDomain(e,t){e.xDomain=t}(e,t.xDomain);case We:return function setYDomain(e,t){e.yDomain=t}(e,t.yDomain);case qe:return function setWidth(e,t){e.width=t}(e,t.width);case Je:return function handleSetDimensions(e,t,n){e.width=t,e.height=n}(e,t.width,t.height);case $e:return function setSelectedTool(e,t){(null===e||void 0===e?void 0:e.data.length)>0&&(t?(t!==e.selectedTool&&resetTool(e,!1),e.selectedTool=t,Ua[t].hasOptionPanel&&(e.selectedOptionPanel=t),Ua[t].isFilter&&setFilterChanges(e,t)):resetTool(e,!1),setMargin(e))}(e,t.selectedTool);case Lt:return function resetSelectedTool(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(e.selectedTool&&Ua[e.selectedTool].isFilter||!t)&&resetTool(e)}(e);case _t:return function setSelectedOptionPanel(e,t){e.selectedOptionPanel=t}(e,t.selectedOptionPanel);case tt:return function zoomOut(e,t){if((null===e||void 0===e?void 0:e.data.length)>0){var n=t.zoomType,a=t.trackID,i=Ef.getInstance(e.ZoomHistory,e.activeTab);if(e.displayerMode===er.DM_1D)switch(n){case da:e.xDomain=e.originDomain.xDomain;break;case ba:setZoom(e,.8);break;case pa:var o=i.pop();e.xDomain=o?o.xDomain:e.originDomain.xDomain,setZoom(e,.8);break;default:e.xDomain=e.originDomain.xDomain,setZoom(e,.8)}else{var r=e.originDomain,c=r.xDomain,l=r.yDomain,s=r.yDomains;switch(a){case Jo.TOP_1D:var u=e.tabActiveSpectrum[e.activeTab.split(",")[0]].id;e.xDomain=c,e.yDomains[u]=s[u];break;case Jo.LEFT_1D:var d=e.tabActiveSpectrum[e.activeTab.split(",")[1]].id;e.yDomain=l,e.yDomains[d]=s[d];break;case Jo.CENTER_2D:var b=i.pop();e.xDomain=b?b.xDomain:c,e.yDomain=b?b.yDomain:l;break;default:e.xDomain=c,e.yDomain=l,e.yDomains=s}}}}(e,t);case Ue:return function shiftSpectrumAlongXAxis(e,t){var n;if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){var a=e.activeSpectrum.index;applyFilter(e.data[a],[{name:Za.shiftX.id,options:t}]),updateXShift(e.data[a]),setDataByFilters(e),setDomain(e)}}(e,t.shiftValue);case Dt:return function applyZeroFillingFilter(e,t){var n;if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){var a=e.activeSpectrum.index,i=[{name:Za.zeroFilling.id,options:t.zeroFillingSize},{name:Za.lineBroadening.id,options:t.lineBroadeningValue}];applyFilter(e.data[a],i),setDataByFilters(e),setDomain(e),setMode(e)}}(e,t.value);case St:return function applyFFTFilter(e){var t;if(null===(t=e.activeSpectrum)||void 0===t?void 0:t.id){var n=e.activeSpectrum.index;applyFilter(e.data[n],[{name:Za.fft.id,options:{}}]),setDataByFilters(e),changeSpectrumVerticalAlignment(e,!1,!0),setDomain(e),setMode(e)}}(e);case Tt:return function applyManualPhaseCorrectionFilter(e,t){var n;if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){var a=e.activeSpectrum.index,i=t.ph0,o=t.ph1,r=e.data[a],c=Af(r.data.x,e.pivot);i-=o*r.data.x.indexOf(c)/r.data.y.length,applyFilter(e.data[a],[{name:Za.phaseCorrection.id,options:{ph0:i,ph1:o}}]),setDataByFilters(e),e.tempData=null,setDomain(e)}}(e,t.value);case Mt:return function applyAutoPhaseCorrectionFilter(e){var t;if(null===(t=e.activeSpectrum)||void 0===t?void 0:t.id){var n=e.activeSpectrum.index,a=e.tempData[n],i=a.data,o=autoPhaseCorrection_apply({data:{x:i.x,re:i.y,im:i.im},info:a.info}),r=o.data,c=o.ph0,l=o.ph1,s=r.im,u=r.re;e.tempData[n].data.im=s,e.tempData[n].data.y=u,applyFilter(e.data[n],[{name:Za.phaseCorrection.id,options:{ph0:c,ph1:l}}]),setDataByFilters(e),e.tempData=null,setDomain(e)}}(e);case At:return function applyAbsoluteFilter(e){var t;if(null===(t=e.activeSpectrum)||void 0===t?void 0:t.id){var n=e.activeSpectrum.index;applyFilter(e.data[n],[{name:Za.absolute.id,options:{}}]),setDataByFilters(e),e.tempData=null,setDomain(e)}}(e);case wt:return function calculateManualPhaseCorrection(e,t){var n=e.tempData,a=e.activeSpectrum.index,i=n[a],o=i.data,r=o.x,c=o.y,l=o.im,s=i.info,u=t.ph0,d=t.ph1,b=Af(n[a].data.x,e.pivot),p={data:{x:r,re:c,im:l},info:s};phaseCorrection_apply(p,{ph0:u-=d*n[a].data.x.indexOf(b)/c.length,ph1:d});var f=p.data,h=f.im,g=f.re;e.tempData[a].data.im=h,e.tempData[a].data.y=g}(e,t.value);case kt:return function FiltersActions_enableFilter(e,t,n){var a;if(null===(a=e.activeSpectrum)||void 0===a?void 0:a.id){var i,o,r=e.activeSpectrum.index;FiltersManager_enableFilter(e.data[r],t,n),1===(null===(i=e.data[r].info)||void 0===i?void 0:i.dimension)?updateXShift(e.data[r]):2===(null===(o=e.data[r].info)||void 0===o?void 0:o.dimension)&&updateShift(e.data[r]),setDataByFilters(e,!1),setDomain(e),setMode(e);var c=Ef.getInstance(e.ZoomHistory,e.activeTab).getLast();c&&(e.xDomain=c.xDomain,e.yDomain=c.yDomain)}}(e,t.id,t.checked);case Ct:return FiltersActions_deleteFilter(e,t.id);case tn:return function filterSnapshotHandler(e,t){var n;if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){var a=e.activeSpectrum.index;if(t.id){var i=e.data[a].filters.findIndex((function(e){return e.id===t.id})),o=e.data[a].filters.slice(0,i+1);reapplyFilters(e.data[a],o)}else reapplyFilters(e.data[a]);setDataByFilters(e),setDomain(e),setMode(e)}}(e,t);case nt:return function handleSpectrumVisibility(e,t){if(Array.isArray(t.id)){var n=t.id;if(0===n.length){var a,i=Object(Pe.a)(e.data);try{for(i.s();!(a=i.n()).done;)setVisible(a.value,!1)}catch(s){i.e(s)}finally{i.f()}}else{var o,r=Object(Pe.a)(e.data);try{for(r.s();!(o=r.n()).done;){var c=o.value;n.includes(c.id)?setVisible(c,!0):setVisible(c,!1)}}catch(s){r.e(s)}finally{r.f()}}}else{var l=e.data.findIndex((function(e){return e.id===t.id}));e.data[l].display[t.key]=t.value,2===e.data[l].info.dimension&&(e.data[l].display.isVisible=checkIsVisible2D(e.data[l]))}}(e,t);case at:return function handleChangePeaksMarkersVisibility(e,t){var n,a=Object(Pe.a)(e.data);try{var i=function _loop(){var e,a=n.value;1===(null===(e=a.info)||void 0===e?void 0:e.dimension)&&t.some((function(e){return e.id===a.id}))?a.display.isPeaksMarkersVisible=!0:a.display.isPeaksMarkersVisible=!1};for(a.s();!(n=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}}(e,t.data);case it:return function SpectrumsActions_handleChangeActiveSpectrum(e,t){var n=!1;if(t){var a=e.data.findIndex((function(e){return e.id===t.id})),i=e.data.findIndex((function(t){var n;return t.id===(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id)}));if(-1!==a){var o=e.data[a];o.display.isVisible=!0,n=-1!==i?e.data[i].info.isFid!==o.info.isFid:o.info.isFid||!1}t=Object(f.a)(Object(f.a)({},t),{},{index:a}),e.activeSpectrum=t,e.tabActiveSpectrum[e.activeTab]=t}else e.activeSpectrum=null,e.tabActiveSpectrum[e.activeTab]=null,n=!1;n&&(setDomain(e),setMode(e))}(e,t.data);case ot:return function handleChangeSpectrumColor(e,t){var n=t.id,a=t.color,i=t.key,o=Object(fa.a)(e).data.findIndex((function(e){return e.id===n}));-1!==o&&(e.data[o].display[i]=a)}(e,t.data);case et:return function changeSpectrumSetting(e,t){var n=t.id,a=t.display,i=Object(fa.a)(e).data.findIndex((function(e){return e.id===n}));-1!==i&&(e.data[i].display=a)}(e,t);case gn:return function alignSpectraHandler(e,t){if(e.data&&e.data.length>0){var n,a=Object(Pe.a)(e.data);try{for(a.s();!(n=a.n()).done;){var i,o,r=n.value;if(1===(null===(i=r.info)||void 0===i?void 0:i.dimension)&&r.info.nucleus===e.activeTab&&!(null===(o=r.info)||void 0===o?void 0:o.isFid)){var c=getReferenceShift(r,Object(f.a)({},t.payload));applyFilter(r,[{name:Za.shiftX.id,options:c}])}}}catch(l){a.e(l)}finally{a.f()}}setDomain(e),setMode(e)}(e,t);case lt:return function handleToggleRealImaginaryVisibility(e){if(null!=e.activeSpectrum){var t=e.activeSpectrum.index;if(e.data[t].display.isRealSpectrumVisible=!e.data[t].display.isRealSpectrumVisible,e.data[t].display.isRealSpectrumVisible){var n=e.data[t].data.re;null!==n&&void 0!==n&&(e.data[t].data.y=n)}else{var a=e.data[t].data.im;null!==a&&void 0!==a&&(e.data[t].data.y=a)}setDomain(e)}}(e);case st:return function ToolsActions_handleZoom(e,t){var n=t.deltaY,a=t.deltaMode,i=t.trackID;if(i)switch(i){case Jo.TOP_1D:Zoom_wheel(n,a,e,getSpectrumID(e,0)),setZoom1D(e,e.margin.top,10,0);break;case Jo.LEFT_1D:Zoom_wheel(n,a,e,getSpectrumID(e,1)),setZoom1D(e,e.margin.left,10,1)}else Zoom_wheel(n,a,e),setZoom(e)}(e,t);case yn:return function setSpectraSameTopHandler(e){e.displayerMode===er.DM_1D&&(e.originDomain.yDomains=e.originDomain.originYDomains,setZoom(e,.8))}(e);case kn:return function resetSpectraScale(e){e.displayerMode===er.DM_1D&&(e.yDomains=Object.keys(e.yDomains).reduce((function(t,n){return t[n]=e.originDomain.yDomain,t}),{}),e.originDomain.yDomains=e.yDomains,e.yDomain=e.originDomain.yDomain)}(e);case jt:return function handleChangeSpectrumDisplayMode(e,t){var n=t.flag,a=Object(fa.a)(e),i=e.activeSpectrum,o=e.height,r=e.activeTab,c=20;if(i){var l=i.index;a.data[l].info.isFid&&(c=o/2)}if(e.verticalAlign.flag=n,e.verticalAlign.stacked=n,n){var s=a.data.filter((function(e){return e.info.nucleus===r})).length;e.verticalAlign.value=Math.floor(o/(s+2))}else e.verticalAlign.value=c}(e,t);case ut:return function addMoleculeHandler(e,t){addMolfile(e.molecules,t)}(e,t.molfile);case dt:return setMoleculeHandler(e,t.molfile,t.key);case bt:return function deleteMoleculeHandler(e,t){var n=t.payload,a=n.key,i=n.assignmentData;e.displayerMode===er.DM_1D&&handleUnlinkRange(e,{payload:{assignmentData:i,rangeData:null}}),e.displayerMode===er.DM_2D&&handleUnlinkZone(e,{payload:{assignmentData:i,zoneData:null}});var o=e.molecules.findIndex((function(e){return e.key===a}));e.molecules.splice(o,1)}(e,t);case xn:return function predictSpectraFromMolculeHandler(e,t){var n=t.payload,a=n.fromMolfile,i=n.options,o=Object(Kr.d)(a.signals,{}),r=o.x,c=o.y,l=null;if(i.spectra["1h"]){var s=initiateDatum1D({data:{x:r,im:null,re:c},info:{nucleus:"1H"}});l=s.id,s.ranges.values=mapRanges(a.ranges,s),updateIntegralRanges(s),e.data.push(s);var u={id:l,index:e.data.length-1};e.tabActiveSpectrum["1H"]=u,e.activeSpectrum=u}ToolsActions_setActiveTab(e),initZoom1DHandler(e.data),setZoom(e,.9,l),e.isLoading=!1}(e,t);case ht:return function handleSetMF(e,t){var n=Object(fa.a)(e),a=n.data,i=n.correlations,o=t.mf;""!==i.options.mf&&i.options.mf===o||(e.correlations=kp.Build.build(a,Object(f.a)(Object(f.a)({},i.options),{},{mf:o}),Dp()(i.values)))}(e,t.payload);case gt:return function handleSetTolerance(e,t){var n=Object(fa.a)(e),a=n.data,i=n.correlations,o=t.tolerance;e.correlations=kp.Build.build(a,Object(f.a)(Object(f.a)({},i.options),{},{tolerance:o}),Dp()(i.values))}(e,t.payload);case pt:return function handleSetCorrelation(e,t){var n=Object(fa.a)(e).correlations,a=t.id,i=t.correlation;e.correlations=kp.CorrelationUtilities.setCorrelation(n,a,i),handleUpdateCorrelations(e)}(e,t.payload);case ft:return function handleSetCorrelations(e,t){var n=t.ids,a=t.correlations;n.forEach((function(t,n){var i=e.correlations;e.correlations=kp.CorrelationUtilities.setCorrelation(i,t,a[n])})),handleUpdateCorrelations(e)}(e,t.payload);case mt:return function handleDeleteSpectra(e,t){var n=e.activeTab,a=Object(fa.a)(e);if(t.id){var i=a.data.findIndex((function(e){return e.id===t.id}));e.data.splice(i,1)}else e.data.forEach((function(t,n){e.data.splice(n,1)}));e.activeSpectrum=null,ToolsActions_setActiveTab(e,n,!0)}(e,t);case"SET_INTEGRAL_Y_DOMAIN":return function handleChangeIntegralYDomain(e,t){var n=e.activeSpectrum;n&&(e.integralsYDomains[n.id]=t)}(e,t.yDomain);case Ot:return function handleBrushEnd(e,t){var n=e.displayerMode===er.DM_2D,a=getXScale(e),i=n?get2DYScale(e):getYScale(e),o=a.invert(t.startX),r=a.invert(t.endX),c=i.invert(t.startY),l=i.invert(t.endY),s=o>r?[r,o]:[o,r],u=c>l?[l,c]:[c,l],d=Ef.getInstance(e.ZoomHistory,e.activeTab);if(e.displayerMode===er.DM_2D){switch(t.trackID){case Jo.CENTER_2D:e.xDomain=s,e.yDomain=u;break;case Jo.TOP_1D:e.xDomain=s;break;case Jo.LEFT_1D:e.yDomain=u}d&&d.push({xDomain:s,yDomain:u})}else e.xDomain=s,d&&d.push({xDomain:s,yDomain:u})}(e,t);case Et:return function setVerticalIndicatorXPosition(e,t){var n=getXScale(e);e.pivot=n.invert(t)}(e,t.position);case zt:return function setSpectrumsVerticalAlign(e){changeSpectrumVerticalAlignment(e,!e.verticalAlign.flag)}(e);case Pt:return handleAutoPeakPicking(e,t.options);case Ft:return handleAutoZonesDetection(e,t.options);case It:return function handleAutoRangesDetection(e,t){var n;if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){var a=e.activeSpectrum.index;detectRanges(e.data[a],t),handleOnChangeRangesData(e)}}(e,t.options);case qt:return handleAddRange(e,t);case Rt:return function handleDeleteRange(e,t){var n,a=Object(fa.a)(e);if(null===(n=a.activeSpectrum)||void 0===n?void 0:n.id){var i=a.activeSpectrum.index,o=t.payload,r=o.id,c=o.assignmentData,l=e.data[i];if(r){var s=l.ranges.values.find((function(e){return e.id===r}));to(c,[s]);var u=getRangeIndex(a,i,r);l.ranges.values.splice(u,1)}else to(c,l.ranges.values),l.ranges.values=[];updateIntegralRanges(e.data[i]),handleOnChangeRangesData(e)}}(e,t);case Wt:return handleResizeRange(e,t);case Gt:return function handleChangeRangeSum(e,t){var n;if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){var a=e.activeSpectrum.index;e.data[a].ranges.options.sum=t,updateIntegralRanges(e.data[a])}}(e,t.value);case nn:return handleChangeRangeRaltiveValue(e,t);case an:return function handleChangeRangeSignalValue(e,t){var n,a=t.payload,i=a.rangeID,o=a.signalID,r=a.value;if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){var c=e.activeSpectrum.index,l=function changeRangeSignal(e,t,n,a){var i=0,o=e.ranges.values.findIndex((function(e){return e.id===t}));if(-1!==o){var r=e.ranges.values[o].signal.findIndex((function(e){return e.id===n}));i=a-e.ranges.values[o].signal[r].delta,e.ranges.values[o].signal[r].delta=a}return i}(e.data[c],i,o,r);applyFilter(e.data[c],[{name:Za.shiftX.id,options:l}]),updateXShift(e.data[c]),handleOnChangeRangesData(e),setDomain(e)}}(e,t);case rn:return function handleChangeRangeSignalKind(e,t){var n,a=Object(fa.a)(e);if(null===(n=a.activeSpectrum)||void 0===n?void 0:n.id){var i=a.activeSpectrum.index,o=t.payload,r=o.rowData,c=o.value,l=getRangeIndex(a,i,r.id),s=e.data[i].ranges.values[l];(null===s||void 0===s?void 0:s.signal)&&(s.signal[r.tableMetaInfo.signalIndex].kind=c,s.kind=Gi.includes(c)?qi:Ji,updateIntegralRanges(e.data[i]),handleOnChangeRangesData(e))}}(e,t);case cn:return function handleSaveEditedRange(e,t){var n,a=Object(fa.a)(e);if(null===(n=a.activeSpectrum)||void 0===n?void 0:n.id){var i=a.activeSpectrum.index,o=t.payload,r=o.editedRowData,c=o.assignmentData,l=Qi(r);delete l.tableMetaInfo,to(c,l);var s=getRangeIndex(a,i,l.id);e.data[i].ranges.values[s]=l,updateIntegralRanges(e.data[i]),handleOnChangeRangesData(e)}}(e,t);case ln:return handleUnlinkRange(e,t);case sn:return function handleSetDiaIDRange(e,t){var n,a=Object(fa.a)(e);if(null===(n=a.activeSpectrum)||void 0===n?void 0:n.id){var i=a.activeSpectrum.index,o=t.payload,r=o.rangeData,c=o.diaID,l=o.signalIndex,s=getRangeIndex(a,i,r.id),u=e.data[i].ranges.values[s];void 0===l?u.diaID=c:u.signal[l].diaID=c,u.pubIntegral=$i(u)}}(e,t);case"SET_PREFERENCES":return function handelSetPreferences(e,t){var n=t.type,a=t.values,i=v()(e.preferences,"panels",{});e.preferences.panels=Object(f.a)(Object(f.a)({},i),{},Object(ie.a)({},n,a))}(e,t.data);case Bt:return function handelSetActiveTab(e,t){t&&ToolsActions_setActiveTab(e,t)}(e,t.tab);case Vt:return function handleAddBaseLineZone(e,t){var n=t.from,a=t.to,i=getXScale(e),o=i.invert(n),r=i.invert(a),c=[];c=o>r?[r,o]:[o,r];var l=e.baseLineZones.slice();l.push({id:generateID(),from:c[0],to:c[1]}),e.baseLineZones=l}(e,t.zone);case Yt:return function handleDeleteBaseLineZone(e,t){var n=Object(fa.a)(e);e.baseLineZones=n.baseLineZones.filter((function(e){return e.id!==t}))}(e,t.id);case Zt:return function handleBaseLineCorrectionFilter(e,t){var n;if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){var a=e.activeSpectrum.index;applyFilter(e.data[a],[{name:Za.baselineCorrection.id,options:Object(f.a)({zones:e.baseLineZones},t.options)}]),e.baseLineZones=[];var i=e.xDomain.slice();setDataByFilters(e),setDomain(e),e.xDomain=i}}(e,t);case Ut:return function setKeyPreferencesHandler(e,t){var n=Object(fa.a)(e),a=n.activeTab,i=n.data,o=n.activeSpectrum,r=n.zoomFactor,c=n.xDomain,l=n.xDomains,s=n.yDomain,u=n.yDomains,d=n.originDomain,b=n.margin,p=n.displayerMode,f=n.tabActiveSpectrum;if(a){var h=Qb("nucleus")(i),g=p===er.DM_2D?h[a].reduce((function(e,t){return e[t.id]=t.processingController.getLevel(),e}),{}):null;e.keysPreferences[t]={activeTab:a,activeSpectrum:o,displayerMode:p,tabActiveSpectrum:f,zoomFactor:r,xDomain:c,xDomains:l,yDomain:s,yDomains:u,originDomain:d,level:g,margin:b,data:h[a].reduce((function(e,t){return e[t.id]={display:{color:t.display.color,isVisible:t.display.isVisible,isPeaksMarkersVisible:t.display.isPeaksMarkersVisible}},e}),{})}}}(e,t.keyCode);case Kt:return function applyKeyPreferencesHandler(e,t){var n=Object(fa.a)(e),a=n.keysPreferences[t];if(a)if(e.activeTab=a.activeTab,n.data.forEach((function(t,n){(function nucluesToString(e){return"string"===typeof e?e:e.join(",")})(t.info.nucleus)===a.activeTab&&(e.data[n].display=Object.assign(Dp()(t.display),a.data[t.id].display))})),e.displayerMode=a.displayerMode,e.tabActiveSpectrum=a.tabActiveSpectrum,e.activeSpectrum=a.activeSpectrum,e.margin=a.margin,setDomain(e),e.xDomain=a.xDomain,e.xDomains=a.xDomains,e.yDomain=a.yDomain,e.originDomain=a.originDomain,e.yDomains=a.yDomains,e.displayerMode===er.DM_2D)for(var i=function _loop(){var t=r[o],i=a.level[t],c=i.levelPositive,l=i.levelNegative,s=n.data.findIndex((function(e){return e.id===t})),u=e.data[s].processingController;u.setLevel(c,l),e.contours[t]=u.drawContours()},o=0,r=Object.keys(a.level);o<r.length;o++)i();else setZoom(e,a.zoomFactor.scale)}(e,t.keyCode);case Jt:return function levelChangeHandler(e,t){var n=t.deltaY,a=t.shiftKey;try{var i;if(null===(i=e.activeSpectrum)||void 0===i?void 0:i.id){var o=e.activeSpectrum,r=o.index,c=o.id,l=e.data[r].processingController;a?l.shiftWheel(n):l.wheel(n);var s=Object.freeze(l.drawContours());e.contours[c]=s}}catch(u){console.log(u)}}(e,t);case $t:return add2dZoneHandler(e,t);case Qt:return function handleDeleteZone(e,t){var n,a=Object(fa.a)(e);if(null===(n=a.activeSpectrum)||void 0===n?void 0:n.id){var i=a.activeSpectrum.index,o=t.payload,r=o.id,c=o.assignmentData;if(r){var l=e.data[i].zones.values.find((function(e){return e.id===r}));vr(c,[l]);var s=getZoneIndex(a,i,r);e.data[i].zones.values.splice(s,1)}else vr(c,e.data[i].zones.values),e.data[i].zones.values=[];handleOnChangeZonesData(e)}}(e,t);case en:return function addMissingProjectionHander(e,t){var n,a=Object(fa.a)(e),i=t.nucleus;if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){var o,r=e.activeSpectrum.index,c=Object(Pe.a)(i);try{for(c.s();!(o=c.n()).done;){var l=o.value,s=Datum2D_getMissingProjection(a.data[r],l);e.data.push(s)}}catch(u){c.e(u)}finally{c.f()}setTab(e,Qb("nucleus")(e.data),e.activeTab,!0),setDomain(e),setMode(e)}}(e,t);case xt:return function handelResetDomain(e){var t=e.originDomain,n=t.xDomain,a=t.yDomain,i=t.xDomains,o=t.yDomains;e.xDomain=n,e.yDomain=a,e.xDomains=i,e.yDomains=o}(e);case mn:return function changeZoneSignalDelta(e,t){var n,a=t.payload,i=a.zoneID,o=a.signal;if(null===(n=e.activeSpectrum)||void 0===n?void 0:n.id){var r=e.activeSpectrum.index,c=function changeZoneSignal(e,t,n){var a=e.zones.values.findIndex((function(e){return e.id===t}));if(-1!==a){var i=e.zones.values[a].signal.findIndex((function(e){return e.id===n.id}));if(-1!==i){var o=e.zones.values[a].signal[i];return{xShift:(null===n||void 0===n?void 0:n.x)||0===(null===n||void 0===n?void 0:n.x)?n.x-o.x.delta:0,yShift:(null===n||void 0===n?void 0:n.y)||0===(null===n||void 0===n?void 0:n.y)?n.y-o.y.delta:0}}}return{xShift:0,yShift:0}}(e.data[r],i,o),l=c.xShift,s=c.yShift,u=[];0!==l&&u.push({name:Za.shift2DX.id,options:l}),0!==s&&u.push({name:Za.shift2DY.id,options:s}),applyFilter(e.data[r],u),updateShift(e.data[r]),setDomain(e),handleOnChangeZonesData(e)}}(e,t);case jn:return function handleChangeZoneSignalKind(e,t){var n,a=Object(fa.a)(e);if(null===(n=a.activeSpectrum)||void 0===n?void 0:n.id){var i=a.activeSpectrum.index,o=t.payload,r=o.rowData,c=o.value,l=getZoneIndex(a,i,r.id),s=e.data[i].zones.values[l];s.signal[r.tableMetaInfo.signalIndex].kind=c,s.kind=Gi.includes(c)?qi:Ji,handleOnChangeZonesData(e)}}(e,t);case vn:return handleUnlinkZone(e,t);case On:return function handleSetDiaIDZone(e,t){var n,a=Object(fa.a)(e);if(null===(n=a.activeSpectrum)||void 0===n?void 0:n.id){var i=a.activeSpectrum.index,o=t.payload,r=o.zoneData,c=o.diaID,l=o.axis,s=o.signalIndex,u=getZoneIndex(a,i,r.id),d=e.data[i].zones.values[u];void 0===s?d[l].diaID=c:d.signal[s][l].diaID=c,d[l].pubIntegral=hr(d,l)}}(e,t);case dn:return function SpectraAanalysisAction_analyzeSpectra(e,t){var n=getRange_getRange(e,t),a=Object(h.a)(n,2),i=a[0],o=a[1];analyzeSpectra(e.data,e.spectraAnalysis,{from:i,to:o,nucleus:e.activeTab})}(e,t);case bn:return handleDeleteSpectraRanges(e,t);case pn:return function handleResizeSpectraRange(e,t){var n=t.payload,a=n.columnKey,i=n.from,o=n.to;analyzeSpectra(e.data,e.spectraAnalysis,{from:i,to:o,nucleus:e.activeTab,columnKey:a})}(e,t);case fn:return handleSetcolumns(e,t);case hn:return handleFiltercolumn(e,t);case"undo":return function handleHistoryUndo(e){var t=e.history,n=t.past,a=t.present,i=t.future,o=n[n.length-1],r=n.slice(0,n.length-1),c=[a].concat(Object(Ee.a)(i)),l=0!==c.length,s=0!==n.length,u=getDomain(e.data),d={past:r,present:o,future:c,hasRedo:l,hasUndo:s};e.xDomain=u.xDomain,e.yDomain=u.yDomain,e.originDomain=u,e.history=d}(e);case"redo":return function handleHistoryRedo(e){var t=e.history,n=(t.future[0],t.future.shift());t.past.push(t.present),t.present=n,t.hasUndo=!0,t.hasRedo=t.future.length>0,setDomain(e.data)}(e);case"reset":return function handleHistoryReset(e,t){e.history={past:[],present:t,future:[],hasRedo:!1,hasUndo:!1}}(e,t);case Cn:return function setIsOverDisplayer(e,t){e.overDisplayer=t.payload}(e,t);default:return}}));var _f,Nf=function ToolBarWrapper(e){var t=function Wrapper(t){var n=useChartData(),a=n.data,i=n.activeSpectrum,o=n.verticalAlign,r=n.displayerMode,c=Object(O.useMemo)((function(){if(a&&i&&i.id){var e=a.find((function(e){return e.id===i.id}));return null!==e&&void 0!==e?{info:e.info,spectrumsCount:e.length}:{}}return{}}),[i,a]).info,l=void 0===c?{}:c,s=t.forwardedRef,u=Object(le.a)(t,["forwardedRef"]);return Object(A.jsx)(e,Object(f.a)(Object(f.a)({},u),{},{info:l,activeSpectrum:i,verticalAlign:o,displayerMode:r,ref:s}))};return Object(O.memo)(Object(O.forwardRef)((function(e,n){return Object(A.jsx)(t,Object(f.a)(Object(f.a)({},e),{},{forwardedRef:n}))})))},Lf=Object(m.b)(_f||(_f=Object(g.a)(["\n  display: flex;\n  flex-direction: column;\n  width: 450px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    display: flex;\n    margin: 30px 5px;\n    input,\n    button {\n      padding: 5px;\n      border: 1px solid gray;\n      border-radius: 5px;\n      height: 36px;\n      margin: 2px;\n    }\n    input {\n      flex: 10;\n    }\n    button {\n      flex: 2;\n      color: white;\n      background-color: gray;\n    }\n  }\n"]))),zf=["dx","jdx"];function LoadJCAMPModal(e){var t=e.onLoadClick,n=e.onClose,a=e.startLoading,i=Object(O.useRef)(),o=Object(O.useCallback)((function(){var e=i.current.value,n=function extractFileMetaFromPath(e){var t=e.replace(/^.*[\\\/]/,"").split(".");return{name:t[0].toLowerCase(),extension:t[1].toLowerCase()}}(e);zf.includes(n.extension)?(a(),function loadFile(e){return _loadFile.apply(this,arguments)}(e).then((function(a){var i={binary:a,name:n.name,jcampURL:e};t(i)}))):t(null)}),[t,a]);return Object(me.c)("div",{css:Lf,children:[Object(me.c)("div",{className:"header handle",children:[Object(me.b)("span",{children:"Load JCAMP Dialog"}),Object(me.b)(Gn,{onClick:n})]}),Object(me.c)("div",{className:"container",children:[Object(me.b)("input",{ref:i,type:"text",placeholder:"Enter URL to JCAMP-DX file"}),Object(me.b)("button",{type:"button",onClick:o,children:"Load"})]})]})}LoadJCAMPModal.defaultProps={onLoadButtonClick:function onLoadButtonClick(){return null},onClose:function onClose(){return null},startLoading:function startLoading(){return null}};var Hf,Bf=LoadJCAMPModal,Xf=Object(m.b)(Hf||(Hf=Object(g.a)(["\n  background-color: transparent;\n  border: none;\n  width: 35px;\n  height: 35px;\n  min-height: 35px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  outline: outline;\n  :focus {\n    outline: none !important;\n  }\n\n  &.fa {\n    svg {\n      font-size: 14px;\n    }\n  }\n  &.cheminfo {\n    svg {\n      font-size: 24px;\n    }\n  }\n"]))),Vf=[{id:"importFile",icon:Object(me.b)(_e.n,{}),label:"Import from file system"},{id:"importJDX",icon:Object(me.b)(_e.n,{}),label:"Add JCAMP-DX from URL"}],Yf=[{id:"svg",icon:Object(me.b)(_e.h,{}),label:"Export as SVG"},{id:"png",icon:Object(me.b)(_e.q,{}),label:"Export as PNG"},{id:"json",icon:Object(me.b)(_e.o,{}),label:"Save data ( Press Ctrl + S )"},{id:"nmre",icon:Object(me.b)(_e.o,{}),label:"Save NMRE data"},{id:"copy",icon:Object(me.b)(_e.e,{}),label:"Copy image to Clipboard ( Press Ctrl + C"}];function BasicToolBar(e){var t=e.info,n=e.verticalAlign,a=e.displayerMode,i=useDispatch(),o=usePreferences(),r=dc(),c=$(),l=useToolsFunctions(),s=l.isStacked,u=l.isRealSpectrumShown,d=l.changeSpectrumViewHandler,b=l.handleChangeDisplayViewMode,p=l.alignSpectrumsVerticallyHandler,h=useExport(),g=h.saveAsSVGHandler,m=h.saveAsPNGHandler,j=h.saveAsJSONHandler,x=h.saveAsNMREHandler,y=h.saveToClipboardHandler,k=Object(f.a)({isComplex:!1,isFid:!1},t),C=Object(O.useCallback)((function(e){e?(i({type:ze,files:[e]}),c.close()):r.error("you file must be one of those extensions [ .jdx, dx ] ")}),[r,i,c]),D=Object(O.useCallback)((function(){c.close(),i({type:Nt,isLoading:!0})}),[i,c]),S=Object(O.useCallback)((function(){c.show(Object(me.b)(Bf,{onLoadClick:C,onClose:function onClose(){return c.close()},startLoading:D}),{})}),[C,c,D]),w=Object(O.useCallback)((function(e){return!v()(o,"display.toolBarButtons.".concat(e))}),[o]),T=Object(O.useCallback)((function(){Tn.current.open()}),[]),M=Object(O.useCallback)((function(e){switch(e.id){case"importFile":T();break;case"importJDX":S();break;default:return}}),[T,S]),A=Object(O.useCallback)((function(e){switch(e.id){case"svg":g();break;case"png":m();break;case"json":j();break;case"nmre":x();break;case"copy":y()}}),[g,m,j,x,y]);return Object(me.c)(O.Fragment,{children:[w("hideImport")&&Object(me.b)(Ru,{style:Xf,className:"fa",component:Object(me.b)(_e.r,{}),toolTip:"Import",onClick:M,items:Vf}),w("hideExportAs")&&Object(me.b)(Ru,{style:Xf,className:"fa",component:Object(me.b)(_e.p,{}),toolTip:"Export As",onClick:A,items:Yf}),a===er.DM_1D&&w("hideSpectraStackAlignments")&&Object(me.b)("button",{type:"button",css:Xf,className:"cheminfo",onClick:b,children:Object(me.b)(Zn,{title:"Spectra alignment",popupPlacement:"right",children:s?Object(me.b)(vs.k,{}):Object(me.b)(vs.l,{})})}),a===er.DM_1D&&w("hideRealImaginary")&&k&&k.isComplex&&Object(me.b)("button",{css:Xf,className:"cheminfo",type:"button",onClick:d,children:Object(me.b)(Zn,{title:u?"Display Real ":"Display Imaginary ",popupPlacement:"right",children:Object(me.b)(vs.q,{})})}),a===er.DM_1D&&w("hideSpectraCenterAlignments")&&Object(me.b)("button",{css:Xf,className:"cheminfo",type:"button",onClick:p,children:Object(me.b)(Zn,{title:n.flag?"Baseline  Bottom":"Baseline  Center",popupPlacement:"right",children:n.flag?Object(me.b)(vs.b,{}):Object(me.b)(vs.c,{})})})]})}var Zf,Uf,Kf=Nf(Object(O.memo)(BasicToolBar)),Wf=Object(m.b)(Zf||(Zf=Object(g.a)(["\n  width: 35px;\n  height: 35px;\n  background-color: white;\n  padding: 5px;\n  margin: 0px;\n  border: none;\n  outline: none;\n\n  :focus {\n    outline: none !important;\n  }\n"]))),Gf=Object(m.b)(Uf||(Uf=Object(g.a)(["\n  color: black;\n  background-color: #f3f3f3 !important;\n"])));function ToggleButton_ToggleButton(e){var t=e.children,n=e.value,a=e.disabled,i=e.isActive,o=e.onChange,r=e.className,c=e.style,l=e.isVisible,s=e.onMouseEnter,u=e.onMouseLeave,d=e.helpID,b=Object(O.useState)(i),p=Object(h.a)(b,2),f=p[0],g=p[1],m=Object(O.useCallback)((function(){var e=!f;g(e),o(e?n:null)}),[f,o,n]);return Object(O.useEffect)((function(){g(i)}),[i]),l?Object(me.b)("button",{type:"button",onClick:m,css:[Wf,f&&Gf],style:c,className:" ".concat(r,f?"  active":" "),disabled:a,onMouseEnter:s,onMouseLeave:u,"data-helpid":d,children:Object(O.cloneElement)(t,{style:{fontSize:"10px"}})}):null}ToggleButton_ToggleButton.displayName="ToggleButton",ToggleButton_ToggleButton.defaultProps={isActive:!1,disabled:!1,isVisible:!0,value:null,className:"",onChange:function onChange(){return null},onValueReady:function onValueReady(){return null}};var qf=ToggleButton_ToggleButton,Jf={display:"flex",flexDirection:"column"};function ToggleButtonGroup(e){var t=e.children,n=e.value,a=e.onChange,i=Object(O.useState)([]),o=Object(h.a)(i,2),r=o[0],c=o[1],l=Object(O.useCallback)((function(e){var t=Object(Ee.a)(r).map((function(t){return{value:t.value,isActive:t.value===e}}));c(t),a(e)}),[a,r]),s=Object(O.useMemo)((function(){var e=0;return O.Children.map(t,(function(t){if(t){if("ToggleButton"===t.type.displayName){var n=Object(O.cloneElement)(t,{onChange:l,isActive:r[e]&&r[e].isActive&&r[e].isActive,index:e});return e++,n}return Object(O.cloneElement)(t)}}))}),[t,l,r]);return Object(O.useEffect)((function(){var e=O.Children.map(t,(function(e){if(e&&"ToggleButton"===e.type.displayName)return{value:e.props.value,isActive:e.props.value===n}}));c(e)}),[t,n]),Object(A.jsxs)("div",{style:Jf,children:[" ",s," "]})}ToggleButtonGroup.defaultProps={onChange:function onChange(){return null}};var $f,Qf=ToggleButtonGroup,eh=Object(m.b)($f||($f=Object(g.a)(["\n  button {\n    background-color: transparent;\n    border: none;\n    width: 35px;\n    height: 35px;\n    min-height: 35px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    outline: outline;\n    :focus {\n      outline: none !important;\n    }\n\n    &.fa {\n      svg {\n        font-size: 14px;\n      }\n    }\n    &.cheminfo {\n      svg {\n        font-size: 18px;\n      }\n    }\n  }\n"])));function FunctionToolBar(e){var t=e.defaultValue,n=e.activeSpectrum,a=e.info,i=e.displayerMode,o=Object(O.useState)(),r=Object(h.a)(o,2),c=r[0],l=r[1],s=useHelp(),u=usePreferences(),d=useDispatch(),b={info:Object(f.a)({isComplex:!1,isFid:!1},a)},p=useToolsFunctions(),g=p.handleChangeOption,m=p.handleFullZoomOut,j=Object(O.useCallback)((function(e){l(e),g(e)}),[g]);Object(O.useEffect)((function(){l(t)}),[t]);var x=Object(O.useCallback)((function(){d({type:St,value:""}),d({type:Qe,selectedFilter:null})}),[d]),y=Object(O.useCallback)((function(e){return!v()(u,"display.toolBarButtons.".concat(e))}),[u]);return Object(me.c)("div",{css:eh,children:[Object(me.c)(Qf,{value:c,onChange:j,children:[y("hideZoomTool")&&Object(me.b)(qf,Object(f.a)(Object(f.a)({value:Ua.zoom.id},s.onHover),{},{helpID:"zoomIn",className:"fa",children:Object(me.b)(Zn,{title:"".concat(Ua.zoom.label," ( Press z )"),popupPlacement:"right",offset:{x:10,y:0},style:{display:"flex"},children:Object(me.b)(_e.D,{})})}),Ua.zoom.id),y("hideZoomOutTool")&&Object(me.b)("button",{className:"fa",type:"button",onClick:m,children:Object(me.b)(Zn,{title:"Horizontal zoom out ( Press f ), Horizontal and Vertical zoom out, double click ( Press ff )",popupPlacement:"right",children:Object(me.b)(_e.k,{})})}),i===er.DM_1D&&y("hidePeakTool")&&Object(me.b)(qf,Object(f.a)(Object(f.a)({value:Ua.peakPicking.id,className:"cheminfo",isVisible:n&&b&&!b.info.isFid},s.onHover),{},{helpID:"peakPicking",children:Object(me.b)(Zn,{title:"".concat(Ua.peakPicking.label," ( Press p )"),popupPlacement:"right",offset:{x:10,y:0},children:Object(me.b)(vs.m,{})})}),Ua.peakPicking.id),i===er.DM_1D&&y("hideIntegralTool")&&Object(me.b)(qf,Object(f.a)(Object(f.a)({value:Ua.integral.id,className:"cheminfo",isVisible:n&&b&&!b.info.isFid},s.onHover),{},{helpID:"integralPicking",children:Object(me.b)(Zn,{title:"".concat(Ua.integral.label," ( Press i )"),popupPlacement:"right",offset:{x:10,y:0},children:Object(me.b)(vs.h,{})})}),Ua.integral.id),i===er.DM_2D&&y("hideIntegralTool")&&Object(me.b)(qf,{value:Ua.zone2D.id,className:"fa",isVisible:n,children:Object(me.b)(Zn,{title:"".concat(Ua.zone2D.label," ( Press i  )"),popupPlacement:"right",offset:{x:10,y:0},children:Object(me.b)(_e.g,{})})},Ua.zone2D.id),i===er.DM_2D&&Object(me.b)(qf,{value:Ua.slicingTool.id,style:eh.icon,isVisible:n,children:Object(me.b)(Zn,{title:"".concat(Ua.slicingTool.label),popupPlacement:"right",offset:{x:10,y:0},children:"Slic"})},Ua.slicingTool.id),i===er.DM_1D&&y("hideAutoRangesTool")&&Object(me.b)(qf,{value:Ua.rangesPicking.id,className:"cheminfo",isVisible:n&&b&&!b.info.isFid,children:Object(me.b)(Zn,{title:Ua.rangesPicking.label,popupPlacement:"right",offset:{x:10,y:0},children:Object(me.b)(vs.p,{})})},Ua.rangesPicking.id),i===er.DM_1D&&y("hideMultipleSpectraAnalysisTool")&&Object(me.b)(qf,{value:Ua.multipleSpectraAnalysis.id,className:"cheminfo",children:Object(me.b)(Zn,{title:Ua.multipleSpectraAnalysis.label,popupPlacement:"right",offset:{x:10,y:0},children:Object(me.b)(vs.i,{})})},Ua.multipleSpectraAnalysis.id),i===er.DM_1D&&y("hideZeroFillingTool")&&Object(me.b)(qf,{value:Ua.zeroFilling.id,className:"cheminfo",isVisible:b&&Za.zeroFilling.isApplicable(b),children:Object(me.b)(Zn,{title:Ua.zeroFilling.label,popupPlacement:"right",offset:{x:10,y:0},children:Object(me.b)(vs.u,{})})},Ua.zeroFilling.id),i===er.DM_1D&&y("hidePhaseCorrectionTool")&&Object(me.b)(qf,{value:Ua.phaseCorrection.id,className:"cheminfo",style:eh.icon,isVisible:n&&b&&Za.phaseCorrection.isApplicable(b),children:Object(me.b)(Zn,{title:Ua.phaseCorrection.label,popupPlacement:"right",offset:{x:10,y:0},children:Object(me.b)(vs.o,{})})},Ua.phaseCorrection.id),i===er.DM_1D&&y("hideBaseLineCorrectionTool")&&Object(me.b)(qf,{value:Ua.baseLineCorrection.id,className:"cheminfo",isVisible:n&&b&&Za.baselineCorrection.isApplicable(b),children:Object(me.b)(Zn,{title:Ua.baseLineCorrection.label,popupPlacement:"right",offset:{x:10,y:0},children:Object(me.b)(vs.d,{})})},Ua.baseLineCorrection.id)]}),i===er.DM_1D&&y("hideFFTTool")&&b&&Za.fft.isApplicable(b)&&Object(me.b)("button",{className:"cheminfo",type:"button",onClick:x,children:Object(me.b)(Zn,{title:"FFT Filter",popupPlacement:"right",offset:{x:10,y:0},children:Object(me.b)(vs.f,{})})})]})}var th=Nf(Object(O.memo)(FunctionToolBar));FunctionToolBar.defaultProps={defaultValue:Ua.zoom.id};var nh={display:"flex",flexDirection:"column",alignItems:"start",borderRight:"0.55px solid #f7f7f7",paddingRight:"1px",overflowY:"auto",height:"100%"};function ToolBar(e){var t=e.selectedTool;return Object(A.jsxs)("div",{style:Object(f.a)({},nh),children:[Object(A.jsx)(th,{defaultValue:t}),Object(A.jsx)(Kf,{})]})}var ah,ih=Object(O.memo)(ToolBar),oh={container:{position:"relative",height:"none"},resizer:{width:10,backgroundColor:"#f7f7f7",cursor:"ew-resize"},pane:{overflow:"hidden"}},rh=Object(m.b)(ah||(ah=Object(g.a)(["\n  background-color: white;\n  width: 100%;\n  display: block;\n  height: 100%;\n  font-size: 14px;\n\n  div:focus {\n    outline: none !important;\n  }\n\n  button {\n    cursor: pointer;\n    color: black;\n    &:disabled {\n      cursor: default;\n    }\n  }\n\n  button:active,\n  button:hover,\n  button:focus,\n  [type='button']:focus,\n  button {\n    outline: none !important;\n  }\n  * {\n    -webkit-user-drag: none;\n    -moz-user-drag: none;\n    -o-user-drag: none;\n    user-drag: none;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n  }\n\n  .SplitPane {\n    height: 100%;\n  }\n\n  .Resizer.vertical:after {\n    content: '\\22EE';\n    top: 50%;\n    color: black;\n    position: absolute;\n    font-size: 14px;\n  }\n\n  .Resizer.vertical {\n    padding: 2px;\n  }\n\n  .Resizer.vertical:hover {\n    background-color: #dfdfdf !important;\n    border-left: 0.55px #bbbbbb solid;\n    border-right: 0.55px #bbbbbb solid;\n  }\n"],["\n  background-color: white;\n  width: 100%;\n  display: block;\n  height: 100%;\n  font-size: 14px;\n\n  div:focus {\n    outline: none !important;\n  }\n\n  button {\n    cursor: pointer;\n    color: black;\n    &:disabled {\n      cursor: default;\n    }\n  }\n\n  button:active,\n  button:hover,\n  button:focus,\n  [type='button']:focus,\n  button {\n    outline: none !important;\n  }\n  * {\n    -webkit-user-drag: none;\n    -moz-user-drag: none;\n    -o-user-drag: none;\n    user-drag: none;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n  }\n\n  .SplitPane {\n    height: 100%;\n  }\n\n  .Resizer.vertical:after {\n    content: '\\\\22EE';\n    top: 50%;\n    color: black;\n    position: absolute;\n    font-size: 14px;\n  }\n\n  .Resizer.vertical {\n    padding: 2px;\n  }\n\n  .Resizer.vertical:hover {\n    background-color: #dfdfdf !important;\n    border-left: 0.55px #bbbbbb solid;\n    border-right: 0.55px #bbbbbb solid;\n  }\n"])));function NMRium(e){var t=e.data,n=e.onDataChange,a=e.docsBaseUrl,i=e.preferences,o=e.getSpinner,r=void 0===o?defaultGetSpinner:o,c=e.message,l=void 0===c?void 0:c,s=Object(O.useRef)(null),u=Object(O.useRef)(null),d=Object(y.a)(!1),b=Object(h.a)(d,2),p=b[0],g=b[1],m=Object(k.a)(s,p,{onClose:function onClose(){g(!1)}}),j=Object(O.useState)(!1),C=Object(h.a)(j,2),D=C[0],S=C[1],w=Object(O.useState)(!1),T=Object(h.a)(w,2),M=T[0],A=T[1],E=Object(O.useState)(kc),P=Object(h.a)(E,2),I=P[0],F=P[1],R=Object(O.useReducer)(Rf,Ff),_=Object(h.a)(R,2),L=_[0],H=_[1],X=Object(O.useReducer)(preferencesReducer,Kc),V=Object(h.a)(X,2),Y=V[0],Z=V[1],U=L.selectedTool,K=L.displayerMode,W=L.data;Object(O.useEffect)((function(){Mf(L.actionType)&&(null===n||void 0===n||n(L))}),[n,L]);var G=Object(O.useMemo)((function(){return dispatchMiddleware(H)}),[]);Object(O.useEffect)((function(){var e;null===(e=s.current)||void 0===e||e.focus()}),[m]),Object(O.useEffect)((function(){Z({type:Yc,payload:{display:i,dispatch:Z}})}),[i]),Object(O.useEffect)((function(){G({type:Nt,isLoading:!0}),G({type:Ne,payload:t})}),[t,G]),Object(O.useEffect)((function(){!function setBaseUrl(e){xc=e}(a),F(kc())}),[a]);var q=Object(O.useCallback)((function(e){e&&!D&&(A(!1),H({type:qe,width:e}))}),[D]),J=Object(O.useMemo)((function(){return v()(Y,"controllers.help.preventAutoHelp",!1)}),[Y]),$=Object(O.useCallback)((function(e){e.stopPropagation(),S((function(e){return!e}))}),[]),Q=Object(O.useCallback)((function(e){checkModifierKeyActivated(e)||e.preventDefault()}),[]),ee=Object(O.useCallback)((function(){G({type:Cn,payload:!0})}),[G]),te=Object(O.useCallback)((function(){G({type:Cn,payload:!1})}),[G]);return Object(me.b)(lc,{children:Object(me.b)(Xn,{value:{rootRef:s.current,elementsWraperRef:u.current},children:Object(me.b)(B,{value:Y,children:Object(me.b)("div",{onMouseEnter:ee,onMouseLeave:te,style:{height:"100%",position:"relative"},children:Object(me.b)(Ao,{data:I,wrapperRef:u.current,preventAutoHelp:J,children:Object(me.b)(bc,{wrapperRef:u.current,children:Object(me.b)(z,{value:G,children:Object(me.b)(N,{value:Object(f.a)(Object(f.a)({},L),{},{isResizeEventStart:M}),children:Object(me.b)(we,{wrapperRef:u.current,children:Object(me.b)(pi.a,{children:Object(me.b)(AssignmentProvider,{spectraData:W,children:Object(me.b)(_n,{value:r,children:Object(me.c)("div",{ref:s,css:rh,onContextMenu:Q,children:[Object(me.b)(Oc,{}),Object(me.b)($l,{isFullscreen:m,onMaximize:g}),Object(me.b)("div",{style:{height:"calc(100% - 36px)",width:"100%",backgroundColor:"white"},children:Object(me.c)(An,{children:[Object(me.b)(ih,{selectedTool:U}),Object(me.c)(x.a,{style:oh.container,resizerStyle:oh.resizer,paneStyle:oh.pane,pane1Style:D?{maxWidth:"100%",width:"calc(100% - 10px)"}:{maxWidth:"80%"},split:"vertical",defaultSize:D?"99%":"calc(100% - 600px)",minSize:"80%",onDragFinished:q,onResizerDoubleClick:$,onDragStarted:function onDragStarted(){A(!0)},children:[K===er.DM_1D?Object(me.b)(qo,{message:l}):Object(me.b)(ic,{message:l}),D?null:Object(me.b)(wf,{selectedTool:U,displayerMode:K})]})]})}),Object(me.b)("div",{ref:u,id:"main-wrapper",style:{position:"absolute",pointerEvents:"none",zIndex:0,left:0,right:0,top:0,bottom:0}},String(m))]})})})})})})})})})})})})})}NMRium.defaultProps={docsBaseUrl:"https://dev.nmrium.org/docs/v0",onDataChange:function onDataChange(){return null},preferences:{general:{disableMultipletAnalysis:!1,hideSetSumFromMolecule:!1},panels:{hideSpectraPanel:!1,hideInformationPanel:!1,hidePeaksPanel:!1,hideIntegralsPanel:!1,hideRangesPanel:!1,hideStructuresPanel:!1,hideFiltersPanel:!1,hideZonesPanel:!1,hideSummaryPanel:!1,hideMultipleSpectraAnalysisPanel:!1},toolBarButtons:{hideZoomTool:!1,hideZoomOutTool:!1,hideImport:!1,hideExportAs:!1,hideSpectraStackAlignments:!1,hideSpectraCenterAlignments:!1,hideRealImaginary:!1,hidePeakTool:!1,hideIntegralTool:!1,hideAutoRangesTool:!1,hideZeroFillingTool:!1,hidePhaseCorrectionTool:!1,hideBaseLineCorrectionTool:!1,hideFFTTool:!1,hideMultipleSpectraAnalysisTool:!1}}};t.a=Object(O.memo)(NMRium)}}]);
//# sourceMappingURL=1.3562657f.chunk.js.map